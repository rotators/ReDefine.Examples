diff --git a/Mods/MegaMod/Original/ECBOX.ssl b/Mods/MegaMod/ReDefine/ECBOX.ssl
index 89af649..653ede4 100644
--- a/Mods/MegaMod/Original/ECBOX.ssl
+++ b/Mods/MegaMod/ReDefine/ECBOX.ssl
@@ -180,16 +180,16 @@ begin
             set_local_var(2, 1);
             reg_anim_func(2, source_obj);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 204));
+                display_msg(message_str(SCRIPT_CONTAINR, 204));
             end
             else begin
-                display_msg(message_str(16, 205));
+                display_msg(message_str(SCRIPT_CONTAINR, 205));
             end
         end
         else begin
             if (obj_is_locked(self_obj)) then begin
                 script_overrides;
-                display_msg(message_str(16, 203));
+                display_msg(message_str(SCRIPT_CONTAINR, 203));
                 call Damage_Critter();
             end
             else begin
@@ -200,7 +200,7 @@ begin
     else begin
         if (obj_is_locked(self_obj)) then begin
             script_overrides;
-            display_msg(message_str(16, 203));
+            display_msg(message_str(SCRIPT_CONTAINR, 203));
         end
     end
 end
@@ -248,10 +248,10 @@ begin
             end
             else begin
                 if (source_obj == dude_obj) then begin
-                    display_msg(message_str(16, 195));
+                    display_msg(message_str(SCRIPT_CONTAINR, 195));
                 end
                 else begin
-                    display_msg(obj_name(source_obj) + message_str(16, 200));
+                    display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 200));
                 end
             end
         end
@@ -350,7 +350,7 @@ begin
             end
         end
         else begin
-            display_msg(message_str(16, 193));
+            display_msg(message_str(SCRIPT_CONTAINR, 193));
         end
     end
 end
@@ -396,36 +396,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 102));
+                            display_msg(message_str(SCRIPT_CONTAINR, 102));
                         end
                         else begin
-                            display_msg(message_str(16, 103));
+                            display_msg(message_str(SCRIPT_CONTAINR, 103));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 104));
+                            display_msg(message_str(SCRIPT_CONTAINR, 104));
                         end
                         else begin
-                            display_msg(message_str(16, 105));
+                            display_msg(message_str(SCRIPT_CONTAINR, 105));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 106));
+                            display_msg(message_str(SCRIPT_CONTAINR, 106));
                         end
                         else begin
-                            display_msg(message_str(16, 107));
+                            display_msg(message_str(SCRIPT_CONTAINR, 107));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 108));
+                            display_msg(message_str(SCRIPT_CONTAINR, 108));
                         end
                         else begin
-                            display_msg(message_str(16, 109));
+                            display_msg(message_str(SCRIPT_CONTAINR, 109));
                         end
                     end
                 end
@@ -434,36 +434,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 110));
+                            display_msg(message_str(SCRIPT_CONTAINR, 110));
                         end
                         else begin
-                            display_msg(message_str(16, 111));
+                            display_msg(message_str(SCRIPT_CONTAINR, 111));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 112));
+                            display_msg(message_str(SCRIPT_CONTAINR, 112));
                         end
                         else begin
-                            display_msg(message_str(16, 113));
+                            display_msg(message_str(SCRIPT_CONTAINR, 113));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 114));
+                            display_msg(message_str(SCRIPT_CONTAINR, 114));
                         end
                         else begin
-                            display_msg(message_str(16, 115));
+                            display_msg(message_str(SCRIPT_CONTAINR, 115));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 116));
+                            display_msg(message_str(SCRIPT_CONTAINR, 116));
                         end
                         else begin
-                            display_msg(message_str(16, 117));
+                            display_msg(message_str(SCRIPT_CONTAINR, 117));
                         end
                     end
                 end
@@ -475,36 +475,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 118));
+                            display_msg(message_str(SCRIPT_CONTAINR, 118));
                         end
                         else begin
-                            display_msg(message_str(16, 119));
+                            display_msg(message_str(SCRIPT_CONTAINR, 119));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 120));
+                            display_msg(message_str(SCRIPT_CONTAINR, 120));
                         end
                         else begin
-                            display_msg(message_str(16, 121));
+                            display_msg(message_str(SCRIPT_CONTAINR, 121));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 122));
+                            display_msg(message_str(SCRIPT_CONTAINR, 122));
                         end
                         else begin
-                            display_msg(message_str(16, 123));
+                            display_msg(message_str(SCRIPT_CONTAINR, 123));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 124));
+                            display_msg(message_str(SCRIPT_CONTAINR, 124));
                         end
                         else begin
-                            display_msg(message_str(16, 125));
+                            display_msg(message_str(SCRIPT_CONTAINR, 125));
                         end
                     end
                 end
@@ -513,36 +513,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 126));
+                            display_msg(message_str(SCRIPT_CONTAINR, 126));
                         end
                         else begin
-                            display_msg(message_str(16, 127));
+                            display_msg(message_str(SCRIPT_CONTAINR, 127));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 128));
+                            display_msg(message_str(SCRIPT_CONTAINR, 128));
                         end
                         else begin
-                            display_msg(message_str(16, 129));
+                            display_msg(message_str(SCRIPT_CONTAINR, 129));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 130));
+                            display_msg(message_str(SCRIPT_CONTAINR, 130));
                         end
                         else begin
-                            display_msg(message_str(16, 131));
+                            display_msg(message_str(SCRIPT_CONTAINR, 131));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 132));
+                            display_msg(message_str(SCRIPT_CONTAINR, 132));
                         end
                         else begin
-                            display_msg(message_str(16, 133));
+                            display_msg(message_str(SCRIPT_CONTAINR, 133));
                         end
                     end
                 end
@@ -556,36 +556,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 134));
+                            display_msg(message_str(SCRIPT_CONTAINR, 134));
                         end
                         else begin
-                            display_msg(message_str(16, 135));
+                            display_msg(message_str(SCRIPT_CONTAINR, 135));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 136));
+                            display_msg(message_str(SCRIPT_CONTAINR, 136));
                         end
                         else begin
-                            display_msg(message_str(16, 137));
+                            display_msg(message_str(SCRIPT_CONTAINR, 137));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 138));
+                            display_msg(message_str(SCRIPT_CONTAINR, 138));
                         end
                         else begin
-                            display_msg(message_str(16, 139));
+                            display_msg(message_str(SCRIPT_CONTAINR, 139));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 140));
+                            display_msg(message_str(SCRIPT_CONTAINR, 140));
                         end
                         else begin
-                            display_msg(message_str(16, 141));
+                            display_msg(message_str(SCRIPT_CONTAINR, 141));
                         end
                     end
                 end
@@ -594,36 +594,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 142));
+                            display_msg(message_str(SCRIPT_CONTAINR, 142));
                         end
                         else begin
-                            display_msg(message_str(16, 143));
+                            display_msg(message_str(SCRIPT_CONTAINR, 143));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 144));
+                            display_msg(message_str(SCRIPT_CONTAINR, 144));
                         end
                         else begin
-                            display_msg(message_str(16, 145));
+                            display_msg(message_str(SCRIPT_CONTAINR, 145));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 146));
+                            display_msg(message_str(SCRIPT_CONTAINR, 146));
                         end
                         else begin
-                            display_msg(message_str(16, 147));
+                            display_msg(message_str(SCRIPT_CONTAINR, 147));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 148));
+                            display_msg(message_str(SCRIPT_CONTAINR, 148));
                         end
                         else begin
-                            display_msg(message_str(16, 149));
+                            display_msg(message_str(SCRIPT_CONTAINR, 149));
                         end
                     end
                 end
@@ -635,36 +635,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 150));
+                            display_msg(message_str(SCRIPT_CONTAINR, 150));
                         end
                         else begin
-                            display_msg(message_str(16, 151));
+                            display_msg(message_str(SCRIPT_CONTAINR, 151));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 152));
+                            display_msg(message_str(SCRIPT_CONTAINR, 152));
                         end
                         else begin
-                            display_msg(message_str(16, 153));
+                            display_msg(message_str(SCRIPT_CONTAINR, 153));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 154));
+                            display_msg(message_str(SCRIPT_CONTAINR, 154));
                         end
                         else begin
-                            display_msg(message_str(16, 155));
+                            display_msg(message_str(SCRIPT_CONTAINR, 155));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 156));
+                            display_msg(message_str(SCRIPT_CONTAINR, 156));
                         end
                         else begin
-                            display_msg(message_str(16, 157));
+                            display_msg(message_str(SCRIPT_CONTAINR, 157));
                         end
                     end
                 end
@@ -673,36 +673,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 158));
+                            display_msg(message_str(SCRIPT_CONTAINR, 158));
                         end
                         else begin
-                            display_msg(message_str(16, 159));
+                            display_msg(message_str(SCRIPT_CONTAINR, 159));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 160));
+                            display_msg(message_str(SCRIPT_CONTAINR, 160));
                         end
                         else begin
-                            display_msg(message_str(16, 161));
+                            display_msg(message_str(SCRIPT_CONTAINR, 161));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 162));
+                            display_msg(message_str(SCRIPT_CONTAINR, 162));
                         end
                         else begin
-                            display_msg(message_str(16, 163));
+                            display_msg(message_str(SCRIPT_CONTAINR, 163));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 164));
+                            display_msg(message_str(SCRIPT_CONTAINR, 164));
                         end
                         else begin
-                            display_msg(message_str(16, 165));
+                            display_msg(message_str(SCRIPT_CONTAINR, 165));
                         end
                     end
                 end
@@ -721,36 +721,36 @@ begin
         if (is_critical(LVar0)) then begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 104));
+                    display_msg(message_str(SCRIPT_CONTAINR, 104));
                 end
                 else begin
-                    display_msg(message_str(16, 108));
+                    display_msg(message_str(SCRIPT_CONTAINR, 108));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 112));
+                    display_msg(message_str(SCRIPT_CONTAINR, 112));
                 end
                 else begin
-                    display_msg(message_str(16, 116));
+                    display_msg(message_str(SCRIPT_CONTAINR, 116));
                 end
             end
         end
         else begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 120));
+                    display_msg(message_str(SCRIPT_CONTAINR, 120));
                 end
                 else begin
-                    display_msg(message_str(16, 124));
+                    display_msg(message_str(SCRIPT_CONTAINR, 124));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 128));
+                    display_msg(message_str(SCRIPT_CONTAINR, 128));
                 end
                 else begin
-                    display_msg(message_str(16, 132));
+                    display_msg(message_str(SCRIPT_CONTAINR, 132));
                 end
             end
         end
@@ -759,36 +759,36 @@ begin
         if (is_critical(LVar0)) then begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 136));
+                    display_msg(message_str(SCRIPT_CONTAINR, 136));
                 end
                 else begin
-                    display_msg(message_str(16, 140));
+                    display_msg(message_str(SCRIPT_CONTAINR, 140));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 144));
+                    display_msg(message_str(SCRIPT_CONTAINR, 144));
                 end
                 else begin
-                    display_msg(message_str(16, 148));
+                    display_msg(message_str(SCRIPT_CONTAINR, 148));
                 end
             end
         end
         else begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 152));
+                    display_msg(message_str(SCRIPT_CONTAINR, 152));
                 end
                 else begin
-                    display_msg(message_str(16, 156));
+                    display_msg(message_str(SCRIPT_CONTAINR, 156));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 160));
+                    display_msg(message_str(SCRIPT_CONTAINR, 160));
                 end
                 else begin
-                    display_msg(message_str(16, 164));
+                    display_msg(message_str(SCRIPT_CONTAINR, 164));
                 end
             end
         end
@@ -805,36 +805,36 @@ begin
         if (is_critical(LVar0)) then begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 114));
+                    display_msg(message_str(SCRIPT_CONTAINR, 114));
                 end
                 else begin
-                    display_msg(message_str(16, 115));
+                    display_msg(message_str(SCRIPT_CONTAINR, 115));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 116));
+                    display_msg(message_str(SCRIPT_CONTAINR, 116));
                 end
                 else begin
-                    display_msg(message_str(16, 117));
+                    display_msg(message_str(SCRIPT_CONTAINR, 117));
                 end
             end
         end
         else begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 130));
+                    display_msg(message_str(SCRIPT_CONTAINR, 130));
                 end
                 else begin
-                    display_msg(message_str(16, 131));
+                    display_msg(message_str(SCRIPT_CONTAINR, 131));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 132));
+                    display_msg(message_str(SCRIPT_CONTAINR, 132));
                 end
                 else begin
-                    display_msg(message_str(16, 133));
+                    display_msg(message_str(SCRIPT_CONTAINR, 133));
                 end
             end
         end
@@ -843,36 +843,36 @@ begin
         if (is_critical(LVar0)) then begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 146));
+                    display_msg(message_str(SCRIPT_CONTAINR, 146));
                 end
                 else begin
-                    display_msg(message_str(16, 147));
+                    display_msg(message_str(SCRIPT_CONTAINR, 147));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 148));
+                    display_msg(message_str(SCRIPT_CONTAINR, 148));
                 end
                 else begin
-                    display_msg(message_str(16, 149));
+                    display_msg(message_str(SCRIPT_CONTAINR, 149));
                 end
             end
         end
         else begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 162));
+                    display_msg(message_str(SCRIPT_CONTAINR, 162));
                 end
                 else begin
-                    display_msg(message_str(16, 163));
+                    display_msg(message_str(SCRIPT_CONTAINR, 163));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 164));
+                    display_msg(message_str(SCRIPT_CONTAINR, 164));
                 end
                 else begin
-                    display_msg(message_str(16, 165));
+                    display_msg(message_str(SCRIPT_CONTAINR, 165));
                 end
             end
         end
@@ -891,24 +891,24 @@ begin
         if (local_var(2) == 0) then begin
             set_local_var(2, 1);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 194));
+                display_msg(message_str(SCRIPT_CONTAINR, 194));
             end
             else begin
-                display_msg(message_str(16, 199));
+                display_msg(message_str(SCRIPT_CONTAINR, 199));
             end
             if (local_var(6) == 0) then begin
                 set_local_var(6, 1);
                 give_exp_points(25);
-                display_msg(message_str(14, 100) + 25 + message_str(14, 101));
+                display_msg(g_mstr(100) + 25 + g_mstr(101));
             end
         end
         else begin
             set_local_var(1, 1);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 196));
+                display_msg(message_str(SCRIPT_CONTAINR, 196));
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 201));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 201));
             end
         end
     end
@@ -919,14 +919,14 @@ begin
         else begin
             if (local_var(2) == 0) then begin
                 if (source_obj == dude_obj) then begin
-                    display_msg(message_str(16, 195));
+                    display_msg(message_str(SCRIPT_CONTAINR, 195));
                 end
                 else begin
-                    display_msg(obj_name(source_obj) + message_str(16, 200));
+                    display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 200));
                 end
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 202));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 202));
             end
         end
     end
@@ -950,33 +950,33 @@ begin
         set_local_var(0, 1);
         obj_unlock(self_obj);
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 170));
+            display_msg(message_str(SCRIPT_CONTAINR, 170));
         end
         else begin
-            display_msg(obj_name(source_obj) + message_str(16, 173));
+            display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 173));
         end
         if (local_var(5) == 0) then begin
             set_local_var(5, 1);
             give_exp_points(25);
-            display_msg(message_str(14, 100) + 25 + message_str(14, 101));
+            display_msg(g_mstr(100) + 25 + g_mstr(101));
         end
     end
     else begin
         if (is_critical(Locks_Roll)) then begin
             jam_lock(self_obj);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 171));
+                display_msg(message_str(SCRIPT_CONTAINR, 171));
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 174));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 174));
             end
         end
         else begin
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 172));
+                display_msg(message_str(SCRIPT_CONTAINR, 172));
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 175));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 175));
             end
         end
     end
@@ -994,23 +994,23 @@ begin
         set_local_var(0, 0);
         obj_lock(self_obj);
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 189));
+            display_msg(message_str(SCRIPT_CONTAINR, 189));
         end
         else begin
-            display_msg(obj_name(source_obj) + message_str(16, 191));
+            display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 191));
         end
         if (local_var(5) == 0) then begin
             set_local_var(5, 1);
             give_exp_points(25);
-            display_msg(message_str(14, 100) + 25 + message_str(14, 101));
+            display_msg(g_mstr(100) + 25 + g_mstr(101));
         end
     end
     else begin
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 190));
+            display_msg(message_str(SCRIPT_CONTAINR, 190));
         end
         else begin
-            display_msg(obj_name(source_obj) + message_str(16, 192));
+            display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 192));
         end
     end
 end
@@ -1042,10 +1042,10 @@ begin
     if (obj_is_open(self_obj)) then begin
         script_overrides;
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 206));
+            display_msg(message_str(SCRIPT_CONTAINR, 206));
         end
         else begin
-            display_msg(obj_name(source_obj) + message_str(16, 207));
+            display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 207));
         end
     end
     else begin
@@ -1054,10 +1054,10 @@ begin
         if (is_success(Traps_Roll)) then begin
             set_local_var(1, 0);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 208));
+                display_msg(message_str(SCRIPT_CONTAINR, 208));
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 210));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 210));
             end
         end
         else begin
@@ -1066,10 +1066,10 @@ begin
             end
             else begin
                 if (source_obj == dude_obj) then begin
-                    display_msg(message_str(16, 209));
+                    display_msg(message_str(SCRIPT_CONTAINR, 209));
                 end
                 else begin
-                    display_msg(obj_name(source_obj) + message_str(16, 211));
+                    display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 211));
                 end
             end
         end
@@ -1084,10 +1084,10 @@ begin
         set_local_var(0, 1);
         obj_unlock(self_obj);
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 176));
+            display_msg(message_str(SCRIPT_CONTAINR, 176));
         end
         else begin
-            display_msg(message_str(16, 181));
+            display_msg(message_str(SCRIPT_CONTAINR, 181));
         end
     end
     else begin
@@ -1095,37 +1095,37 @@ begin
             critter_dmg(source_obj, 2, 0 bwor 256);
             if (source_obj == dude_obj) then begin
                 if (2 == 1) then begin
-                    display_msg(message_str(16, 177));
+                    display_msg(message_str(SCRIPT_CONTAINR, 177));
                 end
                 else begin
-                    display_msg(message_str(16, 178) + 2 + message_str(16, 179));
+                    display_msg(message_str(SCRIPT_CONTAINR, 178) + 2 + message_str(SCRIPT_CONTAINR, 179));
                 end
             end
             else begin
-                if (get_critter_stat(source_obj, 34) == 0) then begin
+                if (get_critter_stat(source_obj, STAT_gender) == 0) then begin
                     if (2 == 1) then begin
-                        display_msg(message_str(16, 182));
+                        display_msg(message_str(SCRIPT_CONTAINR, 182));
                     end
                     else begin
-                        display_msg(message_str(16, 183) + 2 + message_str(16, 184));
+                        display_msg(message_str(SCRIPT_CONTAINR, 183) + 2 + message_str(SCRIPT_CONTAINR, 184));
                     end
                 end
                 else begin
                     if (2 == 1) then begin
-                        display_msg(message_str(16, 186));
+                        display_msg(message_str(SCRIPT_CONTAINR, 186));
                     end
                     else begin
-                        display_msg(message_str(16, 187) + 2 + message_str(16, 188));
+                        display_msg(message_str(SCRIPT_CONTAINR, 187) + 2 + message_str(SCRIPT_CONTAINR, 188));
                     end
                 end
             end
         end
         else begin
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 180));
+                display_msg(message_str(SCRIPT_CONTAINR, 180));
             end
             else begin
-                display_msg(message_str(16, 185));
+                display_msg(message_str(SCRIPT_CONTAINR, 185));
             end
         end
     end
@@ -1137,11 +1137,11 @@ begin
     LVar0 := random(10, 20);
     if (source_obj == dude_obj) then begin
         critter_dmg(dude_obj, LVar0, 6 bwor 256);
-        display_msg(message_str(16, 166) + LVar0 + message_str(16, 167));
+        display_msg(message_str(SCRIPT_CONTAINR, 166) + LVar0 + message_str(SCRIPT_CONTAINR, 167));
     end
     else begin
         critter_dmg(source_obj, LVar0, 6 bwor 256);
-        display_msg(obj_name(source_obj) + message_str(16, 168) + LVar0 + message_str(16, 169));
+        display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 168) + LVar0 + message_str(SCRIPT_CONTAINR, 169));
     end
     set_local_var(1, 1);
 end
@@ -1149,32 +1149,32 @@ end
 procedure GetZone
 begin
     variable LVar0 := 0;
-    if ((metarule(44, 0) >= 0) and (metarule(44, 0) <= 350)) then begin
-        if ((metarule(45, 0) >= 0) and (metarule(45, 0) <= 700)) then begin
+    if ((worldmap_xpos >= 0) and (worldmap_xpos <= 350)) then begin
+        if ((worldmap_ypos >= 0) and (worldmap_ypos <= 700)) then begin
             LVar0 := 1;
         end
     end
     if (LVar0) then begin
         return 1;
     end
-    if ((metarule(44, 0) >= 350) and (metarule(44, 0) <= 1400)) then begin
-        if ((metarule(45, 0) >= 0) and (metarule(45, 0) <= 400)) then begin
+    if ((worldmap_xpos >= 350) and (worldmap_xpos <= 1400)) then begin
+        if ((worldmap_ypos >= 0) and (worldmap_ypos <= 400)) then begin
             LVar0 := 1;
         end
     end
     if (LVar0) then begin
         return 2;
     end
-    if ((metarule(44, 0) >= 350) and (metarule(44, 0) <= 1400)) then begin
-        if ((metarule(45, 0) >= 400) and (metarule(45, 0) <= 1100)) then begin
+    if ((worldmap_xpos >= 350) and (worldmap_xpos <= 1400)) then begin
+        if ((worldmap_ypos >= 400) and (worldmap_ypos <= 1100)) then begin
             LVar0 := 1;
         end
     end
     if (LVar0) then begin
         return 3;
     end
-    if ((metarule(44, 0) >= 700) and (metarule(44, 0) <= 1400)) then begin
-        if ((metarule(45, 0) >= 2400) and (metarule(45, 0) <= 2700)) then begin
+    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 1400)) then begin
+        if ((worldmap_ypos >= 2400) and (worldmap_ypos <= 2700)) then begin
             LVar0 := 1;
         end
     end
@@ -1218,7 +1218,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
-                restock_obj := create_object_sid(272, 0, 0, -1);
+                restock_obj := create_object(272, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 272));
             end
             else begin
@@ -1230,17 +1230,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 272);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1259,7 +1259,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
-            restock_obj := create_object_sid(272, 0, 0, -1);
+            restock_obj := create_object(272, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 272));
         end
         else begin
@@ -1271,17 +1271,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 272);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1301,7 +1301,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
-                restock_obj := create_object_sid(271, 0, 0, -1);
+                restock_obj := create_object(271, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 271));
             end
             else begin
@@ -1313,17 +1313,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 271);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1342,7 +1342,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
-            restock_obj := create_object_sid(271, 0, 0, -1);
+            restock_obj := create_object(271, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 271));
         end
         else begin
@@ -1354,17 +1354,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 271);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1380,11 +1380,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
         if (10 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
-                restock_obj := create_object_sid(4, 0, 0, -1);
+                restock_obj := create_object(4, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 4));
             end
             else begin
@@ -1396,17 +1396,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 4);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1425,7 +1425,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
-            restock_obj := create_object_sid(4, 0, 0, -1);
+            restock_obj := create_object(4, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 4));
         end
         else begin
@@ -1437,17 +1437,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 4);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1467,7 +1467,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 320) < restock_amt) then begin
         if (20 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 320) < restock_amt) then begin
-                restock_obj := create_object_sid(320, 0, 0, -1);
+                restock_obj := create_object(320, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 320));
             end
             else begin
@@ -1479,17 +1479,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 320);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1508,7 +1508,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 320) < restock_amt) then begin
-            restock_obj := create_object_sid(320, 0, 0, -1);
+            restock_obj := create_object(320, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 320));
         end
         else begin
@@ -1520,17 +1520,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 320);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1546,11 +1546,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 7) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 7) < restock_amt) then begin
-                restock_obj := create_object_sid(7, 0, 0, -1);
+                restock_obj := create_object(7, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 7));
             end
             else begin
@@ -1562,17 +1562,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 7);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1591,7 +1591,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 7) < restock_amt) then begin
-            restock_obj := create_object_sid(7, 0, 0, -1);
+            restock_obj := create_object(7, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 7));
         end
         else begin
@@ -1603,17 +1603,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 7);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1633,7 +1633,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 19) < restock_amt) then begin
         if (20 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 19) < restock_amt) then begin
-                restock_obj := create_object_sid(19, 0, 0, -1);
+                restock_obj := create_object(19, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 19));
             end
             else begin
@@ -1645,17 +1645,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 19);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1674,7 +1674,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 19) < restock_amt) then begin
-            restock_obj := create_object_sid(19, 0, 0, -1);
+            restock_obj := create_object(19, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 19));
         end
         else begin
@@ -1686,17 +1686,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 19);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1712,11 +1712,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                restock_obj := create_object_sid(273, 0, 0, -1);
+                restock_obj := create_object(273, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
             end
             else begin
@@ -1728,17 +1728,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1757,7 +1757,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-            restock_obj := create_object_sid(273, 0, 0, -1);
+            restock_obj := create_object(273, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
         end
         else begin
@@ -1769,17 +1769,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1795,11 +1795,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-                restock_obj := create_object_sid(49, 0, 0, -1);
+                restock_obj := create_object(49, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
             end
             else begin
@@ -1811,17 +1811,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 49);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1840,7 +1840,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-            restock_obj := create_object_sid(49, 0, 0, -1);
+            restock_obj := create_object(49, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
         end
         else begin
@@ -1852,17 +1852,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 49);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1882,7 +1882,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
-                restock_obj := create_object_sid(778, 0, 0, -1);
+                restock_obj := create_object(778, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 778));
             end
             else begin
@@ -1894,17 +1894,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 778);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -1923,7 +1923,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
-            restock_obj := create_object_sid(778, 0, 0, -1);
+            restock_obj := create_object(778, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 778));
         end
         else begin
@@ -1935,17 +1935,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 778);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -1965,7 +1965,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
-                restock_obj := create_object_sid(779, 0, 0, -1);
+                restock_obj := create_object(779, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 779));
             end
             else begin
@@ -1977,17 +1977,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 779);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2006,7 +2006,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
-            restock_obj := create_object_sid(779, 0, 0, -1);
+            restock_obj := create_object(779, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 779));
         end
         else begin
@@ -2018,17 +2018,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 779);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2044,11 +2044,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
-                restock_obj := create_object_sid(780, 0, 0, -1);
+                restock_obj := create_object(780, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 780));
             end
             else begin
@@ -2060,17 +2060,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 780);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2089,7 +2089,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
-            restock_obj := create_object_sid(780, 0, 0, -1);
+            restock_obj := create_object(780, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 780));
         end
         else begin
@@ -2101,17 +2101,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 780);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2131,7 +2131,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
-                restock_obj := create_object_sid(781, 0, 0, -1);
+                restock_obj := create_object(781, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 781));
             end
             else begin
@@ -2143,17 +2143,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 781);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2172,7 +2172,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
-            restock_obj := create_object_sid(781, 0, 0, -1);
+            restock_obj := create_object(781, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 781));
         end
         else begin
@@ -2184,17 +2184,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 781);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2214,7 +2214,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
-                restock_obj := create_object_sid(782, 0, 0, -1);
+                restock_obj := create_object(782, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 782));
             end
             else begin
@@ -2226,17 +2226,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 782);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2255,7 +2255,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
-            restock_obj := create_object_sid(782, 0, 0, -1);
+            restock_obj := create_object(782, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 782));
         end
         else begin
@@ -2267,17 +2267,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 782);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2297,7 +2297,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
-                restock_obj := create_object_sid(783, 0, 0, -1);
+                restock_obj := create_object(783, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 783));
             end
             else begin
@@ -2309,17 +2309,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 783);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2338,7 +2338,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
-            restock_obj := create_object_sid(783, 0, 0, -1);
+            restock_obj := create_object(783, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 783));
         end
         else begin
@@ -2350,17 +2350,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 783);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2380,7 +2380,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
-                restock_obj := create_object_sid(784, 0, 0, -1);
+                restock_obj := create_object(784, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 784));
             end
             else begin
@@ -2392,17 +2392,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 784);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2421,7 +2421,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
-            restock_obj := create_object_sid(784, 0, 0, -1);
+            restock_obj := create_object(784, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 784));
         end
         else begin
@@ -2433,17 +2433,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 784);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2463,7 +2463,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
-                restock_obj := create_object_sid(785, 0, 0, -1);
+                restock_obj := create_object(785, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 785));
             end
             else begin
@@ -2475,17 +2475,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 785);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2504,7 +2504,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
-            restock_obj := create_object_sid(785, 0, 0, -1);
+            restock_obj := create_object(785, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 785));
         end
         else begin
@@ -2516,17 +2516,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 785);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2546,7 +2546,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
-                restock_obj := create_object_sid(786, 0, 0, -1);
+                restock_obj := create_object(786, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 786));
             end
             else begin
@@ -2558,17 +2558,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 786);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2587,7 +2587,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
-            restock_obj := create_object_sid(786, 0, 0, -1);
+            restock_obj := create_object(786, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 786));
         end
         else begin
@@ -2599,17 +2599,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 786);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2629,7 +2629,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
-                restock_obj := create_object_sid(787, 0, 0, -1);
+                restock_obj := create_object(787, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 787));
             end
             else begin
@@ -2641,17 +2641,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 787);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2670,7 +2670,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
-            restock_obj := create_object_sid(787, 0, 0, -1);
+            restock_obj := create_object(787, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 787));
         end
         else begin
@@ -2682,17 +2682,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 787);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2712,7 +2712,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
-                restock_obj := create_object_sid(788, 0, 0, -1);
+                restock_obj := create_object(788, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 788));
             end
             else begin
@@ -2724,17 +2724,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 788);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2753,7 +2753,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
-            restock_obj := create_object_sid(788, 0, 0, -1);
+            restock_obj := create_object(788, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 788));
         end
         else begin
@@ -2765,17 +2765,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 788);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2795,7 +2795,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
-                restock_obj := create_object_sid(789, 0, 0, -1);
+                restock_obj := create_object(789, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 789));
             end
             else begin
@@ -2807,17 +2807,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 789);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2836,7 +2836,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
-            restock_obj := create_object_sid(789, 0, 0, -1);
+            restock_obj := create_object(789, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 789));
         end
         else begin
@@ -2848,17 +2848,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 789);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2878,7 +2878,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
-                restock_obj := create_object_sid(790, 0, 0, -1);
+                restock_obj := create_object(790, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 790));
             end
             else begin
@@ -2890,17 +2890,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 790);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -2919,7 +2919,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
-            restock_obj := create_object_sid(790, 0, 0, -1);
+            restock_obj := create_object(790, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 790));
         end
         else begin
@@ -2931,17 +2931,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 790);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -2961,7 +2961,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
-                restock_obj := create_object_sid(791, 0, 0, -1);
+                restock_obj := create_object(791, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 791));
             end
             else begin
@@ -2973,17 +2973,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 791);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3002,7 +3002,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
-            restock_obj := create_object_sid(791, 0, 0, -1);
+            restock_obj := create_object(791, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 791));
         end
         else begin
@@ -3014,17 +3014,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 791);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3044,7 +3044,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
-                restock_obj := create_object_sid(792, 0, 0, -1);
+                restock_obj := create_object(792, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 792));
             end
             else begin
@@ -3056,17 +3056,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 792);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3085,7 +3085,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
-            restock_obj := create_object_sid(792, 0, 0, -1);
+            restock_obj := create_object(792, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 792));
         end
         else begin
@@ -3097,17 +3097,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 792);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3127,7 +3127,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
-                restock_obj := create_object_sid(793, 0, 0, -1);
+                restock_obj := create_object(793, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 793));
             end
             else begin
@@ -3139,17 +3139,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 793);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3168,7 +3168,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
-            restock_obj := create_object_sid(793, 0, 0, -1);
+            restock_obj := create_object(793, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 793));
         end
         else begin
@@ -3180,17 +3180,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 793);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3210,7 +3210,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
-                restock_obj := create_object_sid(794, 0, 0, -1);
+                restock_obj := create_object(794, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 794));
             end
             else begin
@@ -3222,17 +3222,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 794);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3251,7 +3251,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
-            restock_obj := create_object_sid(794, 0, 0, -1);
+            restock_obj := create_object(794, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 794));
         end
         else begin
@@ -3263,17 +3263,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 794);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3293,7 +3293,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
-                restock_obj := create_object_sid(795, 0, 0, -1);
+                restock_obj := create_object(795, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 795));
             end
             else begin
@@ -3305,17 +3305,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 795);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3334,7 +3334,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
-            restock_obj := create_object_sid(795, 0, 0, -1);
+            restock_obj := create_object(795, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 795));
         end
         else begin
@@ -3346,17 +3346,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 795);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3376,7 +3376,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-                restock_obj := create_object_sid(106, 0, 0, -1);
+                restock_obj := create_object(106, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
             end
             else begin
@@ -3388,17 +3388,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 106);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3417,7 +3417,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-            restock_obj := create_object_sid(106, 0, 0, -1);
+            restock_obj := create_object(106, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
         end
         else begin
@@ -3429,17 +3429,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 106);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3455,11 +3455,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                restock_obj := create_object_sid(71, 0, 0, -1);
+                restock_obj := create_object(71, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
             end
             else begin
@@ -3471,17 +3471,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3500,7 +3500,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-            restock_obj := create_object_sid(71, 0, 0, -1);
+            restock_obj := create_object(71, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
         end
         else begin
@@ -3512,17 +3512,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3538,11 +3538,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                restock_obj := create_object_sid(103, 0, 0, -1);
+                restock_obj := create_object(103, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
             end
             else begin
@@ -3554,17 +3554,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3583,7 +3583,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-            restock_obj := create_object_sid(103, 0, 0, -1);
+            restock_obj := create_object(103, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
         end
         else begin
@@ -3595,17 +3595,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3621,11 +3621,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                restock_obj := create_object_sid(81, 0, 0, -1);
+                restock_obj := create_object(81, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
             end
             else begin
@@ -3637,17 +3637,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3666,7 +3666,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-            restock_obj := create_object_sid(81, 0, 0, -1);
+            restock_obj := create_object(81, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
         end
         else begin
@@ -3678,17 +3678,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3708,7 +3708,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                restock_obj := create_object_sid(318, 0, 0, -1);
+                restock_obj := create_object(318, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
             end
             else begin
@@ -3720,17 +3720,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3749,7 +3749,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-            restock_obj := create_object_sid(318, 0, 0, -1);
+            restock_obj := create_object(318, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
         end
         else begin
@@ -3761,17 +3761,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3795,7 +3795,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
         if (10 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
-                restock_obj := create_object_sid(259, 0, 0, -1);
+                restock_obj := create_object(259, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 259));
             end
             else begin
@@ -3807,17 +3807,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 259);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3836,7 +3836,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
-            restock_obj := create_object_sid(259, 0, 0, -1);
+            restock_obj := create_object(259, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 259));
         end
         else begin
@@ -3848,17 +3848,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 259);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3874,11 +3874,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-                restock_obj := create_object_sid(49, 0, 0, -1);
+                restock_obj := create_object(49, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
             end
             else begin
@@ -3890,17 +3890,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 49);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -3919,7 +3919,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-            restock_obj := create_object_sid(49, 0, 0, -1);
+            restock_obj := create_object(49, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
         end
         else begin
@@ -3931,17 +3931,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 49);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -3961,7 +3961,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
-                restock_obj := create_object_sid(4, 0, 0, -1);
+                restock_obj := create_object(4, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 4));
             end
             else begin
@@ -3973,17 +3973,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 4);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4002,7 +4002,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
-            restock_obj := create_object_sid(4, 0, 0, -1);
+            restock_obj := create_object(4, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 4));
         end
         else begin
@@ -4014,17 +4014,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 4);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4044,7 +4044,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                restock_obj := create_object_sid(81, 0, 0, -1);
+                restock_obj := create_object(81, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
             end
             else begin
@@ -4056,17 +4056,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4085,7 +4085,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-            restock_obj := create_object_sid(81, 0, 0, -1);
+            restock_obj := create_object(81, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
         end
         else begin
@@ -4097,17 +4097,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4127,7 +4127,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-                restock_obj := create_object_sid(106, 0, 0, -1);
+                restock_obj := create_object(106, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
             end
             else begin
@@ -4139,17 +4139,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 106);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4168,7 +4168,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-            restock_obj := create_object_sid(106, 0, 0, -1);
+            restock_obj := create_object(106, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
         end
         else begin
@@ -4180,17 +4180,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 106);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4206,11 +4206,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 124) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 124) < restock_amt) then begin
-                restock_obj := create_object_sid(124, 0, 0, -1);
+                restock_obj := create_object(124, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 124));
             end
             else begin
@@ -4222,17 +4222,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 124);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4251,7 +4251,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 124) < restock_amt) then begin
-            restock_obj := create_object_sid(124, 0, 0, -1);
+            restock_obj := create_object(124, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 124));
         end
         else begin
@@ -4263,17 +4263,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 124);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4289,11 +4289,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
         if (9 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                restock_obj := create_object_sid(273, 0, 0, -1);
+                restock_obj := create_object(273, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
             end
             else begin
@@ -4305,17 +4305,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4334,7 +4334,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-            restock_obj := create_object_sid(273, 0, 0, -1);
+            restock_obj := create_object(273, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
         end
         else begin
@@ -4346,17 +4346,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4372,11 +4372,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 125) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 125) < restock_amt) then begin
-                restock_obj := create_object_sid(125, 0, 0, -1);
+                restock_obj := create_object(125, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 125));
             end
             else begin
@@ -4388,17 +4388,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 125);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4417,7 +4417,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 125) < restock_amt) then begin
-            restock_obj := create_object_sid(125, 0, 0, -1);
+            restock_obj := create_object(125, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 125));
         end
         else begin
@@ -4429,17 +4429,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 125);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4459,7 +4459,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 79) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 79) < restock_amt) then begin
-                restock_obj := create_object_sid(79, 0, 0, -1);
+                restock_obj := create_object(79, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 79));
             end
             else begin
@@ -4471,17 +4471,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 79);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4500,7 +4500,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 79) < restock_amt) then begin
-            restock_obj := create_object_sid(79, 0, 0, -1);
+            restock_obj := create_object(79, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 79));
         end
         else begin
@@ -4512,17 +4512,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 79);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4542,7 +4542,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 45) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 45) < restock_amt) then begin
-                restock_obj := create_object_sid(45, 0, 0, -1);
+                restock_obj := create_object(45, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 45));
             end
             else begin
@@ -4554,17 +4554,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 45);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4583,7 +4583,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 45) < restock_amt) then begin
-            restock_obj := create_object_sid(45, 0, 0, -1);
+            restock_obj := create_object(45, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 45));
         end
         else begin
@@ -4595,17 +4595,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 45);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4625,7 +4625,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
-                restock_obj := create_object_sid(234, 0, 0, -1);
+                restock_obj := create_object(234, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 234));
             end
             else begin
@@ -4637,17 +4637,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 234);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4666,7 +4666,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
-            restock_obj := create_object_sid(234, 0, 0, -1);
+            restock_obj := create_object(234, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 234));
         end
         else begin
@@ -4678,17 +4678,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 234);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4704,11 +4704,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
         if (2 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
-                restock_obj := create_object_sid(29, 0, 0, -1);
+                restock_obj := create_object(29, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 29));
             end
             else begin
@@ -4720,17 +4720,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4749,7 +4749,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 29));
         end
         else begin
@@ -4761,17 +4761,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 29);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4787,11 +4787,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
         if (2 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                restock_obj := create_object_sid(30, 0, 0, -1);
+                restock_obj := create_object(30, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
             end
             else begin
@@ -4803,17 +4803,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 30);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4832,7 +4832,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-            restock_obj := create_object_sid(30, 0, 0, -1);
+            restock_obj := create_object(30, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
         end
         else begin
@@ -4844,17 +4844,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 30);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4874,7 +4874,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
         if (2 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                restock_obj := create_object_sid(41, 0, 0, -1);
+                restock_obj := create_object(41, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
             end
             else begin
@@ -4886,17 +4886,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4915,7 +4915,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-            restock_obj := create_object_sid(41, 0, 0, -1);
+            restock_obj := create_object(41, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
         end
         else begin
@@ -4927,17 +4927,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -4957,7 +4957,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
-                restock_obj := create_object_sid(778, 0, 0, -1);
+                restock_obj := create_object(778, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 778));
             end
             else begin
@@ -4969,17 +4969,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 778);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -4998,7 +4998,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
-            restock_obj := create_object_sid(778, 0, 0, -1);
+            restock_obj := create_object(778, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 778));
         end
         else begin
@@ -5010,17 +5010,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 778);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5040,7 +5040,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
-                restock_obj := create_object_sid(779, 0, 0, -1);
+                restock_obj := create_object(779, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 779));
             end
             else begin
@@ -5052,17 +5052,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 779);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5081,7 +5081,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
-            restock_obj := create_object_sid(779, 0, 0, -1);
+            restock_obj := create_object(779, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 779));
         end
         else begin
@@ -5093,17 +5093,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 779);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5119,11 +5119,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
-                restock_obj := create_object_sid(780, 0, 0, -1);
+                restock_obj := create_object(780, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 780));
             end
             else begin
@@ -5135,17 +5135,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 780);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5164,7 +5164,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
-            restock_obj := create_object_sid(780, 0, 0, -1);
+            restock_obj := create_object(780, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 780));
         end
         else begin
@@ -5176,17 +5176,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 780);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5206,7 +5206,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
-                restock_obj := create_object_sid(781, 0, 0, -1);
+                restock_obj := create_object(781, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 781));
             end
             else begin
@@ -5218,17 +5218,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 781);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5247,7 +5247,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
-            restock_obj := create_object_sid(781, 0, 0, -1);
+            restock_obj := create_object(781, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 781));
         end
         else begin
@@ -5259,17 +5259,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 781);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5289,7 +5289,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
-                restock_obj := create_object_sid(782, 0, 0, -1);
+                restock_obj := create_object(782, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 782));
             end
             else begin
@@ -5301,17 +5301,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 782);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5330,7 +5330,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
-            restock_obj := create_object_sid(782, 0, 0, -1);
+            restock_obj := create_object(782, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 782));
         end
         else begin
@@ -5342,17 +5342,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 782);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5372,7 +5372,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
-                restock_obj := create_object_sid(783, 0, 0, -1);
+                restock_obj := create_object(783, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 783));
             end
             else begin
@@ -5384,17 +5384,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 783);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5413,7 +5413,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
-            restock_obj := create_object_sid(783, 0, 0, -1);
+            restock_obj := create_object(783, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 783));
         end
         else begin
@@ -5425,17 +5425,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 783);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5455,7 +5455,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
-                restock_obj := create_object_sid(784, 0, 0, -1);
+                restock_obj := create_object(784, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 784));
             end
             else begin
@@ -5467,17 +5467,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 784);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5496,7 +5496,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
-            restock_obj := create_object_sid(784, 0, 0, -1);
+            restock_obj := create_object(784, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 784));
         end
         else begin
@@ -5508,17 +5508,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 784);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5538,7 +5538,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
-                restock_obj := create_object_sid(785, 0, 0, -1);
+                restock_obj := create_object(785, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 785));
             end
             else begin
@@ -5550,17 +5550,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 785);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5579,7 +5579,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
-            restock_obj := create_object_sid(785, 0, 0, -1);
+            restock_obj := create_object(785, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 785));
         end
         else begin
@@ -5591,17 +5591,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 785);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5621,7 +5621,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
-                restock_obj := create_object_sid(786, 0, 0, -1);
+                restock_obj := create_object(786, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 786));
             end
             else begin
@@ -5633,17 +5633,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 786);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5662,7 +5662,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
-            restock_obj := create_object_sid(786, 0, 0, -1);
+            restock_obj := create_object(786, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 786));
         end
         else begin
@@ -5674,17 +5674,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 786);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5704,7 +5704,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
-                restock_obj := create_object_sid(787, 0, 0, -1);
+                restock_obj := create_object(787, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 787));
             end
             else begin
@@ -5716,17 +5716,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 787);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5745,7 +5745,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
-            restock_obj := create_object_sid(787, 0, 0, -1);
+            restock_obj := create_object(787, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 787));
         end
         else begin
@@ -5757,17 +5757,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 787);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5787,7 +5787,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
-                restock_obj := create_object_sid(788, 0, 0, -1);
+                restock_obj := create_object(788, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 788));
             end
             else begin
@@ -5799,17 +5799,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 788);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5828,7 +5828,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
-            restock_obj := create_object_sid(788, 0, 0, -1);
+            restock_obj := create_object(788, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 788));
         end
         else begin
@@ -5840,17 +5840,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 788);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5870,7 +5870,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
-                restock_obj := create_object_sid(789, 0, 0, -1);
+                restock_obj := create_object(789, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 789));
             end
             else begin
@@ -5882,17 +5882,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 789);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5911,7 +5911,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
-            restock_obj := create_object_sid(789, 0, 0, -1);
+            restock_obj := create_object(789, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 789));
         end
         else begin
@@ -5923,17 +5923,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 789);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -5953,7 +5953,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
-                restock_obj := create_object_sid(790, 0, 0, -1);
+                restock_obj := create_object(790, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 790));
             end
             else begin
@@ -5965,17 +5965,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 790);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -5994,7 +5994,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
-            restock_obj := create_object_sid(790, 0, 0, -1);
+            restock_obj := create_object(790, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 790));
         end
         else begin
@@ -6006,17 +6006,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 790);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6036,7 +6036,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
-                restock_obj := create_object_sid(791, 0, 0, -1);
+                restock_obj := create_object(791, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 791));
             end
             else begin
@@ -6048,17 +6048,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 791);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6077,7 +6077,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
-            restock_obj := create_object_sid(791, 0, 0, -1);
+            restock_obj := create_object(791, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 791));
         end
         else begin
@@ -6089,17 +6089,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 791);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6119,7 +6119,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
-                restock_obj := create_object_sid(792, 0, 0, -1);
+                restock_obj := create_object(792, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 792));
             end
             else begin
@@ -6131,17 +6131,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 792);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6160,7 +6160,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
-            restock_obj := create_object_sid(792, 0, 0, -1);
+            restock_obj := create_object(792, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 792));
         end
         else begin
@@ -6172,17 +6172,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 792);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6202,7 +6202,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
-                restock_obj := create_object_sid(793, 0, 0, -1);
+                restock_obj := create_object(793, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 793));
             end
             else begin
@@ -6214,17 +6214,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 793);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6243,7 +6243,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
-            restock_obj := create_object_sid(793, 0, 0, -1);
+            restock_obj := create_object(793, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 793));
         end
         else begin
@@ -6255,17 +6255,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 793);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6285,7 +6285,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
-                restock_obj := create_object_sid(794, 0, 0, -1);
+                restock_obj := create_object(794, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 794));
             end
             else begin
@@ -6297,17 +6297,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 794);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6326,7 +6326,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
-            restock_obj := create_object_sid(794, 0, 0, -1);
+            restock_obj := create_object(794, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 794));
         end
         else begin
@@ -6338,17 +6338,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 794);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6368,7 +6368,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
-                restock_obj := create_object_sid(795, 0, 0, -1);
+                restock_obj := create_object(795, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 795));
             end
             else begin
@@ -6380,17 +6380,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 795);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6409,7 +6409,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
-            restock_obj := create_object_sid(795, 0, 0, -1);
+            restock_obj := create_object(795, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 795));
         end
         else begin
@@ -6421,17 +6421,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 795);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6451,7 +6451,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-                restock_obj := create_object_sid(106, 0, 0, -1);
+                restock_obj := create_object(106, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
             end
             else begin
@@ -6463,17 +6463,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 106);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6492,7 +6492,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-            restock_obj := create_object_sid(106, 0, 0, -1);
+            restock_obj := create_object(106, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
         end
         else begin
@@ -6504,17 +6504,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 106);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6530,11 +6530,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                restock_obj := create_object_sid(71, 0, 0, -1);
+                restock_obj := create_object(71, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
             end
             else begin
@@ -6546,17 +6546,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6575,7 +6575,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-            restock_obj := create_object_sid(71, 0, 0, -1);
+            restock_obj := create_object(71, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
         end
         else begin
@@ -6587,17 +6587,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6613,11 +6613,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                restock_obj := create_object_sid(103, 0, 0, -1);
+                restock_obj := create_object(103, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
             end
             else begin
@@ -6629,17 +6629,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6658,7 +6658,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-            restock_obj := create_object_sid(103, 0, 0, -1);
+            restock_obj := create_object(103, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
         end
         else begin
@@ -6670,17 +6670,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6696,11 +6696,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                restock_obj := create_object_sid(81, 0, 0, -1);
+                restock_obj := create_object(81, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
             end
             else begin
@@ -6712,17 +6712,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6741,7 +6741,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-            restock_obj := create_object_sid(81, 0, 0, -1);
+            restock_obj := create_object(81, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
         end
         else begin
@@ -6753,17 +6753,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6783,7 +6783,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                restock_obj := create_object_sid(318, 0, 0, -1);
+                restock_obj := create_object(318, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
             end
             else begin
@@ -6795,17 +6795,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6824,7 +6824,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-            restock_obj := create_object_sid(318, 0, 0, -1);
+            restock_obj := create_object(318, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
         end
         else begin
@@ -6836,17 +6836,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6870,7 +6870,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
         if (2 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                restock_obj := create_object_sid(273, 0, 0, -1);
+                restock_obj := create_object(273, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
             end
             else begin
@@ -6882,17 +6882,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6911,7 +6911,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-            restock_obj := create_object_sid(273, 0, 0, -1);
+            restock_obj := create_object(273, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
         end
         else begin
@@ -6923,17 +6923,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -6949,11 +6949,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                restock_obj := create_object_sid(40, 0, 0, -1);
+                restock_obj := create_object(40, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
             end
             else begin
@@ -6965,17 +6965,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -6994,7 +6994,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
         end
         else begin
@@ -7006,17 +7006,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 40);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7032,11 +7032,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
         if (2 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-                restock_obj := create_object_sid(49, 0, 0, -1);
+                restock_obj := create_object(49, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
             end
             else begin
@@ -7048,17 +7048,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 49);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7077,7 +7077,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-            restock_obj := create_object_sid(49, 0, 0, -1);
+            restock_obj := create_object(49, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
         end
         else begin
@@ -7089,17 +7089,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 49);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7115,11 +7115,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
-                restock_obj := create_object_sid(36, 0, 0, -1);
+                restock_obj := create_object(36, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 36));
             end
             else begin
@@ -7131,17 +7131,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 36);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7160,7 +7160,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
-            restock_obj := create_object_sid(36, 0, 0, -1);
+            restock_obj := create_object(36, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 36));
         end
         else begin
@@ -7172,17 +7172,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 36);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7198,11 +7198,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
-                restock_obj := create_object_sid(35, 0, 0, -1);
+                restock_obj := create_object(35, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 35));
             end
             else begin
@@ -7214,17 +7214,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7243,7 +7243,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
-            restock_obj := create_object_sid(35, 0, 0, -1);
+            restock_obj := create_object(35, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 35));
         end
         else begin
@@ -7255,17 +7255,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7285,7 +7285,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 25) < restock_amt) then begin
         if (2 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 25) < restock_amt) then begin
-                restock_obj := create_object_sid(25, 0, 0, -1);
+                restock_obj := create_object(25, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 25));
             end
             else begin
@@ -7297,17 +7297,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 25);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7326,7 +7326,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 25) < restock_amt) then begin
-            restock_obj := create_object_sid(25, 0, 0, -1);
+            restock_obj := create_object(25, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 25));
         end
         else begin
@@ -7338,17 +7338,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 25);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7368,7 +7368,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
         if (10 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                restock_obj := create_object_sid(71, 0, 0, -1);
+                restock_obj := create_object(71, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
             end
             else begin
@@ -7380,17 +7380,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7409,7 +7409,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-            restock_obj := create_object_sid(71, 0, 0, -1);
+            restock_obj := create_object(71, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
         end
         else begin
@@ -7421,17 +7421,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7451,7 +7451,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
         if (10 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                restock_obj := create_object_sid(81, 0, 0, -1);
+                restock_obj := create_object(81, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
             end
             else begin
@@ -7463,17 +7463,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7492,7 +7492,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-            restock_obj := create_object_sid(81, 0, 0, -1);
+            restock_obj := create_object(81, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
         end
         else begin
@@ -7504,17 +7504,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7534,7 +7534,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
         if (10 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
-                restock_obj := create_object_sid(259, 0, 0, -1);
+                restock_obj := create_object(259, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 259));
             end
             else begin
@@ -7546,17 +7546,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 259);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7575,7 +7575,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
-            restock_obj := create_object_sid(259, 0, 0, -1);
+            restock_obj := create_object(259, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 259));
         end
         else begin
@@ -7587,17 +7587,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 259);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7617,7 +7617,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 124) < restock_amt) then begin
         if (10 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 124) < restock_amt) then begin
-                restock_obj := create_object_sid(124, 0, 0, -1);
+                restock_obj := create_object(124, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 124));
             end
             else begin
@@ -7629,17 +7629,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 124);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7658,7 +7658,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 124) < restock_amt) then begin
-            restock_obj := create_object_sid(124, 0, 0, -1);
+            restock_obj := create_object(124, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 124));
         end
         else begin
@@ -7670,17 +7670,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 124);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7696,11 +7696,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
         if (8 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
-                restock_obj := create_object_sid(20, 0, 0, -1);
+                restock_obj := create_object(20, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 20));
             end
             else begin
@@ -7712,17 +7712,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 20);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7741,7 +7741,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
-            restock_obj := create_object_sid(20, 0, 0, -1);
+            restock_obj := create_object(20, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 20));
         end
         else begin
@@ -7753,17 +7753,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 20);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7783,7 +7783,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
         if (10 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
-                restock_obj := create_object_sid(4, 0, 0, -1);
+                restock_obj := create_object(4, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 4));
             end
             else begin
@@ -7795,17 +7795,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 4);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7824,7 +7824,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 4) < restock_amt) then begin
-            restock_obj := create_object_sid(4, 0, 0, -1);
+            restock_obj := create_object(4, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 4));
         end
         else begin
@@ -7836,17 +7836,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 4);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7862,11 +7862,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
         if (7 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
-                restock_obj := create_object_sid(29, 0, 0, -1);
+                restock_obj := create_object(29, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 29));
             end
             else begin
@@ -7878,17 +7878,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7907,7 +7907,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 29));
         end
         else begin
@@ -7919,17 +7919,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 29);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -7949,7 +7949,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
-                restock_obj := create_object_sid(778, 0, 0, -1);
+                restock_obj := create_object(778, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 778));
             end
             else begin
@@ -7961,17 +7961,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 778);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -7990,7 +7990,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
-            restock_obj := create_object_sid(778, 0, 0, -1);
+            restock_obj := create_object(778, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 778));
         end
         else begin
@@ -8002,17 +8002,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 778);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8032,7 +8032,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
-                restock_obj := create_object_sid(779, 0, 0, -1);
+                restock_obj := create_object(779, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 779));
             end
             else begin
@@ -8044,17 +8044,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 779);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8073,7 +8073,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
-            restock_obj := create_object_sid(779, 0, 0, -1);
+            restock_obj := create_object(779, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 779));
         end
         else begin
@@ -8085,17 +8085,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 779);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8111,11 +8111,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
-                restock_obj := create_object_sid(780, 0, 0, -1);
+                restock_obj := create_object(780, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 780));
             end
             else begin
@@ -8127,17 +8127,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 780);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8156,7 +8156,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
-            restock_obj := create_object_sid(780, 0, 0, -1);
+            restock_obj := create_object(780, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 780));
         end
         else begin
@@ -8168,17 +8168,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 780);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8198,7 +8198,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
-                restock_obj := create_object_sid(781, 0, 0, -1);
+                restock_obj := create_object(781, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 781));
             end
             else begin
@@ -8210,17 +8210,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 781);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8239,7 +8239,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
-            restock_obj := create_object_sid(781, 0, 0, -1);
+            restock_obj := create_object(781, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 781));
         end
         else begin
@@ -8251,17 +8251,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 781);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8281,7 +8281,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
-                restock_obj := create_object_sid(782, 0, 0, -1);
+                restock_obj := create_object(782, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 782));
             end
             else begin
@@ -8293,17 +8293,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 782);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8322,7 +8322,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
-            restock_obj := create_object_sid(782, 0, 0, -1);
+            restock_obj := create_object(782, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 782));
         end
         else begin
@@ -8334,17 +8334,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 782);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8364,7 +8364,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
-                restock_obj := create_object_sid(783, 0, 0, -1);
+                restock_obj := create_object(783, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 783));
             end
             else begin
@@ -8376,17 +8376,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 783);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8405,7 +8405,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
-            restock_obj := create_object_sid(783, 0, 0, -1);
+            restock_obj := create_object(783, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 783));
         end
         else begin
@@ -8417,17 +8417,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 783);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8447,7 +8447,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
-                restock_obj := create_object_sid(784, 0, 0, -1);
+                restock_obj := create_object(784, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 784));
             end
             else begin
@@ -8459,17 +8459,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 784);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8488,7 +8488,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
-            restock_obj := create_object_sid(784, 0, 0, -1);
+            restock_obj := create_object(784, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 784));
         end
         else begin
@@ -8500,17 +8500,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 784);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8530,7 +8530,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
-                restock_obj := create_object_sid(785, 0, 0, -1);
+                restock_obj := create_object(785, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 785));
             end
             else begin
@@ -8542,17 +8542,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 785);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8571,7 +8571,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
-            restock_obj := create_object_sid(785, 0, 0, -1);
+            restock_obj := create_object(785, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 785));
         end
         else begin
@@ -8583,17 +8583,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 785);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8613,7 +8613,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
-                restock_obj := create_object_sid(786, 0, 0, -1);
+                restock_obj := create_object(786, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 786));
             end
             else begin
@@ -8625,17 +8625,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 786);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8654,7 +8654,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
-            restock_obj := create_object_sid(786, 0, 0, -1);
+            restock_obj := create_object(786, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 786));
         end
         else begin
@@ -8666,17 +8666,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 786);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8696,7 +8696,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
-                restock_obj := create_object_sid(787, 0, 0, -1);
+                restock_obj := create_object(787, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 787));
             end
             else begin
@@ -8708,17 +8708,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 787);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8737,7 +8737,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
-            restock_obj := create_object_sid(787, 0, 0, -1);
+            restock_obj := create_object(787, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 787));
         end
         else begin
@@ -8749,17 +8749,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 787);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8779,7 +8779,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
-                restock_obj := create_object_sid(788, 0, 0, -1);
+                restock_obj := create_object(788, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 788));
             end
             else begin
@@ -8791,17 +8791,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 788);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8820,7 +8820,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
-            restock_obj := create_object_sid(788, 0, 0, -1);
+            restock_obj := create_object(788, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 788));
         end
         else begin
@@ -8832,17 +8832,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 788);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8862,7 +8862,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
-                restock_obj := create_object_sid(789, 0, 0, -1);
+                restock_obj := create_object(789, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 789));
             end
             else begin
@@ -8874,17 +8874,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 789);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8903,7 +8903,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
-            restock_obj := create_object_sid(789, 0, 0, -1);
+            restock_obj := create_object(789, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 789));
         end
         else begin
@@ -8915,17 +8915,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 789);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -8945,7 +8945,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
-                restock_obj := create_object_sid(790, 0, 0, -1);
+                restock_obj := create_object(790, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 790));
             end
             else begin
@@ -8957,17 +8957,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 790);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -8986,7 +8986,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
-            restock_obj := create_object_sid(790, 0, 0, -1);
+            restock_obj := create_object(790, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 790));
         end
         else begin
@@ -8998,17 +8998,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 790);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9028,7 +9028,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
-                restock_obj := create_object_sid(791, 0, 0, -1);
+                restock_obj := create_object(791, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 791));
             end
             else begin
@@ -9040,17 +9040,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 791);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9069,7 +9069,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
-            restock_obj := create_object_sid(791, 0, 0, -1);
+            restock_obj := create_object(791, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 791));
         end
         else begin
@@ -9081,17 +9081,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 791);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9111,7 +9111,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
-                restock_obj := create_object_sid(792, 0, 0, -1);
+                restock_obj := create_object(792, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 792));
             end
             else begin
@@ -9123,17 +9123,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 792);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9152,7 +9152,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
-            restock_obj := create_object_sid(792, 0, 0, -1);
+            restock_obj := create_object(792, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 792));
         end
         else begin
@@ -9164,17 +9164,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 792);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9194,7 +9194,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
-                restock_obj := create_object_sid(793, 0, 0, -1);
+                restock_obj := create_object(793, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 793));
             end
             else begin
@@ -9206,17 +9206,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 793);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9235,7 +9235,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
-            restock_obj := create_object_sid(793, 0, 0, -1);
+            restock_obj := create_object(793, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 793));
         end
         else begin
@@ -9247,17 +9247,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 793);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9277,7 +9277,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
-                restock_obj := create_object_sid(794, 0, 0, -1);
+                restock_obj := create_object(794, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 794));
             end
             else begin
@@ -9289,17 +9289,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 794);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9318,7 +9318,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
-            restock_obj := create_object_sid(794, 0, 0, -1);
+            restock_obj := create_object(794, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 794));
         end
         else begin
@@ -9330,17 +9330,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 794);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9360,7 +9360,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
-                restock_obj := create_object_sid(795, 0, 0, -1);
+                restock_obj := create_object(795, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 795));
             end
             else begin
@@ -9372,17 +9372,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 795);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9401,7 +9401,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
-            restock_obj := create_object_sid(795, 0, 0, -1);
+            restock_obj := create_object(795, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 795));
         end
         else begin
@@ -9413,17 +9413,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 795);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9443,7 +9443,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-                restock_obj := create_object_sid(106, 0, 0, -1);
+                restock_obj := create_object(106, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
             end
             else begin
@@ -9455,17 +9455,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 106);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9484,7 +9484,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-            restock_obj := create_object_sid(106, 0, 0, -1);
+            restock_obj := create_object(106, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
         end
         else begin
@@ -9496,17 +9496,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 106);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9522,11 +9522,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                restock_obj := create_object_sid(71, 0, 0, -1);
+                restock_obj := create_object(71, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
             end
             else begin
@@ -9538,17 +9538,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9567,7 +9567,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-            restock_obj := create_object_sid(71, 0, 0, -1);
+            restock_obj := create_object(71, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
         end
         else begin
@@ -9579,17 +9579,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9605,11 +9605,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                restock_obj := create_object_sid(103, 0, 0, -1);
+                restock_obj := create_object(103, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
             end
             else begin
@@ -9621,17 +9621,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9650,7 +9650,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-            restock_obj := create_object_sid(103, 0, 0, -1);
+            restock_obj := create_object(103, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
         end
         else begin
@@ -9662,17 +9662,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9688,11 +9688,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                restock_obj := create_object_sid(81, 0, 0, -1);
+                restock_obj := create_object(81, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
             end
             else begin
@@ -9704,17 +9704,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9733,7 +9733,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-            restock_obj := create_object_sid(81, 0, 0, -1);
+            restock_obj := create_object(81, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
         end
         else begin
@@ -9745,17 +9745,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9775,7 +9775,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                restock_obj := create_object_sid(318, 0, 0, -1);
+                restock_obj := create_object(318, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
             end
             else begin
@@ -9787,17 +9787,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9816,7 +9816,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-            restock_obj := create_object_sid(318, 0, 0, -1);
+            restock_obj := create_object(318, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
         end
         else begin
@@ -9828,17 +9828,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9862,7 +9862,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                restock_obj := create_object_sid(273, 0, 0, -1);
+                restock_obj := create_object(273, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
             end
             else begin
@@ -9874,17 +9874,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9903,7 +9903,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-            restock_obj := create_object_sid(273, 0, 0, -1);
+            restock_obj := create_object(273, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
         end
         else begin
@@ -9915,17 +9915,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -9941,11 +9941,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                restock_obj := create_object_sid(40, 0, 0, -1);
+                restock_obj := create_object(40, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
             end
             else begin
@@ -9957,17 +9957,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -9986,7 +9986,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
         end
         else begin
@@ -9998,17 +9998,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 40);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10028,7 +10028,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
         if (2 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-                restock_obj := create_object_sid(49, 0, 0, -1);
+                restock_obj := create_object(49, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
             end
             else begin
@@ -10040,17 +10040,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 49);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10069,7 +10069,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-            restock_obj := create_object_sid(49, 0, 0, -1);
+            restock_obj := create_object(49, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
         end
         else begin
@@ -10081,17 +10081,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 49);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10107,11 +10107,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 26) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 26) < restock_amt) then begin
-                restock_obj := create_object_sid(26, 0, 0, -1);
+                restock_obj := create_object(26, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 26));
             end
             else begin
@@ -10123,17 +10123,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 26);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10152,7 +10152,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 26) < restock_amt) then begin
-            restock_obj := create_object_sid(26, 0, 0, -1);
+            restock_obj := create_object(26, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 26));
         end
         else begin
@@ -10164,17 +10164,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 26);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10190,11 +10190,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
         if (2 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
-                restock_obj := create_object_sid(35, 0, 0, -1);
+                restock_obj := create_object(35, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 35));
             end
             else begin
@@ -10206,17 +10206,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10235,7 +10235,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
-            restock_obj := create_object_sid(35, 0, 0, -1);
+            restock_obj := create_object(35, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 35));
         end
         else begin
@@ -10247,17 +10247,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10273,11 +10273,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
-                restock_obj := create_object_sid(36, 0, 0, -1);
+                restock_obj := create_object(36, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 36));
             end
             else begin
@@ -10289,17 +10289,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 36);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10318,7 +10318,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
-            restock_obj := create_object_sid(36, 0, 0, -1);
+            restock_obj := create_object(36, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 36));
         end
         else begin
@@ -10330,17 +10330,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 36);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10356,11 +10356,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 38) < restock_amt) then begin
         if (3 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 38) < restock_amt) then begin
-                restock_obj := create_object_sid(38, 0, 0, -1);
+                restock_obj := create_object(38, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 38));
             end
             else begin
@@ -10372,17 +10372,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 38);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10401,7 +10401,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 38) < restock_amt) then begin
-            restock_obj := create_object_sid(38, 0, 0, -1);
+            restock_obj := create_object(38, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 38));
         end
         else begin
@@ -10413,17 +10413,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 38);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10439,11 +10439,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
         if (3 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
-                restock_obj := create_object_sid(39, 0, 0, -1);
+                restock_obj := create_object(39, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 39));
             end
             else begin
@@ -10455,17 +10455,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 39);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10484,7 +10484,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
-            restock_obj := create_object_sid(39, 0, 0, -1);
+            restock_obj := create_object(39, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 39));
         end
         else begin
@@ -10496,17 +10496,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 39);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10526,7 +10526,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
         if (8 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                restock_obj := create_object_sid(71, 0, 0, -1);
+                restock_obj := create_object(71, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
             end
             else begin
@@ -10538,17 +10538,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10567,7 +10567,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-            restock_obj := create_object_sid(71, 0, 0, -1);
+            restock_obj := create_object(71, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
         end
         else begin
@@ -10579,17 +10579,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10609,7 +10609,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
         if (8 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                restock_obj := create_object_sid(81, 0, 0, -1);
+                restock_obj := create_object(81, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
             end
             else begin
@@ -10621,17 +10621,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10650,7 +10650,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-            restock_obj := create_object_sid(81, 0, 0, -1);
+            restock_obj := create_object(81, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
         end
         else begin
@@ -10662,17 +10662,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10692,7 +10692,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 125) < restock_amt) then begin
         if (7 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 125) < restock_amt) then begin
-                restock_obj := create_object_sid(125, 0, 0, -1);
+                restock_obj := create_object(125, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 125));
             end
             else begin
@@ -10704,17 +10704,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 125);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10733,7 +10733,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 125) < restock_amt) then begin
-            restock_obj := create_object_sid(125, 0, 0, -1);
+            restock_obj := create_object(125, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 125));
         end
         else begin
@@ -10745,17 +10745,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 125);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10775,7 +10775,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
         if (20 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
-                restock_obj := create_object_sid(259, 0, 0, -1);
+                restock_obj := create_object(259, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 259));
             end
             else begin
@@ -10787,17 +10787,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 259);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10816,7 +10816,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 259) < restock_amt) then begin
-            restock_obj := create_object_sid(259, 0, 0, -1);
+            restock_obj := create_object(259, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 259));
         end
         else begin
@@ -10828,17 +10828,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 259);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10858,7 +10858,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
-                restock_obj := create_object_sid(778, 0, 0, -1);
+                restock_obj := create_object(778, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 778));
             end
             else begin
@@ -10870,17 +10870,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 778);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10899,7 +10899,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 778) < restock_amt) then begin
-            restock_obj := create_object_sid(778, 0, 0, -1);
+            restock_obj := create_object(778, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 778));
         end
         else begin
@@ -10911,17 +10911,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 778);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -10941,7 +10941,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
-                restock_obj := create_object_sid(779, 0, 0, -1);
+                restock_obj := create_object(779, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 779));
             end
             else begin
@@ -10953,17 +10953,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 779);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -10982,7 +10982,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 779) < restock_amt) then begin
-            restock_obj := create_object_sid(779, 0, 0, -1);
+            restock_obj := create_object(779, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 779));
         end
         else begin
@@ -10994,17 +10994,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 779);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11020,11 +11020,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
-                restock_obj := create_object_sid(780, 0, 0, -1);
+                restock_obj := create_object(780, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 780));
             end
             else begin
@@ -11036,17 +11036,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 780);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11065,7 +11065,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 780) < restock_amt) then begin
-            restock_obj := create_object_sid(780, 0, 0, -1);
+            restock_obj := create_object(780, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 780));
         end
         else begin
@@ -11077,17 +11077,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 780);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11107,7 +11107,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
-                restock_obj := create_object_sid(781, 0, 0, -1);
+                restock_obj := create_object(781, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 781));
             end
             else begin
@@ -11119,17 +11119,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 781);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11148,7 +11148,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 781) < restock_amt) then begin
-            restock_obj := create_object_sid(781, 0, 0, -1);
+            restock_obj := create_object(781, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 781));
         end
         else begin
@@ -11160,17 +11160,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 781);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11190,7 +11190,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
-                restock_obj := create_object_sid(782, 0, 0, -1);
+                restock_obj := create_object(782, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 782));
             end
             else begin
@@ -11202,17 +11202,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 782);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11231,7 +11231,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 782) < restock_amt) then begin
-            restock_obj := create_object_sid(782, 0, 0, -1);
+            restock_obj := create_object(782, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 782));
         end
         else begin
@@ -11243,17 +11243,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 782);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11273,7 +11273,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
-                restock_obj := create_object_sid(783, 0, 0, -1);
+                restock_obj := create_object(783, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 783));
             end
             else begin
@@ -11285,17 +11285,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 783);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11314,7 +11314,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 783) < restock_amt) then begin
-            restock_obj := create_object_sid(783, 0, 0, -1);
+            restock_obj := create_object(783, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 783));
         end
         else begin
@@ -11326,17 +11326,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 783);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11356,7 +11356,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
-                restock_obj := create_object_sid(784, 0, 0, -1);
+                restock_obj := create_object(784, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 784));
             end
             else begin
@@ -11368,17 +11368,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 784);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11397,7 +11397,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 784) < restock_amt) then begin
-            restock_obj := create_object_sid(784, 0, 0, -1);
+            restock_obj := create_object(784, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 784));
         end
         else begin
@@ -11409,17 +11409,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 784);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11439,7 +11439,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
-                restock_obj := create_object_sid(785, 0, 0, -1);
+                restock_obj := create_object(785, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 785));
             end
             else begin
@@ -11451,17 +11451,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 785);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11480,7 +11480,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 785) < restock_amt) then begin
-            restock_obj := create_object_sid(785, 0, 0, -1);
+            restock_obj := create_object(785, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 785));
         end
         else begin
@@ -11492,17 +11492,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 785);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11522,7 +11522,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
-                restock_obj := create_object_sid(786, 0, 0, -1);
+                restock_obj := create_object(786, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 786));
             end
             else begin
@@ -11534,17 +11534,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 786);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11563,7 +11563,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 786) < restock_amt) then begin
-            restock_obj := create_object_sid(786, 0, 0, -1);
+            restock_obj := create_object(786, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 786));
         end
         else begin
@@ -11575,17 +11575,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 786);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11605,7 +11605,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
-                restock_obj := create_object_sid(787, 0, 0, -1);
+                restock_obj := create_object(787, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 787));
             end
             else begin
@@ -11617,17 +11617,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 787);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11646,7 +11646,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 787) < restock_amt) then begin
-            restock_obj := create_object_sid(787, 0, 0, -1);
+            restock_obj := create_object(787, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 787));
         end
         else begin
@@ -11658,17 +11658,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 787);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11688,7 +11688,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
-                restock_obj := create_object_sid(788, 0, 0, -1);
+                restock_obj := create_object(788, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 788));
             end
             else begin
@@ -11700,17 +11700,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 788);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11729,7 +11729,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 788) < restock_amt) then begin
-            restock_obj := create_object_sid(788, 0, 0, -1);
+            restock_obj := create_object(788, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 788));
         end
         else begin
@@ -11741,17 +11741,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 788);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11771,7 +11771,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
-                restock_obj := create_object_sid(789, 0, 0, -1);
+                restock_obj := create_object(789, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 789));
             end
             else begin
@@ -11783,17 +11783,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 789);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11812,7 +11812,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 789) < restock_amt) then begin
-            restock_obj := create_object_sid(789, 0, 0, -1);
+            restock_obj := create_object(789, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 789));
         end
         else begin
@@ -11824,17 +11824,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 789);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11854,7 +11854,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
-                restock_obj := create_object_sid(790, 0, 0, -1);
+                restock_obj := create_object(790, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 790));
             end
             else begin
@@ -11866,17 +11866,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 790);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11895,7 +11895,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 790) < restock_amt) then begin
-            restock_obj := create_object_sid(790, 0, 0, -1);
+            restock_obj := create_object(790, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 790));
         end
         else begin
@@ -11907,17 +11907,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 790);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -11937,7 +11937,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
-                restock_obj := create_object_sid(791, 0, 0, -1);
+                restock_obj := create_object(791, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 791));
             end
             else begin
@@ -11949,17 +11949,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 791);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -11978,7 +11978,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 791) < restock_amt) then begin
-            restock_obj := create_object_sid(791, 0, 0, -1);
+            restock_obj := create_object(791, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 791));
         end
         else begin
@@ -11990,17 +11990,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 791);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12020,7 +12020,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
-                restock_obj := create_object_sid(792, 0, 0, -1);
+                restock_obj := create_object(792, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 792));
             end
             else begin
@@ -12032,17 +12032,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 792);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12061,7 +12061,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 792) < restock_amt) then begin
-            restock_obj := create_object_sid(792, 0, 0, -1);
+            restock_obj := create_object(792, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 792));
         end
         else begin
@@ -12073,17 +12073,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 792);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12103,7 +12103,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
-                restock_obj := create_object_sid(793, 0, 0, -1);
+                restock_obj := create_object(793, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 793));
             end
             else begin
@@ -12115,17 +12115,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 793);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12144,7 +12144,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 793) < restock_amt) then begin
-            restock_obj := create_object_sid(793, 0, 0, -1);
+            restock_obj := create_object(793, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 793));
         end
         else begin
@@ -12156,17 +12156,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 793);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12186,7 +12186,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
-                restock_obj := create_object_sid(794, 0, 0, -1);
+                restock_obj := create_object(794, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 794));
             end
             else begin
@@ -12198,17 +12198,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 794);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12227,7 +12227,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 794) < restock_amt) then begin
-            restock_obj := create_object_sid(794, 0, 0, -1);
+            restock_obj := create_object(794, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 794));
         end
         else begin
@@ -12239,17 +12239,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 794);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12269,7 +12269,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
-                restock_obj := create_object_sid(795, 0, 0, -1);
+                restock_obj := create_object(795, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 795));
             end
             else begin
@@ -12281,17 +12281,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 795);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12310,7 +12310,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 795) < restock_amt) then begin
-            restock_obj := create_object_sid(795, 0, 0, -1);
+            restock_obj := create_object(795, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 795));
         end
         else begin
@@ -12322,17 +12322,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 795);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12352,7 +12352,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-                restock_obj := create_object_sid(106, 0, 0, -1);
+                restock_obj := create_object(106, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
             end
             else begin
@@ -12364,17 +12364,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 106);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12393,7 +12393,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 106) < restock_amt) then begin
-            restock_obj := create_object_sid(106, 0, 0, -1);
+            restock_obj := create_object(106, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 106));
         end
         else begin
@@ -12405,17 +12405,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 106);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12431,11 +12431,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                restock_obj := create_object_sid(71, 0, 0, -1);
+                restock_obj := create_object(71, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
             end
             else begin
@@ -12447,17 +12447,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12476,7 +12476,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-            restock_obj := create_object_sid(71, 0, 0, -1);
+            restock_obj := create_object(71, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
         end
         else begin
@@ -12488,17 +12488,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12514,11 +12514,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                restock_obj := create_object_sid(103, 0, 0, -1);
+                restock_obj := create_object(103, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
             end
             else begin
@@ -12530,17 +12530,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12559,7 +12559,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-            restock_obj := create_object_sid(103, 0, 0, -1);
+            restock_obj := create_object(103, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
         end
         else begin
@@ -12571,17 +12571,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12597,11 +12597,11 @@ begin
             end
         end
     end
-    restock_amt := random(1, 1);
+    restock_amt := 1;
     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
         if (1 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                restock_obj := create_object_sid(81, 0, 0, -1);
+                restock_obj := create_object(81, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
             end
             else begin
@@ -12613,17 +12613,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12642,7 +12642,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-            restock_obj := create_object_sid(81, 0, 0, -1);
+            restock_obj := create_object(81, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
         end
         else begin
@@ -12654,17 +12654,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12684,7 +12684,7 @@ begin
     if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
         if (5 >= random(1, 100)) then begin
             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                restock_obj := create_object_sid(318, 0, 0, -1);
+                restock_obj := create_object(318, 0, 0);
                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
             end
             else begin
@@ -12696,17 +12696,17 @@ begin
                     while (removed_qty) do begin
                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
                         if (obj_type(self_obj) == 1) then begin
-                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                    restock_obj := critter_inven_obj(self_obj, 0);
+                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                     rm_obj_from_inven(self_obj, restock_obj);
                                     add_obj_to_inven(self_obj, restock_obj);
                                 end
                             end
                             else begin
-                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                    metarule(43, self_obj);
+                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                    inven_unwield(self_obj);
                                 end
                             end
                         end
@@ -12725,7 +12725,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-            restock_obj := create_object_sid(318, 0, 0, -1);
+            restock_obj := create_object(318, 0, 0);
             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
         end
         else begin
@@ -12737,17 +12737,17 @@ begin
                 while (removed_qty) do begin
                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
                     if (obj_type(self_obj) == 1) then begin
-                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                restock_obj := critter_inven_obj(self_obj, 0);
+                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                 rm_obj_from_inven(self_obj, restock_obj);
                                 add_obj_to_inven(self_obj, restock_obj);
                             end
                         end
                         else begin
-                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                metarule(43, self_obj);
+                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                inven_unwield(self_obj);
                             end
                         end
                     end
@@ -12764,4 +12764,3 @@ begin
         end
     end
 end
-
