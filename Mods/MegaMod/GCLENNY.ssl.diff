diff --git a/Mods/MegaMod/Original/GCLENNY.ssl b/Mods/MegaMod/ReDefine/GCLENNY.ssl
index cd30bde..4909d89 100644
--- a/Mods/MegaMod/Original/GCLENNY.ssl
+++ b/Mods/MegaMod/ReDefine/GCLENNY.ssl
@@ -167,12 +167,12 @@ procedure use_obj_on_p_proc;
 
 procedure Check_Next_Third_Of_Areas
 begin
-    if (metarule(46, 0) == 16) then begin
+    if (cur_town == 16) then begin
         PartyMemberBackground := 15;
     end
     else begin
-        if (metarule(46, 0) == 52) then begin
-            if (cur_map_index == 182) then begin
+        if (cur_town == 52) then begin
+            if (CUR_MAP_ABUNDGR) then begin
                 PartyMemberBackground := 14;
             end
             else begin
@@ -180,8 +180,8 @@ begin
             end
         end
         else begin
-            if ((metarule(46, 0) == 54) or (metarule(46, 0) == 85)) then begin
-                if ((cur_map_index == 175) and (elevation(dude_obj) == 1)) then begin
+            if ((cur_town == 54) or (cur_town == 85)) then begin
+                if ((CUR_MAP_VILMERCH) and (dude_elevation == 1)) then begin
                     PartyMemberBackground := 14;
                 end
                 else begin
@@ -194,12 +194,12 @@ begin
                 end
             end
             else begin
-                if (metarule(46, 0) == 49) then begin
-                    if ((cur_map_index == 184) or (cur_map_index == 185) or (cur_map_index == 177)) then begin
+                if (cur_town == 49) then begin
+                    if ((CUR_MAP_EPAMAIN1) or (CUR_MAP_EPAMAIN2) or (CUR_MAP_EPASL)) then begin
                         PartyMemberBackground := 23;
                     end
                     else begin
-                        if ((elevation(dude_obj) == 1) or (elevation(dude_obj) == 2)) then begin
+                        if ((dude_elevation == 1) or (dude_elevation == 2)) then begin
                             PartyMemberBackground := 24;
                         end
                         else begin
@@ -213,8 +213,8 @@ begin
                     end
                 end
                 else begin
-                    if (metarule(46, 0) == 98) then begin
-                        if (elevation(dude_obj) == 0) then begin
+                    if (cur_town == 98) then begin
+                        if (dude_elevation == 0) then begin
                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                 PartyMemberBackground := 22;
                             end
@@ -227,13 +227,13 @@ begin
                         end
                     end
                     else begin
-                        if (metarule(46, 0) == 20) then begin
-                            if ((cur_map_index == 25) or (cur_map_index == 26)) then begin
+                        if (cur_town == 20) then begin
+                            if ((CUR_MAP_GSTCAV1) or (CUR_MAP_GSTCAV2)) then begin
                                 PartyMemberBackground := 14;
                             end
                         end
                         else begin
-                            if (metarule(46, 0) == 21) then begin
+                            if (cur_town == 21) then begin
                                 if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                     PartyMemberBackground := 43;
                                 end
@@ -242,11 +242,11 @@ begin
                                 end
                             end
                             else begin
-                                if (metarule(46, 0) == 22) then begin
+                                if (cur_town == 22) then begin
                                     PartyMemberBackground := 44;
                                 end
                                 else begin
-                                    if (metarule(46, 0) == 23) then begin
+                                    if (cur_town == 23) then begin
                                         if (elevation(self_obj) == 2) then begin
                                             PartyMemberBackground := 6;
                                         end
@@ -255,7 +255,7 @@ begin
                                         end
                                     end
                                     else begin
-                                        if (metarule(46, 0) == 24) then begin
+                                        if (cur_town == 24) then begin
                                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                 PartyMemberBackground := 22;
                                             end
@@ -264,8 +264,8 @@ begin
                                             end
                                         end
                                         else begin
-                                            if (metarule(46, 0) == 25) then begin
-                                                if (cur_map_index == 92) then begin
+                                            if (cur_town == 25) then begin
+                                                if (CUR_MAP_RAIDERS1) then begin
                                                     if (elevation(self_obj) == 0) then begin
                                                         if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                             PartyMemberBackground := 22;
@@ -283,7 +283,7 @@ begin
                                                 end
                                             end
                                             else begin
-                                                if (metarule(46, 0) == 26) then begin
+                                                if (cur_town == 26) then begin
                                                     if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                         PartyMemberBackground := 22;
                                                     end
@@ -292,7 +292,7 @@ begin
                                                     end
                                                 end
                                                 else begin
-                                                    if ((cur_map_index == 69) or (cur_map_index == 70) or (cur_map_index == 71) or (cur_map_index == 72) or (cur_map_index == 73) or (cur_map_index == 74) or (cur_map_index == 75) or (cur_map_index == 95) or (cur_map_index == 121) or (cur_map_index == 122) or (cur_map_index == 123) or (cur_map_index == 124)) then begin
+                                                    if ((CUR_MAP_CAVE0) or (CUR_MAP_CAVE1) or (CUR_MAP_CAVE2) or (CUR_MAP_CAVE3) or (CUR_MAP_CAVE4) or (CUR_MAP_MOUNTN1) or (CUR_MAP_MOUNTN2) or (CUR_MAP_BHRNDMNT) or (CUR_MAP_MOUNTN3) or (CUR_MAP_MOUNTN4) or (CUR_MAP_MOUNTN5) or (CUR_MAP_MOUNTN6)) then begin
                                                         if (elevation(self_obj) == 1) then begin
                                                             PartyMemberBackground := 14;
                                                         end
@@ -306,11 +306,11 @@ begin
                                                         end
                                                     end
                                                     else begin
-                                                        if ((cur_map_index == 68) or (cur_map_index == 125) or (cur_map_index == 141) or (cur_map_index == 142) or (cur_map_index == 143) or (cur_map_index == 144) or (cur_map_index == 145) or (cur_map_index == 146)) then begin
+                                                        if ((CUR_MAP_CITY1) or (CUR_MAP_CITY2) or (CUR_MAP_CITY3) or (CUR_MAP_CITY4) or (CUR_MAP_CITY5) or (CUR_MAP_CITY6) or (CUR_MAP_CITY7) or (CUR_MAP_CITY8)) then begin
                                                             PartyMemberBackground := 4;
                                                         end
                                                         else begin
-                                                            if ((cur_map_index == 76) or (cur_map_index == 77) or (cur_map_index == 85) or (cur_map_index == 86) or (cur_map_index == 87) or (cur_map_index == 88) or (cur_map_index == 89) or (cur_map_index == 90) or (cur_map_index == 91) or (cur_map_index == 110) or (cur_map_index == 111) or (cur_map_index == 112)) then begin
+                                                            if ((CUR_MAP_COAST1) or (CUR_MAP_COAST2) or (CUR_MAP_COAST3) or (CUR_MAP_COAST4) or (CUR_MAP_COAST5) or (CUR_MAP_COAST6) or (CUR_MAP_COAST7) or (CUR_MAP_COAST8) or (CUR_MAP_COAST9) or (CUR_MAP_COAST10) or (CUR_MAP_COAST11) or (CUR_MAP_07DESERT)) then begin
                                                                 if (elevation(self_obj) == 1) then begin
                                                                     PartyMemberBackground := 14;
                                                                 end
@@ -324,7 +324,7 @@ begin
                                                                 end
                                                             end
                                                             else begin
-                                                                if (metarule(46, 0) == 30) then begin
+                                                                if (cur_town == 30) then begin
                                                                     if (elevation(self_obj) == 1) then begin
                                                                         PartyMemberBackground := 14;
                                                                     end
@@ -359,7 +359,7 @@ end
 
 procedure Check_Second_Third_Of_Areas
 begin
-    if (metarule(46, 0) == 31) then begin
+    if (cur_town == 31) then begin
         if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
             PartyMemberBackground := 22;
         end
@@ -368,7 +368,7 @@ begin
         end
     end
     else begin
-        if (metarule(46, 0) == 32) then begin
+        if (cur_town == 32) then begin
             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                 PartyMemberBackground := 22;
             end
@@ -377,7 +377,7 @@ begin
             end
         end
         else begin
-            if (metarule(46, 0) == 33) then begin
+            if (cur_town == 33) then begin
                 if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                     PartyMemberBackground := 22;
                 end
@@ -386,7 +386,7 @@ begin
                 end
             end
             else begin
-                if (metarule(46, 0) == 34) then begin
+                if (cur_town == 34) then begin
                     if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                         PartyMemberBackground := 22;
                     end
@@ -395,11 +395,11 @@ begin
                     end
                 end
                 else begin
-                    if (metarule(46, 0) == 35) then begin
+                    if (cur_town == 35) then begin
                         PartyMemberBackground := 4;
                     end
                     else begin
-                        if (metarule(46, 0) == 36) then begin
+                        if (cur_town == 36) then begin
                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                 PartyMemberBackground := 22;
                             end
@@ -408,11 +408,11 @@ begin
                             end
                         end
                         else begin
-                            if (metarule(46, 0) == 37) then begin
+                            if (cur_town == 37) then begin
                                 PartyMemberBackground := 4;
                             end
                             else begin
-                                if (metarule(46, 0) == 38) then begin
+                                if (cur_town == 38) then begin
                                     if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                         PartyMemberBackground := 22;
                                     end
@@ -421,7 +421,7 @@ begin
                                     end
                                 end
                                 else begin
-                                    if (metarule(46, 0) == 39) then begin
+                                    if (cur_town == 39) then begin
                                         if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                             PartyMemberBackground := 22;
                                         end
@@ -430,7 +430,7 @@ begin
                                         end
                                     end
                                     else begin
-                                        if (metarule(46, 0) == 40) then begin
+                                        if (cur_town == 40) then begin
                                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                 PartyMemberBackground := 22;
                                             end
@@ -439,7 +439,7 @@ begin
                                             end
                                         end
                                         else begin
-                                            if (metarule(46, 0) == 41) then begin
+                                            if (cur_town == 41) then begin
                                                 if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                     PartyMemberBackground := 22;
                                                 end
@@ -448,7 +448,7 @@ begin
                                                 end
                                             end
                                             else begin
-                                                if (metarule(46, 0) == 42) then begin
+                                                if (cur_town == 42) then begin
                                                     if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                         PartyMemberBackground := 22;
                                                     end
@@ -457,7 +457,7 @@ begin
                                                     end
                                                 end
                                                 else begin
-                                                    if (metarule(46, 0) == 43) then begin
+                                                    if (cur_town == 43) then begin
                                                         if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                             PartyMemberBackground := 22;
                                                         end
@@ -466,7 +466,7 @@ begin
                                                         end
                                                     end
                                                     else begin
-                                                        if (metarule(46, 0) == 44) then begin
+                                                        if (cur_town == 44) then begin
                                                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                                 PartyMemberBackground := 22;
                                                             end
@@ -494,7 +494,7 @@ end
 
 procedure Check_Final_Third_Of_Areas
 begin
-    if (metarule(46, 0) == 45) then begin
+    if (cur_town == 45) then begin
         if (elevation(self_obj) == 1) then begin
             PartyMemberBackground := 14;
         end
@@ -508,7 +508,7 @@ begin
         end
     end
     else begin
-        if (metarule(46, 0) == 46) then begin
+        if (cur_town == 46) then begin
             if (elevation(self_obj) == 1) then begin
                 PartyMemberBackground := 14;
             end
@@ -522,7 +522,7 @@ begin
             end
         end
         else begin
-            if (metarule(46, 0) == 47) then begin
+            if (cur_town == 47) then begin
                 if (elevation(self_obj) == 1) then begin
                     PartyMemberBackground := 14;
                 end
@@ -536,7 +536,7 @@ begin
                 end
             end
             else begin
-                if (metarule(46, 0) == 48) then begin
+                if (cur_town == 48) then begin
                     if (elevation(self_obj) == 1) then begin
                         PartyMemberBackground := 6;
                     end
@@ -545,8 +545,8 @@ begin
                     end
                 end
                 else begin
-                    if (metarule(46, 0) == 58) then begin
-                        if (cur_map_index == 167) then begin
+                    if (cur_town == 58) then begin
+                        if (CUR_MAP_GLOWENT) then begin
                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                 PartyMemberBackground := 22;
                             end
@@ -559,7 +559,7 @@ begin
                         end
                     end
                     else begin
-                        if (metarule(46, 0) == 91) then begin
+                        if (cur_town == 91) then begin
                             if ((elevation(self_obj) == 1) or (elevation(self_obj) == 2)) then begin
                                 PartyMemberBackground := 6;
                             end
@@ -593,70 +593,70 @@ end
 
 procedure critter_p_proc
 begin
-    if ((cur_map_index == 54) and (self_obj == party_member_obj(16777323)) and (map_var(2) == party_member_obj(16777323))) then begin
+    if ((CUR_MAP_NEWR1) and (self_obj == party_member_obj(16777323)) and (map_var(2) == party_member_obj(16777323))) then begin
         set_map_var(2, 0);
         waiting := 1;
-        if (get_critter_stat(self_obj, 0) < 10) then begin
-            use_obj_on_obj(create_object_sid(482, 0, 0, -1), self_obj);
+        if (self_strength < 10) then begin
+            use_obj_on_obj(create_object(482, 0, 0), self_obj);
         end
     end
-    if ((cur_map_index == 54) and (self_obj == party_member_obj(16777801)) and (map_var(2) == party_member_obj(16777801))) then begin
+    if ((CUR_MAP_NEWR1) and (self_obj == party_member_obj(16777801)) and (map_var(2) == party_member_obj(16777801))) then begin
         set_map_var(2, 0);
         waiting := 1;
-        if (get_critter_stat(self_obj, 0) < 10) then begin
-            use_obj_on_obj(create_object_sid(482, 0, 0, -1), self_obj);
+        if (self_strength < 10) then begin
+            use_obj_on_obj(create_object(482, 0, 0), self_obj);
         end
     end
     if (local_var(17) == 1) then begin
         obj_set_light_level(self_obj, 100, 3);
         set_local_var(17, 2);
     end
-    if ((local_var(5) == 2) or ((metarule(46, 0) == 5) and global_var(238)) or (local_var(6) == 1) and obj_can_see_obj(self_obj, dude_obj)) then begin
+    if ((local_var(5) == 2) or ((cur_town == 5) and global_var(GVAR_ENEMY_GECKO)) or (local_var(6) == 1) and obj_can_see_obj(self_obj, dude_obj)) then begin
         set_local_var(5, 1);
-        attack_complex(dude_obj, 0, 1, 0, 0, 30000, 0, 0);
+        attack(dude_obj);
     end
     else begin
         if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0)) then begin
             debug_msg("Lenny_In_Party == " + (party_member_obj(16777323) != 0) + ". local_var(LVAR_never_again) == " + local_var(14));
-            if ((global_var(0) < -100) and not(has_trait(0, dude_obj, 39))) then begin
+            if ((global_var(GVAR_PLAYER_REPUTATION) < -100) and not(has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))) then begin
                 call Node070();
                 debug_msg("LENNY: Bad Karma");
             end
             else begin
-                if ((global_var(1) >= 2) and not(has_trait(0, dude_obj, 39))) then begin
+                if ((global_var(GVAR_CHILDKILLER_REPUTATION) >= 2) and not(has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))) then begin
                     call Node071();
                     debug_msg("LENNY: Childkiller");
                 end
                 else begin
-                    if ((global_var(11) == 1) and not(has_trait(0, dude_obj, 39))) then begin
+                    if ((global_var(GVAR_REPUTATION_SLAVER) == 1) and not(has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))) then begin
                         call Node073();
                         debug_msg("LENNY: Slaver");
                     end
                     else begin
-                        if ((global_var(82) == 8) or (global_var(395) > 0) or (global_var(583) == 1) and not(has_trait(0, dude_obj, 39))) then begin
+                        if ((global_var(GVAR_VAULT_GECKO_PLANT) == 8) or (global_var(GVAR_GECKO_MELTDOWN) > 0) or (global_var(GVAR_PLANT_SCHEDULED_FOR_CHANGE) == 1) and not(has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))) then begin
                             call Node074();
                             debug_msg("LENNY: Destroyed Plant");
                         end
                         else begin
-                            if ((get_critter_stat(dude_obj, 3) <= 1) and not(has_trait(0, dude_obj, 39))) then begin
+                            if ((dude_charisma <= 1) and not(has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))) then begin
                                 call Node075();
                                 debug_msg("LENNY: Player Ugly");
                             end
                             else begin
-                                if ((metarule(46, 0) == 5) and (global_var(238) == 1) and not(has_trait(0, dude_obj, 39))) then begin
+                                if ((cur_town == 5) and (global_var(GVAR_ENEMY_GECKO) == 1) and not(has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))) then begin
                                     call Node076();
                                     debug_msg("LENNY: Causing trouble in Gecko");
                                 end
                                 else begin
                                     if ((local_var(10) != 0) == 0) then begin
                                         if (waiting != 1) then begin
-                                            if (((local_var(10) != 0) == 0) and ((global_var(398) != 0) == 0)) then begin
+                                            if (((local_var(10) != 0) == 0) and ((global_var(GVAR_PARTY_NO_FOLLOW) != 0) == 0)) then begin
                                                 if (local_var(11) == 0) then begin
                                                     set_local_var(11, 6);
                                                 end
                                                 if (tile_distance_objs(self_obj, dude_obj) > (3 * local_var(11) / 2)) then begin
                                                     if (anim_busy(self_obj) == 0) then begin
-                                                        dest_tile := tile_num_in_direction(tile_num_in_direction(tile_num(dude_obj), rotation_to_tile(tile_num(dude_obj), tile_num(self_obj)), local_var(11)), random(0, 5), random(0, 2));
+                                                        dest_tile := tile_num_in_direction(tile_num_in_direction(dude_tile, rotation_to_tile(dude_tile, tile_num(self_obj)), local_var(11)), random(0, 5), random(0, 2));
                                                         if (tile_distance_objs(self_obj, dude_obj) > (3 * local_var(11) / 2 * 2)) then begin
                                                             animate_move_obj_to_tile(self_obj, dest_tile, 1);
                                                         end
@@ -665,7 +665,7 @@ begin
                                                         end
                                                     end
                                                     else begin
-                                                        if (tile_distance(tile_num(self_obj), tile_num(dude_obj)) < tile_distance(tile_num(self_obj), dest_tile)) then begin
+                                                        if (tile_distance(tile_num(self_obj), dude_tile) < tile_distance(tile_num(self_obj), dest_tile)) then begin
                                                             reg_anim_func(2, self_obj);
                                                         end
                                                     end
@@ -681,25 +681,25 @@ begin
             end
         end
         else begin
-            if ((metarule(46, 0) == 5) and (global_var(238) == 1)) then begin
+            if ((cur_town == 5) and (global_var(GVAR_ENEMY_GECKO) == 1)) then begin
                 call Node998();
             end
         end
     end
-    debug_msg("Gecko Standing: " + global_var(238));
+    debug_msg("Gecko Standing: " + global_var(GVAR_ENEMY_GECKO));
 end
 
 procedure combat_p_proc
 begin
     variable LVar0 := 0;
-    if (((get_critter_stat(dude_obj, 7) / 2) > get_critter_stat(dude_obj, 35)) and (party_member_obj(obj_pid(self_obj)) != 0)) then begin
-        animate_move_obj_to_tile(self_obj, tile_num(dude_obj), 1);
+    if (((get_critter_stat(dude_obj, STAT_max_hp) / 2) > get_critter_stat(dude_obj, STAT_current_hp)) and (party_member_obj(obj_pid(self_obj)) != 0)) then begin
+        animate_move_obj_to_tile(self_obj, dude_tile, 1);
         if (obj_is_carrying_obj_pid(self_obj, 91)) then begin
             use_obj_on_obj(obj_carrying_pid_obj(self_obj, 91), dude_obj);
             if (is_success(roll_vs_skill(self_obj, 7, 0))) then begin
                 LVar0 := random(10, 25);
                 critter_heal(dude_obj, LVar0);
-                display_msg(obj_name(self_obj) + " heals you for " + LVar0 + " hit points,with doctor skill.");
+                display_msg(self_name + " heals you for " + LVar0 + " hit points,with doctor skill.");
             end
         end
         else begin
@@ -708,7 +708,7 @@ begin
                 if (is_success(roll_vs_skill(self_obj, 6, 0))) then begin
                     LVar0 := random(5, 15);
                     critter_heal(dude_obj, LVar0);
-                    display_msg(obj_name(self_obj) + " heals you for " + LVar0 + " hit points,with first aid skill.");
+                    display_msg(self_name + " heals you for " + LVar0 + " hit points,with first aid skill.");
                 end
             end
         end
@@ -727,7 +727,7 @@ end
 procedure push_p_proc
 begin
     if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0)) then begin
-        float_msg(self_obj, message_str(139, random(2300, 2307)), 8);
+        float_msg(self_obj, mstr(random(2300, 2307)), FLOAT_MSG_YELLOW);
     end
     else begin
         script_overrides;
@@ -737,12 +737,12 @@ end
 procedure talk_p_proc
 begin
     ArmourVal := critter_inven_obj(self_obj, 0);
-    set_global_var(1642, get_ini_setting("megamod.ini|SETTINGS|party_armor_graphic"));
+    set_global_var(GVAR_CAR_PAINT_JOB, get_ini_setting("megamod.ini|SETTINGS|party_armor_graphic"));
     visit_04_before := 0;
     visit_14_before := 0;
     if (local_var(2) == 0) then begin
         set_local_var(2, 1);
-        set_local_var(3, (get_critter_stat(dude_obj, 3) - get_critter_stat(self_obj, 3)) * 5);
+        set_local_var(3, (dude_charisma - self_charisma) * 5);
         debug_msg("Base Reaction == " + local_var(3));
     end
     Static_Reaction := 0;
@@ -754,14 +754,14 @@ begin
     else begin
         reaction_bonus_karma := -1 * (-1 * reaction_bonus_karma / 1000);
     end
-    if (global_var(51) >= 0) then begin
-        reaction_bonus_town_rep := global_var(51) / 2;
+    if (global_var(GVAR_TOWN_REP_GECKO) >= 0) then begin
+        reaction_bonus_town_rep := global_var(GVAR_TOWN_REP_GECKO) / 2;
     end
     else begin
-        reaction_bonus_town_rep := -1 * (-1 * global_var(51) / 2);
+        reaction_bonus_town_rep := -1 * (-1 * global_var(GVAR_TOWN_REP_GECKO) / 2);
     end
-    if (has_trait(2, dude_obj, 13)) then begin
-        if (get_critter_stat(dude_obj, 34) == get_critter_stat(self_obj, 34)) then begin
+    if (has_trait(TRAIT_TRAIT, dude_obj, TRAIT_sex_appeal)) then begin
+        if (dude_gender == self_gender) then begin
             Static_Reaction := Static_Reaction + -20;
         end
         else begin
@@ -787,52 +787,52 @@ begin
             Static_Reaction := Static_Reaction + reaction_bonus_town_rep;
         end
         debug_msg("Town Rep Bonus == " + Static_Reaction);
-        set_global_var(37, 0);
-        set_global_var(38, 0);
-        set_global_var(39, 0);
-        set_global_var(40, 0);
-        set_global_var(41, 0);
-        set_global_var(42, 0);
-        set_global_var(43, 0);
-        set_global_var(44, 0);
-        set_global_var(45, 0);
-        tmp_gen_rep := global_var(0);
-        if (has_trait(0, dude_obj, 95)) then begin
-            tmp_gen_rep := global_var(0) * 2;
+        set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
+        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
+        set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
+        set_global_var(GVAR_KARMA_DEFENDER, 0);
+        set_global_var(GVAR_KARMA_WANDERER, 0);
+        set_global_var(GVAR_KARMA_BETRAYER, 0);
+        set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
+        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
+        set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
+        tmp_gen_rep := global_var(GVAR_PLAYER_REPUTATION);
+        if (has_trait(TRAIT_PERK, dude_obj, PERK_karma_beacon_perk)) then begin
+            tmp_gen_rep := global_var(GVAR_PLAYER_REPUTATION) * 2;
         end
         if (tmp_gen_rep >= 1000) then begin
-            set_global_var(37, 1);
+            set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
         end
         else begin
             if (tmp_gen_rep >= 750) then begin
-                set_global_var(38, 1);
+                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
             end
             else begin
                 if (tmp_gen_rep >= 500) then begin
-                    set_global_var(39, 1);
+                    set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                 end
                 else begin
                     if (tmp_gen_rep >= 250) then begin
-                        set_global_var(40, 1);
+                        set_global_var(GVAR_KARMA_DEFENDER, 1);
                     end
                     else begin
                         if (tmp_gen_rep > -250) then begin
-                            set_global_var(41, 1);
+                            set_global_var(GVAR_KARMA_WANDERER, 1);
                         end
                         else begin
                             if (tmp_gen_rep > -500) then begin
-                                set_global_var(42, 1);
+                                set_global_var(GVAR_KARMA_BETRAYER, 1);
                             end
                             else begin
                                 if (tmp_gen_rep > -750) then begin
-                                    set_global_var(43, 1);
+                                    set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                 end
                                 else begin
                                     if (tmp_gen_rep > -1000) then begin
-                                        set_global_var(44, 1);
+                                        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                     end
                                     else begin
-                                        set_global_var(45, 1);
+                                        set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                     end
                                 end
                             end
@@ -841,35 +841,35 @@ begin
                 end
             end
         end
-        if (global_var(37) == 1) then begin
+        if (global_var(GVAR_KARMA_HOLY_WARRIOR) == 1) then begin
             Static_Reaction := Static_Reaction - 20;
         end
         else begin
-            if (global_var(38) == 1) then begin
+            if (global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES) == 1) then begin
                 Static_Reaction := Static_Reaction - 15;
             end
             else begin
-                if (global_var(39) == 1) then begin
+                if (global_var(GVAR_KARMA_SHIELD_OF_HOPE) == 1) then begin
                     Static_Reaction := Static_Reaction - 10;
                 end
                 else begin
-                    if (global_var(40) == 1) then begin
+                    if (global_var(GVAR_KARMA_DEFENDER) == 1) then begin
                         Static_Reaction := Static_Reaction - 5;
                     end
                     else begin
-                        if (global_var(41) == 1) then begin
+                        if (global_var(GVAR_KARMA_WANDERER) == 1) then begin
                             Static_Reaction := Static_Reaction - 0;
                         end
                         else begin
-                            if (global_var(42) == 1) then begin
+                            if (global_var(GVAR_KARMA_BETRAYER) == 1) then begin
                                 Static_Reaction := Static_Reaction + -5;
                             end
                             else begin
-                                if (global_var(43) == 1) then begin
+                                if (global_var(GVAR_KARMA_SWORD_OF_DESPAIR) == 1) then begin
                                     Static_Reaction := Static_Reaction + -10;
                                 end
                                 else begin
-                                    if (global_var(44) == 1) then begin
+                                    if (global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE) == 1) then begin
                                         Static_Reaction := Static_Reaction + -15;
                                     end
                                     else begin
@@ -889,52 +889,52 @@ begin
         debug_msg("Karma Reaction Bonus == " + Static_Reaction);
         Static_Reaction := Static_Reaction + reaction_bonus_town_rep;
         debug_msg("Town Rep Bonus == " + Static_Reaction);
-        set_global_var(37, 0);
-        set_global_var(38, 0);
-        set_global_var(39, 0);
-        set_global_var(40, 0);
-        set_global_var(41, 0);
-        set_global_var(42, 0);
-        set_global_var(43, 0);
-        set_global_var(44, 0);
-        set_global_var(45, 0);
-        tmp_gen_rep := global_var(0);
-        if (has_trait(0, dude_obj, 95)) then begin
-            tmp_gen_rep := global_var(0) * 2;
+        set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
+        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
+        set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
+        set_global_var(GVAR_KARMA_DEFENDER, 0);
+        set_global_var(GVAR_KARMA_WANDERER, 0);
+        set_global_var(GVAR_KARMA_BETRAYER, 0);
+        set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
+        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
+        set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
+        tmp_gen_rep := global_var(GVAR_PLAYER_REPUTATION);
+        if (has_trait(TRAIT_PERK, dude_obj, PERK_karma_beacon_perk)) then begin
+            tmp_gen_rep := global_var(GVAR_PLAYER_REPUTATION) * 2;
         end
         if (tmp_gen_rep >= 1000) then begin
-            set_global_var(37, 1);
+            set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
         end
         else begin
             if (tmp_gen_rep >= 750) then begin
-                set_global_var(38, 1);
+                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
             end
             else begin
                 if (tmp_gen_rep >= 500) then begin
-                    set_global_var(39, 1);
+                    set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                 end
                 else begin
                     if (tmp_gen_rep >= 250) then begin
-                        set_global_var(40, 1);
+                        set_global_var(GVAR_KARMA_DEFENDER, 1);
                     end
                     else begin
                         if (tmp_gen_rep > -250) then begin
-                            set_global_var(41, 1);
+                            set_global_var(GVAR_KARMA_WANDERER, 1);
                         end
                         else begin
                             if (tmp_gen_rep > -500) then begin
-                                set_global_var(42, 1);
+                                set_global_var(GVAR_KARMA_BETRAYER, 1);
                             end
                             else begin
                                 if (tmp_gen_rep > -750) then begin
-                                    set_global_var(43, 1);
+                                    set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                 end
                                 else begin
                                     if (tmp_gen_rep > -1000) then begin
-                                        set_global_var(44, 1);
+                                        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                     end
                                     else begin
-                                        set_global_var(45, 1);
+                                        set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                     end
                                 end
                             end
@@ -943,35 +943,35 @@ begin
                 end
             end
         end
-        if (global_var(37) == 1) then begin
+        if (global_var(GVAR_KARMA_HOLY_WARRIOR) == 1) then begin
             Static_Reaction := Static_Reaction + 20;
         end
         else begin
-            if (global_var(38) == 1) then begin
+            if (global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES) == 1) then begin
                 Static_Reaction := Static_Reaction + 15;
             end
             else begin
-                if (global_var(39) == 1) then begin
+                if (global_var(GVAR_KARMA_SHIELD_OF_HOPE) == 1) then begin
                     Static_Reaction := Static_Reaction + 10;
                 end
                 else begin
-                    if (global_var(40) == 1) then begin
+                    if (global_var(GVAR_KARMA_DEFENDER) == 1) then begin
                         Static_Reaction := Static_Reaction + 5;
                     end
                     else begin
-                        if (global_var(41) == 1) then begin
+                        if (global_var(GVAR_KARMA_WANDERER) == 1) then begin
                             Static_Reaction := Static_Reaction + 0;
                         end
                         else begin
-                            if (global_var(42) == 1) then begin
+                            if (global_var(GVAR_KARMA_BETRAYER) == 1) then begin
                                 Static_Reaction := Static_Reaction + -5;
                             end
                             else begin
-                                if (global_var(43) == 1) then begin
+                                if (global_var(GVAR_KARMA_SWORD_OF_DESPAIR) == 1) then begin
                                     Static_Reaction := Static_Reaction + -10;
                                 end
                                 else begin
-                                    if (global_var(44) == 1) then begin
+                                    if (global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE) == 1) then begin
                                         Static_Reaction := Static_Reaction + -15;
                                     end
                                     else begin
@@ -987,32 +987,32 @@ begin
         debug_msg("Good Person Reaction Bonus == " + Static_Reaction);
     end
     if (Slavery_Tolerant == 0) then begin
-        if (global_var(11) == 1) then begin
+        if (global_var(GVAR_REPUTATION_SLAVER) == 1) then begin
             Static_Reaction := Static_Reaction + (2 * -25);
         end
     end
     else begin
         if (Slavery_Tolerant == 1) then begin
-            if (global_var(11) == 1) then begin
+            if (global_var(GVAR_REPUTATION_SLAVER) == 1) then begin
                 Static_Reaction := Static_Reaction + -25;
             end
         end
         else begin
             if (Slavery_Tolerant == 3) then begin
-                if (global_var(11) == 1) then begin
+                if (global_var(GVAR_REPUTATION_SLAVER) == 1) then begin
                     Static_Reaction := Static_Reaction - -25;
                 end
             end
         end
     end
     debug_msg("Slaver + Aligned Reaction == " + Static_Reaction);
-    Static_Reaction := Static_Reaction + (10 * has_trait(0, dude_obj, 10));
+    Static_Reaction := Static_Reaction + (10 * has_trait(TRAIT_PERK, dude_obj, PERK_presence));
     debug_msg("Presence Reaction == " + Static_Reaction);
-    if (global_var(1) >= 2) then begin
+    if (global_var(GVAR_CHILDKILLER_REPUTATION) >= 2) then begin
         Static_Reaction := Static_Reaction + -30;
     end
     debug_msg("Childkiller Reaction == " + Static_Reaction);
-    if (has_trait(0, dude_obj, 39)) then begin
+    if (has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality)) then begin
         if (Evil_Critter == 1) then begin
             if (Static_Reaction > 0) then begin
                 Static_Reaction := Static_Reaction * -1;
@@ -1027,12 +1027,12 @@ begin
     set_local_var(0, local_var(3) + Static_Reaction);
     debug_msg("Initial Reaction == " + local_var(0));
     call checkarea();
-    if (metarule(46, 0) == 0) then begin
-        if (cur_map_index == 3) then begin
+    if (cur_town == 0) then begin
+        if (CUR_MAP_ARCAVES) then begin
             PartyMemberBackground := 34;
         end
         else begin
-            if (cur_map_index == 35) then begin
+            if (CUR_MAP_ARGARDEN) then begin
                 if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                     PartyMemberBackground := 28;
                 end
@@ -1041,7 +1041,7 @@ begin
                 end
             end
             else begin
-                if (cur_map_index == 5) then begin
+                if (CUR_MAP_ARBRIDGE) then begin
                     PartyMemberBackground := 39;
                 end
                 else begin
@@ -1051,12 +1051,12 @@ begin
         end
     end
     else begin
-        if (metarule(46, 0) == 2) then begin
-            if (cur_map_index == 11) then begin
+        if (cur_town == 2) then begin
+            if (CUR_MAP_KLARATCV) then begin
                 PartyMemberBackground := 14;
             end
             else begin
-                if (cur_map_index == 48) then begin
+                if (CUR_MAP_KLACANYN) then begin
                     if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                         PartyMemberBackground := 37;
                     end
@@ -1065,7 +1065,7 @@ begin
                     end
                 end
                 else begin
-                    if ((cur_map_index == 14) or (cur_map_index == 13)) then begin
+                    if ((CUR_MAP_KLAGRAZ) or (CUR_MAP_KLATRAP)) then begin
                         if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                             PartyMemberBackground := 28;
                         end
@@ -1085,16 +1085,16 @@ begin
             end
         end
         else begin
-            if (metarule(46, 0) == 1) then begin
+            if (cur_town == 1) then begin
                 PartyMemberBackground := 3;
             end
             else begin
-                if (metarule(46, 0) == 3) then begin
-                    if ((cur_map_index == 18) and (elevation(dude_obj) == 2)) then begin
+                if (cur_town == 3) then begin
+                    if ((CUR_MAP_MODMAIN) and (dude_elevation == 2)) then begin
                         PartyMemberBackground := 14;
                     end
                     else begin
-                        if ((cur_map_index == 20) or (cur_map_index == 21) or (cur_map_index == 24)) then begin
+                        if ((CUR_MAP_MODBRAH) or (CUR_MAP_MODGARD) or (CUR_MAP_GSTFARM)) then begin
                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                 PartyMemberBackground := 21;
                             end
@@ -1103,7 +1103,7 @@ begin
                             end
                         end
                         else begin
-                            if ((cur_map_index == 22) or (cur_map_index == 23)) then begin
+                            if ((CUR_MAP_MODSHIT) or (CUR_MAP_MODWELL)) then begin
                                 PartyMemberBackground := 14;
                             end
                             else begin
@@ -1113,8 +1113,8 @@ begin
                     end
                 end
                 else begin
-                    if (metarule(46, 0) == 4) then begin
-                        if (cur_map_index == 30) then begin
+                    if (cur_town == 4) then begin
+                        if (CUR_MAP_VCTYVLT) then begin
                             PartyMemberBackground := 10;
                         end
                         else begin
@@ -1122,12 +1122,12 @@ begin
                         end
                     end
                     else begin
-                        if (metarule(46, 0) == 5) then begin
-                            if (cur_map_index == 32) then begin
+                        if (cur_town == 5) then begin
+                            if (CUR_MAP_GECKPWPL) then begin
                                 PartyMemberBackground := 6;
                             end
                             else begin
-                                if (cur_map_index == 34) then begin
+                                if (CUR_MAP_GECKTUNL) then begin
                                     PartyMemberBackground := 14;
                                 end
                                 else begin
@@ -1136,8 +1136,8 @@ begin
                             end
                         end
                         else begin
-                            if (metarule(46, 0) == 6) then begin
-                                if (cur_map_index == 79) then begin
+                            if (cur_town == 6) then begin
+                                if (CUR_MAP_BROKEN2) then begin
                                     if ((elevation(self_obj) == 1) or (elevation(self_obj) == 2)) then begin
                                         PartyMemberBackground := 14;
                                     end
@@ -1147,8 +1147,8 @@ begin
                                 end
                             end
                             else begin
-                                if (metarule(46, 0) == 7) then begin
-                                    if (metarule(46, 0) == 48) then begin
+                                if (cur_town == 7) then begin
+                                    if (cur_town == 48) then begin
                                         if (elevation(self_obj) == 1) then begin
                                             PartyMemberBackground := 6;
                                         end
@@ -1161,8 +1161,8 @@ begin
                                     end
                                 end
                                 else begin
-                                    if (metarule(46, 0) == 8) then begin
-                                        if (cur_map_index == 27) then begin
+                                    if (cur_town == 8) then begin
+                                        if (CUR_MAP_DEPOLV1) then begin
                                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                 PartyMemberBackground := 21;
                                             end
@@ -1175,8 +1175,8 @@ begin
                                         end
                                     end
                                     else begin
-                                        if (metarule(46, 0) == 9) then begin
-                                            if (cur_map_index == 36) then begin
+                                        if (cur_town == 9) then begin
+                                            if (CUR_MAP_VAULT15) then begin
                                                 PartyMemberBackground := 10;
                                             end
                                             else begin
@@ -1189,8 +1189,8 @@ begin
                                             end
                                         end
                                         else begin
-                                            if (metarule(46, 0) == 10) then begin
-                                                if (cur_map_index == 45) then begin
+                                            if (cur_town == 10) then begin
+                                                if (CUR_MAP_NCR4) then begin
                                                     if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                         PartyMemberBackground := 21;
                                                     end
@@ -1203,8 +1203,8 @@ begin
                                                 end
                                             end
                                             else begin
-                                                if (metarule(46, 0) == 11) then begin
-                                                    if (cur_map_index == 40) then begin
+                                                if (cur_town == 11) then begin
+                                                    if (CUR_MAP_VAULT13) then begin
                                                         PartyMemberBackground := 10;
                                                     end
                                                     else begin
@@ -1212,8 +1212,8 @@ begin
                                                     end
                                                 end
                                                 else begin
-                                                    if (metarule(46, 0) == 12) then begin
-                                                        if (cur_map_index == 51) then begin
+                                                    if (cur_town == 12) then begin
+                                                        if (CUR_MAP_MBCLOSE) then begin
                                                             if ((game_time_hour >= 2000) or (game_time_hour < 600)) then begin
                                                                 PartyMemberBackground := 21;
                                                             end
@@ -1226,8 +1226,8 @@ begin
                                                         end
                                                     end
                                                     else begin
-                                                        if (metarule(46, 0) == 13) then begin
-                                                            if ((cur_map_index == 66) or (cur_map_index == 67) or (cur_map_index == 63)) then begin
+                                                        if (cur_town == 13) then begin
+                                                            if ((CUR_MAP_REDDTUN) or (CUR_MAP_REDMTUN) or (CUR_MAP_REDWAN1)) then begin
                                                                 PartyMemberBackground := 14;
                                                             end
                                                             else begin
@@ -1235,11 +1235,11 @@ begin
                                                             end
                                                         end
                                                         else begin
-                                                            if (metarule(46, 0) == 14) then begin
+                                                            if (cur_town == 14) then begin
                                                                 PartyMemberBackground := 12;
                                                             end
                                                             else begin
-                                                                if (metarule(46, 0) == 15) then begin
+                                                                if (cur_town == 15) then begin
                                                                     if (elevation(self_obj) == 0) then begin
                                                                         PartyMemberBackground := 7;
                                                                     end
@@ -1288,30 +1288,30 @@ begin
         end
         else begin
             if (local_var(14) > 0) then begin
-                float_msg(self_obj, message_str(139, 3005), 2);
+                float_msg(self_obj, mstr(3005), FLOAT_MSG_RED);
             end
             else begin
-                if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0) and (global_var(0) < -100)) then begin
+                if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0) and (global_var(GVAR_PLAYER_REPUTATION) < -100)) then begin
                     call Node070();
                     debug_msg("LENNY: Bad Karma");
                 end
                 else begin
-                    if ((party_member_obj(16777323) != 0) and (global_var(1) >= 2)) then begin
+                    if ((party_member_obj(16777323) != 0) and (global_var(GVAR_CHILDKILLER_REPUTATION) >= 2)) then begin
                         call Node071();
                         debug_msg("LENNY: Childkiller");
                     end
                     else begin
-                        if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0) and (((global_var(4) + global_var(5)) >= 25) and ((global_var(5) > (2 * global_var(4))) or (global_var(3) == 1)))) then begin
+                        if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0) and (((global_var(GVAR_BAD_MONSTER) + global_var(GVAR_GOOD_MONSTER)) >= 25) and ((global_var(GVAR_GOOD_MONSTER) > (2 * global_var(GVAR_BAD_MONSTER))) or (global_var(GVAR_BERSERKER_REPUTATION) == 1)))) then begin
                             call Node072();
                             debug_msg("LENNY: Berserker");
                         end
                         else begin
-                            if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0) and (global_var(11) == 1)) then begin
+                            if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0) and (global_var(GVAR_REPUTATION_SLAVER) == 1)) then begin
                                 call Node073();
                                 debug_msg("LENNY: Slaver");
                             end
                             else begin
-                                if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0) and ((global_var(82) == 8) or (global_var(395) > 0) or (global_var(583) == 1))) then begin
+                                if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0) and ((global_var(GVAR_VAULT_GECKO_PLANT) == 8) or (global_var(GVAR_GECKO_MELTDOWN) > 0) or (global_var(GVAR_PLANT_SCHEDULED_FOR_CHANGE) == 1))) then begin
                                     call Node074();
                                     debug_msg("LENNY: Destroyed Plant");
                                 end
@@ -1324,7 +1324,7 @@ begin
                                         end_dialogue;
                                     end
                                     else begin
-                                        if (get_critter_stat(dude_obj, 4) <= 3) then begin
+                                        if (dude_is_stupid) then begin
                                             call Node003();
                                         end
                                         else begin
@@ -1343,7 +1343,7 @@ begin
             end
         end
     end
-    if (global_var(1642) == 1) then begin
+    if (global_var(GVAR_CAR_PAINT_JOB) == 1) then begin
         call armour_change();
     end
 end
@@ -1351,63 +1351,63 @@ end
 procedure destroy_p_proc
 begin
     if (source_obj == dude_obj) then begin
-        set_global_var(5, global_var(5) + 1);
-        if (((global_var(4) + global_var(5)) >= 25) and ((global_var(4) > (3 * global_var(5))) or (global_var(2) == 1)) and (global_var(1) == 0)) then begin
-            set_global_var(2, 1);
-            set_global_var(3, 0);
+        set_global_var(GVAR_GOOD_MONSTER, global_var(GVAR_GOOD_MONSTER) + 1);
+        if (((global_var(GVAR_BAD_MONSTER) + global_var(GVAR_GOOD_MONSTER)) >= 25) and ((global_var(4) > (3 * global_var(GVAR_GOOD_MONSTER))) or (global_var(GVAR_CHAMPION_REPUTATION) == 1)) and (global_var(GVAR_CHILDKILLER_REPUTATION) == 0)) then begin
+            set_global_var(GVAR_CHAMPION_REPUTATION, 1);
+            set_global_var(GVAR_BERSERKER_REPUTATION, 0);
         end
-        if (((global_var(4) + global_var(5)) >= 25) and ((global_var(5) > (2 * global_var(4))) or (global_var(3) == 1))) then begin
-            set_global_var(3, 1);
-            set_global_var(2, 0);
+        if (((global_var(GVAR_BAD_MONSTER) + global_var(GVAR_GOOD_MONSTER)) >= 25) and ((global_var(GVAR_GOOD_MONSTER) > (2 * global_var(GVAR_BAD_MONSTER))) or (global_var(GVAR_BERSERKER_REPUTATION) == 1))) then begin
+            set_global_var(GVAR_BERSERKER_REPUTATION, 1);
+            set_global_var(GVAR_CHAMPION_REPUTATION, 0);
         end
-        set_global_var(0, global_var(0) + -10);
+        set_global_var(GVAR_PLAYER_REPUTATION, global_var(GVAR_PLAYER_REPUTATION) + -10);
         debug_msg("Player gains " + -10 + " Karma Points.");
-        set_global_var(37, 0);
-        set_global_var(38, 0);
-        set_global_var(39, 0);
-        set_global_var(40, 0);
-        set_global_var(41, 0);
-        set_global_var(42, 0);
-        set_global_var(43, 0);
-        set_global_var(44, 0);
-        set_global_var(45, 0);
-        tmp_gen_rep := global_var(0);
-        if (has_trait(0, dude_obj, 95)) then begin
-            tmp_gen_rep := global_var(0) * 2;
+        set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
+        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
+        set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
+        set_global_var(GVAR_KARMA_DEFENDER, 0);
+        set_global_var(GVAR_KARMA_WANDERER, 0);
+        set_global_var(GVAR_KARMA_BETRAYER, 0);
+        set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
+        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
+        set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
+        tmp_gen_rep := global_var(GVAR_PLAYER_REPUTATION);
+        if (has_trait(TRAIT_PERK, dude_obj, PERK_karma_beacon_perk)) then begin
+            tmp_gen_rep := global_var(GVAR_PLAYER_REPUTATION) * 2;
         end
         if (tmp_gen_rep >= 1000) then begin
-            set_global_var(37, 1);
+            set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
         end
         else begin
             if (tmp_gen_rep >= 750) then begin
-                set_global_var(38, 1);
+                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
             end
             else begin
                 if (tmp_gen_rep >= 500) then begin
-                    set_global_var(39, 1);
+                    set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                 end
                 else begin
                     if (tmp_gen_rep >= 250) then begin
-                        set_global_var(40, 1);
+                        set_global_var(GVAR_KARMA_DEFENDER, 1);
                     end
                     else begin
                         if (tmp_gen_rep > -250) then begin
-                            set_global_var(41, 1);
+                            set_global_var(GVAR_KARMA_WANDERER, 1);
                         end
                         else begin
                             if (tmp_gen_rep > -500) then begin
-                                set_global_var(42, 1);
+                                set_global_var(GVAR_KARMA_BETRAYER, 1);
                             end
                             else begin
                                 if (tmp_gen_rep > -750) then begin
-                                    set_global_var(43, 1);
+                                    set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                 end
                                 else begin
                                     if (tmp_gen_rep > -1000) then begin
-                                        set_global_var(44, 1);
+                                        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                     end
                                     else begin
-                                        set_global_var(45, 1);
+                                        set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                     end
                                 end
                             end
@@ -1416,7 +1416,7 @@ begin
                 end
             end
         end
-        set_global_var(51, global_var(51) + -5);
+        set_global_var(GVAR_TOWN_REP_GECKO, global_var(GVAR_TOWN_REP_GECKO) + -5);
         debug_msg("Added " + -5 + " to Town Rep");
     end
 end
@@ -1425,19 +1425,19 @@ procedure look_at_p_proc
 begin
     script_overrides;
     if (party_member_obj(16777323) != 0) then begin
-        display_msg(message_str(139, 104));
+        display_mstr(104);
     end
     else begin
         if ((party_member_obj(16777323) != 0) or (local_var(10) != 0)) then begin
-            display_msg(message_str(139, 103));
+            display_mstr(103);
         end
         else begin
             if (local_var(15) == 0) then begin
                 set_local_var(15, 1);
-                display_msg(message_str(139, 100));
+                display_mstr(100);
             end
             else begin
-                display_msg(message_str(139, 101));
+                display_mstr(101);
             end
         end
     end
@@ -1446,22 +1446,22 @@ end
 procedure description_p_proc
 begin
     script_overrides;
-    display_msg(message_str(139, 101));
+    display_mstr(101);
 end
 
 procedure use_skill_on_p_proc
 begin
     if (action_being_used == 12) then begin
         script_overrides;
-        if (has_skill(source_obj, 12) > 99) then begin
-            display_msg(message_str(139, 6100));
+        if (has_skill(source_obj, SKILL_SCIENCE) > 99) then begin
+            display_mstr(6100);
         end
         else begin
-            if (has_skill(source_obj, 12) > 69) then begin
-                display_msg(message_str(139, 6101));
+            if (has_skill(source_obj, SKILL_SCIENCE) > 69) then begin
+                display_mstr(6101);
             end
             else begin
-                display_msg(message_str(139, 6102));
+                display_mstr(6102);
             end
         end
     end
@@ -1471,49 +1471,49 @@ procedure damage_p_proc
 begin
     if (source_obj == dude_obj) then begin
         if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-            debug_msg("abandon party: " + obj_name(self_obj));
+            debug_msg("abandon party: " + self_name);
             party_remove(self_obj);
         end
         if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
             debug_msg("start: set_dude_was_married");
-            if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-                debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-                set_global_var(449, global_var(6));
-                debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-                set_global_var(6, 0);
+            if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+                debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+                set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+                debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+                set_global_var(GVAR_PLAYER_MARRIED, 0);
             end
             debug_msg("finished: set_dude_was_married");
         end
-        if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-            critter_add_trait(self_obj, 1, 6, local_var(12));
+        if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+            critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
             set_local_var(12, -1);
         end
-        debug_msg("" + obj_name(self_obj) + " has abandoned the party");
+        debug_msg("" + self_name + " has abandoned the party");
         set_local_var(5, 2);
-        if (cur_map_index == 31) then begin
-            set_global_var(238, 1);
+        if (CUR_MAP_GECKSETL) then begin
+            set_global_var(GVAR_ENEMY_GECKO, 1);
         end
-        if (cur_map_index == 33) then begin
-            set_global_var(238, 1);
+        if (CUR_MAP_GECKJUNK) then begin
+            set_global_var(GVAR_ENEMY_GECKO, 1);
         end
-        if (cur_map_index == 32) then begin
-            set_global_var(238, 1);
+        if (CUR_MAP_GECKPWPL) then begin
+            set_global_var(GVAR_ENEMY_GECKO, 1);
         end
-        if (cur_map_index == 34) then begin
-            set_global_var(238, 1);
+        if (CUR_MAP_GECKTUNL) then begin
+            set_global_var(GVAR_ENEMY_GECKO, 1);
         end
     end
 end
 
 procedure map_enter_p_proc
 begin
-    if ((cur_map_index == 19) or (cur_map_index == 37) or (cur_map_index == 38)) then begin
-        if ((elevation(self_obj) != elevation(dude_obj)) and (local_var(10) != 0)) then begin
-            move_to(self_obj, tile_num(self_obj), elevation(dude_obj));
+    if ((CUR_MAP_MODINN) or (CUR_MAP_V15ENT) or (CUR_MAP_V15ENTB)) then begin
+        if ((elevation(self_obj) != dude_elevation) and (local_var(10) != 0)) then begin
+            move_to(self_obj, tile_num(self_obj), dude_elevation);
         end
     end
     if (party_member_obj(16777323) == 0) then begin
-        critter_add_trait(self_obj, 1, 6, 49);
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, 49);
     end
     else begin
         add_timer_event(self_obj, game_ticks(random(50, 150)), 10);
@@ -1526,8 +1526,8 @@ begin
     if (combat_is_initialized == 0) then begin
         if (anim_busy(self_obj) == 0) then begin
             if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-                if (metarule3(109, self_obj, 0, 0) == 1) then begin
-                    if ((100 * get_critter_stat(self_obj, 35) / get_critter_stat(self_obj, 7)) <= 60) then begin
+                if (chem_use_level(self_obj) == 1) then begin
+                    if ((100 * get_critter_stat(self_obj, STAT_current_hp) / get_critter_stat(self_obj, STAT_max_hp)) <= 60) then begin
                         global_temp := 1;
                         if (obj_is_carrying_obj_pid(self_obj, 144)) then begin
                             if ((global_temp == 0) and (combat_is_initialized == 0)) then begin
@@ -1539,7 +1539,7 @@ begin
                             end
                             PartyHealingItem := obj_carrying_pid_obj(self_obj, 144);
                             use_obj_on_obj(PartyHealingItem, self_obj);
-                            debug_msg(obj_name(self_obj) + " used super stimpak.");
+                            debug_msg(self_name + " used super stimpak.");
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 40)) then begin
@@ -1551,7 +1551,7 @@ begin
                                     gfade_in(600);
                                 end
                                 use_obj_on_obj(obj_carrying_pid_obj(self_obj, 40), self_obj);
-                                debug_msg(obj_name(self_obj) + " used stimpak.");
+                                debug_msg(self_name + " used stimpak.");
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 273)) then begin
@@ -1563,7 +1563,7 @@ begin
                                         gfade_in(600);
                                     end
                                     use_obj_on_obj(obj_carrying_pid_obj(self_obj, 273), self_obj);
-                                    debug_msg(obj_name(self_obj) + " used healing powder.");
+                                    debug_msg(self_name + " used healing powder.");
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 91)) then begin
@@ -1575,7 +1575,7 @@ begin
                                             gfade_in(600);
                                         end
                                         use_obj_on_obj(obj_carrying_pid_obj(self_obj, 91), self_obj);
-                                        debug_msg(obj_name(self_obj) + " used doctor's bag kit.");
+                                        debug_msg(self_name + " used doctor's bag kit.");
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 47)) then begin
@@ -1587,7 +1587,7 @@ begin
                                                 gfade_in(600);
                                             end
                                             use_obj_on_obj(obj_carrying_pid_obj(self_obj, 47), self_obj);
-                                            debug_msg(obj_name(self_obj) + " used First Aid kit.");
+                                            debug_msg(self_name + " used First Aid kit.");
                                         end
                                     end
                                 end
@@ -1596,8 +1596,8 @@ begin
                     end
                 end
                 else begin
-                    if (metarule3(109, self_obj, 0, 0) == 2) then begin
-                        if ((100 * get_critter_stat(self_obj, 35) / get_critter_stat(self_obj, 7)) <= 30) then begin
+                    if (chem_use_level(self_obj) == 2) then begin
+                        if ((100 * get_critter_stat(self_obj, STAT_current_hp) / get_critter_stat(self_obj, STAT_max_hp)) <= 30) then begin
                             global_temp := 1;
                             if (obj_is_carrying_obj_pid(self_obj, 144)) then begin
                                 if ((global_temp == 0) and (combat_is_initialized == 0)) then begin
@@ -1609,7 +1609,7 @@ begin
                                 end
                                 PartyHealingItem := obj_carrying_pid_obj(self_obj, 144);
                                 use_obj_on_obj(PartyHealingItem, self_obj);
-                                debug_msg(obj_name(self_obj) + " used super stimpak.");
+                                debug_msg(self_name + " used super stimpak.");
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 40)) then begin
@@ -1621,7 +1621,7 @@ begin
                                         gfade_in(600);
                                     end
                                     use_obj_on_obj(obj_carrying_pid_obj(self_obj, 40), self_obj);
-                                    debug_msg(obj_name(self_obj) + " used stimpak.");
+                                    debug_msg(self_name + " used stimpak.");
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 273)) then begin
@@ -1633,7 +1633,7 @@ begin
                                             gfade_in(600);
                                         end
                                         use_obj_on_obj(obj_carrying_pid_obj(self_obj, 273), self_obj);
-                                        debug_msg(obj_name(self_obj) + " used healing powder.");
+                                        debug_msg(self_name + " used healing powder.");
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 91)) then begin
@@ -1645,7 +1645,7 @@ begin
                                                 gfade_in(600);
                                             end
                                             use_obj_on_obj(obj_carrying_pid_obj(self_obj, 91), self_obj);
-                                            debug_msg(obj_name(self_obj) + " used doctor's bag kit.");
+                                            debug_msg(self_name + " used doctor's bag kit.");
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 47)) then begin
@@ -1657,7 +1657,7 @@ begin
                                                     gfade_in(600);
                                                 end
                                                 use_obj_on_obj(obj_carrying_pid_obj(self_obj, 47), self_obj);
-                                                debug_msg(obj_name(self_obj) + " used First Aid kit.");
+                                                debug_msg(self_name + " used First Aid kit.");
                                             end
                                         end
                                     end
@@ -1666,8 +1666,8 @@ begin
                         end
                     end
                     else begin
-                        if (metarule3(109, self_obj, 0, 0) == 3) then begin
-                            if ((100 * get_critter_stat(self_obj, 35) / get_critter_stat(self_obj, 7)) <= 50) then begin
+                        if (chem_use_level(self_obj) == 3) then begin
+                            if ((100 * get_critter_stat(self_obj, STAT_current_hp) / get_critter_stat(self_obj, STAT_max_hp)) <= 50) then begin
                                 global_temp := 1;
                                 if (obj_is_carrying_obj_pid(self_obj, 144)) then begin
                                     if ((global_temp == 0) and (combat_is_initialized == 0)) then begin
@@ -1679,7 +1679,7 @@ begin
                                     end
                                     PartyHealingItem := obj_carrying_pid_obj(self_obj, 144);
                                     use_obj_on_obj(PartyHealingItem, self_obj);
-                                    debug_msg(obj_name(self_obj) + " used super stimpak.");
+                                    debug_msg(self_name + " used super stimpak.");
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 40)) then begin
@@ -1691,7 +1691,7 @@ begin
                                             gfade_in(600);
                                         end
                                         use_obj_on_obj(obj_carrying_pid_obj(self_obj, 40), self_obj);
-                                        debug_msg(obj_name(self_obj) + " used stimpak.");
+                                        debug_msg(self_name + " used stimpak.");
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 273)) then begin
@@ -1703,7 +1703,7 @@ begin
                                                 gfade_in(600);
                                             end
                                             use_obj_on_obj(obj_carrying_pid_obj(self_obj, 273), self_obj);
-                                            debug_msg(obj_name(self_obj) + " used healing powder.");
+                                            debug_msg(self_name + " used healing powder.");
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 91)) then begin
@@ -1715,7 +1715,7 @@ begin
                                                     gfade_in(600);
                                                 end
                                                 use_obj_on_obj(obj_carrying_pid_obj(self_obj, 91), self_obj);
-                                                debug_msg(obj_name(self_obj) + " used doctor's bag kit.");
+                                                debug_msg(self_name + " used doctor's bag kit.");
                                             end
                                             else begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 47)) then begin
@@ -1727,7 +1727,7 @@ begin
                                                         gfade_in(600);
                                                     end
                                                     use_obj_on_obj(obj_carrying_pid_obj(self_obj, 47), self_obj);
-                                                    debug_msg(obj_name(self_obj) + " used First Aid kit.");
+                                                    debug_msg(self_name + " used First Aid kit.");
                                                 end
                                             end
                                         end
@@ -1736,8 +1736,8 @@ begin
                             end
                         end
                         else begin
-                            if (metarule3(109, self_obj, 0, 0) == 4) then begin
-                                if ((100 * get_critter_stat(self_obj, 35) / get_critter_stat(self_obj, 7)) <= 50) then begin
+                            if (chem_use_level(self_obj) == 4) then begin
+                                if ((100 * get_critter_stat(self_obj, STAT_current_hp) / get_critter_stat(self_obj, STAT_max_hp)) <= 50) then begin
                                     global_temp := 1;
                                     if (obj_is_carrying_obj_pid(self_obj, 144)) then begin
                                         if ((global_temp == 0) and (combat_is_initialized == 0)) then begin
@@ -1749,7 +1749,7 @@ begin
                                         end
                                         PartyHealingItem := obj_carrying_pid_obj(self_obj, 144);
                                         use_obj_on_obj(PartyHealingItem, self_obj);
-                                        debug_msg(obj_name(self_obj) + " used super stimpak.");
+                                        debug_msg(self_name + " used super stimpak.");
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 40)) then begin
@@ -1761,7 +1761,7 @@ begin
                                                 gfade_in(600);
                                             end
                                             use_obj_on_obj(obj_carrying_pid_obj(self_obj, 40), self_obj);
-                                            debug_msg(obj_name(self_obj) + " used stimpak.");
+                                            debug_msg(self_name + " used stimpak.");
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 273)) then begin
@@ -1773,7 +1773,7 @@ begin
                                                     gfade_in(600);
                                                 end
                                                 use_obj_on_obj(obj_carrying_pid_obj(self_obj, 273), self_obj);
-                                                debug_msg(obj_name(self_obj) + " used healing powder.");
+                                                debug_msg(self_name + " used healing powder.");
                                             end
                                             else begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 91)) then begin
@@ -1785,7 +1785,7 @@ begin
                                                         gfade_in(600);
                                                     end
                                                     use_obj_on_obj(obj_carrying_pid_obj(self_obj, 91), self_obj);
-                                                    debug_msg(obj_name(self_obj) + " used doctor's bag kit.");
+                                                    debug_msg(self_name + " used doctor's bag kit.");
                                                 end
                                                 else begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 47)) then begin
@@ -1797,7 +1797,7 @@ begin
                                                             gfade_in(600);
                                                         end
                                                         use_obj_on_obj(obj_carrying_pid_obj(self_obj, 47), self_obj);
-                                                        debug_msg(obj_name(self_obj) + " used First Aid kit.");
+                                                        debug_msg(self_name + " used First Aid kit.");
                                                     end
                                                 end
                                             end
@@ -1833,7 +1833,7 @@ end
 procedure HealPlayer
 begin
     Heal_Cost := 30;
-    critter_heal(dude_obj, get_critter_stat(dude_obj, 7) - get_critter_stat(dude_obj, 35));
+    critter_heal(dude_obj, get_critter_stat(dude_obj, STAT_max_hp) - get_critter_stat(dude_obj, STAT_current_hp));
     if ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32)) then begin
         Heal_Cost := 60;
         critter_injure(dude_obj, 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
@@ -1864,148 +1864,148 @@ procedure PartyFree
 begin
     k := 0;
     Heal_Cost := 30;
-    if ((get_critter_stat(dude_obj, 7) > get_critter_stat(dude_obj, 35)) or ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32))) then begin
+    if ((get_critter_stat(dude_obj, STAT_max_hp) > get_critter_stat(dude_obj, STAT_current_hp)) or ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32))) then begin
         k := k + 1;
-        critter_heal(dude_obj, get_critter_stat(dude_obj, 7) - get_critter_stat(dude_obj, 35));
+        critter_heal(dude_obj, get_critter_stat(dude_obj, STAT_max_hp) - get_critter_stat(dude_obj, STAT_current_hp));
         critter_injure(dude_obj, 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
     end
     if (party_member_obj(16777278) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777278), 35) < get_critter_stat(party_member_obj(16777278), 7)) or (critter_state(party_member_obj(16777278)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777278), STAT_current_hp) < get_critter_stat(party_member_obj(16777278), STAT_max_hp)) or (critter_state(party_member_obj(16777278)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777278), get_critter_stat(party_member_obj(16777278), 7) - get_critter_stat(party_member_obj(16777278), 35));
+            critter_heal(party_member_obj(16777278), get_critter_stat(party_member_obj(16777278), STAT_max_hp) - get_critter_stat(party_member_obj(16777278), STAT_current_hp));
             critter_injure(party_member_obj(16777278), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777376) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777376), 35) < get_critter_stat(party_member_obj(16777376), 7)) or (critter_state(party_member_obj(16777376)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777376), STAT_current_hp) < get_critter_stat(party_member_obj(16777376), STAT_max_hp)) or (critter_state(party_member_obj(16777376)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777376), get_critter_stat(party_member_obj(16777376), 7) - get_critter_stat(party_member_obj(16777376), 35));
+            critter_heal(party_member_obj(16777376), get_critter_stat(party_member_obj(16777376), STAT_max_hp) - get_critter_stat(party_member_obj(16777376), STAT_current_hp));
             critter_injure(party_member_obj(16777376), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777377) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777377), 35) < get_critter_stat(party_member_obj(16777377), 7)) or (critter_state(party_member_obj(16777377)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777377), STAT_current_hp) < get_critter_stat(party_member_obj(16777377), STAT_max_hp)) or (critter_state(party_member_obj(16777377)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777377), get_critter_stat(party_member_obj(16777377), 7) - get_critter_stat(party_member_obj(16777377), 35));
+            critter_heal(party_member_obj(16777377), get_critter_stat(party_member_obj(16777377), STAT_max_hp) - get_critter_stat(party_member_obj(16777377), STAT_current_hp));
             critter_injure(party_member_obj(16777377), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777305) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777305), 35) < get_critter_stat(party_member_obj(16777305), 7)) or (critter_state(party_member_obj(16777305)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777305), STAT_current_hp) < get_critter_stat(party_member_obj(16777305), STAT_max_hp)) or (critter_state(party_member_obj(16777305)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777305), get_critter_stat(party_member_obj(16777305), 7) - get_critter_stat(party_member_obj(16777305), 35));
+            critter_heal(party_member_obj(16777305), get_critter_stat(party_member_obj(16777305), STAT_max_hp) - get_critter_stat(party_member_obj(16777305), STAT_current_hp));
             critter_injure(party_member_obj(16777305), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777313) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777313), 35) < get_critter_stat(party_member_obj(16777313), 7)) or (critter_state(party_member_obj(16777313)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777313), STAT_current_hp) < get_critter_stat(party_member_obj(16777313), STAT_max_hp)) or (critter_state(party_member_obj(16777313)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777313), get_critter_stat(party_member_obj(16777313), 7) - get_critter_stat(party_member_obj(16777313), 35));
+            critter_heal(party_member_obj(16777313), get_critter_stat(party_member_obj(16777313), STAT_max_hp) - get_critter_stat(party_member_obj(16777313), STAT_current_hp));
             critter_injure(party_member_obj(16777313), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777323) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777323), 35) < get_critter_stat(party_member_obj(16777323), 7)) or (critter_state(party_member_obj(16777323)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777323), STAT_current_hp) < get_critter_stat(party_member_obj(16777323), STAT_max_hp)) or (critter_state(party_member_obj(16777323)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777323), get_critter_stat(party_member_obj(16777323), 7) - get_critter_stat(party_member_obj(16777323), 35));
+            critter_heal(party_member_obj(16777323), get_critter_stat(party_member_obj(16777323), STAT_max_hp) - get_critter_stat(party_member_obj(16777323), STAT_current_hp));
             critter_injure(party_member_obj(16777323), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777352) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777352), 35) < get_critter_stat(party_member_obj(16777352), 7)) or (critter_state(party_member_obj(16777352)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777352), STAT_current_hp) < get_critter_stat(party_member_obj(16777352), STAT_max_hp)) or (critter_state(party_member_obj(16777352)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777352), get_critter_stat(party_member_obj(16777352), 7) - get_critter_stat(party_member_obj(16777352), 35));
+            critter_heal(party_member_obj(16777352), get_critter_stat(party_member_obj(16777352), STAT_max_hp) - get_critter_stat(party_member_obj(16777352), STAT_current_hp));
             critter_injure(party_member_obj(16777352), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777378) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777378), 35) < get_critter_stat(party_member_obj(16777378), 7)) or (critter_state(party_member_obj(16777378)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777378), STAT_current_hp) < get_critter_stat(party_member_obj(16777378), STAT_max_hp)) or (critter_state(party_member_obj(16777378)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777378), get_critter_stat(party_member_obj(16777378), 7) - get_critter_stat(party_member_obj(16777378), 35));
+            critter_heal(party_member_obj(16777378), get_critter_stat(party_member_obj(16777378), STAT_max_hp) - get_critter_stat(party_member_obj(16777378), STAT_current_hp));
             critter_injure(party_member_obj(16777378), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777368) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777368), 35) < get_critter_stat(party_member_obj(16777368), 7)) or (critter_state(party_member_obj(16777368)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777368), STAT_current_hp) < get_critter_stat(party_member_obj(16777368), STAT_max_hp)) or (critter_state(party_member_obj(16777368)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777368), get_critter_stat(party_member_obj(16777368), 7) - get_critter_stat(party_member_obj(16777368), 35));
+            critter_heal(party_member_obj(16777368), get_critter_stat(party_member_obj(16777368), STAT_max_hp) - get_critter_stat(party_member_obj(16777368), STAT_current_hp));
             critter_injure(party_member_obj(16777368), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777379) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777379), 35) < get_critter_stat(party_member_obj(16777379), 7)) or (critter_state(party_member_obj(16777379)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777379), STAT_current_hp) < get_critter_stat(party_member_obj(16777379), STAT_max_hp)) or (critter_state(party_member_obj(16777379)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777379), get_critter_stat(party_member_obj(16777379), 7) - get_critter_stat(party_member_obj(16777379), 35));
+            critter_heal(party_member_obj(16777379), get_critter_stat(party_member_obj(16777379), STAT_max_hp) - get_critter_stat(party_member_obj(16777379), STAT_current_hp));
             critter_injure(party_member_obj(16777379), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777380) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777380), 35) < get_critter_stat(party_member_obj(16777380), 7)) or (critter_state(party_member_obj(16777380)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777380), STAT_current_hp) < get_critter_stat(party_member_obj(16777380), STAT_max_hp)) or (critter_state(party_member_obj(16777380)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777380), get_critter_stat(party_member_obj(16777380), 7) - get_critter_stat(party_member_obj(16777380), 35));
+            critter_heal(party_member_obj(16777380), get_critter_stat(party_member_obj(16777380), STAT_max_hp) - get_critter_stat(party_member_obj(16777380), STAT_current_hp));
             critter_injure(party_member_obj(16777380), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777295) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777295), 35) < get_critter_stat(party_member_obj(16777295), 7)) or (critter_state(party_member_obj(16777295)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777295), STAT_current_hp) < get_critter_stat(party_member_obj(16777295), STAT_max_hp)) or (critter_state(party_member_obj(16777295)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777295), get_critter_stat(party_member_obj(16777295), 7) - get_critter_stat(party_member_obj(16777295), 35));
+            critter_heal(party_member_obj(16777295), get_critter_stat(party_member_obj(16777295), STAT_max_hp) - get_critter_stat(party_member_obj(16777295), STAT_current_hp));
             critter_injure(party_member_obj(16777295), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777558) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777558), 35) < get_critter_stat(party_member_obj(16777558), 7)) or (critter_state(party_member_obj(16777558)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777558), STAT_current_hp) < get_critter_stat(party_member_obj(16777558), STAT_max_hp)) or (critter_state(party_member_obj(16777558)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777558), get_critter_stat(party_member_obj(16777558), 7) - get_critter_stat(party_member_obj(16777558), 35));
+            critter_heal(party_member_obj(16777558), get_critter_stat(party_member_obj(16777558), STAT_max_hp) - get_critter_stat(party_member_obj(16777558), STAT_current_hp));
             critter_injure(party_member_obj(16777558), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777687) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777687), 35) < get_critter_stat(party_member_obj(16777687), 7)) or (critter_state(party_member_obj(16777687)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777687), STAT_current_hp) < get_critter_stat(party_member_obj(16777687), STAT_max_hp)) or (critter_state(party_member_obj(16777687)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777687), get_critter_stat(party_member_obj(16777687), 7) - get_critter_stat(party_member_obj(16777687), 35));
+            critter_heal(party_member_obj(16777687), get_critter_stat(party_member_obj(16777687), STAT_max_hp) - get_critter_stat(party_member_obj(16777687), STAT_current_hp));
             critter_injure(party_member_obj(16777687), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777859) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777859), 35) < get_critter_stat(party_member_obj(16777859), 7)) or (critter_state(party_member_obj(16777859)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777859), STAT_current_hp) < get_critter_stat(party_member_obj(16777859), STAT_max_hp)) or (critter_state(party_member_obj(16777859)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777859), get_critter_stat(party_member_obj(16777859), 7) - get_critter_stat(party_member_obj(16777859), 35));
+            critter_heal(party_member_obj(16777859), get_critter_stat(party_member_obj(16777859), STAT_max_hp) - get_critter_stat(party_member_obj(16777859), STAT_current_hp));
             critter_injure(party_member_obj(16777859), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777801) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777801), 35) < get_critter_stat(party_member_obj(16777801), 7)) or (critter_state(party_member_obj(16777801)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777801), STAT_current_hp) < get_critter_stat(party_member_obj(16777801), STAT_max_hp)) or (critter_state(party_member_obj(16777801)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777801), get_critter_stat(party_member_obj(16777801), 7) - get_critter_stat(party_member_obj(16777801), 35));
+            critter_heal(party_member_obj(16777801), get_critter_stat(party_member_obj(16777801), STAT_max_hp) - get_critter_stat(party_member_obj(16777801), STAT_current_hp));
             critter_injure(party_member_obj(16777801), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777872) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777872), 35) < get_critter_stat(party_member_obj(16777872), 7)) or (critter_state(party_member_obj(16777872)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777872), STAT_current_hp) < get_critter_stat(party_member_obj(16777872), STAT_max_hp)) or (critter_state(party_member_obj(16777872)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777872), get_critter_stat(party_member_obj(16777872), 7) - get_critter_stat(party_member_obj(16777872), 35));
+            critter_heal(party_member_obj(16777872), get_critter_stat(party_member_obj(16777872), STAT_max_hp) - get_critter_stat(party_member_obj(16777872), STAT_current_hp));
             critter_injure(party_member_obj(16777872), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777875) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777875), 35) < get_critter_stat(party_member_obj(16777875), 7)) or (critter_state(party_member_obj(16777875)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777875), STAT_current_hp) < get_critter_stat(party_member_obj(16777875), STAT_max_hp)) or (critter_state(party_member_obj(16777875)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777875), get_critter_stat(party_member_obj(16777875), 7) - get_critter_stat(party_member_obj(16777875), 35));
+            critter_heal(party_member_obj(16777875), get_critter_stat(party_member_obj(16777875), STAT_max_hp) - get_critter_stat(party_member_obj(16777875), STAT_current_hp));
             critter_injure(party_member_obj(16777875), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777876) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777876), 35) < get_critter_stat(party_member_obj(16777876), 7)) or (critter_state(party_member_obj(16777876)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777876), STAT_current_hp) < get_critter_stat(party_member_obj(16777876), STAT_max_hp)) or (critter_state(party_member_obj(16777876)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777876), get_critter_stat(party_member_obj(16777876), 7) - get_critter_stat(party_member_obj(16777876), 35));
+            critter_heal(party_member_obj(16777876), get_critter_stat(party_member_obj(16777876), STAT_max_hp) - get_critter_stat(party_member_obj(16777876), STAT_current_hp));
             critter_injure(party_member_obj(16777876), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
     if (party_member_obj(16777874) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777874), 35) < get_critter_stat(party_member_obj(16777874), 7)) or (critter_state(party_member_obj(16777874)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777874), STAT_current_hp) < get_critter_stat(party_member_obj(16777874), STAT_max_hp)) or (critter_state(party_member_obj(16777874)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
-            critter_heal(party_member_obj(16777874), get_critter_stat(party_member_obj(16777874), 7) - get_critter_stat(party_member_obj(16777874), 35));
+            critter_heal(party_member_obj(16777874), get_critter_stat(party_member_obj(16777874), STAT_max_hp) - get_critter_stat(party_member_obj(16777874), STAT_current_hp));
             critter_injure(party_member_obj(16777874), 4 bwor 8 bwor 16 bwor 32 bwor 8388608);
         end
     end
@@ -2021,102 +2021,102 @@ procedure HowMany
 begin
     k := 0;
     if (party_member_obj(16777278) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777278), 35) < get_critter_stat(party_member_obj(16777278), 7)) or (critter_state(party_member_obj(16777278)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777278), STAT_current_hp) < get_critter_stat(party_member_obj(16777278), STAT_max_hp)) or (critter_state(party_member_obj(16777278)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777376) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777376), 35) < get_critter_stat(party_member_obj(16777376), 7)) or (critter_state(party_member_obj(16777376)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777376), STAT_current_hp) < get_critter_stat(party_member_obj(16777376), STAT_max_hp)) or (critter_state(party_member_obj(16777376)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777377) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777377), 35) < get_critter_stat(party_member_obj(16777377), 7)) or (critter_state(party_member_obj(16777377)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777377), STAT_current_hp) < get_critter_stat(party_member_obj(16777377), STAT_max_hp)) or (critter_state(party_member_obj(16777377)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777305) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777305), 35) < get_critter_stat(party_member_obj(16777305), 7)) or (critter_state(party_member_obj(16777305)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777305), STAT_current_hp) < get_critter_stat(party_member_obj(16777305), STAT_max_hp)) or (critter_state(party_member_obj(16777305)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777313) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777313), 35) < get_critter_stat(party_member_obj(16777313), 7)) or (critter_state(party_member_obj(16777313)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777313), STAT_current_hp) < get_critter_stat(party_member_obj(16777313), STAT_max_hp)) or (critter_state(party_member_obj(16777313)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777323) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777323), 35) < get_critter_stat(party_member_obj(16777323), 7)) or (critter_state(party_member_obj(16777323)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777323), STAT_current_hp) < get_critter_stat(party_member_obj(16777323), STAT_max_hp)) or (critter_state(party_member_obj(16777323)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777352) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777352), 35) < get_critter_stat(party_member_obj(16777352), 7)) or (critter_state(party_member_obj(16777352)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777352), STAT_current_hp) < get_critter_stat(party_member_obj(16777352), STAT_max_hp)) or (critter_state(party_member_obj(16777352)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777378) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777378), 35) < get_critter_stat(party_member_obj(16777378), 7)) or (critter_state(party_member_obj(16777378)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777378), STAT_current_hp) < get_critter_stat(party_member_obj(16777378), STAT_max_hp)) or (critter_state(party_member_obj(16777378)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777368) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777368), 35) < get_critter_stat(party_member_obj(16777368), 7)) or (critter_state(party_member_obj(16777368)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777368), STAT_current_hp) < get_critter_stat(party_member_obj(16777368), STAT_max_hp)) or (critter_state(party_member_obj(16777368)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777379) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777379), 35) < get_critter_stat(party_member_obj(16777379), 7)) or (critter_state(party_member_obj(16777379)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777379), STAT_current_hp) < get_critter_stat(party_member_obj(16777379), STAT_max_hp)) or (critter_state(party_member_obj(16777379)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777380) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777380), 35) < get_critter_stat(party_member_obj(16777380), 7)) or (critter_state(party_member_obj(16777380)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777380), STAT_current_hp) < get_critter_stat(party_member_obj(16777380), STAT_max_hp)) or (critter_state(party_member_obj(16777380)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777295) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777295), 35) < get_critter_stat(party_member_obj(16777295), 7)) or (critter_state(party_member_obj(16777295)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777295), STAT_current_hp) < get_critter_stat(party_member_obj(16777295), STAT_max_hp)) or (critter_state(party_member_obj(16777295)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777558) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777558), 35) < get_critter_stat(party_member_obj(16777558), 7)) or (critter_state(party_member_obj(16777558)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777558), STAT_current_hp) < get_critter_stat(party_member_obj(16777558), STAT_max_hp)) or (critter_state(party_member_obj(16777558)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777687) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777687), 35) < get_critter_stat(party_member_obj(16777687), 7)) or (critter_state(party_member_obj(16777687)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777687), STAT_current_hp) < get_critter_stat(party_member_obj(16777687), STAT_max_hp)) or (critter_state(party_member_obj(16777687)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777875) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777875), 35) < get_critter_stat(party_member_obj(16777875), 7)) or (critter_state(party_member_obj(16777875)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777875), STAT_current_hp) < get_critter_stat(party_member_obj(16777875), STAT_max_hp)) or (critter_state(party_member_obj(16777875)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777876) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777876), 35) < get_critter_stat(party_member_obj(16777876), 7)) or (critter_state(party_member_obj(16777876)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777876), STAT_current_hp) < get_critter_stat(party_member_obj(16777876), STAT_max_hp)) or (critter_state(party_member_obj(16777876)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777874) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777874), 35) < get_critter_stat(party_member_obj(16777874), 7)) or (critter_state(party_member_obj(16777874)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
+        if ((get_critter_stat(party_member_obj(16777874), STAT_current_hp) < get_critter_stat(party_member_obj(16777874), STAT_max_hp)) or (critter_state(party_member_obj(16777874)) bwand (4 bwor 8 bwor 16 bwor 32))) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777801) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777801), 35) < get_critter_stat(party_member_obj(16777801), 7)) or (critter_state(party_member_obj(16777801)) bwand 60)) then begin
+        if ((get_critter_stat(party_member_obj(16777801), STAT_current_hp) < get_critter_stat(party_member_obj(16777801), STAT_max_hp)) or (critter_state(party_member_obj(16777801)) bwand 60)) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777872) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777872), 35) < get_critter_stat(party_member_obj(16777872), 7)) or (critter_state(party_member_obj(16777872)) bwand 60)) then begin
+        if ((get_critter_stat(party_member_obj(16777872), STAT_current_hp) < get_critter_stat(party_member_obj(16777872), STAT_max_hp)) or (critter_state(party_member_obj(16777872)) bwand 60)) then begin
             k := k + 1;
         end
     end
     if (party_member_obj(16777859) != 0) then begin
-        if ((get_critter_stat(party_member_obj(16777859), 35) < get_critter_stat(party_member_obj(16777859), 7)) or (critter_state(party_member_obj(16777859)) bwand 60)) then begin
+        if ((get_critter_stat(party_member_obj(16777859), STAT_current_hp) < get_critter_stat(party_member_obj(16777859), STAT_max_hp)) or (critter_state(party_member_obj(16777859)) bwand 60)) then begin
             k := k + 1;
         end
     end
@@ -2125,19 +2125,19 @@ end
 procedure timed_event_p_proc
 begin
     if (fixed_param == 900) then begin
-        metarule3(100, self_obj, 900, 0);
-        if (has_trait(1, self_obj, 666)) then begin
+        rm_fixed_timer_event(self_obj, 900);
+        if (obj_is_visible_flag(self_obj)) then begin
             if ((party_member_obj(16777323) != 0) or (party_member_obj(16777801) != 0)) then begin
                 if (critter_state(self_obj) bwand (4 bwor 8 bwor 16 bwor 32)) then begin
-                    float_msg(self_obj, message_str(139, 5000), 2);
+                    float_msg(self_obj, mstr(5000), FLOAT_MSG_RED);
                 end
                 else begin
-                    if (get_critter_stat(self_obj, 37)) then begin
-                        float_msg(self_obj, message_str(139, 5001), 2);
+                    if (get_critter_stat(self_obj, STAT_current_rad)) then begin
+                        float_msg(self_obj, mstr(5001), FLOAT_MSG_RED);
                     end
                     else begin
                         if (get_poison(self_obj)) then begin
-                            float_msg(self_obj, message_str(139, 5002), 2);
+                            float_msg(self_obj, mstr(5002), FLOAT_MSG_RED);
                         end
                     end
                 end
@@ -2146,9 +2146,9 @@ begin
     end
     else begin
         if (fixed_param == 10) then begin
-            metarule3(100, self_obj, 10, 0);
-            if ((global_var(398) and combat_is_initialized) == 0) then begin
-                float_msg(self_obj, message_str(139, random(6200, 6224)), 8);
+            rm_fixed_timer_event(self_obj, 10);
+            if ((global_var(GVAR_PARTY_NO_FOLLOW) and combat_is_initialized) == 0) then begin
+                float_msg(self_obj, mstr(random(6200, 6224)), FLOAT_MSG_YELLOW);
             end
             add_timer_event(self_obj, game_ticks(random(50, 150)), 10);
         end
@@ -2161,7 +2161,7 @@ end
 
 procedure Node910
 begin
-    if (global_var(83) == 9) then begin
+    if (global_var(GVAR_VAULT_PLANT_STATUS) == 9) then begin
         call Node008();
     end
     else begin
@@ -2252,7 +2252,7 @@ end
 
 procedure Node951
 begin
-    if (has_trait(0, dude_obj, 39) or ((global_var(0) > 0) and (local_var(0) > 30))) then begin
+    if (has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality) or ((global_var(GVAR_PLAYER_REPUTATION) > 0) and (local_var(0) > 30))) then begin
         call Node021();
     end
     else begin
@@ -2263,24 +2263,24 @@ end
 procedure Node953
 begin
     if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-        debug_msg("abandon party: " + obj_name(self_obj));
+        debug_msg("abandon party: " + self_name);
         party_remove(self_obj);
     end
     if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
         debug_msg("start: set_dude_was_married");
-        if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-            set_global_var(449, global_var(6));
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-            set_global_var(6, 0);
+        if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_MARRIED, 0);
         end
         debug_msg("finished: set_dude_was_married");
     end
-    if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-        critter_add_trait(self_obj, 1, 6, local_var(12));
+    if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
         set_local_var(12, -1);
     end
-    debug_msg("" + obj_name(self_obj) + " has abandoned the party");
+    debug_msg("" + self_name + " has abandoned the party");
 end
 
 procedure Node954
@@ -2317,7 +2317,7 @@ end
 
 procedure Node995
 begin
-    if (get_critter_stat(dude_obj, 3) >= 7) then begin
+    if (dude_charisma >= 7) then begin
         set_local_var(3, 100);
         set_local_var(1, 4);
     end
@@ -2335,7 +2335,7 @@ end
 
 procedure Node997
 begin
-    if (get_critter_stat(dude_obj, 3) >= 8) then begin
+    if (dude_charisma >= 8) then begin
         call Node004();
     end
     else begin
@@ -2405,70 +2405,70 @@ begin
     if (local_var(4) == 0) then begin
         set_local_var(4, 1);
         if (local_var(9) == 0) then begin
-            gsay_reply(139, 110);
+            Reply(110);
         end
         else begin
-            gsay_reply(139, 112);
+            Reply(112);
         end
     end
     else begin
         if (local_var(9) == 0) then begin
-            gsay_reply(139, 113);
+            Reply(113);
         end
         else begin
-            gsay_reply(139, 111);
+            Reply(111);
         end
     end
-    giq_option(-3, 139, 114, Node002, 50);
-    giq_option(4, 139, 115, Node005, 50);
+    giq_option(-3, NAME, 114, Node002, NEUTRAL_REACTION);
+    giq_option(4, NAME, 115, Node005, NEUTRAL_REACTION);
     if (local_var(18)) then begin
-        giq_option(4, 139, 122, Node02a, 50);
+        giq_option(4, NAME, 122, Node02a, NEUTRAL_REACTION);
     end
-    if (global_var(233) < 0) then begin
-        giq_option(4, 139, 119, Node004, 50);
+    if (global_var(GVAR_VAULT13_FOUND_GECK) < 0) then begin
+        giq_option(4, NAME, 119, Node004, NEUTRAL_REACTION);
     end
     if (local_var(9) > 0) then begin
-        giq_option(4, 139, 120, Node008, 50);
+        giq_option(4, NAME, 120, Node008, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 121, Node999, 50);
+    giq_option(4, NAME, 121, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node002
 begin
-    gsay_reply(139, 130);
-    giq_option(1, 139, 131, Node999, 50);
+    Reply(130);
+    giq_option(1, NAME, 131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node02a
 begin
     call HowMany();
-    gsay_reply(139, 125);
-    if ((get_critter_stat(dude_obj, 35) < get_critter_stat(dude_obj, 7)) or ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32))) then begin
-        giq_option(4, 139, 116, Node006, 50);
+    Reply(125);
+    if ((get_critter_stat(dude_obj, STAT_current_hp) < get_critter_stat(dude_obj, STAT_max_hp)) or ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32))) then begin
+        giq_option(4, NAME, 116, Node006, NEUTRAL_REACTION);
     end
     if (k > 0) then begin
-        giq_option(4, 139, 117, Node007, 50);
+        giq_option(4, NAME, 117, Node007, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 126, Node999, 50);
+    giq_option(4, NAME, 126, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node003
 begin
-    float_msg(self_obj, message_str(139, random(140, 142)), 2);
+    float_msg(self_obj, mstr(random(140, 142)), FLOAT_MSG_RED);
 end
 
 procedure Node004
 begin
     call HowMany();
-    gsay_reply(139, 150);
-    if ((get_critter_stat(dude_obj, 35) < get_critter_stat(dude_obj, 7)) or ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32))) then begin
-        giq_option(4, 139, 151, Node006, 50);
+    Reply(150);
+    if ((get_critter_stat(dude_obj, STAT_current_hp) < get_critter_stat(dude_obj, STAT_max_hp)) or ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32))) then begin
+        giq_option(4, NAME, 151, Node006, NEUTRAL_REACTION);
     end
     if (k > 0) then begin
-        giq_option(4, 139, 152, Node007, 50);
+        giq_option(4, NAME, 152, Node007, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 153, Node04a, 50);
-    giq_option(4, 139, 154, Node999, 50);
+    giq_option(4, NAME, 153, Node04a, NEUTRAL_REACTION);
+    giq_option(4, NAME, 154, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node04a
@@ -2483,32 +2483,32 @@ begin
         set_local_var(18, 1);
     end
     call HowMany();
-    gsay_reply(139, 160);
-    giq_option(4, 139, 161, Node023, 50);
-    giq_option(4, 139, 162, Node001, 50);
-    giq_option(4, 139, 163, Node009, 50);
-    if ((get_critter_stat(dude_obj, 35) < get_critter_stat(dude_obj, 7)) or ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32))) then begin
-        giq_option(4, 139, 164, Node006, 50);
+    Reply(160);
+    giq_option(4, NAME, 161, Node023, NEUTRAL_REACTION);
+    giq_option(4, NAME, 162, Node001, NEUTRAL_REACTION);
+    giq_option(4, NAME, 163, Node009, NEUTRAL_REACTION);
+    if ((get_critter_stat(dude_obj, STAT_current_hp) < get_critter_stat(dude_obj, STAT_max_hp)) or ((critter_state(dude_obj) bwand 4) or (critter_state(dude_obj) bwand 8) or (critter_state(dude_obj) bwand 16) or (critter_state(dude_obj) bwand 32))) then begin
+        giq_option(4, NAME, 164, Node006, NEUTRAL_REACTION);
     end
     if (k > 0) then begin
-        giq_option(4, 139, 165, Node007, 50);
+        giq_option(4, NAME, 165, Node007, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 166, Node999, 50);
+    giq_option(4, NAME, 166, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node006
 begin
     from6 := 1;
     if (local_var(9) == 0) then begin
-        gsay_reply(139, 174);
+        Reply(174);
     end
     else begin
-        gsay_reply(139, 170);
-        giq_option(4, 139, 171, Node015, 50);
+        Reply(170);
+        giq_option(4, NAME, 171, Node015, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 172, Node920, 50);
-    giq_option(4, 139, 173, Node922, 50);
-    giq_option(4, 139, 175, Node999, 50);
+    giq_option(4, NAME, 172, Node920, NEUTRAL_REACTION);
+    giq_option(4, NAME, 173, Node922, NEUTRAL_REACTION);
+    giq_option(4, NAME, 175, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node007
@@ -2516,44 +2516,44 @@ begin
     from6 := 0;
     call HowMany();
     if (k == 0) then begin
-        gsay_message(139, 187, 50);
+        gsay_message(NAME, 187, NEUTRAL_REACTION);
     end
     else begin
         if (local_var(9) == 0) then begin
             if (k < 2) then begin
-                gsay_reply(139, 185);
+                Reply(185);
             end
             else begin
-                gsay_reply(139, 186);
+                Reply(186);
             end
         end
         else begin
             if (k < 2) then begin
-                gsay_reply(139, 180);
+                Reply(180);
             end
             else begin
-                gsay_reply(139, 181);
+                Reply(181);
             end
-            giq_option(4, 139, 182, Node015, 50);
+            giq_option(4, NAME, 182, Node015, NEUTRAL_REACTION);
         end
-        giq_option(4, 139, 183, Node924, 50);
-        giq_option(4, 139, 184, Node926, 50);
-        giq_option(4, 139, 175, Node999, 50);
+        giq_option(4, NAME, 183, Node924, NEUTRAL_REACTION);
+        giq_option(4, NAME, 184, Node926, NEUTRAL_REACTION);
+        giq_option(4, NAME, 175, Node999, NEUTRAL_REACTION);
     end
 end
 
 procedure Node008
 begin
-    gsay_reply(139, 190);
-    giq_option(4, 139, 191, Node16a, 49);
-    giq_option(4, 139, 192, Node999, 50);
+    Reply(190);
+    giq_option(4, NAME, 191, Node16a, GOOD_REACTION);
+    giq_option(4, NAME, 192, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node009
 begin
-    gsay_reply(139, 200);
-    giq_option(4, 139, 201, Node10a, 49);
-    giq_option(4, 139, 202, Node999, 50);
+    Reply(200);
+    giq_option(4, NAME, 201, Node10a, GOOD_REACTION);
+    giq_option(4, NAME, 202, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node10a
@@ -2606,9 +2606,9 @@ end
 
 procedure Node010
 begin
-    gsay_reply(139, 210);
-    giq_option(4, 139, 211, Node11a, 50);
-    giq_option(4, 139, 212, Node999, 50);
+    Reply(210);
+    giq_option(4, NAME, 211, Node11a, NEUTRAL_REACTION);
+    giq_option(4, NAME, 212, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node11a
@@ -2661,9 +2661,9 @@ end
 
 procedure Node011
 begin
-    gsay_reply(139, 220);
-    giq_option(4, 139, 221, Node12a, 49);
-    giq_option(4, 139, 222, Node999, 50);
+    Reply(220);
+    giq_option(4, NAME, 221, Node12a, GOOD_REACTION);
+    giq_option(4, NAME, 222, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node12a
@@ -2716,9 +2716,9 @@ end
 
 procedure Node012
 begin
-    gsay_reply(139, 230);
-    giq_option(4, 139, 231, Node13a, 49);
-    giq_option(4, 139, 232, Node999, 50);
+    Reply(230);
+    giq_option(4, NAME, 231, Node13a, GOOD_REACTION);
+    giq_option(4, NAME, 232, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node13a
@@ -2771,9 +2771,9 @@ end
 
 procedure Node013
 begin
-    gsay_reply(139, 240);
-    giq_option(4, 139, 241, Node14a, 49);
-    giq_option(4, 139, 242, Node999, 50);
+    Reply(240);
+    giq_option(4, NAME, 241, Node14a, GOOD_REACTION);
+    giq_option(4, NAME, 242, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node14a
@@ -2826,19 +2826,19 @@ end
 
 procedure Node014
 begin
-    gsay_reply(139, 250);
-    giq_option(4, 139, 251, Node1a, 49);
-    giq_option(4, 139, 252, Node999, 50);
+    Reply(250);
+    giq_option(4, NAME, 251, Node1a, GOOD_REACTION);
+    giq_option(4, NAME, 252, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node015
 begin
-    gsay_reply(139, 260);
+    Reply(260);
     if (from6) then begin
-        giq_option(4, 139, 261, Node006, 50);
+        giq_option(4, NAME, 261, Node006, NEUTRAL_REACTION);
     end
     else begin
-        giq_option(4, 139, 261, Node007, 50);
+        giq_option(4, NAME, 261, Node007, NEUTRAL_REACTION);
     end
 end
 
@@ -2892,9 +2892,9 @@ end
 
 procedure Node016
 begin
-    gsay_reply(139, 270);
-    giq_option(4, 139, 271, Node17a, 50);
-    giq_option(4, 139, 272, Node999, 50);
+    Reply(270);
+    giq_option(4, NAME, 271, Node17a, NEUTRAL_REACTION);
+    giq_option(4, NAME, 272, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node17a
@@ -2947,10 +2947,10 @@ end
 
 procedure Node017
 begin
-    gsay_reply(139, 280);
-    giq_option(4, 139, 281, Node18a, 49);
-    giq_option(4, 139, 282, Node999, 51);
-    giq_option(4, 139, 283, Node999, 50);
+    Reply(280);
+    giq_option(4, NAME, 281, Node18a, GOOD_REACTION);
+    giq_option(4, NAME, 282, Node999, BAD_REACTION);
+    giq_option(4, NAME, 283, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node18a
@@ -3003,9 +3003,9 @@ end
 
 procedure Node018
 begin
-    gsay_reply(139, 290);
-    giq_option(4, 139, 291, Node019, 49);
-    giq_option(4, 139, 292, Node999, 50);
+    Reply(290);
+    giq_option(4, NAME, 291, Node019, GOOD_REACTION);
+    giq_option(4, NAME, 292, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node19a
@@ -3058,9 +3058,9 @@ end
 
 procedure Node019
 begin
-    gsay_reply(139, 300);
-    giq_option(4, 139, 301, Node20a, 49);
-    giq_option(4, 139, 302, Node999, 50);
+    Reply(300);
+    giq_option(4, NAME, 301, Node20a, GOOD_REACTION);
+    giq_option(4, NAME, 302, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node20a
@@ -3113,386 +3113,386 @@ end
 
 procedure Node020
 begin
-    gsay_reply(139, 310);
-    if (((((metarule(16, 0) - 1) >= (floor(get_critter_stat(dude_obj, 3) / 2) + has_trait(0, dude_obj, 98) + (20 * has_trait(0, dude_obj, 39)))) or ((metarule(16, 0) - 1) >= (5 + (20 * has_trait(0, dude_obj, 39))))) == 0) and ((party_member_obj(16777323) != 0) == 0)) then begin
-        giq_option(4, 139, 311, Node951, 49);
+    Reply(310);
+    if (((((party_member_count(0) - 1) >= (floor(dude_charisma / 2) + has_trait(TRAIT_PERK, dude_obj, PERK_magnetic_personality_perk) + (20 * has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality)))) or ((party_member_count(0) - 1) >= (5 + (20 * has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))))) == 0) and ((party_member_obj(16777323) != 0) == 0)) then begin
+        giq_option(4, NAME, 311, Node951, GOOD_REACTION);
     end
-    giq_option(4, 139, 312, Node001, 50);
-    giq_option(4, 139, 313, Node999, 51);
-    giq_option(4, 139, 314, Node999, 50);
+    giq_option(4, NAME, 312, Node001, NEUTRAL_REACTION);
+    giq_option(4, NAME, 313, Node999, BAD_REACTION);
+    giq_option(4, NAME, 314, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node021
 begin
-    if ((get_critter_stat(dude_obj, 3) <= 1) and (has_trait(0, dude_obj, 39) == 0)) then begin
-        gsay_message(139, 330, 50);
+    if ((dude_charisma <= 1) and (has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality) == 0)) then begin
+        gsay_message(NAME, 330, NEUTRAL_REACTION);
     end
     else begin
-        gsay_reply(139, 320);
-        giq_option(4, 139, 321, Node800, 49);
-        giq_option(4, 139, 322, Node001, 51);
+        Reply(320);
+        giq_option(4, NAME, 321, Node800, GOOD_REACTION);
+        giq_option(4, NAME, 322, Node001, BAD_REACTION);
     end
 end
 
 procedure Node022
 begin
-    gsay_reply(139, 330);
-    giq_option(4, 139, 333, Node999, 50);
-    giq_option(4, 139, 334, Node999, 51);
+    Reply(330);
+    giq_option(4, NAME, 333, Node999, NEUTRAL_REACTION);
+    giq_option(4, NAME, 334, Node999, BAD_REACTION);
 end
 
 procedure Node023
 begin
-    gsay_reply(139, 340);
-    giq_option(4, 139, 341, Node005, 50);
-    giq_option(4, 139, 342, Node999, 50);
+    Reply(340);
+    giq_option(4, NAME, 341, Node005, NEUTRAL_REACTION);
+    giq_option(4, NAME, 342, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node024
 begin
-    gsay_reply(139, 350);
-    giq_option(4, 139, 351, Node001, 50);
-    giq_option(4, 139, 352, Node999, 50);
+    Reply(350);
+    giq_option(4, NAME, 351, Node001, NEUTRAL_REACTION);
+    giq_option(4, NAME, 352, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node025
 begin
-    gsay_reply(139, 360);
-    giq_option(1, 139, 372, Node953, 50);
-    giq_option(1, 139, 373, Node953, 51);
-    giq_option(1, 139, 374, Node953, 51);
-    giq_option(1, 139, 375, Node953, 50);
+    Reply(360);
+    giq_option(1, NAME, 372, Node953, NEUTRAL_REACTION);
+    giq_option(1, NAME, 373, Node953, BAD_REACTION);
+    giq_option(1, NAME, 374, Node953, BAD_REACTION);
+    giq_option(1, NAME, 375, Node953, NEUTRAL_REACTION);
 end
 
 procedure Node070
 begin
-    if (has_trait(1, self_obj, 666)) then begin
-        float_msg(self_obj, message_str(139, 3000), 2);
+    if (obj_is_visible_flag(self_obj)) then begin
+        float_msg(self_obj, mstr(3000), FLOAT_MSG_RED);
     end
     if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-        debug_msg("abandon party: " + obj_name(self_obj));
+        debug_msg("abandon party: " + self_name);
         party_remove(self_obj);
     end
     if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
         debug_msg("start: set_dude_was_married");
-        if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-            set_global_var(449, global_var(6));
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-            set_global_var(6, 0);
+        if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_MARRIED, 0);
         end
         debug_msg("finished: set_dude_was_married");
     end
-    if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-        critter_add_trait(self_obj, 1, 6, local_var(12));
+    if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
         set_local_var(12, -1);
     end
-    debug_msg("" + obj_name(self_obj) + " has abandoned the party");
+    debug_msg("" + self_name + " has abandoned the party");
 end
 
 procedure Node071
 begin
     set_local_var(14, 1);
-    if (has_trait(1, self_obj, 666)) then begin
-        float_msg(self_obj, message_str(139, 370), 2);
+    if (obj_is_visible_flag(self_obj)) then begin
+        float_msg(self_obj, mstr(370), FLOAT_MSG_RED);
     end
     if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-        debug_msg("abandon party: " + obj_name(self_obj));
+        debug_msg("abandon party: " + self_name);
         party_remove(self_obj);
     end
     if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
         debug_msg("start: set_dude_was_married");
-        if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-            set_global_var(449, global_var(6));
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-            set_global_var(6, 0);
+        if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_MARRIED, 0);
         end
         debug_msg("finished: set_dude_was_married");
     end
-    if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-        critter_add_trait(self_obj, 1, 6, local_var(12));
+    if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
         set_local_var(12, -1);
     end
-    debug_msg("" + obj_name(self_obj) + " has abandoned the party");
-    critter_add_trait(self_obj, 1, 6, 49);
+    debug_msg("" + self_name + " has abandoned the party");
+    critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, 49);
 end
 
 procedure Node072
 begin
-    if (has_trait(1, self_obj, 666)) then begin
-        float_msg(self_obj, message_str(139, 3002), 2);
+    if (obj_is_visible_flag(self_obj)) then begin
+        float_msg(self_obj, mstr(3002), FLOAT_MSG_RED);
     end
     if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-        debug_msg("abandon party: " + obj_name(self_obj));
+        debug_msg("abandon party: " + self_name);
         party_remove(self_obj);
     end
     if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
         debug_msg("start: set_dude_was_married");
-        if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-            set_global_var(449, global_var(6));
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-            set_global_var(6, 0);
+        if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_MARRIED, 0);
         end
         debug_msg("finished: set_dude_was_married");
     end
-    if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-        critter_add_trait(self_obj, 1, 6, local_var(12));
+    if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
         set_local_var(12, -1);
     end
-    debug_msg("" + obj_name(self_obj) + " has abandoned the party");
+    debug_msg("" + self_name + " has abandoned the party");
 end
 
 procedure Node073
 begin
-    if (has_trait(1, self_obj, 666)) then begin
-        float_msg(self_obj, message_str(139, 370), 2);
+    if (obj_is_visible_flag(self_obj)) then begin
+        float_msg(self_obj, mstr(370), FLOAT_MSG_RED);
     end
     if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-        debug_msg("abandon party: " + obj_name(self_obj));
+        debug_msg("abandon party: " + self_name);
         party_remove(self_obj);
     end
     if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
         debug_msg("start: set_dude_was_married");
-        if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-            set_global_var(449, global_var(6));
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-            set_global_var(6, 0);
+        if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_MARRIED, 0);
         end
         debug_msg("finished: set_dude_was_married");
     end
-    if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-        critter_add_trait(self_obj, 1, 6, local_var(12));
+    if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
         set_local_var(12, -1);
     end
-    debug_msg("" + obj_name(self_obj) + " has abandoned the party");
+    debug_msg("" + self_name + " has abandoned the party");
 end
 
 procedure Node074
 begin
     set_local_var(14, 1);
     set_local_var(6, 1);
-    if (has_trait(1, self_obj, 666)) then begin
-        float_msg(self_obj, message_str(139, 370), 2);
+    if (obj_is_visible_flag(self_obj)) then begin
+        float_msg(self_obj, mstr(370), FLOAT_MSG_RED);
     end
     if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-        debug_msg("abandon party: " + obj_name(self_obj));
+        debug_msg("abandon party: " + self_name);
         party_remove(self_obj);
     end
     if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
         debug_msg("start: set_dude_was_married");
-        if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-            set_global_var(449, global_var(6));
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-            set_global_var(6, 0);
+        if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_MARRIED, 0);
         end
         debug_msg("finished: set_dude_was_married");
     end
-    if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-        critter_add_trait(self_obj, 1, 6, local_var(12));
+    if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
         set_local_var(12, -1);
     end
-    debug_msg("" + obj_name(self_obj) + " has abandoned the party");
-    critter_add_trait(self_obj, 1, 6, 49);
+    debug_msg("" + self_name + " has abandoned the party");
+    critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, 49);
 end
 
 procedure Node075
 begin
-    if (has_trait(1, self_obj, 666)) then begin
-        float_msg(self_obj, message_str(139, 371), 2);
+    if (obj_is_visible_flag(self_obj)) then begin
+        float_msg(self_obj, mstr(371), FLOAT_MSG_RED);
     end
     if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-        debug_msg("abandon party: " + obj_name(self_obj));
+        debug_msg("abandon party: " + self_name);
         party_remove(self_obj);
     end
     if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
         debug_msg("start: set_dude_was_married");
-        if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-            set_global_var(449, global_var(6));
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-            set_global_var(6, 0);
+        if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_MARRIED, 0);
         end
         debug_msg("finished: set_dude_was_married");
     end
-    if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-        critter_add_trait(self_obj, 1, 6, local_var(12));
+    if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
         set_local_var(12, -1);
     end
-    debug_msg("" + obj_name(self_obj) + " has abandoned the party");
+    debug_msg("" + self_name + " has abandoned the party");
     set_local_var(10, game_time);
 end
 
 procedure Node076
 begin
     set_local_var(14, 1);
-    if (has_trait(1, self_obj, 666)) then begin
-        float_msg(self_obj, message_str(139, 370), 2);
+    if (obj_is_visible_flag(self_obj)) then begin
+        float_msg(self_obj, mstr(370), FLOAT_MSG_RED);
     end
     if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-        debug_msg("abandon party: " + obj_name(self_obj));
+        debug_msg("abandon party: " + self_name);
         party_remove(self_obj);
     end
     if ((obj_pid(self_obj) == 16777380) or (obj_pid(self_obj) == 16777379)) then begin
         debug_msg("start: set_dude_was_married");
-        if ((global_var(6) != 0) and ((global_var(449) != 0) == 0)) then begin
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(449));
-            set_global_var(449, global_var(6));
-            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(449));
-            set_global_var(6, 0);
+        if ((global_var(GVAR_PLAYER_MARRIED) != 0) and ((global_var(GVAR_PLAYER_WAS_MARRIED) != 0) == 0)) then begin
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED before == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_WAS_MARRIED, global_var(GVAR_PLAYER_MARRIED));
+            debug_msg("   GVAR_PLAYER_WAS_MARRIED after == " + global_var(GVAR_PLAYER_WAS_MARRIED));
+            set_global_var(GVAR_PLAYER_MARRIED, 0);
         end
         debug_msg("finished: set_dude_was_married");
     end
-    if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-        critter_add_trait(self_obj, 1, 6, local_var(12));
+    if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
         set_local_var(12, -1);
     end
-    debug_msg("" + obj_name(self_obj) + " has abandoned the party");
-    critter_add_trait(self_obj, 1, 6, 49);
+    debug_msg("" + self_name + " has abandoned the party");
+    critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, 49);
 end
 
 procedure Node077
 begin
-    gsay_reply(139, 6010);
+    Reply(6010);
     if (party_member_obj(16777305) != 0) then begin
-        giq_option(4, 139, 6011, Node079, 50);
+        giq_option(4, NAME, 6011, Node079, NEUTRAL_REACTION);
     end
-    if ((global_var(174) bwand 8) != 0) then begin
-        giq_option(4, 139, 6012, Node078, 50);
+    if ((global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwand 8) != 0) then begin
+        giq_option(4, NAME, 6012, Node078, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 6013, Node079, 50);
+    giq_option(4, NAME, 6013, Node079, NEUTRAL_REACTION);
 end
 
 procedure Node078
 begin
-    gsay_reply(139, 6020);
-    giq_option(4, 139, message_str(14, 352), Node079, 50);
+    Reply(6020);
+    giq_option(4, NAME, g_mstr(352), Node079, NEUTRAL_REACTION);
 end
 
 procedure Node079
 begin
-    gsay_reply(139, 6021);
-    giq_option(4, 139, 6022, Node081, 50);
-    if (has_skill(dude_obj, 7) >= 40) then begin
-        giq_option(4, 139, 6023, Node081, 50);
+    Reply(6021);
+    giq_option(4, NAME, 6022, Node081, NEUTRAL_REACTION);
+    if (dude_skill(SKILL_DOCTOR) >= 40) then begin
+        giq_option(4, NAME, 6023, Node081, NEUTRAL_REACTION);
     end
 end
 
 procedure Node080
 begin
-    gsay_reply(139, 6030);
-    giq_option(4, 139, message_str(14, 352), Node081, 50);
+    Reply(6030);
+    giq_option(4, NAME, g_mstr(352), Node081, NEUTRAL_REACTION);
 end
 
 procedure Node081
 begin
     set_local_var(19, 1);
-    gsay_reply(139, 6040);
-    giq_option(4, 139, 6041, Node1000, 50);
-    if ((global_var(174) bwand 8) != 0) then begin
-        giq_option(4, 139, 6042, Node083, 50);
+    Reply(6040);
+    giq_option(4, NAME, 6041, Node1000, NEUTRAL_REACTION);
+    if ((global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwand 8) != 0) then begin
+        giq_option(4, NAME, 6042, Node083, NEUTRAL_REACTION);
     end
     if (party_member_obj(16777305) != 0) then begin
-        giq_option(4, 139, 6043, Node082, 50);
+        giq_option(4, NAME, 6043, Node082, NEUTRAL_REACTION);
     end
 end
 
 procedure Node082
 begin
-    gsay_reply(139, 6050);
-    giq_option(4, 139, 6051, Node083, 50);
-    giq_option(4, 139, 6052, Node083, 50);
+    Reply(6050);
+    giq_option(4, NAME, 6051, Node083, NEUTRAL_REACTION);
+    giq_option(4, NAME, 6052, Node083, NEUTRAL_REACTION);
 end
 
 procedure Node083
 begin
-    gsay_reply(139, 6060);
-    giq_option(4, 139, 6061, Node084, 50);
+    Reply(6060);
+    giq_option(4, NAME, 6061, Node084, NEUTRAL_REACTION);
 end
 
 procedure Node084
 begin
-    gsay_reply(139, 6070);
-    giq_option(4, 139, 6071, Node085, 50);
-    giq_option(4, 139, 6072, Node086, 50);
+    Reply(6070);
+    giq_option(4, NAME, 6071, Node085, NEUTRAL_REACTION);
+    giq_option(4, NAME, 6072, Node086, NEUTRAL_REACTION);
 end
 
 procedure Node085
 begin
-    gsay_reply(139, 6080 + (get_critter_stat(dude_obj, 34) == 1));
-    giq_option(4, 139, message_str(14, 352), Node086, 50);
+    Reply(6080 + (dude_gender == 1));
+    giq_option(4, NAME, g_mstr(352), Node086, NEUTRAL_REACTION);
 end
 
 procedure Node086
 begin
-    set_global_var(174, global_var(174) bwor 256);
-    gsay_reply(139, 6082);
-    giq_option(4, 139, 6083, Node087, 50);
-    giq_option(4, 139, 6084, Node999, 50);
+    set_global_var(GVAR_NEWRENO_SNUFF_WESTIN, global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwor 256);
+    Reply(6082);
+    giq_option(4, NAME, 6083, Node087, NEUTRAL_REACTION);
+    giq_option(4, NAME, 6084, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node087
 begin
-    gsay_reply(139, 6090);
-    giq_option(4, 139, 6091, Node1000, 50);
-    giq_option(4, 139, 6092, Node999, 50);
+    Reply(6090);
+    giq_option(4, NAME, 6091, Node1000, NEUTRAL_REACTION);
+    giq_option(4, NAME, 6092, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node800
 begin
     if (local_var(13) == 0) then begin
         set_local_var(13, 1);
-        set_global_var(0, global_var(0) + 5);
+        set_global_var(GVAR_PLAYER_REPUTATION, global_var(GVAR_PLAYER_REPUTATION) + 5);
         debug_msg("Player gains " + 5 + " Karma Points.");
-        set_global_var(37, 0);
-        set_global_var(38, 0);
-        set_global_var(39, 0);
-        set_global_var(40, 0);
-        set_global_var(41, 0);
-        set_global_var(42, 0);
-        set_global_var(43, 0);
-        set_global_var(44, 0);
-        set_global_var(45, 0);
-        tmp_gen_rep := global_var(0);
-        if (has_trait(0, dude_obj, 95)) then begin
-            tmp_gen_rep := global_var(0) * 2;
+        set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
+        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
+        set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
+        set_global_var(GVAR_KARMA_DEFENDER, 0);
+        set_global_var(GVAR_KARMA_WANDERER, 0);
+        set_global_var(GVAR_KARMA_BETRAYER, 0);
+        set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
+        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
+        set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
+        tmp_gen_rep := global_var(GVAR_PLAYER_REPUTATION);
+        if (has_trait(TRAIT_PERK, dude_obj, PERK_karma_beacon_perk)) then begin
+            tmp_gen_rep := global_var(GVAR_PLAYER_REPUTATION) * 2;
         end
         if (tmp_gen_rep >= 1000) then begin
-            set_global_var(37, 1);
+            set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
         end
         else begin
             if (tmp_gen_rep >= 750) then begin
-                set_global_var(38, 1);
+                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
             end
             else begin
                 if (tmp_gen_rep >= 500) then begin
-                    set_global_var(39, 1);
+                    set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                 end
                 else begin
                     if (tmp_gen_rep >= 250) then begin
-                        set_global_var(40, 1);
+                        set_global_var(GVAR_KARMA_DEFENDER, 1);
                     end
                     else begin
                         if (tmp_gen_rep > -250) then begin
-                            set_global_var(41, 1);
+                            set_global_var(GVAR_KARMA_WANDERER, 1);
                         end
                         else begin
                             if (tmp_gen_rep > -500) then begin
-                                set_global_var(42, 1);
+                                set_global_var(GVAR_KARMA_BETRAYER, 1);
                             end
                             else begin
                                 if (tmp_gen_rep > -750) then begin
-                                    set_global_var(43, 1);
+                                    set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                 end
                                 else begin
                                     if (tmp_gen_rep > -1000) then begin
-                                        set_global_var(44, 1);
+                                        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                     end
                                     else begin
-                                        set_global_var(45, 1);
+                                        set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                     end
                                 end
                             end
@@ -3501,17 +3501,17 @@ begin
                 end
             end
         end
-        set_global_var(51, global_var(51) + 10);
+        set_global_var(GVAR_TOWN_REP_GECKO, global_var(GVAR_TOWN_REP_GECKO) + 10);
     end
     if ((critter_state(self_obj) bwand 1) == 0) then begin
         if (local_var(11) == 0) then begin
             set_local_var(11, 6);
         end
         set_local_var(10, 0);
-        if (has_trait(1, self_obj, 6) != 0) then begin
-            set_local_var(12, has_trait(1, self_obj, 6));
+        if (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) != 0) then begin
+            set_local_var(12, has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM));
         end
-        critter_add_trait(self_obj, 1, 6, 0);
+        critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
         party_add(self_obj);
     end
     call Node1000();
@@ -3519,39 +3519,39 @@ end
 
 procedure Node1000
 begin
-    gsay_reply(139, 1000);
+    Reply(1000);
     if (local_var(10) == 0) then begin
         if (local_var(11) == 0) then begin
             set_local_var(11, 6);
         end
-        if (get_critter_stat(self_obj, 35) < get_critter_stat(self_obj, 7)) then begin
-            giq_option(4, 139, 384, Node1001, 50);
+        if (get_critter_stat(self_obj, STAT_current_hp) < get_critter_stat(self_obj, STAT_max_hp)) then begin
+            giq_option(4, NAME, 384, Node1001, NEUTRAL_REACTION);
         end
-        giq_option(4, 139, 382, Node1008, 50);
-        giq_option(4, 139, 383, Node1002, 50);
+        giq_option(4, NAME, 382, Node1008, NEUTRAL_REACTION);
+        giq_option(4, NAME, 383, Node1002, NEUTRAL_REACTION);
         if (local_var(11) == 3) then begin
-            giq_option(4, 139, 381, Node1007, 50);
+            giq_option(4, NAME, 381, Node1007, NEUTRAL_REACTION);
         end
         else begin
-            giq_option(4, 139, 6125, Node1007, 50);
+            giq_option(4, NAME, 6125, Node1007, NEUTRAL_REACTION);
         end
-        if (((global_var(174) bwand 8) != 0) or (party_member_obj(16777305) != 0) and (local_var(19) == 0)) then begin
-            giq_option(4, 139, 6000, Node077, 50);
+        if (((global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwand 8) != 0) or (party_member_obj(16777305) != 0) and (local_var(19) == 0)) then begin
+            giq_option(4, NAME, 6000, Node077, NEUTRAL_REACTION);
         end
-        if (obj_is_carrying_obj_pid(dude_obj, 333) and not((global_var(174) bwand 256) != 0)) then begin
-            giq_option(4, 139, 6001, Node081, 50);
+        if (obj_is_carrying_obj_pid(dude_obj, 333) and not((global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwand 256) != 0)) then begin
+            giq_option(4, NAME, 6001, Node081, NEUTRAL_REACTION);
         end
     end
     else begin
-        giq_option(4, 139, 388, Node1100, 50);
+        giq_option(4, NAME, 388, Node1100, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 389, Node999, 50);
-    giq_option(-3, 139, message_str(14, random(300, 303)), Node999, 50);
-    if ((global_var(1072) == 1) or (global_var(1072) == 2)) then begin
-        giq_option(4, 139, 4010, MNode001, 50);
+    giq_option(4, NAME, 389, Node999, NEUTRAL_REACTION);
+    giq_option(-3, NAME, g_mstr(random(300, 303)), Node999, NEUTRAL_REACTION);
+    if ((global_var(GVAR_BRTHD_NETWORK) == 1) or (global_var(GVAR_BRTHD_NETWORK) == 2)) then begin
+        giq_option(4, NAME, 4010, MNode001, NEUTRAL_REACTION);
     end
-    if ((global_var(1072) == 1) or (global_var(1072) == 2)) then begin
-        giq_option(-3, 139, 4010, MNode004, 50);
+    if ((global_var(GVAR_BRTHD_NETWORK) == 1) or (global_var(GVAR_BRTHD_NETWORK) == 2)) then begin
+        giq_option(-3, NAME, 4010, MNode004, NEUTRAL_REACTION);
     end
 end
 
@@ -3562,7 +3562,7 @@ begin
             gfade_out(600);
             PartyHealingItem := obj_carrying_pid_obj(self_obj, 144);
             use_obj_on_obj(PartyHealingItem, self_obj);
-            debug_msg(obj_name(self_obj) + " used super stimpak.");
+            debug_msg(self_name + " used super stimpak.");
             gfade_in(600);
         end
     end
@@ -3572,7 +3572,7 @@ begin
                 gfade_out(600);
                 PartyHealingItem := obj_carrying_pid_obj(self_obj, 40);
                 use_obj_on_obj(PartyHealingItem, self_obj);
-                debug_msg(obj_name(self_obj) + " used stimpak.");
+                debug_msg(self_name + " used stimpak.");
                 gfade_in(600);
             end
         end
@@ -3582,7 +3582,7 @@ begin
                     gfade_out(600);
                     PartyHealingItem := obj_carrying_pid_obj(self_obj, 273);
                     use_obj_on_obj(PartyHealingItem, self_obj);
-                    debug_msg(obj_name(self_obj) + " used healing powder.");
+                    debug_msg(self_name + " used healing powder.");
                     gfade_in(600);
                 end
             end
@@ -3591,7 +3591,7 @@ begin
                     if ((global_temp == 0) and (combat_is_initialized == 0)) then begin
                         gfade_out(600);
                         use_obj_on_obj(obj_carrying_pid_obj(self_obj, 91), self_obj);
-                        debug_msg(obj_name(self_obj) + " used doctor's bag kit.");
+                        debug_msg(self_name + " used doctor's bag kit.");
                         gfade_in(600);
                     end
                 end
@@ -3600,12 +3600,12 @@ begin
                         if ((global_temp == 0) and (combat_is_initialized == 0)) then begin
                             gfade_out(600);
                             use_obj_on_obj(obj_carrying_pid_obj(self_obj, 47), self_obj);
-                            debug_msg(obj_name(self_obj) + " used First Aid kit.");
+                            debug_msg(self_name + " used First Aid kit.");
                             gfade_in(600);
                         end
                     end
                     else begin
-                        if (has_skill(self_obj, 7) > has_skill(self_obj, 6)) then begin
+                        if (has_skill(self_obj, SKILL_DOCTOR) > has_skill(self_obj, SKILL_FIRST_AID)) then begin
                             if ((global_temp == 0) and (combat_is_initialized == 0)) then begin
                                 gfade_out(600);
                                 if ((60 * (60 * 10)) > 0) then begin
@@ -3615,7 +3615,7 @@ begin
                             end
                             if (is_success(roll_vs_skill(self_obj, 7, 0))) then begin
                                 critter_heal(self_obj, random(10, 25));
-                                debug_msg(obj_name(self_obj) + " healed some using doctor skill.");
+                                debug_msg(self_name + " healed some using doctor skill.");
                             end
                         end
                         else begin
@@ -3628,7 +3628,7 @@ begin
                             end
                             if (is_success(roll_vs_skill(self_obj, 6, 0))) then begin
                                 critter_heal(self_obj, random(5, 15));
-                                debug_msg(obj_name(self_obj) + " healed some using first aid skill.");
+                                debug_msg(self_name + " healed some using first aid skill.");
                             end
                         end
                     end
@@ -3637,113 +3637,113 @@ begin
         end
     end
     global_temp := 0;
-    if (get_critter_stat(self_obj, 35) == get_critter_stat(self_obj, 7)) then begin
-        gsay_reply(139, 1100);
+    if (get_critter_stat(self_obj, STAT_current_hp) == get_critter_stat(self_obj, STAT_max_hp)) then begin
+        Reply(1100);
     end
     else begin
-        if ((get_critter_stat(self_obj, 35) * 100 / get_critter_stat(self_obj, 7)) >= 90) then begin
-            gsay_reply(139, 1200);
+        if ((get_critter_stat(self_obj, STAT_current_hp) * 100 / get_critter_stat(self_obj, STAT_max_hp)) >= 90) then begin
+            Reply(1200);
         end
         else begin
-            if ((get_critter_stat(self_obj, 35) * 100 / get_critter_stat(self_obj, 7)) >= 70) then begin
-                gsay_reply(139, 1300);
+            if ((get_critter_stat(self_obj, STAT_current_hp) * 100 / get_critter_stat(self_obj, STAT_max_hp)) >= 70) then begin
+                Reply(1300);
             end
             else begin
-                gsay_reply(139, 1400);
+                Reply(1400);
             end
         end
     end
-    if (get_critter_stat(self_obj, 35) < get_critter_stat(self_obj, 7)) then begin
-        giq_option(4, 139, 384, Node1001, 50);
+    if (get_critter_stat(self_obj, STAT_current_hp) < get_critter_stat(self_obj, STAT_max_hp)) then begin
+        giq_option(4, NAME, 384, Node1001, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 382, Node1008, 50);
-    giq_option(4, 139, 383, Node1002, 50);
+    giq_option(4, NAME, 382, Node1008, NEUTRAL_REACTION);
+    giq_option(4, NAME, 383, Node1002, NEUTRAL_REACTION);
     if (local_var(11) == 3) then begin
-        giq_option(4, 139, 381, Node1007, 50);
+        giq_option(4, NAME, 381, Node1007, NEUTRAL_REACTION);
     end
     else begin
-        giq_option(4, 139, 6125, Node1007, 50);
+        giq_option(4, NAME, 6125, Node1007, NEUTRAL_REACTION);
     end
-    if (((global_var(174) bwand 8) != 0) or (party_member_obj(16777305) != 0) and (local_var(19) == 0)) then begin
-        giq_option(4, 139, 6000, Node077, 50);
+    if (((global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwand 8) != 0) or (party_member_obj(16777305) != 0) and (local_var(19) == 0)) then begin
+        giq_option(4, NAME, 6000, Node077, NEUTRAL_REACTION);
     end
-    if (obj_is_carrying_obj_pid(dude_obj, 333) and not((global_var(174) bwand 256) != 0)) then begin
-        giq_option(4, 139, 6001, Node081, 50);
+    if (obj_is_carrying_obj_pid(dude_obj, 333) and not((global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwand 256) != 0)) then begin
+        giq_option(4, NAME, 6001, Node081, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 389, Node999, 50);
-    giq_option(-3, 139, message_str(14, random(300, 303)), Node999, 50);
+    giq_option(4, NAME, 389, Node999, NEUTRAL_REACTION);
+    giq_option(-3, NAME, g_mstr(random(300, 303)), Node999, NEUTRAL_REACTION);
 end
 
 procedure Node1002
 begin
     set_local_var(10, game_time);
     party_remove(self_obj);
-    gsay_reply(139, 1500);
-    giq_option(4, 139, 6127, Node999, 50);
-    giq_option(-3, 139, message_str(14, random(300, 303)), Node999, 50);
+    Reply(1500);
+    giq_option(4, NAME, 6127, Node999, NEUTRAL_REACTION);
+    giq_option(-3, NAME, g_mstr(random(300, 303)), Node999, NEUTRAL_REACTION);
 end
 
 procedure Node1003
 begin
-    metarule(43, self_obj);
-    gsay_reply(139, 4001);
-    giq_option(4, 139, 6128, Node1010, 50);
+    inven_unwield(self_obj);
+    Reply(4001);
+    giq_option(4, NAME, 6128, Node1010, NEUTRAL_REACTION);
     if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-        giq_option(4, 139, 6130, Node1009, 50);
+        giq_option(4, NAME, 6130, Node1009, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 6131, Node1000, 50);
+    giq_option(4, NAME, 6131, Node1000, NEUTRAL_REACTION);
 end
 
 procedure Node1004
 begin
     set_local_var(11, 3);
-    gsay_reply(139, 1700);
-    giq_option(4, 139, 6131, Node1000, 50);
-    giq_option(4, 139, 389, Node999, 50);
+    Reply(1700);
+    giq_option(4, NAME, 6131, Node1000, NEUTRAL_REACTION);
+    giq_option(4, NAME, 389, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node1005
 begin
     set_local_var(11, 6);
-    gsay_reply(139, 1800);
-    giq_option(4, 139, 6131, Node1000, 50);
-    giq_option(4, 139, 389, Node999, 50);
+    Reply(1800);
+    giq_option(4, NAME, 6131, Node1000, NEUTRAL_REACTION);
+    giq_option(4, NAME, 389, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node1006
 begin
     set_local_var(11, 9);
-    gsay_reply(139, 1900);
-    giq_option(4, 139, 6131, Node1000, 50);
-    giq_option(4, 139, 389, Node999, 50);
+    Reply(1900);
+    giq_option(4, NAME, 6131, Node1000, NEUTRAL_REACTION);
+    giq_option(4, NAME, 389, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node1007
 begin
-    gsay_reply(139, 4000);
+    Reply(4000);
     if (local_var(11) != 3) then begin
-        giq_option(4, 139, 6132, Node1004, 50);
+        giq_option(4, NAME, 6132, Node1004, NEUTRAL_REACTION);
     end
     if (local_var(11) != 6) then begin
-        giq_option(4, 139, 6133, Node1005, 50);
+        giq_option(4, NAME, 6133, Node1005, NEUTRAL_REACTION);
     end
     if (local_var(11) != 9) then begin
-        giq_option(4, 139, 511, Node1006, 50);
+        giq_option(4, NAME, 511, Node1006, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 6131, Node1000, 50);
+    giq_option(4, NAME, 6131, Node1000, NEUTRAL_REACTION);
 end
 
 procedure Node1008
 begin
-    gsay_reply(139, 400);
-    giq_option(4, 139, 6128, Node1010, 50);
+    Reply(400);
+    giq_option(4, NAME, 6128, Node1010, NEUTRAL_REACTION);
     if ((obj_item_subtype(critter_inven_obj(self_obj, 1)) == 3) or (obj_item_subtype(critter_inven_obj(self_obj, 2)) == 3)) then begin
-        giq_option(4, 139, 6129, Node1003, 50);
+        giq_option(4, NAME, 6129, Node1003, NEUTRAL_REACTION);
     end
     if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-        giq_option(4, 139, 6130, Node1009, 50);
+        giq_option(4, NAME, 6130, Node1009, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 6131, Node1000, 50);
+    giq_option(4, NAME, 6131, Node1000, NEUTRAL_REACTION);
 end
 
 procedure Node1009
@@ -3754,68 +3754,68 @@ begin
         rm_obj_from_inven(self_obj, restock_obj);
         add_obj_to_inven(self_obj, restock_obj);
     end
-    gsay_reply(139, 4003);
-    giq_option(4, 139, 6128, Node1010, 50);
+    Reply(4003);
+    giq_option(4, NAME, 6128, Node1010, NEUTRAL_REACTION);
     if ((obj_item_subtype(critter_inven_obj(self_obj, 1)) == 3) or (obj_item_subtype(critter_inven_obj(self_obj, 2)) == 3)) then begin
-        giq_option(4, 139, 6129, Node1003, 50);
+        giq_option(4, NAME, 6129, Node1003, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 6131, Node1000, 50);
+    giq_option(4, NAME, 6131, Node1000, NEUTRAL_REACTION);
 end
 
 procedure Node1010
 begin
-    gsay_reply(139, 4002);
+    Reply(4002);
     if ((obj_item_subtype(critter_inven_obj(self_obj, 1)) == 3) or (obj_item_subtype(critter_inven_obj(self_obj, 2)) == 3)) then begin
-        giq_option(4, 139, 6129, Node1003, 50);
+        giq_option(4, NAME, 6129, Node1003, NEUTRAL_REACTION);
     end
     if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-        giq_option(4, 139, 6130, Node1009, 50);
+        giq_option(4, NAME, 6130, Node1009, NEUTRAL_REACTION);
     end
-    giq_option(4, 139, 6131, Node1000, 50);
+    giq_option(4, NAME, 6131, Node1000, NEUTRAL_REACTION);
 end
 
 procedure Node1100
 begin
-    if ((get_critter_stat(dude_obj, 3) <= 1) and not(has_trait(0, dude_obj, 39))) then begin
+    if ((dude_charisma <= 1) and not(has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))) then begin
         if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-            debug_msg("abandon party: " + obj_name(self_obj));
+            debug_msg("abandon party: " + self_name);
             party_remove(self_obj);
         end
-        if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-            critter_add_trait(self_obj, 1, 6, local_var(12));
+        if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+            critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
             set_local_var(12, -1);
         end
-        debug_msg("" + obj_name(self_obj) + " has abandoned the party");
-        gsay_reply(139, 371);
-        giq_option(1, 139, message_str(14, 10007), Node999, 50);
+        debug_msg("" + self_name + " has abandoned the party");
+        Reply(371);
+        giq_option(1, NAME, g_mstr(10007), Node999, NEUTRAL_REACTION);
     end
     else begin
-        if (((metarule(16, 0) - 1) >= (floor(get_critter_stat(dude_obj, 3) / 2) + has_trait(0, dude_obj, 98) + (20 * has_trait(0, dude_obj, 39)))) or ((metarule(16, 0) - 1) >= (5 + (20 * has_trait(0, dude_obj, 39))))) then begin
+        if (((party_member_count(0) - 1) >= (floor(dude_charisma / 2) + has_trait(TRAIT_PERK, dude_obj, PERK_magnetic_personality_perk) + (20 * has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality)))) or ((party_member_count(0) - 1) >= (5 + (20 * has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))))) then begin
             if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-                debug_msg("abandon party: " + obj_name(self_obj));
+                debug_msg("abandon party: " + self_name);
                 party_remove(self_obj);
             end
-            if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-                critter_add_trait(self_obj, 1, 6, local_var(12));
+            if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+                critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
                 set_local_var(12, -1);
             end
-            debug_msg("" + obj_name(self_obj) + " has abandoned the party");
-            gsay_reply(139, 2000);
-            giq_option(1, 139, message_str(14, 10007), Node999, 50);
+            debug_msg("" + self_name + " has abandoned the party");
+            Reply(2000);
+            giq_option(1, NAME, g_mstr(10007), Node999, NEUTRAL_REACTION);
         end
         else begin
-            if ((global_var(51) <= -15) and not(has_trait(0, dude_obj, 39))) then begin
+            if ((global_var(GVAR_TOWN_REP_GECKO) <= -15) and not(has_trait(TRAIT_PERK, dude_obj, PERK_cult_of_personality))) then begin
                 if (party_member_obj(obj_pid(self_obj)) != 0) then begin
-                    debug_msg("abandon party: " + obj_name(self_obj));
+                    debug_msg("abandon party: " + self_name);
                     party_remove(self_obj);
                 end
-                if ((local_var(12) != -1) and (has_trait(1, self_obj, 6) == 0)) then begin
-                    critter_add_trait(self_obj, 1, 6, local_var(12));
+                if ((local_var(12) != -1) and (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) == 0)) then begin
+                    critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, local_var(12));
                     set_local_var(12, -1);
                 end
-                debug_msg("" + obj_name(self_obj) + " has abandoned the party");
-                gsay_reply(139, 2100);
-                giq_option(1, 139, message_str(14, 10007), Node999, 50);
+                debug_msg("" + self_name + " has abandoned the party");
+                Reply(2100);
+                giq_option(1, NAME, g_mstr(10007), Node999, NEUTRAL_REACTION);
             end
             else begin
                 if ((critter_state(self_obj) bwand 1) == 0) then begin
@@ -3823,31 +3823,31 @@ begin
                         set_local_var(11, 6);
                     end
                     set_local_var(10, 0);
-                    if (has_trait(1, self_obj, 6) != 0) then begin
-                        set_local_var(12, has_trait(1, self_obj, 6));
+                    if (has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM) != 0) then begin
+                        set_local_var(12, has_trait(TRAIT_OBJECT, self_obj, OBJECT_TEAM_NUM));
                     end
-                    critter_add_trait(self_obj, 1, 6, 0);
+                    critter_add_trait(self_obj, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
                     party_add(self_obj);
                 end
-                debug_msg("join party: " + obj_name(self_obj));
-                gsay_reply(139, 2200);
+                debug_msg("join party: " + self_name);
+                Reply(2200);
                 if (local_var(11) == 0) then begin
                     set_local_var(11, 6);
                 end
-                giq_option(4, 139, 389, Node999, 50);
-                if (((global_var(174) bwand 8) != 0) or (party_member_obj(16777305) != 0) and (local_var(19) == 0)) then begin
-                    giq_option(4, 139, 6000, Node077, 50);
+                giq_option(4, NAME, 389, Node999, NEUTRAL_REACTION);
+                if (((global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwand 8) != 0) or (party_member_obj(16777305) != 0) and (local_var(19) == 0)) then begin
+                    giq_option(4, NAME, 6000, Node077, NEUTRAL_REACTION);
                 end
-                if (obj_is_carrying_obj_pid(dude_obj, 333) and ((global_var(174) bwand 256) == 0)) then begin
-                    giq_option(4, 139, 6001, Node081, 50);
+                if (obj_is_carrying_obj_pid(dude_obj, 333) and ((global_var(GVAR_NEWRENO_SNUFF_WESTIN) bwand 256) == 0)) then begin
+                    giq_option(4, NAME, 6001, Node081, NEUTRAL_REACTION);
                 end
-                if (get_critter_stat(self_obj, 35) < get_critter_stat(self_obj, 7)) then begin
-                    giq_option(4, 139, 384, Node1001, 50);
+                if (get_critter_stat(self_obj, STAT_current_hp) < get_critter_stat(self_obj, STAT_max_hp)) then begin
+                    giq_option(4, NAME, 384, Node1001, NEUTRAL_REACTION);
                 end
-                giq_option(4, 139, 401, Node1007, 50);
-                giq_option(4, 139, 382, Node1008, 50);
-                giq_option(4, 139, 383, Node1002, 50);
-                giq_option(-3, 139, message_str(14, random(300, 303)), Node999, 50);
+                giq_option(4, NAME, 401, Node1007, NEUTRAL_REACTION);
+                giq_option(4, NAME, 382, Node1008, NEUTRAL_REACTION);
+                giq_option(4, NAME, 383, Node1002, NEUTRAL_REACTION);
+                giq_option(-3, NAME, g_mstr(random(300, 303)), Node999, NEUTRAL_REACTION);
             end
         end
     end
@@ -3857,48 +3857,48 @@ procedure armour_change
 begin
     if (critter_inven_obj(self_obj, 0) != ArmourVal) then begin
         ArmourVal := obj_pid(critter_inven_obj(self_obj, 0));
-        if ((critter_inven_obj(self_obj, 0) == 0) and (global_var(1015) == 0)) then begin
-            metarule3(107, self_obj, 16777295, 0);
+        if ((critter_inven_obj(self_obj, 0) == 0) and (global_var(GVAR_ENTERED_BHILLS_BMENT_NO_QUEST) == 0)) then begin
+            art_change_fid_num(self_obj, 16777295);
         end
         else begin
-            if ((critter_inven_obj(self_obj, 0) == 0) and (global_var(1015) == 1)) then begin
-                metarule3(107, self_obj, 16777229, 0);
+            if ((critter_inven_obj(self_obj, 0) == 0) and (global_var(GVAR_ENTERED_BHILLS_BMENT_NO_QUEST) == 1)) then begin
+                art_change_fid_num(self_obj, 16777229);
             end
             else begin
                 if ((obj_pid(critter_inven_obj(self_obj, 0)) == 1) or (obj_pid(critter_inven_obj(self_obj, 0)) == 379)) then begin
-                    metarule3(107, self_obj, 16777260, 0);
+                    art_change_fid_num(self_obj, 16777260);
                 end
                 else begin
                     if ((obj_pid(critter_inven_obj(self_obj, 0)) == 232) or (obj_pid(critter_inven_obj(self_obj, 0)) == 3)) then begin
-                        metarule3(107, self_obj, 16777217, 0);
+                        art_change_fid_num(self_obj, 16777217);
                     end
                     else begin
                         if ((obj_pid(critter_inven_obj(self_obj, 0)) == 349) or (obj_pid(critter_inven_obj(self_obj, 0)) == 348)) then begin
-                            metarule3(107, self_obj, 16777287, 0);
+                            art_change_fid_num(self_obj, 16777287);
                         end
                         else begin
                             if ((obj_pid(critter_inven_obj(self_obj, 0)) == 240) or (obj_pid(critter_inven_obj(self_obj, 0)) == 380) or (obj_pid(critter_inven_obj(self_obj, 0)) == 2)) then begin
-                                metarule3(107, self_obj, 16777230, 0);
+                                art_change_fid_num(self_obj, 16777230);
                             end
                             else begin
                                 if ((obj_pid(critter_inven_obj(self_obj, 0)) == 74) or (obj_pid(critter_inven_obj(self_obj, 0)) == 265)) then begin
-                                    metarule3(107, self_obj, 16777229, 0);
+                                    art_change_fid_num(self_obj, 16777229);
                                 end
                                 else begin
                                     if ((obj_pid(critter_inven_obj(self_obj, 0)) == 239) or (obj_pid(critter_inven_obj(self_obj, 0)) == 17) or (obj_pid(critter_inven_obj(self_obj, 0)) == 381)) then begin
-                                        metarule3(107, self_obj, 16777226, 0);
+                                        art_change_fid_num(self_obj, 16777226);
                                     end
                                     else begin
                                         if ((obj_pid(critter_inven_obj(self_obj, 0)) == 524) or (obj_pid(critter_inven_obj(self_obj, 0)) == 113)) then begin
-                                            metarule3(107, self_obj, 16777218, 0);
+                                            art_change_fid_num(self_obj, 16777218);
                                         end
                                         else begin
                                             if (obj_pid(critter_inven_obj(self_obj, 0)) == 554) then begin
-                                                metarule3(107, self_obj, 16777301, 0);
+                                                art_change_fid_num(self_obj, 16777301);
                                             end
                                             else begin
                                                 if (obj_pid(critter_inven_obj(self_obj, 0)) == 580) then begin
-                                                    metarule3(107, self_obj, 16777328, 0);
+                                                    art_change_fid_num(self_obj, 16777328);
                                                 end
                                             end
                                         end
@@ -3919,91 +3919,91 @@ end
 
 procedure MNode001
 begin
-    gsay_reply(139, 4011);
-    giq_option(1, 139, 4012, MNode002, 49);
-    giq_option(1, 139, 4013, Node1000, 50);
+    Reply(4011);
+    giq_option(1, NAME, 4012, MNode002, GOOD_REACTION);
+    giq_option(1, NAME, 4013, Node1000, NEUTRAL_REACTION);
 end
 
 procedure MNode002
 begin
-    gsay_reply(139, 4014);
-    if (has_skill(dude_obj, 14) > 105) then begin
-        giq_option(1, 139, 4015, MNode003, 50);
+    Reply(4014);
+    if (dude_skill(SKILL_SPEECH) > 105) then begin
+        giq_option(1, NAME, 4015, MNode003, NEUTRAL_REACTION);
     end
-    giq_option(1, 139, 4016, Node1000, 50);
+    giq_option(1, NAME, 4016, Node1000, NEUTRAL_REACTION);
 end
 
 procedure MNode003
 begin
-    set_global_var(1072, 2);
-    gsay_reply(139, 4017);
-    giq_option(1, 139, 4018, Node999, 50);
+    set_global_var(GVAR_BRTHD_NETWORK, 2);
+    Reply(4017);
+    giq_option(1, NAME, 4018, Node999, NEUTRAL_REACTION);
 end
 
 procedure MNode004
 begin
-    gsay_reply(139, 4021);
-    giq_option(1, 139, 4022, MNode005, 49);
-    giq_option(1, 139, 4023, Node1000, 50);
+    Reply(4021);
+    giq_option(1, NAME, 4022, MNode005, GOOD_REACTION);
+    giq_option(1, NAME, 4023, Node1000, NEUTRAL_REACTION);
 end
 
 procedure MNode005
 begin
-    gsay_reply(139, 4024);
-    if (has_skill(dude_obj, 14) > 105) then begin
-        giq_option(1, 139, 4025, MNode006, 50);
+    Reply(4024);
+    if (dude_skill(SKILL_SPEECH) > 105) then begin
+        giq_option(1, NAME, 4025, MNode006, NEUTRAL_REACTION);
     end
-    giq_option(1, 139, 4026, Node1000, 50);
+    giq_option(1, NAME, 4026, Node1000, NEUTRAL_REACTION);
 end
 
 procedure MNode006
 begin
-    set_global_var(1072, 2);
-    gsay_reply(139, 4027);
-    giq_option(1, 139, 4028, Node999, 50);
+    set_global_var(GVAR_BRTHD_NETWORK, 2);
+    Reply(4027);
+    giq_option(1, NAME, 4028, Node999, NEUTRAL_REACTION);
 end
 
 procedure use_obj_on_p_proc
 begin
     if ((obj_pid(obj_being_used_with) == 39) or (obj_pid(obj_being_used_with) == 38)) then begin
         script_overrides;
-        display_msg(message_str(14, 20000));
+        display_msg(g_mstr(20000));
     end
     if ((obj_pid(obj_being_used_with) == 310) or (obj_pid(obj_being_used_with) == 311) or (obj_pid(obj_being_used_with) == 469)) then begin
         if (local_var(17) == 0) then begin
             set_local_var(17, 1);
-            float_msg(self_obj, message_str(139, 5100), 3);
+            float_msg(self_obj, mstr(5100), FLOAT_MSG_GREEN);
         end
     end
     if ((obj_pid(obj_being_used_with) == 48) and (local_var(17) == 2)) then begin
         obj_set_light_level(self_obj, 0, 0);
         set_local_var(17, 0);
-        float_msg(self_obj, message_str(139, 5101), 8);
+        float_msg(self_obj, mstr(5101), FLOAT_MSG_YELLOW);
     end
     if (obj_pid(obj_being_used_with) == 473) then begin
         script_overrides;
-        float_msg(self_obj, message_str(139, 6106), 8);
+        float_msg(self_obj, mstr(6106), FLOAT_MSG_YELLOW);
     end
     if ((obj_pid(obj_being_used_with) == 281) or (obj_pid(obj_being_used_with) == 282)) then begin
         script_overrides;
-        float_msg(self_obj, message_str(139, 6107), 8);
+        float_msg(self_obj, mstr(6107), FLOAT_MSG_YELLOW);
     end
     if ((obj_pid(obj_being_used_with) == 321) or (obj_pid(obj_being_used_with) == 322) or (obj_pid(obj_being_used_with) == 323) or (obj_pid(obj_being_used_with) == 324)) then begin
         script_overrides;
         if (obj_pid(obj_being_used_with) == 321) then begin
-            float_msg(self_obj, message_str(139, 6110) + message_str(139, 6111), 8);
+            float_msg(self_obj, mstr(6110) + mstr(6111), FLOAT_MSG_YELLOW);
         end
         else begin
             if (obj_pid(obj_being_used_with) == 322) then begin
-                float_msg(self_obj, message_str(139, 6110) + message_str(139, 6112), 8);
+                float_msg(self_obj, mstr(6110) + mstr(6112), FLOAT_MSG_YELLOW);
             end
             else begin
                 if (obj_pid(obj_being_used_with) == 323) then begin
-                    float_msg(self_obj, message_str(139, 6110) + message_str(139, 6113), 8);
+                    float_msg(self_obj, mstr(6110) + mstr(6113), FLOAT_MSG_YELLOW);
                 end
                 else begin
                     if (obj_pid(obj_being_used_with) == 324) then begin
-                        float_msg(self_obj, message_str(139, 6110) + message_str(139, 6114), 8);
+                        float_msg(self_obj, mstr(6110) + mstr(6114), FLOAT_MSG_YELLOW);
                     end
                 end
             end
@@ -4011,7 +4011,7 @@ begin
         if (source_obj == dude_obj) then begin
             restock_obj := obj_carrying_pid_obj(dude_obj, obj_pid(obj_being_used_with));
             if ((critter_inven_obj(dude_obj, 2) == restock_obj) or (critter_inven_obj(dude_obj, 1) == restock_obj)) then begin
-                metarule(43, dude_obj);
+                inven_unwield(dude_obj);
             end
             rm_obj_from_inven(dude_obj, restock_obj);
             destroy_object(restock_obj);
@@ -4020,15 +4020,14 @@ begin
     end
     if (obj_pid(obj_being_used_with) == 606) then begin
         script_overrides;
-        float_msg(self_obj, message_str(139, 6105), 8);
+        float_msg(self_obj, mstr(6105), FLOAT_MSG_YELLOW);
     end
     if (obj_pid(obj_being_used_with) == 618) then begin
         script_overrides;
-        float_msg(self_obj, message_str(139, 6120), 8);
+        float_msg(self_obj, mstr(6120), FLOAT_MSG_YELLOW);
     end
     if (obj_pid(obj_being_used_with) == 317) then begin
         script_overrides;
-        float_msg(self_obj, message_str(139, 6121), 8);
+        float_msg(self_obj, mstr(6121), FLOAT_MSG_YELLOW);
     end
 end
-
