diff --git a/Mods/MegaMod/Original/SIDTBL.ssl b/Mods/MegaMod/ReDefine/SIDTBL.ssl
index 3bb9dda..8f26b29 100644
--- a/Mods/MegaMod/Original/SIDTBL.ssl
+++ b/Mods/MegaMod/ReDefine/SIDTBL.ssl
@@ -223,16 +223,16 @@ begin
                 set_local_var(2, 1);
                 reg_anim_func(2, source_obj);
                 if (source_obj == dude_obj) then begin
-                    display_msg(message_str(16, 204));
+                    display_msg(message_str(SCRIPT_CONTAINR, 204));
                 end
                 else begin
-                    display_msg(message_str(16, 205));
+                    display_msg(message_str(SCRIPT_CONTAINR, 205));
                 end
             end
             else begin
                 if (obj_is_locked(self_obj)) then begin
                     script_overrides;
-                    display_msg(message_str(16, 203));
+                    display_msg(message_str(SCRIPT_CONTAINR, 203));
                     call Damage_Critter();
                 end
                 else begin
@@ -243,7 +243,7 @@ begin
         else begin
             if (obj_is_locked(self_obj)) then begin
                 script_overrides;
-                display_msg(message_str(16, 203));
+                display_msg(message_str(SCRIPT_CONTAINR, 203));
             end
         end
     end
@@ -283,10 +283,10 @@ begin
             end
             else begin
                 if (source_obj == dude_obj) then begin
-                    display_msg(message_str(16, 195));
+                    display_msg(message_str(SCRIPT_CONTAINR, 195));
                 end
                 else begin
-                    display_msg(obj_name(source_obj) + message_str(16, 200));
+                    display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 200));
                 end
             end
         end
@@ -364,7 +364,7 @@ end
 procedure damage_p_proc
 begin
     variable LVar0 := 0;
-    if (metarule(49, target_obj) == 6) then begin
+    if (weapon_dmg_type(target_obj) == 6) then begin
         if (3 == 0) then begin
             if (local_var(1) == 0) then begin
                 set_local_var(1, 1);
@@ -398,7 +398,7 @@ begin
         end
     end
     else begin
-        display_msg(message_str(16, 193));
+        display_msg(message_str(SCRIPT_CONTAINR, 193));
     end
     return 0;
     LVar0 := 0;
@@ -423,7 +423,7 @@ begin
     if (i_duppo_obj != -1) then begin
         if (local_var(7) < game_time) then begin
             if (tile_num(self_obj) == 17327) then begin
-                LVar0 := create_object_sid(128, 5, 0, -1);
+                LVar0 := create_object(128, 5, 0);
                 if (obj_is_carrying_obj_pid(self_obj, 479) > 0) then begin
                     LVar1 := obj_carrying_pid_obj(self_obj, 479);
                     rm_obj_from_inven(self_obj, LVar1);
@@ -664,217 +664,217 @@ begin
                     rm_obj_from_inven(self_obj, LVar1);
                     add_obj_to_inven(LVar0, LVar1);
                 end
-                global_temp := create_object_sid(128, 0, 0, -1);
+                global_temp := create_object(128, 0, 0);
                 move_obj_inven_to_obj(self_obj, global_temp);
                 destroy_object(global_temp);
-                if ((cur_map_index == 3) or (cur_map_index == 4) or (cur_map_index == 35) or (cur_map_index == 5)) then begin
+                if ((CUR_MAP_ARCAVES) or (CUR_MAP_ARVILLAG) or (CUR_MAP_ARCAVES5) or (CUR_MAP_ARBRIDGE)) then begin
                     current_town := "Arroyo";
                 end
-                if ((cur_map_index == 9) or (cur_map_index == 10) or (cur_map_index == 11) or (cur_map_index == 13) or (cur_map_index == 14) or (cur_map_index == 48) or (cur_map_index == 161)) then begin
+                if ((CUR_MAP_KLADWTWN) or (CUR_MAP_KLAMALL) or (CUR_MAP_KLARATCV) or (CUR_MAP_KLATRAP) or (CUR_MAP_KLAGRAZ) or (CUR_MAP_KLACANYN) or (CUR_MAP_KLACVENT)) then begin
                     current_town := "Klamath";
                 end
-                if (cur_map_index == 12) then begin
+                if (CUR_MAP_KLATOXCV) then begin
                     current_town := "Klamath Toxic Caves";
                 end
-                if (cur_map_index == 158) then begin
+                if (CUR_MAP_RNDMDDG) then begin
                     current_town := "Mad Dog Area";
                 end
-                if ((cur_map_index == 6) or (cur_map_index == 7) or (cur_map_index == 8)) then begin
+                if ((CUR_MAP_DENBUS1) or (CUR_MAP_DENBUS2) or (CUR_MAP_DENRES1)) then begin
                     current_town := "Den";
                 end
-                if ((cur_map_index == 231) or (cur_map_index == 253) or (cur_map_index == 254) or (cur_map_index == 255)) then begin
+                if ((CUR_MAP_PRIMIT) or (CUR_MAP_TRIBE02) or (CUR_MAP_SLVCAMP) or (CUR_MAP_TRIBE2)) then begin
                     current_town := "Primitive Tribes";
                 end
-                if (cur_map_index == 163) then begin
+                if (CUR_MAP_TRIBE01) then begin
                     current_town := "Primitive Tribe";
                 end
-                if (cur_map_index == 52) then begin
+                if (CUR_MAP_DNSLVRUN) then begin
                     current_town := "Den Slave Run";
                 end
-                if (cur_map_index == 160) then begin
+                if (CUR_MAP_JENFARM7) then begin
                     current_town := "Jennings Farm Area";
                 end
-                if (cur_map_index == 156) then begin
+                if (CUR_MAP_TRUCK) then begin
                     current_town := "Truck";
                 end
-                if (cur_map_index == 162) then begin
+                if (CUR_MAP_SCRAPT) then begin
                     current_town := "Scraptown";
                 end
-                if ((cur_map_index == 18) or (cur_map_index == 19) or (cur_map_index == 20) or (cur_map_index == 21) or (cur_map_index == 22) or (cur_map_index == 23)) then begin
+                if ((CUR_MAP_MODMAIN) or (CUR_MAP_MODINN) or (CUR_MAP_MODBRAH) or (CUR_MAP_MODGARD) or (CUR_MAP_MODSHIT) or (CUR_MAP_MODWELL)) then begin
                     current_town := "Modoc";
                 end
-                if (cur_map_index == 202) then begin
+                if (CUR_MAP_CRISIENT) then begin
                     current_town := "Vault 23";
                 end
-                if ((cur_map_index == 24) or (cur_map_index == 25) or (cur_map_index == 26)) then begin
+                if ((CUR_MAP_GSTFARM) or (CUR_MAP_GSTCAV1) or (CUR_MAP_GSTCAV2)) then begin
                     current_town := "Ghost Farm";
                 end
-                if (cur_map_index == 223) then begin
+                if (CUR_MAP_MODOCT) then begin
                     current_town := "Modoc Thieves Guild";
                 end
-                if (cur_map_index == 224) then begin
+                if (CUR_MAP_MODOCT2) then begin
                     current_town := "Salvatore's Gun Stash";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvatore";
                 end
-                if (cur_map_index == 226) then begin
+                if (CUR_MAP_MODOCT4) then begin
                     current_town := "Salvatore Meeting";
                 end
-                if ((cur_map_index == 31) or (cur_map_index == 32) or (cur_map_index == 33) or (cur_map_index == 34)) then begin
+                if ((CUR_MAP_GECKSETL) or (CUR_MAP_GECKPWPL) or (CUR_MAP_GECKJUNK) or (CUR_MAP_GECKTUNL)) then begin
                     current_town := "Gecko";
                 end
-                if ((cur_map_index == 15) or (cur_map_index == 16) or (cur_map_index == 17) or (cur_map_index == 30)) then begin
+                if ((CUR_MAP_VCTYCTYD) or (CUR_MAP_VCTYDWTN) or (CUR_MAP_VCTYCOCL) or (CUR_MAP_VCTYVLT)) then begin
                     current_town := "Vault City";
                 end
-                if ((cur_map_index == 92) or (cur_map_index == 93)) then begin
+                if ((CUR_MAP_RAIDERS1) or (CUR_MAP_RAIDERS2)) then begin
                     current_town := "Raiders";
                 end
-                if ((cur_map_index == 78) or (cur_map_index == 79)) then begin
+                if ((CUR_MAP_BROKEN1) or (CUR_MAP_BROKEN2)) then begin
                     current_town := "Broken Hills";
                 end
-                if ((cur_map_index == 64) or (cur_map_index == 62) or (cur_map_index == 63) or (cur_map_index == 65) or (cur_map_index == 66) or (cur_map_index == 67)) then begin
+                if ((CUR_MAP_REDDOWN) or (CUR_MAP_REDWAME) or (CUR_MAP_REDWAN1) or (CUR_MAP_REDMENT) or (CUR_MAP_REDDTUN) or (CUR_MAP_REDMTUN)) then begin
                     current_town := "Redding";
                 end
-                if ((cur_map_index == 54) or (cur_map_index == 55) or (cur_map_index == 56) or (cur_map_index == 57) or (cur_map_index == 58) or (cur_map_index == 61) or (cur_map_index == 147)) then begin
+                if ((CUR_MAP_NEWR1) or (CUR_MAP_NEWR2) or (CUR_MAP_NEWR3) or (CUR_MAP_NEWR4) or (CUR_MAP_NEWRCS) or (CUR_MAP_NEWRBA) or (CUR_MAP_NEWRVB)) then begin
                     current_town := "New Reno";
                 end
-                if ((cur_map_index == 195) or (cur_map_index == 197) or (cur_map_index == 235) or (cur_map_index == 196)) then begin
+                if ((CUR_MAP_LARS1) or (CUR_MAP_LARS3) or (CUR_MAP_LARSSCRP) or (CUR_MAP_LARS2)) then begin
                     current_town := "Lars-City";
                 end
-                if (cur_map_index == 232) then begin
+                if (CUR_MAP_CRSNMAIN) then begin
                     current_town := "Lars-City Carson";
                 end
-                if (cur_map_index == 155) then begin
+                if (CUR_MAP_ABBEY) then begin
                     current_town := "Abbey";
                 end
-                if ((cur_map_index == 153) or (cur_map_index == 154)) then begin
+                if ((CUR_MAP_EPAMAIN) or (CUR_MAP_EPAWRHSE)) then begin
                     current_town := "EPA";
                 end
-                if ((cur_map_index == 220) or (cur_map_index == 221)) then begin
+                if ((CUR_MAP_COLLY) or (CUR_MAP_COLLY1)) then begin
                     current_town := "Collyweb";
                 end
-                if (cur_map_index == 59) then begin
+                if (CUR_MAP_NEWRGO) then begin
                     current_town := "Golgotha";
                 end
-                if (cur_map_index == 60) then begin
+                if (CUR_MAP_NEWRST) then begin
                     current_town := "Reno Stables";
                 end
-                if ((cur_map_index == 27) or (cur_map_index == 28) or (cur_map_index == 29)) then begin
+                if ((CUR_MAP_DEPOLV1) or (CUR_MAP_DEPOLVA) or (CUR_MAP_DEPOLVB)) then begin
                     current_town := "Sierra Army Base";
                 end
-                if ((cur_map_index == 46) or (cur_map_index == 43) or (cur_map_index == 42) or (cur_map_index == 44) or (cur_map_index == 45)) then begin
+                if ((CUR_MAP_NCRENT) or (CUR_MAP_NCR2) or (CUR_MAP_NCR1) or (CUR_MAP_NCR3) or (CUR_MAP_NCR4)) then begin
                     current_town := "NCR";
                 end
-                if (cur_map_index == 157) then begin
+                if (CUR_MAP_B21) then begin
                     current_town := "B21";
                 end
-                if ((cur_map_index == 37) or (cur_map_index == 38) or (cur_map_index == 36) or (cur_map_index == 39)) then begin
+                if ((CUR_MAP_V15ENT) or (CUR_MAP_V15ENTB) or (CUR_MAP_VAULT15) or (CUR_MAP_V15SENT)) then begin
                     current_town := "Vault 15";
                 end
-                if ((cur_map_index == 40) or (cur_map_index == 41)) then begin
+                if ((CUR_MAP_VAULT13) or (CUR_MAP_V13ENT)) then begin
                     current_town := "Vault 13";
                 end
-                if ((cur_map_index == 49) or (cur_map_index == 50) or (cur_map_index == 51)) then begin
+                if ((CUR_MAP_MBASE12) or (CUR_MAP_MBASE34) or (CUR_MAP_MBCLOSE)) then begin
                     current_town := "Military Base";
                 end
-                if ((cur_map_index == 137) or (cur_map_index == 136) or (cur_map_index == 135) or (cur_map_index == 138) or (cur_map_index == 139) or (cur_map_index == 140) or (cur_map_index == 148)) then begin
+                if ((CUR_MAP_SFCHINA) or (CUR_MAP_SFDOCK) or (CUR_MAP_SFTANKER) or (CUR_MAP_SFSHUTL1) or (CUR_MAP_SFSHUTL2) or (CUR_MAP_SFELRONB) or (CUR_MAP_SFCHINA2)) then begin
                     current_town := "San Francisco";
                 end
-                if ((cur_map_index == 213) or (cur_map_index == 214) or (cur_map_index == 215) or (cur_map_index == 188)) then begin
+                if ((CUR_MAP_BROHDENT1) or (CUR_MAP_BROHD121) or (CUR_MAP_BROHD341) or (CUR_MAP_BROHD1K)) then begin
                     current_town := "Brohdent";
                 end
-                if ((cur_map_index == 218) or (cur_map_index == 217) or (cur_map_index == 219)) then begin
+                if ((CUR_MAP_V14ENT) or (CUR_MAP_VAULT14) or (CUR_MAP_VAULT14B)) then begin
                     current_town := "Vault 14";
                 end
-                if (cur_map_index == 109) then begin
+                if (CUR_MAP_NAVARRO) then begin
                     current_town := "Navarro";
                 end
-                if ((cur_map_index == 129) or (cur_map_index == 128) or (cur_map_index == 130) or (cur_map_index == 131) or (cur_map_index == 132) or (cur_map_index == 133) or (cur_map_index == 134) or (cur_map_index == 243) or (cur_map_index == 244)) then begin
+                if ((CUR_MAP_ENCDOCK) or (CUR_MAP_ENCDET) or (CUR_MAP_ENCFITE) or (CUR_MAP_ENCGD) or (CUR_MAP_ENCPRES) or (CUR_MAP_ENCRCTR) or (CUR_MAP_ENCTRP) or (CUR_MAP_ENCVERT) or (CUR_MAP_ENCFT2)) then begin
                     current_town := "Enclave";
                 end
-                if ((cur_map_index == 238) or (cur_map_index == 229) or (cur_map_index == 240)) then begin
+                if ((CUR_MAP_BROHDENT) or (CUR_MAP_CITYCH3) or (CUR_MAP_BROHD34)) then begin
                     current_town := "BoS Bunker";
                 end
-                if (cur_map_index == 241) then begin
+                if (CUR_MAP_BRHDHLP) then begin
                     current_town := "BoS Help";
                 end
-                if ((cur_map_index == 242) or (cur_map_index == 151)) then begin
+                if ((CUR_MAP_EPAENT) or (CUR_MAP_EPAX)) then begin
                     current_town := "BOS Facility";
                 end
-                if (cur_map_index == 96) then begin
+                if (CUR_MAP_RNDWHALE) then begin
                     current_town := "Special Whale";
                 end
-                if (cur_map_index == 97) then begin
+                if (CUR_MAP_RNDTINWD) then begin
                     current_town := "Special Woodsman";
                 end
-                if (cur_map_index == 98) then begin
+                if (CUR_MAP_RNDBHEAD) then begin
                     current_town := "Special Head";
                 end
-                if (cur_map_index == 99) then begin
+                if (CUR_MAP_RNDSHUTL) then begin
                     current_town := "Special Shuttle";
                 end
-                if (cur_map_index == 100) then begin
+                if (CUR_MAP_RNDUVILG) then begin
                     current_town := "Special Unwashed";
                 end
-                if (cur_map_index == 101) then begin
+                if (CUR_MAP_RNDBRIDG) then begin
                     current_town := "Special Bridge";
                 end
-                if (cur_map_index == 102) then begin
+                if (CUR_MAP_RNDCAFE) then begin
                     current_town := "Special Cafe";
                 end
-                if (cur_map_index == 103) then begin
+                if (CUR_MAP_RNDHOLY1) then begin
                     current_town := "Special Holy 1";
                 end
-                if (cur_map_index == 104) then begin
+                if (CUR_MAP_RNDHOLY2) then begin
                     current_town := "Special Holy 2";
                 end
-                if (cur_map_index == 105) then begin
+                if (CUR_MAP_RNDFORVR) then begin
                     current_town := "Special Guardian";
                 end
-                if (cur_map_index == 106) then begin
+                if (CUR_MAP_RNDTOXIC) then begin
                     current_town := "Special Toxic";
                 end
-                if (cur_map_index == 107) then begin
+                if (CUR_MAP_RNDPARIH) then begin
                     current_town := "Special Pariah";
                 end
-                if (cur_map_index == 108) then begin
+                if (CUR_MAP_RNDEXCOW) then begin
                     current_town := "Special Brahmin";
                 end
-                if (cur_map_index == 164) then begin
+                if (CUR_MAP_RNDPOSTM) then begin
                     current_town := "Special Postman";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvator";
                 end
-                if (cur_map_index == 216) then begin
+                if (CUR_MAP_RNDMSTR) then begin
                     current_town := "Dead Soldiers of Master Army";
                 end
-                if ((cur_map_index == 95) or (cur_map_index == 94)) then begin
+                if ((CUR_MAP_BHRNDMNT) or (CUR_MAP_BHRNDDST)) then begin
                     current_town := "Caravan Encounters";
                 end
-                if (cur_map_index == 149) then begin
+                if (CUR_MAP_GAMMOVIE) then begin
                     current_town := "In Game Movie";
                 end
-                if (cur_map_index == 150) then begin
+                if (CUR_MAP_RNDBESS) then begin
                     current_town := "Bess Dead";
                 end
-                if ((cur_map_index == 152) or (cur_map_index == 159)) then begin
+                if ((CUR_MAP_RNDBD) or (CUR_MAP_RNDBD)) then begin
                     current_town := "DeathClaw Encounters";
                 end
-                if ((cur_map_index == 0) or (cur_map_index == 1) or (cur_map_index == 2) or (cur_map_index == 81) or (cur_map_index == 82) or (cur_map_index == 83) or (cur_map_index == 84) or (cur_map_index == 113) or (cur_map_index == 114) or (cur_map_index == 115) or (cur_map_index == 116) or (cur_map_index == 117)) then begin
+                if ((CUR_MAP_DESERT1) or (CUR_MAP_DESERT2) or (CUR_MAP_DESERT3) or (CUR_MAP_DESERT4) or (CUR_MAP_DESERT5) or (CUR_MAP_DESERT6) or (CUR_MAP_DESERT7) or (CUR_MAP_DESERT213) or (CUR_MAP_DESERT214) or (CUR_MAP_DESERT215) or (CUR_MAP_DESERT216) or (CUR_MAP_DESERT217)) then begin
                     current_town := "Random Encounter Desert";
                 end
-                if ((cur_map_index == 74) or (cur_map_index == 75) or (cur_map_index == 121) or (cur_map_index == 122) or (cur_map_index == 123) or (cur_map_index == 124)) then begin
+                if ((CUR_MAP_MOUNTN1) or (CUR_MAP_MOUNTN2) or (CUR_MAP_MOUNTN3) or (CUR_MAP_MOUNTN4) or (CUR_MAP_MOUNTN5) or (CUR_MAP_MOUNTN6)) then begin
                     current_town := "Random Encounter Mountain";
                 end
-                if ((cur_map_index == 68) or (cur_map_index == 125) or (cur_map_index == 141) or (cur_map_index == 142) or (cur_map_index == 143) or (cur_map_index == 144) or (cur_map_index == 145) or (cur_map_index == 146)) then begin
+                if ((CUR_MAP_CITY1) or (CUR_MAP_CITY2) or (CUR_MAP_CITY3) or (CUR_MAP_CITY4) or (CUR_MAP_CITY5) or (CUR_MAP_CITY6) or (CUR_MAP_CITY7) or (CUR_MAP_CITY8)) then begin
                     current_town := "Random Encounter City";
                 end
-                if ((cur_map_index == 76) or (cur_map_index == 77) or (cur_map_index == 85) or (cur_map_index == 86) or (cur_map_index == 87) or (cur_map_index == 88) or (cur_map_index == 89) or (cur_map_index == 90) or (cur_map_index == 91) or (cur_map_index == 110) or (cur_map_index == 111) or (cur_map_index == 112)) then begin
+                if ((CUR_MAP_COAST1) or (CUR_MAP_COAST2) or (CUR_MAP_COAST3) or (CUR_MAP_COAST4) or (CUR_MAP_COAST5) or (CUR_MAP_COAST6) or (CUR_MAP_COAST7) or (CUR_MAP_COAST8) or (CUR_MAP_COAST9) or (CUR_MAP_COAST10) or (CUR_MAP_COAST11) or (CUR_MAP_07DESERT)) then begin
                     current_town := "Random Encounter Coast";
                 end
-                if ((cur_map_index == 69) or (cur_map_index == 70) or (cur_map_index == 71) or (cur_map_index == 72) or (cur_map_index == 73) or (cur_map_index == 80) or (cur_map_index == 119) or (cur_map_index == 120)) then begin
+                if ((CUR_MAP_CAVE0) or (CUR_MAP_CAVE1) or (CUR_MAP_CAVE2) or (CUR_MAP_CAVE3) or (CUR_MAP_CAVE4) or (CUR_MAP_CAVE5) or (CUR_MAP_CAVE6) or (CUR_MAP_CAVE7)) then begin
                     current_town := "Random Encounter Cavern";
                 end
                 if ((current_town == "Arroyo") or (current_town == "Klamath") or (current_town == "Klamath Toxic Caves") or (current_town == "Mad Dog Area")) then begin
@@ -903,7 +903,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                restock_obj := create_object_sid(805, 0, 0, -1);
+                                restock_obj := create_object(805, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                             end
                             else begin
@@ -916,17 +916,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -944,7 +944,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                            restock_obj := create_object_sid(805, 0, 0, -1);
+                            restock_obj := create_object(805, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                         end
                         else begin
@@ -957,17 +957,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -986,7 +986,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                restock_obj := create_object_sid(103, 0, 0, -1);
+                                restock_obj := create_object(103, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                             end
                             else begin
@@ -999,17 +999,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1027,7 +1027,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                            restock_obj := create_object_sid(103, 0, 0, -1);
+                            restock_obj := create_object(103, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                         end
                         else begin
@@ -1040,17 +1040,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1069,7 +1069,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                restock_obj := create_object_sid(81, 0, 0, -1);
+                                restock_obj := create_object(81, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                             end
                             else begin
@@ -1082,17 +1082,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1110,7 +1110,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                            restock_obj := create_object_sid(81, 0, 0, -1);
+                            restock_obj := create_object(81, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                         end
                         else begin
@@ -1123,17 +1123,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1152,7 +1152,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                restock_obj := create_object_sid(318, 0, 0, -1);
+                                restock_obj := create_object(318, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                             end
                             else begin
@@ -1165,17 +1165,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1193,7 +1193,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                            restock_obj := create_object_sid(318, 0, 0, -1);
+                            restock_obj := create_object(318, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                         end
                         else begin
@@ -1206,17 +1206,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1235,7 +1235,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                restock_obj := create_object_sid(71, 0, 0, -1);
+                                restock_obj := create_object(71, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                             end
                             else begin
@@ -1248,17 +1248,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1276,7 +1276,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                            restock_obj := create_object_sid(71, 0, 0, -1);
+                            restock_obj := create_object(71, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                         end
                         else begin
@@ -1289,17 +1289,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1318,7 +1318,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                restock_obj := create_object_sid(273, 0, 0, -1);
+                                restock_obj := create_object(273, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                             end
                             else begin
@@ -1331,17 +1331,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1359,7 +1359,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                            restock_obj := create_object_sid(273, 0, 0, -1);
+                            restock_obj := create_object(273, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                         end
                         else begin
@@ -1372,17 +1372,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1401,7 +1401,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                restock_obj := create_object_sid(801, 0, 0, -1);
+                                restock_obj := create_object(801, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                             end
                             else begin
@@ -1414,17 +1414,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1442,7 +1442,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                            restock_obj := create_object_sid(801, 0, 0, -1);
+                            restock_obj := create_object(801, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                         end
                         else begin
@@ -1455,17 +1455,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1487,7 +1487,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
                             if (50 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                    restock_obj := create_object_sid(805, 0, 0, -1);
+                                    restock_obj := create_object(805, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                 end
                                 else begin
@@ -1500,17 +1500,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -1528,7 +1528,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                restock_obj := create_object_sid(805, 0, 0, -1);
+                                restock_obj := create_object(805, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                             end
                             else begin
@@ -1541,17 +1541,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1570,7 +1570,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
                             if (50 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                    restock_obj := create_object_sid(103, 0, 0, -1);
+                                    restock_obj := create_object(103, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                 end
                                 else begin
@@ -1583,17 +1583,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -1611,7 +1611,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                restock_obj := create_object_sid(103, 0, 0, -1);
+                                restock_obj := create_object(103, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                             end
                             else begin
@@ -1624,17 +1624,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1653,7 +1653,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
                             if (50 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                    restock_obj := create_object_sid(81, 0, 0, -1);
+                                    restock_obj := create_object(81, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                 end
                                 else begin
@@ -1666,17 +1666,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -1694,7 +1694,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                restock_obj := create_object_sid(81, 0, 0, -1);
+                                restock_obj := create_object(81, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                             end
                             else begin
@@ -1707,17 +1707,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1736,7 +1736,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
                             if (50 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                    restock_obj := create_object_sid(318, 0, 0, -1);
+                                    restock_obj := create_object(318, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                 end
                                 else begin
@@ -1749,17 +1749,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -1777,7 +1777,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                restock_obj := create_object_sid(318, 0, 0, -1);
+                                restock_obj := create_object(318, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                             end
                             else begin
@@ -1790,17 +1790,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1819,7 +1819,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
                             if (50 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                    restock_obj := create_object_sid(71, 0, 0, -1);
+                                    restock_obj := create_object(71, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                 end
                                 else begin
@@ -1832,17 +1832,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -1860,7 +1860,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                restock_obj := create_object_sid(71, 0, 0, -1);
+                                restock_obj := create_object(71, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                             end
                             else begin
@@ -1873,17 +1873,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1902,7 +1902,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
                             if (50 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                    restock_obj := create_object_sid(273, 0, 0, -1);
+                                    restock_obj := create_object(273, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                 end
                                 else begin
@@ -1915,17 +1915,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -1943,7 +1943,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                restock_obj := create_object_sid(273, 0, 0, -1);
+                                restock_obj := create_object(273, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                             end
                             else begin
@@ -1956,17 +1956,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1985,7 +1985,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
                             if (50 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                    restock_obj := create_object_sid(801, 0, 0, -1);
+                                    restock_obj := create_object(801, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                 end
                                 else begin
@@ -1998,17 +1998,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2026,7 +2026,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                restock_obj := create_object_sid(801, 0, 0, -1);
+                                restock_obj := create_object(801, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                             end
                             else begin
@@ -2039,17 +2039,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2068,7 +2068,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
                             if (50 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                    restock_obj := create_object_sid(802, 0, 0, -1);
+                                    restock_obj := create_object(802, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                 end
                                 else begin
@@ -2081,17 +2081,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2109,7 +2109,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                restock_obj := create_object_sid(802, 0, 0, -1);
+                                restock_obj := create_object(802, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                             end
                             else begin
@@ -2122,17 +2122,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2154,7 +2154,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
                                 if (50 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                        restock_obj := create_object_sid(805, 0, 0, -1);
+                                        restock_obj := create_object(805, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                     end
                                     else begin
@@ -2167,17 +2167,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2195,7 +2195,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                    restock_obj := create_object_sid(805, 0, 0, -1);
+                                    restock_obj := create_object(805, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                 end
                                 else begin
@@ -2208,17 +2208,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2237,7 +2237,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
                                 if (50 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                        restock_obj := create_object_sid(103, 0, 0, -1);
+                                        restock_obj := create_object(103, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                     end
                                     else begin
@@ -2250,17 +2250,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2278,7 +2278,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                    restock_obj := create_object_sid(103, 0, 0, -1);
+                                    restock_obj := create_object(103, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                 end
                                 else begin
@@ -2291,17 +2291,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2320,7 +2320,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
                                 if (50 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                        restock_obj := create_object_sid(81, 0, 0, -1);
+                                        restock_obj := create_object(81, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                     end
                                     else begin
@@ -2333,17 +2333,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2361,7 +2361,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                    restock_obj := create_object_sid(81, 0, 0, -1);
+                                    restock_obj := create_object(81, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                 end
                                 else begin
@@ -2374,17 +2374,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2403,7 +2403,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
                                 if (50 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                        restock_obj := create_object_sid(318, 0, 0, -1);
+                                        restock_obj := create_object(318, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                     end
                                     else begin
@@ -2416,17 +2416,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2444,7 +2444,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                    restock_obj := create_object_sid(318, 0, 0, -1);
+                                    restock_obj := create_object(318, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                 end
                                 else begin
@@ -2457,17 +2457,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2486,7 +2486,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
                                 if (50 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                        restock_obj := create_object_sid(71, 0, 0, -1);
+                                        restock_obj := create_object(71, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                     end
                                     else begin
@@ -2499,17 +2499,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2527,7 +2527,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                    restock_obj := create_object_sid(71, 0, 0, -1);
+                                    restock_obj := create_object(71, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                 end
                                 else begin
@@ -2540,17 +2540,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2569,7 +2569,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
                                 if (50 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                        restock_obj := create_object_sid(273, 0, 0, -1);
+                                        restock_obj := create_object(273, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                     end
                                     else begin
@@ -2582,17 +2582,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2610,7 +2610,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                    restock_obj := create_object_sid(273, 0, 0, -1);
+                                    restock_obj := create_object(273, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                 end
                                 else begin
@@ -2623,17 +2623,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2652,7 +2652,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
                                 if (50 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                        restock_obj := create_object_sid(801, 0, 0, -1);
+                                        restock_obj := create_object(801, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                     end
                                     else begin
@@ -2665,17 +2665,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2693,7 +2693,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                    restock_obj := create_object_sid(801, 0, 0, -1);
+                                    restock_obj := create_object(801, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                 end
                                 else begin
@@ -2706,17 +2706,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2735,7 +2735,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
                                 if (50 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                        restock_obj := create_object_sid(802, 0, 0, -1);
+                                        restock_obj := create_object(802, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                     end
                                     else begin
@@ -2748,17 +2748,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2776,7 +2776,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                    restock_obj := create_object_sid(802, 0, 0, -1);
+                                    restock_obj := create_object(802, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                 end
                                 else begin
@@ -2789,17 +2789,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2821,7 +2821,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                            restock_obj := create_object_sid(805, 0, 0, -1);
+                                            restock_obj := create_object(805, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                         end
                                         else begin
@@ -2834,17 +2834,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -2862,7 +2862,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                        restock_obj := create_object_sid(805, 0, 0, -1);
+                                        restock_obj := create_object(805, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                     end
                                     else begin
@@ -2875,17 +2875,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2904,7 +2904,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                            restock_obj := create_object_sid(103, 0, 0, -1);
+                                            restock_obj := create_object(103, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                         end
                                         else begin
@@ -2917,17 +2917,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -2945,7 +2945,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                        restock_obj := create_object_sid(103, 0, 0, -1);
+                                        restock_obj := create_object(103, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                     end
                                     else begin
@@ -2958,17 +2958,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2987,7 +2987,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                            restock_obj := create_object_sid(81, 0, 0, -1);
+                                            restock_obj := create_object(81, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                         end
                                         else begin
@@ -3000,17 +3000,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3028,7 +3028,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                        restock_obj := create_object_sid(81, 0, 0, -1);
+                                        restock_obj := create_object(81, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                     end
                                     else begin
@@ -3041,17 +3041,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -3070,7 +3070,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                            restock_obj := create_object_sid(318, 0, 0, -1);
+                                            restock_obj := create_object(318, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                         end
                                         else begin
@@ -3083,17 +3083,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3111,7 +3111,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                        restock_obj := create_object_sid(318, 0, 0, -1);
+                                        restock_obj := create_object(318, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                     end
                                     else begin
@@ -3124,17 +3124,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -3153,7 +3153,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                            restock_obj := create_object_sid(71, 0, 0, -1);
+                                            restock_obj := create_object(71, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                         end
                                         else begin
@@ -3166,17 +3166,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3194,7 +3194,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                        restock_obj := create_object_sid(71, 0, 0, -1);
+                                        restock_obj := create_object(71, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                     end
                                     else begin
@@ -3207,17 +3207,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -3236,7 +3236,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                            restock_obj := create_object_sid(273, 0, 0, -1);
+                                            restock_obj := create_object(273, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                         end
                                         else begin
@@ -3249,17 +3249,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3277,7 +3277,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                        restock_obj := create_object_sid(273, 0, 0, -1);
+                                        restock_obj := create_object(273, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                     end
                                     else begin
@@ -3290,17 +3290,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -3319,7 +3319,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                            restock_obj := create_object_sid(801, 0, 0, -1);
+                                            restock_obj := create_object(801, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                         end
                                         else begin
@@ -3332,17 +3332,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3360,7 +3360,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                        restock_obj := create_object_sid(801, 0, 0, -1);
+                                        restock_obj := create_object(801, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                     end
                                     else begin
@@ -3373,17 +3373,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -3402,7 +3402,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                            restock_obj := create_object_sid(802, 0, 0, -1);
+                                            restock_obj := create_object(802, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                         end
                                         else begin
@@ -3415,17 +3415,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3443,7 +3443,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                        restock_obj := create_object_sid(802, 0, 0, -1);
+                                        restock_obj := create_object(802, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                     end
                                     else begin
@@ -3456,17 +3456,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -3485,7 +3485,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
                                     if (50 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                                            restock_obj := create_object_sid(40, 0, 0, -1);
+                                            restock_obj := create_object(40, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                                         end
                                         else begin
@@ -3498,17 +3498,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3526,7 +3526,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                                        restock_obj := create_object_sid(40, 0, 0, -1);
+                                        restock_obj := create_object(40, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                                     end
                                     else begin
@@ -3539,17 +3539,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -3571,7 +3571,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                                restock_obj := create_object_sid(805, 0, 0, -1);
+                                                restock_obj := create_object(805, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                             end
                                             else begin
@@ -3584,17 +3584,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -3612,7 +3612,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                            restock_obj := create_object_sid(805, 0, 0, -1);
+                                            restock_obj := create_object(805, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                         end
                                         else begin
@@ -3625,17 +3625,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3654,7 +3654,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                                restock_obj := create_object_sid(103, 0, 0, -1);
+                                                restock_obj := create_object(103, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                             end
                                             else begin
@@ -3667,17 +3667,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -3695,7 +3695,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                            restock_obj := create_object_sid(103, 0, 0, -1);
+                                            restock_obj := create_object(103, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                         end
                                         else begin
@@ -3708,17 +3708,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3737,7 +3737,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                                restock_obj := create_object_sid(81, 0, 0, -1);
+                                                restock_obj := create_object(81, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                             end
                                             else begin
@@ -3750,17 +3750,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -3778,7 +3778,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                            restock_obj := create_object_sid(81, 0, 0, -1);
+                                            restock_obj := create_object(81, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                         end
                                         else begin
@@ -3791,17 +3791,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3820,7 +3820,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                                restock_obj := create_object_sid(318, 0, 0, -1);
+                                                restock_obj := create_object(318, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                             end
                                             else begin
@@ -3833,17 +3833,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -3861,7 +3861,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                            restock_obj := create_object_sid(318, 0, 0, -1);
+                                            restock_obj := create_object(318, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                         end
                                         else begin
@@ -3874,17 +3874,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3903,7 +3903,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                                restock_obj := create_object_sid(71, 0, 0, -1);
+                                                restock_obj := create_object(71, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                             end
                                             else begin
@@ -3916,17 +3916,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -3944,7 +3944,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                            restock_obj := create_object_sid(71, 0, 0, -1);
+                                            restock_obj := create_object(71, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                         end
                                         else begin
@@ -3957,17 +3957,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3986,7 +3986,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                                restock_obj := create_object_sid(273, 0, 0, -1);
+                                                restock_obj := create_object(273, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                             end
                                             else begin
@@ -3999,17 +3999,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4027,7 +4027,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                            restock_obj := create_object_sid(273, 0, 0, -1);
+                                            restock_obj := create_object(273, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                         end
                                         else begin
@@ -4040,17 +4040,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -4069,7 +4069,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                                restock_obj := create_object_sid(801, 0, 0, -1);
+                                                restock_obj := create_object(801, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                             end
                                             else begin
@@ -4082,17 +4082,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4110,7 +4110,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                            restock_obj := create_object_sid(801, 0, 0, -1);
+                                            restock_obj := create_object(801, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                         end
                                         else begin
@@ -4123,17 +4123,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -4152,7 +4152,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                                restock_obj := create_object_sid(802, 0, 0, -1);
+                                                restock_obj := create_object(802, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                             end
                                             else begin
@@ -4165,17 +4165,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4193,7 +4193,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                            restock_obj := create_object_sid(802, 0, 0, -1);
+                                            restock_obj := create_object(802, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                         end
                                         else begin
@@ -4206,17 +4206,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -4235,7 +4235,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
                                         if (50 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                                                restock_obj := create_object_sid(40, 0, 0, -1);
+                                                restock_obj := create_object(40, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                                             end
                                             else begin
@@ -4248,17 +4248,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4276,7 +4276,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                                            restock_obj := create_object_sid(40, 0, 0, -1);
+                                            restock_obj := create_object(40, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                                         end
                                         else begin
@@ -4289,17 +4289,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -4321,7 +4321,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(805, 0, 0, -1);
+                                                    restock_obj := create_object(805, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                                 end
                                                 else begin
@@ -4334,17 +4334,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4362,7 +4362,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 805) < restock_amt) then begin
-                                                restock_obj := create_object_sid(805, 0, 0, -1);
+                                                restock_obj := create_object(805, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 805));
                                             end
                                             else begin
@@ -4375,17 +4375,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 805);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 805);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4404,7 +4404,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(103, 0, 0, -1);
+                                                    restock_obj := create_object(103, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                                 end
                                                 else begin
@@ -4417,17 +4417,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4445,7 +4445,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 103) < restock_amt) then begin
-                                                restock_obj := create_object_sid(103, 0, 0, -1);
+                                                restock_obj := create_object(103, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 103));
                                             end
                                             else begin
@@ -4458,17 +4458,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 103);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 103);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4487,7 +4487,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(81, 0, 0, -1);
+                                                    restock_obj := create_object(81, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                                 end
                                                 else begin
@@ -4500,17 +4500,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4528,7 +4528,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 81) < restock_amt) then begin
-                                                restock_obj := create_object_sid(81, 0, 0, -1);
+                                                restock_obj := create_object(81, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 81));
                                             end
                                             else begin
@@ -4541,17 +4541,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 81);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 81);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4570,7 +4570,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(318, 0, 0, -1);
+                                                    restock_obj := create_object(318, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                                 end
                                                 else begin
@@ -4583,17 +4583,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4611,7 +4611,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 318) < restock_amt) then begin
-                                                restock_obj := create_object_sid(318, 0, 0, -1);
+                                                restock_obj := create_object(318, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 318));
                                             end
                                             else begin
@@ -4624,17 +4624,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 318);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 318);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4653,7 +4653,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(71, 0, 0, -1);
+                                                    restock_obj := create_object(71, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                                 end
                                                 else begin
@@ -4666,17 +4666,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4694,7 +4694,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                                restock_obj := create_object_sid(71, 0, 0, -1);
+                                                restock_obj := create_object(71, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                                             end
                                             else begin
@@ -4707,17 +4707,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4736,7 +4736,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(273, 0, 0, -1);
+                                                    restock_obj := create_object(273, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                                 end
                                                 else begin
@@ -4749,17 +4749,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4777,7 +4777,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                                restock_obj := create_object_sid(273, 0, 0, -1);
+                                                restock_obj := create_object(273, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                                             end
                                             else begin
@@ -4790,17 +4790,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4819,7 +4819,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(801, 0, 0, -1);
+                                                    restock_obj := create_object(801, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                                 end
                                                 else begin
@@ -4832,17 +4832,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4860,7 +4860,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 801) < restock_amt) then begin
-                                                restock_obj := create_object_sid(801, 0, 0, -1);
+                                                restock_obj := create_object(801, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 801));
                                             end
                                             else begin
@@ -4873,17 +4873,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 801);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 801);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4902,7 +4902,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(802, 0, 0, -1);
+                                                    restock_obj := create_object(802, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                                 end
                                                 else begin
@@ -4915,17 +4915,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4943,7 +4943,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 802) < restock_amt) then begin
-                                                restock_obj := create_object_sid(802, 0, 0, -1);
+                                                restock_obj := create_object(802, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 802));
                                             end
                                             else begin
@@ -4956,17 +4956,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 802);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 802);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4985,7 +4985,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(40, 0, 0, -1);
+                                                    restock_obj := create_object(40, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                                                 end
                                                 else begin
@@ -4998,17 +4998,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -5026,7 +5026,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                                                restock_obj := create_object_sid(40, 0, 0, -1);
+                                                restock_obj := create_object(40, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                                             end
                                             else begin
@@ -5039,17 +5039,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -5068,7 +5068,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
                                             if (50 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(144, 0, 0, -1);
+                                                    restock_obj := create_object(144, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 144));
                                                 end
                                                 else begin
@@ -5081,17 +5081,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 144);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 144);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -5109,7 +5109,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
-                                                restock_obj := create_object_sid(144, 0, 0, -1);
+                                                restock_obj := create_object(144, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 144));
                                             end
                                             else begin
@@ -5122,17 +5122,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 144);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 144);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -5153,214 +5153,214 @@ begin
                         end
                     end
                 end
-                if ((cur_map_index == 3) or (cur_map_index == 4) or (cur_map_index == 35) or (cur_map_index == 5)) then begin
+                if ((CUR_MAP_ARCAVES) or (CUR_MAP_ARVILLAG) or (CUR_MAP_ARCAVES5) or (CUR_MAP_ARBRIDGE)) then begin
                     current_town := "Arroyo";
                 end
-                if ((cur_map_index == 9) or (cur_map_index == 10) or (cur_map_index == 11) or (cur_map_index == 13) or (cur_map_index == 14) or (cur_map_index == 48) or (cur_map_index == 161)) then begin
+                if ((CUR_MAP_KLADWTWN) or (CUR_MAP_KLAMALL) or (CUR_MAP_KLARATCV) or (CUR_MAP_KLATRAP) or (CUR_MAP_KLAGRAZ) or (CUR_MAP_KLACANYN) or (CUR_MAP_KLACVENT)) then begin
                     current_town := "Klamath";
                 end
-                if (cur_map_index == 12) then begin
+                if (CUR_MAP_KLATOXCV) then begin
                     current_town := "Klamath Toxic Caves";
                 end
-                if (cur_map_index == 158) then begin
+                if (CUR_MAP_RNDMDDG) then begin
                     current_town := "Mad Dog Area";
                 end
-                if ((cur_map_index == 6) or (cur_map_index == 7) or (cur_map_index == 8)) then begin
+                if ((CUR_MAP_DENBUS1) or (CUR_MAP_DENBUS2) or (CUR_MAP_DENRES1)) then begin
                     current_town := "Den";
                 end
-                if ((cur_map_index == 231) or (cur_map_index == 253) or (cur_map_index == 254) or (cur_map_index == 255)) then begin
+                if ((CUR_MAP_PRIMIT) or (CUR_MAP_TRIBE02) or (CUR_MAP_SLVCAMP) or (CUR_MAP_TRIBE2)) then begin
                     current_town := "Primitive Tribes";
                 end
-                if (cur_map_index == 163) then begin
+                if (CUR_MAP_TRIBE01) then begin
                     current_town := "Primitive Tribe";
                 end
-                if (cur_map_index == 52) then begin
+                if (CUR_MAP_DNSLVRUN) then begin
                     current_town := "Den Slave Run";
                 end
-                if (cur_map_index == 160) then begin
+                if (CUR_MAP_JENFARM7) then begin
                     current_town := "Jennings Farm Area";
                 end
-                if (cur_map_index == 156) then begin
+                if (CUR_MAP_TRUCK) then begin
                     current_town := "Truck";
                 end
-                if (cur_map_index == 162) then begin
+                if (CUR_MAP_SCRAPT) then begin
                     current_town := "Scraptown";
                 end
-                if ((cur_map_index == 18) or (cur_map_index == 19) or (cur_map_index == 20) or (cur_map_index == 21) or (cur_map_index == 22) or (cur_map_index == 23)) then begin
+                if ((CUR_MAP_MODMAIN) or (CUR_MAP_MODINN) or (CUR_MAP_MODBRAH) or (CUR_MAP_MODGARD) or (CUR_MAP_MODSHIT) or (CUR_MAP_MODWELL)) then begin
                     current_town := "Modoc";
                 end
-                if (cur_map_index == 202) then begin
+                if (CUR_MAP_CRISIENT) then begin
                     current_town := "Vault 23";
                 end
-                if ((cur_map_index == 24) or (cur_map_index == 25) or (cur_map_index == 26)) then begin
+                if ((CUR_MAP_GSTFARM) or (CUR_MAP_GSTCAV1) or (CUR_MAP_GSTCAV2)) then begin
                     current_town := "Ghost Farm";
                 end
-                if (cur_map_index == 223) then begin
+                if (CUR_MAP_MODOCT) then begin
                     current_town := "Modoc Thieves Guild";
                 end
-                if (cur_map_index == 224) then begin
+                if (CUR_MAP_MODOCT2) then begin
                     current_town := "Salvatore's Gun Stash";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvatore";
                 end
-                if (cur_map_index == 226) then begin
+                if (CUR_MAP_MODOCT4) then begin
                     current_town := "Salvatore Meeting";
                 end
-                if ((cur_map_index == 31) or (cur_map_index == 32) or (cur_map_index == 33) or (cur_map_index == 34)) then begin
+                if ((CUR_MAP_GECKSETL) or (CUR_MAP_GECKPWPL) or (CUR_MAP_GECKJUNK) or (CUR_MAP_GECKTUNL)) then begin
                     current_town := "Gecko";
                 end
-                if ((cur_map_index == 15) or (cur_map_index == 16) or (cur_map_index == 17) or (cur_map_index == 30)) then begin
+                if ((CUR_MAP_VCTYCTYD) or (CUR_MAP_VCTYDWTN) or (CUR_MAP_VCTYCOCL) or (CUR_MAP_VCTYVLT)) then begin
                     current_town := "Vault City";
                 end
-                if ((cur_map_index == 92) or (cur_map_index == 93)) then begin
+                if ((CUR_MAP_RAIDERS1) or (CUR_MAP_RAIDERS2)) then begin
                     current_town := "Raiders";
                 end
-                if ((cur_map_index == 78) or (cur_map_index == 79)) then begin
+                if ((CUR_MAP_BROKEN1) or (CUR_MAP_BROKEN2)) then begin
                     current_town := "Broken Hills";
                 end
-                if ((cur_map_index == 64) or (cur_map_index == 62) or (cur_map_index == 63) or (cur_map_index == 65) or (cur_map_index == 66) or (cur_map_index == 67)) then begin
+                if ((CUR_MAP_REDDOWN) or (CUR_MAP_REDWAME) or (CUR_MAP_REDWAN1) or (CUR_MAP_REDMENT) or (CUR_MAP_REDDTUN) or (CUR_MAP_REDMTUN)) then begin
                     current_town := "Redding";
                 end
-                if ((cur_map_index == 54) or (cur_map_index == 55) or (cur_map_index == 56) or (cur_map_index == 57) or (cur_map_index == 58) or (cur_map_index == 61) or (cur_map_index == 147)) then begin
+                if ((CUR_MAP_NEWR1) or (CUR_MAP_NEWR2) or (CUR_MAP_NEWR3) or (CUR_MAP_NEWR4) or (CUR_MAP_NEWRCS) or (CUR_MAP_NEWRBA) or (CUR_MAP_NEWRVB)) then begin
                     current_town := "New Reno";
                 end
-                if ((cur_map_index == 195) or (cur_map_index == 197) or (cur_map_index == 235) or (cur_map_index == 196)) then begin
+                if ((CUR_MAP_LARS1) or (CUR_MAP_LARS3) or (CUR_MAP_LARSSCRP) or (CUR_MAP_LARS2)) then begin
                     current_town := "Lars-City";
                 end
-                if (cur_map_index == 232) then begin
+                if (CUR_MAP_CRSNMAIN) then begin
                     current_town := "Lars-City Carson";
                 end
-                if (cur_map_index == 155) then begin
+                if (CUR_MAP_ABBEY) then begin
                     current_town := "Abbey";
                 end
-                if ((cur_map_index == 153) or (cur_map_index == 154)) then begin
+                if ((CUR_MAP_EPAMAIN) or (CUR_MAP_EPAWRHSE)) then begin
                     current_town := "EPA";
                 end
-                if ((cur_map_index == 220) or (cur_map_index == 221)) then begin
+                if ((CUR_MAP_COLLY) or (CUR_MAP_COLLY1)) then begin
                     current_town := "Collyweb";
                 end
-                if (cur_map_index == 59) then begin
+                if (CUR_MAP_NEWRGO) then begin
                     current_town := "Golgotha";
                 end
-                if (cur_map_index == 60) then begin
+                if (CUR_MAP_NEWRST) then begin
                     current_town := "Reno Stables";
                 end
-                if ((cur_map_index == 27) or (cur_map_index == 28) or (cur_map_index == 29)) then begin
+                if ((CUR_MAP_DEPOLV1) or (CUR_MAP_DEPOLVA) or (CUR_MAP_DEPOLVB)) then begin
                     current_town := "Sierra Army Base";
                 end
-                if ((cur_map_index == 46) or (cur_map_index == 43) or (cur_map_index == 42) or (cur_map_index == 44) or (cur_map_index == 45)) then begin
+                if ((CUR_MAP_NCRENT) or (CUR_MAP_NCR2) or (CUR_MAP_NCR1) or (CUR_MAP_NCR3) or (CUR_MAP_NCR4)) then begin
                     current_town := "NCR";
                 end
-                if (cur_map_index == 157) then begin
+                if (CUR_MAP_B21) then begin
                     current_town := "B21";
                 end
-                if ((cur_map_index == 37) or (cur_map_index == 38) or (cur_map_index == 36) or (cur_map_index == 39)) then begin
+                if ((CUR_MAP_V15ENT) or (CUR_MAP_V15ENTB) or (CUR_MAP_VAULT15) or (CUR_MAP_V15SENT)) then begin
                     current_town := "Vault 15";
                 end
-                if ((cur_map_index == 40) or (cur_map_index == 41)) then begin
+                if ((CUR_MAP_VAULT13) or (CUR_MAP_V13ENT)) then begin
                     current_town := "Vault 13";
                 end
-                if ((cur_map_index == 49) or (cur_map_index == 50) or (cur_map_index == 51)) then begin
+                if ((CUR_MAP_MBASE12) or (CUR_MAP_MBASE34) or (CUR_MAP_MBCLOSE)) then begin
                     current_town := "Military Base";
                 end
-                if ((cur_map_index == 137) or (cur_map_index == 136) or (cur_map_index == 135) or (cur_map_index == 138) or (cur_map_index == 139) or (cur_map_index == 140) or (cur_map_index == 148)) then begin
+                if ((CUR_MAP_SFCHINA) or (CUR_MAP_SFDOCK) or (CUR_MAP_SFTANKER) or (CUR_MAP_SFSHUTL1) or (CUR_MAP_SFSHUTL2) or (CUR_MAP_SFELRONB) or (CUR_MAP_SFCHINA2)) then begin
                     current_town := "San Francisco";
                 end
-                if ((cur_map_index == 213) or (cur_map_index == 214) or (cur_map_index == 215) or (cur_map_index == 188)) then begin
+                if ((CUR_MAP_BROHDENT1) or (CUR_MAP_BROHD121) or (CUR_MAP_BROHD341) or (CUR_MAP_BROHD1K)) then begin
                     current_town := "Brohdent";
                 end
-                if ((cur_map_index == 218) or (cur_map_index == 217) or (cur_map_index == 219)) then begin
+                if ((CUR_MAP_V14ENT) or (CUR_MAP_VAULT14) or (CUR_MAP_VAULT14B)) then begin
                     current_town := "Vault 14";
                 end
-                if (cur_map_index == 109) then begin
+                if (CUR_MAP_NAVARRO) then begin
                     current_town := "Navarro";
                 end
-                if ((cur_map_index == 129) or (cur_map_index == 128) or (cur_map_index == 130) or (cur_map_index == 131) or (cur_map_index == 132) or (cur_map_index == 133) or (cur_map_index == 134) or (cur_map_index == 243) or (cur_map_index == 244)) then begin
+                if ((CUR_MAP_ENCDOCK) or (CUR_MAP_ENCDET) or (CUR_MAP_ENCFITE) or (CUR_MAP_ENCGD) or (CUR_MAP_ENCPRES) or (CUR_MAP_ENCRCTR) or (CUR_MAP_ENCTRP) or (CUR_MAP_ENCVERT) or (CUR_MAP_ENCFT2)) then begin
                     current_town := "Enclave";
                 end
-                if ((cur_map_index == 238) or (cur_map_index == 229) or (cur_map_index == 240)) then begin
+                if ((CUR_MAP_BROHDENT) or (CUR_MAP_CITYCH3) or (CUR_MAP_BROHD34)) then begin
                     current_town := "BoS Bunker";
                 end
-                if (cur_map_index == 241) then begin
+                if (CUR_MAP_BRHDHLP) then begin
                     current_town := "BoS Help";
                 end
-                if ((cur_map_index == 242) or (cur_map_index == 151)) then begin
+                if ((CUR_MAP_EPAENT) or (CUR_MAP_EPAX)) then begin
                     current_town := "BOS Facility";
                 end
-                if (cur_map_index == 96) then begin
+                if (CUR_MAP_RNDWHALE) then begin
                     current_town := "Special Whale";
                 end
-                if (cur_map_index == 97) then begin
+                if (CUR_MAP_RNDTINWD) then begin
                     current_town := "Special Woodsman";
                 end
-                if (cur_map_index == 98) then begin
+                if (CUR_MAP_RNDBHEAD) then begin
                     current_town := "Special Head";
                 end
-                if (cur_map_index == 99) then begin
+                if (CUR_MAP_RNDSHUTL) then begin
                     current_town := "Special Shuttle";
                 end
-                if (cur_map_index == 100) then begin
+                if (CUR_MAP_RNDUVILG) then begin
                     current_town := "Special Unwashed";
                 end
-                if (cur_map_index == 101) then begin
+                if (CUR_MAP_RNDBRIDG) then begin
                     current_town := "Special Bridge";
                 end
-                if (cur_map_index == 102) then begin
+                if (CUR_MAP_RNDCAFE) then begin
                     current_town := "Special Cafe";
                 end
-                if (cur_map_index == 103) then begin
+                if (CUR_MAP_RNDHOLY1) then begin
                     current_town := "Special Holy 1";
                 end
-                if (cur_map_index == 104) then begin
+                if (CUR_MAP_RNDHOLY2) then begin
                     current_town := "Special Holy 2";
                 end
-                if (cur_map_index == 105) then begin
+                if (CUR_MAP_RNDFORVR) then begin
                     current_town := "Special Guardian";
                 end
-                if (cur_map_index == 106) then begin
+                if (CUR_MAP_RNDTOXIC) then begin
                     current_town := "Special Toxic";
                 end
-                if (cur_map_index == 107) then begin
+                if (CUR_MAP_RNDPARIH) then begin
                     current_town := "Special Pariah";
                 end
-                if (cur_map_index == 108) then begin
+                if (CUR_MAP_RNDEXCOW) then begin
                     current_town := "Special Brahmin";
                 end
-                if (cur_map_index == 164) then begin
+                if (CUR_MAP_RNDPOSTM) then begin
                     current_town := "Special Postman";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvator";
                 end
-                if (cur_map_index == 216) then begin
+                if (CUR_MAP_RNDMSTR) then begin
                     current_town := "Dead Soldiers of Master Army";
                 end
-                if ((cur_map_index == 95) or (cur_map_index == 94)) then begin
+                if ((CUR_MAP_BHRNDMNT) or (CUR_MAP_BHRNDDST)) then begin
                     current_town := "Caravan Encounters";
                 end
-                if (cur_map_index == 149) then begin
+                if (CUR_MAP_GAMMOVIE) then begin
                     current_town := "In Game Movie";
                 end
-                if (cur_map_index == 150) then begin
+                if (CUR_MAP_RNDBESS) then begin
                     current_town := "Bess Dead";
                 end
-                if ((cur_map_index == 152) or (cur_map_index == 159)) then begin
+                if ((CUR_MAP_RNDBD) or (CUR_MAP_RNDBD)) then begin
                     current_town := "DeathClaw Encounters";
                 end
-                if ((cur_map_index == 0) or (cur_map_index == 1) or (cur_map_index == 2) or (cur_map_index == 81) or (cur_map_index == 82) or (cur_map_index == 83) or (cur_map_index == 84) or (cur_map_index == 113) or (cur_map_index == 114) or (cur_map_index == 115) or (cur_map_index == 116) or (cur_map_index == 117)) then begin
+                if ((CUR_MAP_DESERT1) or (CUR_MAP_DESERT2) or (CUR_MAP_DESERT3) or (CUR_MAP_DESERT4) or (CUR_MAP_DESERT5) or (CUR_MAP_DESERT6) or (CUR_MAP_DESERT7) or (CUR_MAP_DESERT213) or (CUR_MAP_DESERT214) or (CUR_MAP_DESERT215) or (CUR_MAP_DESERT216) or (CUR_MAP_DESERT217)) then begin
                     current_town := "Random Encounter Desert";
                 end
-                if ((cur_map_index == 74) or (cur_map_index == 75) or (cur_map_index == 121) or (cur_map_index == 122) or (cur_map_index == 123) or (cur_map_index == 124)) then begin
+                if ((CUR_MAP_MOUNTN1) or (CUR_MAP_MOUNTN2) or (CUR_MAP_MOUNTN3) or (CUR_MAP_MOUNTN4) or (CUR_MAP_MOUNTN5) or (CUR_MAP_MOUNTN6)) then begin
                     current_town := "Random Encounter Mountain";
                 end
-                if ((cur_map_index == 68) or (cur_map_index == 125) or (cur_map_index == 141) or (cur_map_index == 142) or (cur_map_index == 143) or (cur_map_index == 144) or (cur_map_index == 145) or (cur_map_index == 146)) then begin
+                if ((CUR_MAP_CITY1) or (CUR_MAP_CITY2) or (CUR_MAP_CITY3) or (CUR_MAP_CITY4) or (CUR_MAP_CITY5) or (CUR_MAP_CITY6) or (CUR_MAP_CITY7) or (CUR_MAP_CITY8)) then begin
                     current_town := "Random Encounter City";
                 end
-                if ((cur_map_index == 76) or (cur_map_index == 77) or (cur_map_index == 85) or (cur_map_index == 86) or (cur_map_index == 87) or (cur_map_index == 88) or (cur_map_index == 89) or (cur_map_index == 90) or (cur_map_index == 91) or (cur_map_index == 110) or (cur_map_index == 111) or (cur_map_index == 112)) then begin
+                if ((CUR_MAP_COAST1) or (CUR_MAP_COAST2) or (CUR_MAP_COAST3) or (CUR_MAP_COAST4) or (CUR_MAP_COAST5) or (CUR_MAP_COAST6) or (CUR_MAP_COAST7) or (CUR_MAP_COAST8) or (CUR_MAP_COAST9) or (CUR_MAP_COAST10) or (CUR_MAP_COAST11) or (CUR_MAP_07DESERT)) then begin
                     current_town := "Random Encounter Coast";
                 end
-                if ((cur_map_index == 69) or (cur_map_index == 70) or (cur_map_index == 71) or (cur_map_index == 72) or (cur_map_index == 73) or (cur_map_index == 80) or (cur_map_index == 119) or (cur_map_index == 120)) then begin
+                if ((CUR_MAP_CAVE0) or (CUR_MAP_CAVE1) or (CUR_MAP_CAVE2) or (CUR_MAP_CAVE3) or (CUR_MAP_CAVE4) or (CUR_MAP_CAVE5) or (CUR_MAP_CAVE6) or (CUR_MAP_CAVE7)) then begin
                     current_town := "Random Encounter Cavern";
                 end
                 if ((current_town == "Arroyo") or (current_town == "Klamath") or (current_town == "Klamath Toxic Caves") or (current_town == "Mad Dog Area")) then begin
@@ -5389,7 +5389,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                restock_obj := create_object_sid(41, 0, 0, -1);
+                                restock_obj := create_object(41, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                             end
                             else begin
@@ -5402,17 +5402,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5430,7 +5430,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                            restock_obj := create_object_sid(41, 0, 0, -1);
+                            restock_obj := create_object(41, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                         end
                         else begin
@@ -5443,17 +5443,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5475,7 +5475,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                             if (100 >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                    restock_obj := create_object_sid(41, 0, 0, -1);
+                                    restock_obj := create_object(41, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                 end
                                 else begin
@@ -5488,17 +5488,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -5516,7 +5516,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                restock_obj := create_object_sid(41, 0, 0, -1);
+                                restock_obj := create_object(41, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                             end
                             else begin
@@ -5529,17 +5529,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5561,7 +5561,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                                 if (100 >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                        restock_obj := create_object_sid(41, 0, 0, -1);
+                                        restock_obj := create_object(41, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                     end
                                     else begin
@@ -5574,17 +5574,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -5602,7 +5602,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                    restock_obj := create_object_sid(41, 0, 0, -1);
+                                    restock_obj := create_object(41, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                 end
                                 else begin
@@ -5615,17 +5615,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -5647,7 +5647,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                                     if (100 >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                            restock_obj := create_object_sid(41, 0, 0, -1);
+                                            restock_obj := create_object(41, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                         end
                                         else begin
@@ -5660,17 +5660,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -5688,7 +5688,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                        restock_obj := create_object_sid(41, 0, 0, -1);
+                                        restock_obj := create_object(41, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                     end
                                     else begin
@@ -5701,17 +5701,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -5733,7 +5733,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                                         if (100 >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                                restock_obj := create_object_sid(41, 0, 0, -1);
+                                                restock_obj := create_object(41, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                             end
                                             else begin
@@ -5746,17 +5746,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -5774,7 +5774,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                            restock_obj := create_object_sid(41, 0, 0, -1);
+                                            restock_obj := create_object(41, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                         end
                                         else begin
@@ -5787,17 +5787,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -5819,7 +5819,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                                             if (100 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(41, 0, 0, -1);
+                                                    restock_obj := create_object(41, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                                 end
                                                 else begin
@@ -5832,17 +5832,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -5860,7 +5860,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                                restock_obj := create_object_sid(41, 0, 0, -1);
+                                                restock_obj := create_object(41, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                             end
                                             else begin
@@ -5873,17 +5873,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -5905,7 +5905,7 @@ begin
                                             if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                                                 if (100 >= random(1, 100)) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                                        restock_obj := create_object_sid(41, 0, 0, -1);
+                                                        restock_obj := create_object(41, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                                     end
                                                     else begin
@@ -5918,17 +5918,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -5946,7 +5946,7 @@ begin
                                             end
                                             else begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(41, 0, 0, -1);
+                                                    restock_obj := create_object(41, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                                                 end
                                                 else begin
@@ -5959,17 +5959,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -5995,7 +5995,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 18) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 18) < restock_amt) then begin
-                            restock_obj := create_object_sid(18, 0, 0, -1);
+                            restock_obj := create_object(18, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 18));
                         end
                         else begin
@@ -6008,17 +6008,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 18);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 18);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6036,7 +6036,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 18) < restock_amt) then begin
-                        restock_obj := create_object_sid(18, 0, 0, -1);
+                        restock_obj := create_object(18, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 18));
                     end
                     else begin
@@ -6049,17 +6049,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 18);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 18);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6078,7 +6078,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 10) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 10) < restock_amt) then begin
-                            restock_obj := create_object_sid(10, 0, 0, -1);
+                            restock_obj := create_object(10, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 10));
                         end
                         else begin
@@ -6091,17 +6091,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 10);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 10);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6119,7 +6119,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 10) < restock_amt) then begin
-                        restock_obj := create_object_sid(10, 0, 0, -1);
+                        restock_obj := create_object(10, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 10));
                     end
                     else begin
@@ -6132,17 +6132,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 10);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 10);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6161,7 +6161,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 94) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 94) < restock_amt) then begin
-                            restock_obj := create_object_sid(94, 0, 0, -1);
+                            restock_obj := create_object(94, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 94));
                         end
                         else begin
@@ -6174,17 +6174,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 94);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 94);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6202,7 +6202,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 94) < restock_amt) then begin
-                        restock_obj := create_object_sid(94, 0, 0, -1);
+                        restock_obj := create_object(94, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 94));
                     end
                     else begin
@@ -6215,17 +6215,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 94);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 94);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6244,7 +6244,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 23) < restock_amt) then begin
                     if (50 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 23) < restock_amt) then begin
-                            restock_obj := create_object_sid(23, 0, 0, -1);
+                            restock_obj := create_object(23, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 23));
                         end
                         else begin
@@ -6257,17 +6257,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 23);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 23);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6285,7 +6285,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 23) < restock_amt) then begin
-                        restock_obj := create_object_sid(23, 0, 0, -1);
+                        restock_obj := create_object(23, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 23));
                     end
                     else begin
@@ -6298,17 +6298,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 23);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 23);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6327,7 +6327,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 268) < restock_amt) then begin
                     if (50 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 268) < restock_amt) then begin
-                            restock_obj := create_object_sid(268, 0, 0, -1);
+                            restock_obj := create_object(268, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 268));
                         end
                         else begin
@@ -6340,17 +6340,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 268);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 268);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6368,7 +6368,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 268) < restock_amt) then begin
-                        restock_obj := create_object_sid(268, 0, 0, -1);
+                        restock_obj := create_object(268, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 268));
                     end
                     else begin
@@ -6381,17 +6381,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 268);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 268);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6410,7 +6410,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 242) < restock_amt) then begin
                     if (50 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 242) < restock_amt) then begin
-                            restock_obj := create_object_sid(242, 0, 0, -1);
+                            restock_obj := create_object(242, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 242));
                         end
                         else begin
@@ -6423,17 +6423,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 242);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 242);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6451,7 +6451,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 242) < restock_amt) then begin
-                        restock_obj := create_object_sid(242, 0, 0, -1);
+                        restock_obj := create_object(242, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 242));
                     end
                     else begin
@@ -6464,17 +6464,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 242);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 242);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6493,7 +6493,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 313) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 313) < restock_amt) then begin
-                            restock_obj := create_object_sid(313, 0, 0, -1);
+                            restock_obj := create_object(313, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 313));
                         end
                         else begin
@@ -6506,17 +6506,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 313);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 313);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6534,7 +6534,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 313) < restock_amt) then begin
-                        restock_obj := create_object_sid(313, 0, 0, -1);
+                        restock_obj := create_object(313, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 313));
                     end
                     else begin
@@ -6547,17 +6547,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 313);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 313);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6576,7 +6576,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                            restock_obj := create_object_sid(30, 0, 0, -1);
+                            restock_obj := create_object(30, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
                         end
                         else begin
@@ -6589,17 +6589,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 30);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 30);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6617,7 +6617,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                        restock_obj := create_object_sid(30, 0, 0, -1);
+                        restock_obj := create_object(30, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
                     end
                     else begin
@@ -6630,17 +6630,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 30);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 30);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6659,7 +6659,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
-                            restock_obj := create_object_sid(36, 0, 0, -1);
+                            restock_obj := create_object(36, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 36));
                         end
                         else begin
@@ -6672,17 +6672,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 36);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 36);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6700,7 +6700,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 36) < restock_amt) then begin
-                        restock_obj := create_object_sid(36, 0, 0, -1);
+                        restock_obj := create_object(36, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 36));
                     end
                     else begin
@@ -6713,17 +6713,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 36);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 36);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6742,7 +6742,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
-                            restock_obj := create_object_sid(127, 0, 0, -1);
+                            restock_obj := create_object(127, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 127));
                         end
                         else begin
@@ -6755,17 +6755,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 127);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 127);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6783,7 +6783,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
-                        restock_obj := create_object_sid(127, 0, 0, -1);
+                        restock_obj := create_object(127, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 127));
                     end
                     else begin
@@ -6796,17 +6796,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 127);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 127);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6825,7 +6825,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
-                            restock_obj := create_object_sid(20, 0, 0, -1);
+                            restock_obj := create_object(20, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 20));
                         end
                         else begin
@@ -6838,17 +6838,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 20);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 20);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6866,7 +6866,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
-                        restock_obj := create_object_sid(20, 0, 0, -1);
+                        restock_obj := create_object(20, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 20));
                     end
                     else begin
@@ -6879,17 +6879,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 20);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 20);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6908,7 +6908,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 79) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 79) < restock_amt) then begin
-                            restock_obj := create_object_sid(79, 0, 0, -1);
+                            restock_obj := create_object(79, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 79));
                         end
                         else begin
@@ -6921,17 +6921,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 79);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 79);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6949,7 +6949,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 79) < restock_amt) then begin
-                        restock_obj := create_object_sid(79, 0, 0, -1);
+                        restock_obj := create_object(79, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 79));
                     end
                     else begin
@@ -6962,17 +6962,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 79);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 79);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -6991,7 +6991,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 304) < restock_amt) then begin
                     if (10 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 304) < restock_amt) then begin
-                            restock_obj := create_object_sid(304, 0, 0, -1);
+                            restock_obj := create_object(304, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 304));
                         end
                         else begin
@@ -7004,17 +7004,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 304);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 304);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7032,7 +7032,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 304) < restock_amt) then begin
-                        restock_obj := create_object_sid(304, 0, 0, -1);
+                        restock_obj := create_object(304, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 304));
                     end
                     else begin
@@ -7045,17 +7045,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 304);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 304);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7074,7 +7074,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
                     if (50 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
-                            restock_obj := create_object_sid(52, 0, 0, -1);
+                            restock_obj := create_object(52, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 52));
                         end
                         else begin
@@ -7087,17 +7087,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 52);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 52);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7115,7 +7115,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
-                        restock_obj := create_object_sid(52, 0, 0, -1);
+                        restock_obj := create_object(52, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 52));
                     end
                     else begin
@@ -7128,17 +7128,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 52);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 52);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7157,7 +7157,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
                     if (30 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
-                            restock_obj := create_object_sid(39, 0, 0, -1);
+                            restock_obj := create_object(39, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 39));
                         end
                         else begin
@@ -7170,17 +7170,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7198,7 +7198,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
-                        restock_obj := create_object_sid(39, 0, 0, -1);
+                        restock_obj := create_object(39, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 39));
                     end
                     else begin
@@ -7211,17 +7211,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7240,7 +7240,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
                     if (50 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
-                            restock_obj := create_object_sid(380, 0, 0, -1);
+                            restock_obj := create_object(380, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 380));
                         end
                         else begin
@@ -7253,17 +7253,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 380);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 380);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7281,7 +7281,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
-                        restock_obj := create_object_sid(380, 0, 0, -1);
+                        restock_obj := create_object(380, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 380));
                     end
                     else begin
@@ -7294,17 +7294,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 380);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 380);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7323,7 +7323,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 761) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 761) < restock_amt) then begin
-                            restock_obj := create_object_sid(761, 0, 0, -1);
+                            restock_obj := create_object(761, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 761));
                         end
                         else begin
@@ -7336,17 +7336,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 761);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 761);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7364,7 +7364,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 761) < restock_amt) then begin
-                        restock_obj := create_object_sid(761, 0, 0, -1);
+                        restock_obj := create_object(761, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 761));
                     end
                     else begin
@@ -7377,17 +7377,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 761);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 761);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7406,7 +7406,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
-                            restock_obj := create_object_sid(85, 0, 0, -1);
+                            restock_obj := create_object(85, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 85));
                         end
                         else begin
@@ -7419,17 +7419,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 85);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 85);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7447,7 +7447,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
-                        restock_obj := create_object_sid(85, 0, 0, -1);
+                        restock_obj := create_object(85, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 85));
                     end
                     else begin
@@ -7460,17 +7460,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 85);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 85);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7489,7 +7489,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 763) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 763) < restock_amt) then begin
-                            restock_obj := create_object_sid(763, 0, 0, -1);
+                            restock_obj := create_object(763, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 763));
                         end
                         else begin
@@ -7502,17 +7502,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 763);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 763);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7530,7 +7530,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 763) < restock_amt) then begin
-                        restock_obj := create_object_sid(763, 0, 0, -1);
+                        restock_obj := create_object(763, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 763));
                     end
                     else begin
@@ -7543,17 +7543,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 763);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 763);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7572,7 +7572,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 767) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 767) < restock_amt) then begin
-                            restock_obj := create_object_sid(767, 0, 0, -1);
+                            restock_obj := create_object(767, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 767));
                         end
                         else begin
@@ -7585,17 +7585,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 767);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 767);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7613,7 +7613,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 767) < restock_amt) then begin
-                        restock_obj := create_object_sid(767, 0, 0, -1);
+                        restock_obj := create_object(767, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 767));
                     end
                     else begin
@@ -7626,17 +7626,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 767);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 767);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7655,7 +7655,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 768) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 768) < restock_amt) then begin
-                            restock_obj := create_object_sid(768, 0, 0, -1);
+                            restock_obj := create_object(768, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 768));
                         end
                         else begin
@@ -7668,17 +7668,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 768);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 768);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7696,7 +7696,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 768) < restock_amt) then begin
-                        restock_obj := create_object_sid(768, 0, 0, -1);
+                        restock_obj := create_object(768, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 768));
                     end
                     else begin
@@ -7709,17 +7709,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 768);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 768);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7738,7 +7738,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 769) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 769) < restock_amt) then begin
-                            restock_obj := create_object_sid(769, 0, 0, -1);
+                            restock_obj := create_object(769, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 769));
                         end
                         else begin
@@ -7751,17 +7751,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 769);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 769);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7779,7 +7779,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 769) < restock_amt) then begin
-                        restock_obj := create_object_sid(769, 0, 0, -1);
+                        restock_obj := create_object(769, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 769));
                     end
                     else begin
@@ -7792,17 +7792,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 769);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 769);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7821,7 +7821,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 770) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 770) < restock_amt) then begin
-                            restock_obj := create_object_sid(770, 0, 0, -1);
+                            restock_obj := create_object(770, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 770));
                         end
                         else begin
@@ -7834,17 +7834,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 770);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 770);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7862,7 +7862,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 770) < restock_amt) then begin
-                        restock_obj := create_object_sid(770, 0, 0, -1);
+                        restock_obj := create_object(770, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 770));
                     end
                     else begin
@@ -7875,17 +7875,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 770);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 770);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7904,7 +7904,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 771) < restock_amt) then begin
                     if (25 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 771) < restock_amt) then begin
-                            restock_obj := create_object_sid(771, 0, 0, -1);
+                            restock_obj := create_object(771, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 771));
                         end
                         else begin
@@ -7917,17 +7917,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 771);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 771);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7945,7 +7945,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 771) < restock_amt) then begin
-                        restock_obj := create_object_sid(771, 0, 0, -1);
+                        restock_obj := create_object(771, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 771));
                     end
                     else begin
@@ -7958,17 +7958,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 771);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 771);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -7987,7 +7987,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 772) < restock_amt) then begin
                     if (30 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 772) < restock_amt) then begin
-                            restock_obj := create_object_sid(772, 0, 0, -1);
+                            restock_obj := create_object(772, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 772));
                         end
                         else begin
@@ -8000,17 +8000,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 772);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 772);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -8028,7 +8028,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 772) < restock_amt) then begin
-                        restock_obj := create_object_sid(772, 0, 0, -1);
+                        restock_obj := create_object(772, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 772));
                     end
                     else begin
@@ -8041,17 +8041,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 772);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 772);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -8070,7 +8070,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 773) < restock_amt) then begin
                     if (30 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 773) < restock_amt) then begin
-                            restock_obj := create_object_sid(773, 0, 0, -1);
+                            restock_obj := create_object(773, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 773));
                         end
                         else begin
@@ -8083,17 +8083,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 773);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 773);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -8111,7 +8111,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 773) < restock_amt) then begin
-                        restock_obj := create_object_sid(773, 0, 0, -1);
+                        restock_obj := create_object(773, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 773));
                     end
                     else begin
@@ -8124,17 +8124,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 773);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 773);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -8153,7 +8153,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 774) < restock_amt) then begin
                     if (25 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 774) < restock_amt) then begin
-                            restock_obj := create_object_sid(774, 0, 0, -1);
+                            restock_obj := create_object(774, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 774));
                         end
                         else begin
@@ -8166,17 +8166,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 774);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 774);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -8194,7 +8194,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 774) < restock_amt) then begin
-                        restock_obj := create_object_sid(774, 0, 0, -1);
+                        restock_obj := create_object(774, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 774));
                     end
                     else begin
@@ -8207,17 +8207,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 774);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 774);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -8236,7 +8236,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 775) < restock_amt) then begin
                     if (25 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 775) < restock_amt) then begin
-                            restock_obj := create_object_sid(775, 0, 0, -1);
+                            restock_obj := create_object(775, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 775));
                         end
                         else begin
@@ -8249,17 +8249,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 775);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 775);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -8277,7 +8277,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 775) < restock_amt) then begin
-                        restock_obj := create_object_sid(775, 0, 0, -1);
+                        restock_obj := create_object(775, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 775));
                     end
                     else begin
@@ -8290,17 +8290,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 775);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 775);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -8319,7 +8319,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 776) < restock_amt) then begin
                     if (30 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 776) < restock_amt) then begin
-                            restock_obj := create_object_sid(776, 0, 0, -1);
+                            restock_obj := create_object(776, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 776));
                         end
                         else begin
@@ -8332,17 +8332,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 776);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 776);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -8360,7 +8360,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 776) < restock_amt) then begin
-                        restock_obj := create_object_sid(776, 0, 0, -1);
+                        restock_obj := create_object(776, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 776));
                     end
                     else begin
@@ -8373,17 +8373,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 776);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 776);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -8402,7 +8402,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 777) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 777) < restock_amt) then begin
-                            restock_obj := create_object_sid(777, 0, 0, -1);
+                            restock_obj := create_object(777, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 777));
                         end
                         else begin
@@ -8415,17 +8415,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 777);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 777);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -8443,7 +8443,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 777) < restock_amt) then begin
-                        restock_obj := create_object_sid(777, 0, 0, -1);
+                        restock_obj := create_object(777, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 777));
                     end
                     else begin
@@ -8456,17 +8456,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 777);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 777);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -8485,7 +8485,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 98) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 98) < restock_amt) then begin
-                            restock_obj := create_object_sid(98, 0, 0, -1);
+                            restock_obj := create_object(98, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 98));
                         end
                         else begin
@@ -8498,17 +8498,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 98);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 98);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -8526,7 +8526,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 98) < restock_amt) then begin
-                        restock_obj := create_object_sid(98, 0, 0, -1);
+                        restock_obj := create_object(98, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 98));
                     end
                     else begin
@@ -8539,17 +8539,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 98);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 98);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -8568,7 +8568,7 @@ begin
                 destroy_object(LVar0);
             end
             if (tile_num(self_obj) == 17724) then begin
-                LVar0 := create_object_sid(128, 5, 0, -1);
+                LVar0 := create_object(128, 5, 0);
                 if (obj_is_carrying_obj_pid(self_obj, 479) > 0) then begin
                     LVar1 := obj_carrying_pid_obj(self_obj, 479);
                     rm_obj_from_inven(self_obj, LVar1);
@@ -8809,217 +8809,217 @@ begin
                     rm_obj_from_inven(self_obj, LVar1);
                     add_obj_to_inven(LVar0, LVar1);
                 end
-                global_temp := create_object_sid(128, 0, 0, -1);
+                global_temp := create_object(128, 0, 0);
                 move_obj_inven_to_obj(self_obj, global_temp);
                 destroy_object(global_temp);
-                if ((cur_map_index == 3) or (cur_map_index == 4) or (cur_map_index == 35) or (cur_map_index == 5)) then begin
+                if ((CUR_MAP_ARCAVES) or (CUR_MAP_ARVILLAG) or (CUR_MAP_ARCAVES5) or (CUR_MAP_ARBRIDGE)) then begin
                     current_town := "Arroyo";
                 end
-                if ((cur_map_index == 9) or (cur_map_index == 10) or (cur_map_index == 11) or (cur_map_index == 13) or (cur_map_index == 14) or (cur_map_index == 48) or (cur_map_index == 161)) then begin
+                if ((CUR_MAP_KLADWTWN) or (CUR_MAP_KLAMALL) or (CUR_MAP_KLARATCV) or (CUR_MAP_KLATRAP) or (CUR_MAP_KLAGRAZ) or (CUR_MAP_KLACANYN) or (CUR_MAP_KLACVENT)) then begin
                     current_town := "Klamath";
                 end
-                if (cur_map_index == 12) then begin
+                if (CUR_MAP_KLATOXCV) then begin
                     current_town := "Klamath Toxic Caves";
                 end
-                if (cur_map_index == 158) then begin
+                if (CUR_MAP_RNDMDDG) then begin
                     current_town := "Mad Dog Area";
                 end
-                if ((cur_map_index == 6) or (cur_map_index == 7) or (cur_map_index == 8)) then begin
+                if ((CUR_MAP_DENBUS1) or (CUR_MAP_DENBUS2) or (CUR_MAP_DENRES1)) then begin
                     current_town := "Den";
                 end
-                if ((cur_map_index == 231) or (cur_map_index == 253) or (cur_map_index == 254) or (cur_map_index == 255)) then begin
+                if ((CUR_MAP_PRIMIT) or (CUR_MAP_TRIBE02) or (CUR_MAP_SLVCAMP) or (CUR_MAP_TRIBE2)) then begin
                     current_town := "Primitive Tribes";
                 end
-                if (cur_map_index == 163) then begin
+                if (CUR_MAP_TRIBE01) then begin
                     current_town := "Primitive Tribe";
                 end
-                if (cur_map_index == 52) then begin
+                if (CUR_MAP_DNSLVRUN) then begin
                     current_town := "Den Slave Run";
                 end
-                if (cur_map_index == 160) then begin
+                if (CUR_MAP_JENFARM7) then begin
                     current_town := "Jennings Farm Area";
                 end
-                if (cur_map_index == 156) then begin
+                if (CUR_MAP_TRUCK) then begin
                     current_town := "Truck";
                 end
-                if (cur_map_index == 162) then begin
+                if (CUR_MAP_SCRAPT) then begin
                     current_town := "Scraptown";
                 end
-                if ((cur_map_index == 18) or (cur_map_index == 19) or (cur_map_index == 20) or (cur_map_index == 21) or (cur_map_index == 22) or (cur_map_index == 23)) then begin
+                if ((CUR_MAP_MODMAIN) or (CUR_MAP_MODINN) or (CUR_MAP_MODBRAH) or (CUR_MAP_MODGARD) or (CUR_MAP_MODSHIT) or (CUR_MAP_MODWELL)) then begin
                     current_town := "Modoc";
                 end
-                if (cur_map_index == 202) then begin
+                if (CUR_MAP_CRISIENT) then begin
                     current_town := "Vault 23";
                 end
-                if ((cur_map_index == 24) or (cur_map_index == 25) or (cur_map_index == 26)) then begin
+                if ((CUR_MAP_GSTFARM) or (CUR_MAP_GSTCAV1) or (CUR_MAP_GSTCAV2)) then begin
                     current_town := "Ghost Farm";
                 end
-                if (cur_map_index == 223) then begin
+                if (CUR_MAP_MODOCT) then begin
                     current_town := "Modoc Thieves Guild";
                 end
-                if (cur_map_index == 224) then begin
+                if (CUR_MAP_MODOCT2) then begin
                     current_town := "Salvatore's Gun Stash";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvatore";
                 end
-                if (cur_map_index == 226) then begin
+                if (CUR_MAP_MODOCT4) then begin
                     current_town := "Salvatore Meeting";
                 end
-                if ((cur_map_index == 31) or (cur_map_index == 32) or (cur_map_index == 33) or (cur_map_index == 34)) then begin
+                if ((CUR_MAP_GECKSETL) or (CUR_MAP_GECKPWPL) or (CUR_MAP_GECKJUNK) or (CUR_MAP_GECKTUNL)) then begin
                     current_town := "Gecko";
                 end
-                if ((cur_map_index == 15) or (cur_map_index == 16) or (cur_map_index == 17) or (cur_map_index == 30)) then begin
+                if ((CUR_MAP_VCTYCTYD) or (CUR_MAP_VCTYDWTN) or (CUR_MAP_VCTYCOCL) or (CUR_MAP_VCTYVLT)) then begin
                     current_town := "Vault City";
                 end
-                if ((cur_map_index == 92) or (cur_map_index == 93)) then begin
+                if ((CUR_MAP_RAIDERS1) or (CUR_MAP_RAIDERS2)) then begin
                     current_town := "Raiders";
                 end
-                if ((cur_map_index == 78) or (cur_map_index == 79)) then begin
+                if ((CUR_MAP_BROKEN1) or (CUR_MAP_BROKEN2)) then begin
                     current_town := "Broken Hills";
                 end
-                if ((cur_map_index == 64) or (cur_map_index == 62) or (cur_map_index == 63) or (cur_map_index == 65) or (cur_map_index == 66) or (cur_map_index == 67)) then begin
+                if ((CUR_MAP_REDDOWN) or (CUR_MAP_REDWAME) or (CUR_MAP_REDWAN1) or (CUR_MAP_REDMENT) or (CUR_MAP_REDDTUN) or (CUR_MAP_REDMTUN)) then begin
                     current_town := "Redding";
                 end
-                if ((cur_map_index == 54) or (cur_map_index == 55) or (cur_map_index == 56) or (cur_map_index == 57) or (cur_map_index == 58) or (cur_map_index == 61) or (cur_map_index == 147)) then begin
+                if ((CUR_MAP_NEWR1) or (CUR_MAP_NEWR2) or (CUR_MAP_NEWR3) or (CUR_MAP_NEWR4) or (CUR_MAP_NEWRCS) or (CUR_MAP_NEWRBA) or (CUR_MAP_NEWRVB)) then begin
                     current_town := "New Reno";
                 end
-                if ((cur_map_index == 195) or (cur_map_index == 197) or (cur_map_index == 235) or (cur_map_index == 196)) then begin
+                if ((CUR_MAP_LARS1) or (CUR_MAP_LARS3) or (CUR_MAP_LARSSCRP) or (CUR_MAP_LARS2)) then begin
                     current_town := "Lars-City";
                 end
-                if (cur_map_index == 232) then begin
+                if (CUR_MAP_CRSNMAIN) then begin
                     current_town := "Lars-City Carson";
                 end
-                if (cur_map_index == 155) then begin
+                if (CUR_MAP_ABBEY) then begin
                     current_town := "Abbey";
                 end
-                if ((cur_map_index == 153) or (cur_map_index == 154)) then begin
+                if ((CUR_MAP_EPAMAIN) or (CUR_MAP_EPAWRHSE)) then begin
                     current_town := "EPA";
                 end
-                if ((cur_map_index == 220) or (cur_map_index == 221)) then begin
+                if ((CUR_MAP_COLLY) or (CUR_MAP_COLLY1)) then begin
                     current_town := "Collyweb";
                 end
-                if (cur_map_index == 59) then begin
+                if (CUR_MAP_NEWRGO) then begin
                     current_town := "Golgotha";
                 end
-                if (cur_map_index == 60) then begin
+                if (CUR_MAP_NEWRST) then begin
                     current_town := "Reno Stables";
                 end
-                if ((cur_map_index == 27) or (cur_map_index == 28) or (cur_map_index == 29)) then begin
+                if ((CUR_MAP_DEPOLV1) or (CUR_MAP_DEPOLVA) or (CUR_MAP_DEPOLVB)) then begin
                     current_town := "Sierra Army Base";
                 end
-                if ((cur_map_index == 46) or (cur_map_index == 43) or (cur_map_index == 42) or (cur_map_index == 44) or (cur_map_index == 45)) then begin
+                if ((CUR_MAP_NCRENT) or (CUR_MAP_NCR2) or (CUR_MAP_NCR1) or (CUR_MAP_NCR3) or (CUR_MAP_NCR4)) then begin
                     current_town := "NCR";
                 end
-                if (cur_map_index == 157) then begin
+                if (CUR_MAP_B21) then begin
                     current_town := "B21";
                 end
-                if ((cur_map_index == 37) or (cur_map_index == 38) or (cur_map_index == 36) or (cur_map_index == 39)) then begin
+                if ((CUR_MAP_V15ENT) or (CUR_MAP_V15ENTB) or (CUR_MAP_VAULT15) or (CUR_MAP_V15SENT)) then begin
                     current_town := "Vault 15";
                 end
-                if ((cur_map_index == 40) or (cur_map_index == 41)) then begin
+                if ((CUR_MAP_VAULT13) or (CUR_MAP_V13ENT)) then begin
                     current_town := "Vault 13";
                 end
-                if ((cur_map_index == 49) or (cur_map_index == 50) or (cur_map_index == 51)) then begin
+                if ((CUR_MAP_MBASE12) or (CUR_MAP_MBASE34) or (CUR_MAP_MBCLOSE)) then begin
                     current_town := "Military Base";
                 end
-                if ((cur_map_index == 137) or (cur_map_index == 136) or (cur_map_index == 135) or (cur_map_index == 138) or (cur_map_index == 139) or (cur_map_index == 140) or (cur_map_index == 148)) then begin
+                if ((CUR_MAP_SFCHINA) or (CUR_MAP_SFDOCK) or (CUR_MAP_SFTANKER) or (CUR_MAP_SFSHUTL1) or (CUR_MAP_SFSHUTL2) or (CUR_MAP_SFELRONB) or (CUR_MAP_SFCHINA2)) then begin
                     current_town := "San Francisco";
                 end
-                if ((cur_map_index == 213) or (cur_map_index == 214) or (cur_map_index == 215) or (cur_map_index == 188)) then begin
+                if ((CUR_MAP_BROHDENT1) or (CUR_MAP_BROHD121) or (CUR_MAP_BROHD341) or (CUR_MAP_BROHD1K)) then begin
                     current_town := "Brohdent";
                 end
-                if ((cur_map_index == 218) or (cur_map_index == 217) or (cur_map_index == 219)) then begin
+                if ((CUR_MAP_V14ENT) or (CUR_MAP_VAULT14) or (CUR_MAP_VAULT14B)) then begin
                     current_town := "Vault 14";
                 end
-                if (cur_map_index == 109) then begin
+                if (CUR_MAP_NAVARRO) then begin
                     current_town := "Navarro";
                 end
-                if ((cur_map_index == 129) or (cur_map_index == 128) or (cur_map_index == 130) or (cur_map_index == 131) or (cur_map_index == 132) or (cur_map_index == 133) or (cur_map_index == 134) or (cur_map_index == 243) or (cur_map_index == 244)) then begin
+                if ((CUR_MAP_ENCDOCK) or (CUR_MAP_ENCDET) or (CUR_MAP_ENCFITE) or (CUR_MAP_ENCGD) or (CUR_MAP_ENCPRES) or (CUR_MAP_ENCRCTR) or (CUR_MAP_ENCTRP) or (CUR_MAP_ENCVERT) or (CUR_MAP_ENCFT2)) then begin
                     current_town := "Enclave";
                 end
-                if ((cur_map_index == 238) or (cur_map_index == 229) or (cur_map_index == 240)) then begin
+                if ((CUR_MAP_BROHDENT) or (CUR_MAP_CITYCH3) or (CUR_MAP_BROHD34)) then begin
                     current_town := "BoS Bunker";
                 end
-                if (cur_map_index == 241) then begin
+                if (CUR_MAP_BRHDHLP) then begin
                     current_town := "BoS Help";
                 end
-                if ((cur_map_index == 242) or (cur_map_index == 151)) then begin
+                if ((CUR_MAP_EPAENT) or (CUR_MAP_EPAX)) then begin
                     current_town := "BOS Facility";
                 end
-                if (cur_map_index == 96) then begin
+                if (CUR_MAP_RNDWHALE) then begin
                     current_town := "Special Whale";
                 end
-                if (cur_map_index == 97) then begin
+                if (CUR_MAP_RNDTINWD) then begin
                     current_town := "Special Woodsman";
                 end
-                if (cur_map_index == 98) then begin
+                if (CUR_MAP_RNDBHEAD) then begin
                     current_town := "Special Head";
                 end
-                if (cur_map_index == 99) then begin
+                if (CUR_MAP_RNDSHUTL) then begin
                     current_town := "Special Shuttle";
                 end
-                if (cur_map_index == 100) then begin
+                if (CUR_MAP_RNDUVILG) then begin
                     current_town := "Special Unwashed";
                 end
-                if (cur_map_index == 101) then begin
+                if (CUR_MAP_RNDBRIDG) then begin
                     current_town := "Special Bridge";
                 end
-                if (cur_map_index == 102) then begin
+                if (CUR_MAP_RNDCAFE) then begin
                     current_town := "Special Cafe";
                 end
-                if (cur_map_index == 103) then begin
+                if (CUR_MAP_RNDHOLY1) then begin
                     current_town := "Special Holy 1";
                 end
-                if (cur_map_index == 104) then begin
+                if (CUR_MAP_RNDHOLY2) then begin
                     current_town := "Special Holy 2";
                 end
-                if (cur_map_index == 105) then begin
+                if (CUR_MAP_RNDFORVR) then begin
                     current_town := "Special Guardian";
                 end
-                if (cur_map_index == 106) then begin
+                if (CUR_MAP_RNDTOXIC) then begin
                     current_town := "Special Toxic";
                 end
-                if (cur_map_index == 107) then begin
+                if (CUR_MAP_RNDPARIH) then begin
                     current_town := "Special Pariah";
                 end
-                if (cur_map_index == 108) then begin
+                if (CUR_MAP_RNDEXCOW) then begin
                     current_town := "Special Brahmin";
                 end
-                if (cur_map_index == 164) then begin
+                if (CUR_MAP_RNDPOSTM) then begin
                     current_town := "Special Postman";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvator";
                 end
-                if (cur_map_index == 216) then begin
+                if (CUR_MAP_RNDMSTR) then begin
                     current_town := "Dead Soldiers of Master Army";
                 end
-                if ((cur_map_index == 95) or (cur_map_index == 94)) then begin
+                if ((CUR_MAP_BHRNDMNT) or (CUR_MAP_BHRNDDST)) then begin
                     current_town := "Caravan Encounters";
                 end
-                if (cur_map_index == 149) then begin
+                if (CUR_MAP_GAMMOVIE) then begin
                     current_town := "In Game Movie";
                 end
-                if (cur_map_index == 150) then begin
+                if (CUR_MAP_RNDBESS) then begin
                     current_town := "Bess Dead";
                 end
-                if ((cur_map_index == 152) or (cur_map_index == 159)) then begin
+                if ((CUR_MAP_RNDBD) or (CUR_MAP_RNDBD)) then begin
                     current_town := "DeathClaw Encounters";
                 end
-                if ((cur_map_index == 0) or (cur_map_index == 1) or (cur_map_index == 2) or (cur_map_index == 81) or (cur_map_index == 82) or (cur_map_index == 83) or (cur_map_index == 84) or (cur_map_index == 113) or (cur_map_index == 114) or (cur_map_index == 115) or (cur_map_index == 116) or (cur_map_index == 117)) then begin
+                if ((CUR_MAP_DESERT1) or (CUR_MAP_DESERT2) or (CUR_MAP_DESERT3) or (CUR_MAP_DESERT4) or (CUR_MAP_DESERT5) or (CUR_MAP_DESERT6) or (CUR_MAP_DESERT7) or (CUR_MAP_DESERT213) or (CUR_MAP_DESERT214) or (CUR_MAP_DESERT215) or (CUR_MAP_DESERT216) or (CUR_MAP_DESERT217)) then begin
                     current_town := "Random Encounter Desert";
                 end
-                if ((cur_map_index == 74) or (cur_map_index == 75) or (cur_map_index == 121) or (cur_map_index == 122) or (cur_map_index == 123) or (cur_map_index == 124)) then begin
+                if ((CUR_MAP_MOUNTN1) or (CUR_MAP_MOUNTN2) or (CUR_MAP_MOUNTN3) or (CUR_MAP_MOUNTN4) or (CUR_MAP_MOUNTN5) or (CUR_MAP_MOUNTN6)) then begin
                     current_town := "Random Encounter Mountain";
                 end
-                if ((cur_map_index == 68) or (cur_map_index == 125) or (cur_map_index == 141) or (cur_map_index == 142) or (cur_map_index == 143) or (cur_map_index == 144) or (cur_map_index == 145) or (cur_map_index == 146)) then begin
+                if ((CUR_MAP_CITY1) or (CUR_MAP_CITY2) or (CUR_MAP_CITY3) or (CUR_MAP_CITY4) or (CUR_MAP_CITY5) or (CUR_MAP_CITY6) or (CUR_MAP_CITY7) or (CUR_MAP_CITY8)) then begin
                     current_town := "Random Encounter City";
                 end
-                if ((cur_map_index == 76) or (cur_map_index == 77) or (cur_map_index == 85) or (cur_map_index == 86) or (cur_map_index == 87) or (cur_map_index == 88) or (cur_map_index == 89) or (cur_map_index == 90) or (cur_map_index == 91) or (cur_map_index == 110) or (cur_map_index == 111) or (cur_map_index == 112)) then begin
+                if ((CUR_MAP_COAST1) or (CUR_MAP_COAST2) or (CUR_MAP_COAST3) or (CUR_MAP_COAST4) or (CUR_MAP_COAST5) or (CUR_MAP_COAST6) or (CUR_MAP_COAST7) or (CUR_MAP_COAST8) or (CUR_MAP_COAST9) or (CUR_MAP_COAST10) or (CUR_MAP_COAST11) or (CUR_MAP_07DESERT)) then begin
                     current_town := "Random Encounter Coast";
                 end
-                if ((cur_map_index == 69) or (cur_map_index == 70) or (cur_map_index == 71) or (cur_map_index == 72) or (cur_map_index == 73) or (cur_map_index == 80) or (cur_map_index == 119) or (cur_map_index == 120)) then begin
+                if ((CUR_MAP_CAVE0) or (CUR_MAP_CAVE1) or (CUR_MAP_CAVE2) or (CUR_MAP_CAVE3) or (CUR_MAP_CAVE4) or (CUR_MAP_CAVE5) or (CUR_MAP_CAVE6) or (CUR_MAP_CAVE7)) then begin
                     current_town := "Random Encounter Cavern";
                 end
                 if ((current_town == "Arroyo") or (current_town == "Klamath") or (current_town == "Klamath Toxic Caves") or (current_town == "Mad Dog Area")) then begin
@@ -9074,214 +9074,214 @@ begin
                         end
                     end
                 end
-                if ((cur_map_index == 3) or (cur_map_index == 4) or (cur_map_index == 35) or (cur_map_index == 5)) then begin
+                if ((CUR_MAP_ARCAVES) or (CUR_MAP_ARVILLAG) or (CUR_MAP_ARCAVES5) or (CUR_MAP_ARBRIDGE)) then begin
                     current_town := "Arroyo";
                 end
-                if ((cur_map_index == 9) or (cur_map_index == 10) or (cur_map_index == 11) or (cur_map_index == 13) or (cur_map_index == 14) or (cur_map_index == 48) or (cur_map_index == 161)) then begin
+                if ((CUR_MAP_KLADWTWN) or (CUR_MAP_KLAMALL) or (CUR_MAP_KLARATCV) or (CUR_MAP_KLATRAP) or (CUR_MAP_KLAGRAZ) or (CUR_MAP_KLACANYN) or (CUR_MAP_KLACVENT)) then begin
                     current_town := "Klamath";
                 end
-                if (cur_map_index == 12) then begin
+                if (CUR_MAP_KLATOXCV) then begin
                     current_town := "Klamath Toxic Caves";
                 end
-                if (cur_map_index == 158) then begin
+                if (CUR_MAP_RNDMDDG) then begin
                     current_town := "Mad Dog Area";
                 end
-                if ((cur_map_index == 6) or (cur_map_index == 7) or (cur_map_index == 8)) then begin
+                if ((CUR_MAP_DENBUS1) or (CUR_MAP_DENBUS2) or (CUR_MAP_DENRES1)) then begin
                     current_town := "Den";
                 end
-                if ((cur_map_index == 231) or (cur_map_index == 253) or (cur_map_index == 254) or (cur_map_index == 255)) then begin
+                if ((CUR_MAP_PRIMIT) or (CUR_MAP_TRIBE02) or (CUR_MAP_SLVCAMP) or (CUR_MAP_TRIBE2)) then begin
                     current_town := "Primitive Tribes";
                 end
-                if (cur_map_index == 163) then begin
+                if (CUR_MAP_TRIBE01) then begin
                     current_town := "Primitive Tribe";
                 end
-                if (cur_map_index == 52) then begin
+                if (CUR_MAP_DNSLVRUN) then begin
                     current_town := "Den Slave Run";
                 end
-                if (cur_map_index == 160) then begin
+                if (CUR_MAP_JENFARM7) then begin
                     current_town := "Jennings Farm Area";
                 end
-                if (cur_map_index == 156) then begin
+                if (CUR_MAP_TRUCK) then begin
                     current_town := "Truck";
                 end
-                if (cur_map_index == 162) then begin
+                if (CUR_MAP_SCRAPT) then begin
                     current_town := "Scraptown";
                 end
-                if ((cur_map_index == 18) or (cur_map_index == 19) or (cur_map_index == 20) or (cur_map_index == 21) or (cur_map_index == 22) or (cur_map_index == 23)) then begin
+                if ((CUR_MAP_MODMAIN) or (CUR_MAP_MODINN) or (CUR_MAP_MODBRAH) or (CUR_MAP_MODGARD) or (CUR_MAP_MODSHIT) or (CUR_MAP_MODWELL)) then begin
                     current_town := "Modoc";
                 end
-                if (cur_map_index == 202) then begin
+                if (CUR_MAP_CRISIENT) then begin
                     current_town := "Vault 23";
                 end
-                if ((cur_map_index == 24) or (cur_map_index == 25) or (cur_map_index == 26)) then begin
+                if ((CUR_MAP_GSTFARM) or (CUR_MAP_GSTCAV1) or (CUR_MAP_GSTCAV2)) then begin
                     current_town := "Ghost Farm";
                 end
-                if (cur_map_index == 223) then begin
+                if (CUR_MAP_MODOCT) then begin
                     current_town := "Modoc Thieves Guild";
                 end
-                if (cur_map_index == 224) then begin
+                if (CUR_MAP_MODOCT2) then begin
                     current_town := "Salvatore's Gun Stash";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvatore";
                 end
-                if (cur_map_index == 226) then begin
+                if (CUR_MAP_MODOCT4) then begin
                     current_town := "Salvatore Meeting";
                 end
-                if ((cur_map_index == 31) or (cur_map_index == 32) or (cur_map_index == 33) or (cur_map_index == 34)) then begin
+                if ((CUR_MAP_GECKSETL) or (CUR_MAP_GECKPWPL) or (CUR_MAP_GECKJUNK) or (CUR_MAP_GECKTUNL)) then begin
                     current_town := "Gecko";
                 end
-                if ((cur_map_index == 15) or (cur_map_index == 16) or (cur_map_index == 17) or (cur_map_index == 30)) then begin
+                if ((CUR_MAP_VCTYCTYD) or (CUR_MAP_VCTYDWTN) or (CUR_MAP_VCTYCOCL) or (CUR_MAP_VCTYVLT)) then begin
                     current_town := "Vault City";
                 end
-                if ((cur_map_index == 92) or (cur_map_index == 93)) then begin
+                if ((CUR_MAP_RAIDERS1) or (CUR_MAP_RAIDERS2)) then begin
                     current_town := "Raiders";
                 end
-                if ((cur_map_index == 78) or (cur_map_index == 79)) then begin
+                if ((CUR_MAP_BROKEN1) or (CUR_MAP_BROKEN2)) then begin
                     current_town := "Broken Hills";
                 end
-                if ((cur_map_index == 64) or (cur_map_index == 62) or (cur_map_index == 63) or (cur_map_index == 65) or (cur_map_index == 66) or (cur_map_index == 67)) then begin
+                if ((CUR_MAP_REDDOWN) or (CUR_MAP_REDWAME) or (CUR_MAP_REDWAN1) or (CUR_MAP_REDMENT) or (CUR_MAP_REDDTUN) or (CUR_MAP_REDMTUN)) then begin
                     current_town := "Redding";
                 end
-                if ((cur_map_index == 54) or (cur_map_index == 55) or (cur_map_index == 56) or (cur_map_index == 57) or (cur_map_index == 58) or (cur_map_index == 61) or (cur_map_index == 147)) then begin
+                if ((CUR_MAP_NEWR1) or (CUR_MAP_NEWR2) or (CUR_MAP_NEWR3) or (CUR_MAP_NEWR4) or (CUR_MAP_NEWRCS) or (CUR_MAP_NEWRBA) or (CUR_MAP_NEWRVB)) then begin
                     current_town := "New Reno";
                 end
-                if ((cur_map_index == 195) or (cur_map_index == 197) or (cur_map_index == 235) or (cur_map_index == 196)) then begin
+                if ((CUR_MAP_LARS1) or (CUR_MAP_LARS3) or (CUR_MAP_LARSSCRP) or (CUR_MAP_LARS2)) then begin
                     current_town := "Lars-City";
                 end
-                if (cur_map_index == 232) then begin
+                if (CUR_MAP_CRSNMAIN) then begin
                     current_town := "Lars-City Carson";
                 end
-                if (cur_map_index == 155) then begin
+                if (CUR_MAP_ABBEY) then begin
                     current_town := "Abbey";
                 end
-                if ((cur_map_index == 153) or (cur_map_index == 154)) then begin
+                if ((CUR_MAP_EPAMAIN) or (CUR_MAP_EPAWRHSE)) then begin
                     current_town := "EPA";
                 end
-                if ((cur_map_index == 220) or (cur_map_index == 221)) then begin
+                if ((CUR_MAP_COLLY) or (CUR_MAP_COLLY1)) then begin
                     current_town := "Collyweb";
                 end
-                if (cur_map_index == 59) then begin
+                if (CUR_MAP_NEWRGO) then begin
                     current_town := "Golgotha";
                 end
-                if (cur_map_index == 60) then begin
+                if (CUR_MAP_NEWRST) then begin
                     current_town := "Reno Stables";
                 end
-                if ((cur_map_index == 27) or (cur_map_index == 28) or (cur_map_index == 29)) then begin
+                if ((CUR_MAP_DEPOLV1) or (CUR_MAP_DEPOLVA) or (CUR_MAP_DEPOLVB)) then begin
                     current_town := "Sierra Army Base";
                 end
-                if ((cur_map_index == 46) or (cur_map_index == 43) or (cur_map_index == 42) or (cur_map_index == 44) or (cur_map_index == 45)) then begin
+                if ((CUR_MAP_NCRENT) or (CUR_MAP_NCR2) or (CUR_MAP_NCR1) or (CUR_MAP_NCR3) or (CUR_MAP_NCR4)) then begin
                     current_town := "NCR";
                 end
-                if (cur_map_index == 157) then begin
+                if (CUR_MAP_B21) then begin
                     current_town := "B21";
                 end
-                if ((cur_map_index == 37) or (cur_map_index == 38) or (cur_map_index == 36) or (cur_map_index == 39)) then begin
+                if ((CUR_MAP_V15ENT) or (CUR_MAP_V15ENTB) or (CUR_MAP_VAULT15) or (CUR_MAP_V15SENT)) then begin
                     current_town := "Vault 15";
                 end
-                if ((cur_map_index == 40) or (cur_map_index == 41)) then begin
+                if ((CUR_MAP_VAULT13) or (CUR_MAP_V13ENT)) then begin
                     current_town := "Vault 13";
                 end
-                if ((cur_map_index == 49) or (cur_map_index == 50) or (cur_map_index == 51)) then begin
+                if ((CUR_MAP_MBASE12) or (CUR_MAP_MBASE34) or (CUR_MAP_MBCLOSE)) then begin
                     current_town := "Military Base";
                 end
-                if ((cur_map_index == 137) or (cur_map_index == 136) or (cur_map_index == 135) or (cur_map_index == 138) or (cur_map_index == 139) or (cur_map_index == 140) or (cur_map_index == 148)) then begin
+                if ((CUR_MAP_SFCHINA) or (CUR_MAP_SFDOCK) or (CUR_MAP_SFTANKER) or (CUR_MAP_SFSHUTL1) or (CUR_MAP_SFSHUTL2) or (CUR_MAP_SFELRONB) or (CUR_MAP_SFCHINA2)) then begin
                     current_town := "San Francisco";
                 end
-                if ((cur_map_index == 213) or (cur_map_index == 214) or (cur_map_index == 215) or (cur_map_index == 188)) then begin
+                if ((CUR_MAP_BROHDENT1) or (CUR_MAP_BROHD121) or (CUR_MAP_BROHD341) or (CUR_MAP_BROHD1K)) then begin
                     current_town := "Brohdent";
                 end
-                if ((cur_map_index == 218) or (cur_map_index == 217) or (cur_map_index == 219)) then begin
+                if ((CUR_MAP_V14ENT) or (CUR_MAP_VAULT14) or (CUR_MAP_VAULT14B)) then begin
                     current_town := "Vault 14";
                 end
-                if (cur_map_index == 109) then begin
+                if (CUR_MAP_NAVARRO) then begin
                     current_town := "Navarro";
                 end
-                if ((cur_map_index == 129) or (cur_map_index == 128) or (cur_map_index == 130) or (cur_map_index == 131) or (cur_map_index == 132) or (cur_map_index == 133) or (cur_map_index == 134) or (cur_map_index == 243) or (cur_map_index == 244)) then begin
+                if ((CUR_MAP_ENCDOCK) or (CUR_MAP_ENCDET) or (CUR_MAP_ENCFITE) or (CUR_MAP_ENCGD) or (CUR_MAP_ENCPRES) or (CUR_MAP_ENCRCTR) or (CUR_MAP_ENCTRP) or (CUR_MAP_ENCVERT) or (CUR_MAP_ENCFT2)) then begin
                     current_town := "Enclave";
                 end
-                if ((cur_map_index == 238) or (cur_map_index == 229) or (cur_map_index == 240)) then begin
+                if ((CUR_MAP_BROHDENT) or (CUR_MAP_CITYCH3) or (CUR_MAP_BROHD34)) then begin
                     current_town := "BoS Bunker";
                 end
-                if (cur_map_index == 241) then begin
+                if (CUR_MAP_BRHDHLP) then begin
                     current_town := "BoS Help";
                 end
-                if ((cur_map_index == 242) or (cur_map_index == 151)) then begin
+                if ((CUR_MAP_EPAENT) or (CUR_MAP_EPAX)) then begin
                     current_town := "BOS Facility";
                 end
-                if (cur_map_index == 96) then begin
+                if (CUR_MAP_RNDWHALE) then begin
                     current_town := "Special Whale";
                 end
-                if (cur_map_index == 97) then begin
+                if (CUR_MAP_RNDTINWD) then begin
                     current_town := "Special Woodsman";
                 end
-                if (cur_map_index == 98) then begin
+                if (CUR_MAP_RNDBHEAD) then begin
                     current_town := "Special Head";
                 end
-                if (cur_map_index == 99) then begin
+                if (CUR_MAP_RNDSHUTL) then begin
                     current_town := "Special Shuttle";
                 end
-                if (cur_map_index == 100) then begin
+                if (CUR_MAP_RNDUVILG) then begin
                     current_town := "Special Unwashed";
                 end
-                if (cur_map_index == 101) then begin
+                if (CUR_MAP_RNDBRIDG) then begin
                     current_town := "Special Bridge";
                 end
-                if (cur_map_index == 102) then begin
+                if (CUR_MAP_RNDCAFE) then begin
                     current_town := "Special Cafe";
                 end
-                if (cur_map_index == 103) then begin
+                if (CUR_MAP_RNDHOLY1) then begin
                     current_town := "Special Holy 1";
                 end
-                if (cur_map_index == 104) then begin
+                if (CUR_MAP_RNDHOLY2) then begin
                     current_town := "Special Holy 2";
                 end
-                if (cur_map_index == 105) then begin
+                if (CUR_MAP_RNDFORVR) then begin
                     current_town := "Special Guardian";
                 end
-                if (cur_map_index == 106) then begin
+                if (CUR_MAP_RNDTOXIC) then begin
                     current_town := "Special Toxic";
                 end
-                if (cur_map_index == 107) then begin
+                if (CUR_MAP_RNDPARIH) then begin
                     current_town := "Special Pariah";
                 end
-                if (cur_map_index == 108) then begin
+                if (CUR_MAP_RNDEXCOW) then begin
                     current_town := "Special Brahmin";
                 end
-                if (cur_map_index == 164) then begin
+                if (CUR_MAP_RNDPOSTM) then begin
                     current_town := "Special Postman";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvator";
                 end
-                if (cur_map_index == 216) then begin
+                if (CUR_MAP_RNDMSTR) then begin
                     current_town := "Dead Soldiers of Master Army";
                 end
-                if ((cur_map_index == 95) or (cur_map_index == 94)) then begin
+                if ((CUR_MAP_BHRNDMNT) or (CUR_MAP_BHRNDDST)) then begin
                     current_town := "Caravan Encounters";
                 end
-                if (cur_map_index == 149) then begin
+                if (CUR_MAP_GAMMOVIE) then begin
                     current_town := "In Game Movie";
                 end
-                if (cur_map_index == 150) then begin
+                if (CUR_MAP_RNDBESS) then begin
                     current_town := "Bess Dead";
                 end
-                if ((cur_map_index == 152) or (cur_map_index == 159)) then begin
+                if ((CUR_MAP_RNDBD) or (CUR_MAP_RNDBD)) then begin
                     current_town := "DeathClaw Encounters";
                 end
-                if ((cur_map_index == 0) or (cur_map_index == 1) or (cur_map_index == 2) or (cur_map_index == 81) or (cur_map_index == 82) or (cur_map_index == 83) or (cur_map_index == 84) or (cur_map_index == 113) or (cur_map_index == 114) or (cur_map_index == 115) or (cur_map_index == 116) or (cur_map_index == 117)) then begin
+                if ((CUR_MAP_DESERT1) or (CUR_MAP_DESERT2) or (CUR_MAP_DESERT3) or (CUR_MAP_DESERT4) or (CUR_MAP_DESERT5) or (CUR_MAP_DESERT6) or (CUR_MAP_DESERT7) or (CUR_MAP_DESERT213) or (CUR_MAP_DESERT214) or (CUR_MAP_DESERT215) or (CUR_MAP_DESERT216) or (CUR_MAP_DESERT217)) then begin
                     current_town := "Random Encounter Desert";
                 end
-                if ((cur_map_index == 74) or (cur_map_index == 75) or (cur_map_index == 121) or (cur_map_index == 122) or (cur_map_index == 123) or (cur_map_index == 124)) then begin
+                if ((CUR_MAP_MOUNTN1) or (CUR_MAP_MOUNTN2) or (CUR_MAP_MOUNTN3) or (CUR_MAP_MOUNTN4) or (CUR_MAP_MOUNTN5) or (CUR_MAP_MOUNTN6)) then begin
                     current_town := "Random Encounter Mountain";
                 end
-                if ((cur_map_index == 68) or (cur_map_index == 125) or (cur_map_index == 141) or (cur_map_index == 142) or (cur_map_index == 143) or (cur_map_index == 144) or (cur_map_index == 145) or (cur_map_index == 146)) then begin
+                if ((CUR_MAP_CITY1) or (CUR_MAP_CITY2) or (CUR_MAP_CITY3) or (CUR_MAP_CITY4) or (CUR_MAP_CITY5) or (CUR_MAP_CITY6) or (CUR_MAP_CITY7) or (CUR_MAP_CITY8)) then begin
                     current_town := "Random Encounter City";
                 end
-                if ((cur_map_index == 76) or (cur_map_index == 77) or (cur_map_index == 85) or (cur_map_index == 86) or (cur_map_index == 87) or (cur_map_index == 88) or (cur_map_index == 89) or (cur_map_index == 90) or (cur_map_index == 91) or (cur_map_index == 110) or (cur_map_index == 111) or (cur_map_index == 112)) then begin
+                if ((CUR_MAP_COAST1) or (CUR_MAP_COAST2) or (CUR_MAP_COAST3) or (CUR_MAP_COAST4) or (CUR_MAP_COAST5) or (CUR_MAP_COAST6) or (CUR_MAP_COAST7) or (CUR_MAP_COAST8) or (CUR_MAP_COAST9) or (CUR_MAP_COAST10) or (CUR_MAP_COAST11) or (CUR_MAP_07DESERT)) then begin
                     current_town := "Random Encounter Coast";
                 end
-                if ((cur_map_index == 69) or (cur_map_index == 70) or (cur_map_index == 71) or (cur_map_index == 72) or (cur_map_index == 73) or (cur_map_index == 80) or (cur_map_index == 119) or (cur_map_index == 120)) then begin
+                if ((CUR_MAP_CAVE0) or (CUR_MAP_CAVE1) or (CUR_MAP_CAVE2) or (CUR_MAP_CAVE3) or (CUR_MAP_CAVE4) or (CUR_MAP_CAVE5) or (CUR_MAP_CAVE6) or (CUR_MAP_CAVE7)) then begin
                     current_town := "Random Encounter Cavern";
                 end
                 if ((current_town == "Arroyo") or (current_town == "Klamath") or (current_town == "Klamath Toxic Caves") or (current_town == "Mad Dog Area")) then begin
@@ -9339,214 +9339,214 @@ begin
                         end
                     end
                 end
-                if ((cur_map_index == 3) or (cur_map_index == 4) or (cur_map_index == 35) or (cur_map_index == 5)) then begin
+                if ((CUR_MAP_ARCAVES) or (CUR_MAP_ARVILLAG) or (CUR_MAP_ARCAVES5) or (CUR_MAP_ARBRIDGE)) then begin
                     current_town := "Arroyo";
                 end
-                if ((cur_map_index == 9) or (cur_map_index == 10) or (cur_map_index == 11) or (cur_map_index == 13) or (cur_map_index == 14) or (cur_map_index == 48) or (cur_map_index == 161)) then begin
+                if ((CUR_MAP_KLADWTWN) or (CUR_MAP_KLAMALL) or (CUR_MAP_KLARATCV) or (CUR_MAP_KLATRAP) or (CUR_MAP_KLAGRAZ) or (CUR_MAP_KLACANYN) or (CUR_MAP_KLACVENT)) then begin
                     current_town := "Klamath";
                 end
-                if (cur_map_index == 12) then begin
+                if (CUR_MAP_KLATOXCV) then begin
                     current_town := "Klamath Toxic Caves";
                 end
-                if (cur_map_index == 158) then begin
+                if (CUR_MAP_RNDMDDG) then begin
                     current_town := "Mad Dog Area";
                 end
-                if ((cur_map_index == 6) or (cur_map_index == 7) or (cur_map_index == 8)) then begin
+                if ((CUR_MAP_DENBUS1) or (CUR_MAP_DENBUS2) or (CUR_MAP_DENRES1)) then begin
                     current_town := "Den";
                 end
-                if ((cur_map_index == 231) or (cur_map_index == 253) or (cur_map_index == 254) or (cur_map_index == 255)) then begin
+                if ((CUR_MAP_PRIMIT) or (CUR_MAP_TRIBE02) or (CUR_MAP_SLVCAMP) or (CUR_MAP_TRIBE2)) then begin
                     current_town := "Primitive Tribes";
                 end
-                if (cur_map_index == 163) then begin
+                if (CUR_MAP_TRIBE01) then begin
                     current_town := "Primitive Tribe";
                 end
-                if (cur_map_index == 52) then begin
+                if (CUR_MAP_DNSLVRUN) then begin
                     current_town := "Den Slave Run";
                 end
-                if (cur_map_index == 160) then begin
+                if (CUR_MAP_JENFARM7) then begin
                     current_town := "Jennings Farm Area";
                 end
-                if (cur_map_index == 156) then begin
+                if (CUR_MAP_TRUCK) then begin
                     current_town := "Truck";
                 end
-                if (cur_map_index == 162) then begin
+                if (CUR_MAP_SCRAPT) then begin
                     current_town := "Scraptown";
                 end
-                if ((cur_map_index == 18) or (cur_map_index == 19) or (cur_map_index == 20) or (cur_map_index == 21) or (cur_map_index == 22) or (cur_map_index == 23)) then begin
+                if ((CUR_MAP_MODMAIN) or (CUR_MAP_MODINN) or (CUR_MAP_MODBRAH) or (CUR_MAP_MODGARD) or (CUR_MAP_MODSHIT) or (CUR_MAP_MODWELL)) then begin
                     current_town := "Modoc";
                 end
-                if (cur_map_index == 202) then begin
+                if (CUR_MAP_CRISIENT) then begin
                     current_town := "Vault 23";
                 end
-                if ((cur_map_index == 24) or (cur_map_index == 25) or (cur_map_index == 26)) then begin
+                if ((CUR_MAP_GSTFARM) or (CUR_MAP_GSTCAV1) or (CUR_MAP_GSTCAV2)) then begin
                     current_town := "Ghost Farm";
                 end
-                if (cur_map_index == 223) then begin
+                if (CUR_MAP_MODOCT) then begin
                     current_town := "Modoc Thieves Guild";
                 end
-                if (cur_map_index == 224) then begin
+                if (CUR_MAP_MODOCT2) then begin
                     current_town := "Salvatore's Gun Stash";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvatore";
                 end
-                if (cur_map_index == 226) then begin
+                if (CUR_MAP_MODOCT4) then begin
                     current_town := "Salvatore Meeting";
                 end
-                if ((cur_map_index == 31) or (cur_map_index == 32) or (cur_map_index == 33) or (cur_map_index == 34)) then begin
+                if ((CUR_MAP_GECKSETL) or (CUR_MAP_GECKPWPL) or (CUR_MAP_GECKJUNK) or (CUR_MAP_GECKTUNL)) then begin
                     current_town := "Gecko";
                 end
-                if ((cur_map_index == 15) or (cur_map_index == 16) or (cur_map_index == 17) or (cur_map_index == 30)) then begin
+                if ((CUR_MAP_VCTYCTYD) or (CUR_MAP_VCTYDWTN) or (CUR_MAP_VCTYCOCL) or (CUR_MAP_VCTYVLT)) then begin
                     current_town := "Vault City";
                 end
-                if ((cur_map_index == 92) or (cur_map_index == 93)) then begin
+                if ((CUR_MAP_RAIDERS1) or (CUR_MAP_RAIDERS2)) then begin
                     current_town := "Raiders";
                 end
-                if ((cur_map_index == 78) or (cur_map_index == 79)) then begin
+                if ((CUR_MAP_BROKEN1) or (CUR_MAP_BROKEN2)) then begin
                     current_town := "Broken Hills";
                 end
-                if ((cur_map_index == 64) or (cur_map_index == 62) or (cur_map_index == 63) or (cur_map_index == 65) or (cur_map_index == 66) or (cur_map_index == 67)) then begin
+                if ((CUR_MAP_REDDOWN) or (CUR_MAP_REDWAME) or (CUR_MAP_REDWAN1) or (CUR_MAP_REDMENT) or (CUR_MAP_REDDTUN) or (CUR_MAP_REDMTUN)) then begin
                     current_town := "Redding";
                 end
-                if ((cur_map_index == 54) or (cur_map_index == 55) or (cur_map_index == 56) or (cur_map_index == 57) or (cur_map_index == 58) or (cur_map_index == 61) or (cur_map_index == 147)) then begin
+                if ((CUR_MAP_NEWR1) or (CUR_MAP_NEWR2) or (CUR_MAP_NEWR3) or (CUR_MAP_NEWR4) or (CUR_MAP_NEWRCS) or (CUR_MAP_NEWRBA) or (CUR_MAP_NEWRVB)) then begin
                     current_town := "New Reno";
                 end
-                if ((cur_map_index == 195) or (cur_map_index == 197) or (cur_map_index == 235) or (cur_map_index == 196)) then begin
+                if ((CUR_MAP_LARS1) or (CUR_MAP_LARS3) or (CUR_MAP_LARSSCRP) or (CUR_MAP_LARS2)) then begin
                     current_town := "Lars-City";
                 end
-                if (cur_map_index == 232) then begin
+                if (CUR_MAP_CRSNMAIN) then begin
                     current_town := "Lars-City Carson";
                 end
-                if (cur_map_index == 155) then begin
+                if (CUR_MAP_ABBEY) then begin
                     current_town := "Abbey";
                 end
-                if ((cur_map_index == 153) or (cur_map_index == 154)) then begin
+                if ((CUR_MAP_EPAMAIN) or (CUR_MAP_EPAWRHSE)) then begin
                     current_town := "EPA";
                 end
-                if ((cur_map_index == 220) or (cur_map_index == 221)) then begin
+                if ((CUR_MAP_COLLY) or (CUR_MAP_COLLY1)) then begin
                     current_town := "Collyweb";
                 end
-                if (cur_map_index == 59) then begin
+                if (CUR_MAP_NEWRGO) then begin
                     current_town := "Golgotha";
                 end
-                if (cur_map_index == 60) then begin
+                if (CUR_MAP_NEWRST) then begin
                     current_town := "Reno Stables";
                 end
-                if ((cur_map_index == 27) or (cur_map_index == 28) or (cur_map_index == 29)) then begin
+                if ((CUR_MAP_DEPOLV1) or (CUR_MAP_DEPOLVA) or (CUR_MAP_DEPOLVB)) then begin
                     current_town := "Sierra Army Base";
                 end
-                if ((cur_map_index == 46) or (cur_map_index == 43) or (cur_map_index == 42) or (cur_map_index == 44) or (cur_map_index == 45)) then begin
+                if ((CUR_MAP_NCRENT) or (CUR_MAP_NCR2) or (CUR_MAP_NCR1) or (CUR_MAP_NCR3) or (CUR_MAP_NCR4)) then begin
                     current_town := "NCR";
                 end
-                if (cur_map_index == 157) then begin
+                if (CUR_MAP_B21) then begin
                     current_town := "B21";
                 end
-                if ((cur_map_index == 37) or (cur_map_index == 38) or (cur_map_index == 36) or (cur_map_index == 39)) then begin
+                if ((CUR_MAP_V15ENT) or (CUR_MAP_V15ENTB) or (CUR_MAP_VAULT15) or (CUR_MAP_V15SENT)) then begin
                     current_town := "Vault 15";
                 end
-                if ((cur_map_index == 40) or (cur_map_index == 41)) then begin
+                if ((CUR_MAP_VAULT13) or (CUR_MAP_V13ENT)) then begin
                     current_town := "Vault 13";
                 end
-                if ((cur_map_index == 49) or (cur_map_index == 50) or (cur_map_index == 51)) then begin
+                if ((CUR_MAP_MBASE12) or (CUR_MAP_MBASE34) or (CUR_MAP_MBCLOSE)) then begin
                     current_town := "Military Base";
                 end
-                if ((cur_map_index == 137) or (cur_map_index == 136) or (cur_map_index == 135) or (cur_map_index == 138) or (cur_map_index == 139) or (cur_map_index == 140) or (cur_map_index == 148)) then begin
+                if ((CUR_MAP_SFCHINA) or (CUR_MAP_SFDOCK) or (CUR_MAP_SFTANKER) or (CUR_MAP_SFSHUTL1) or (CUR_MAP_SFSHUTL2) or (CUR_MAP_SFELRONB) or (CUR_MAP_SFCHINA2)) then begin
                     current_town := "San Francisco";
                 end
-                if ((cur_map_index == 213) or (cur_map_index == 214) or (cur_map_index == 215) or (cur_map_index == 188)) then begin
+                if ((CUR_MAP_BROHDENT1) or (CUR_MAP_BROHD121) or (CUR_MAP_BROHD341) or (CUR_MAP_BROHD1K)) then begin
                     current_town := "Brohdent";
                 end
-                if ((cur_map_index == 218) or (cur_map_index == 217) or (cur_map_index == 219)) then begin
+                if ((CUR_MAP_V14ENT) or (CUR_MAP_VAULT14) or (CUR_MAP_VAULT14B)) then begin
                     current_town := "Vault 14";
                 end
-                if (cur_map_index == 109) then begin
+                if (CUR_MAP_NAVARRO) then begin
                     current_town := "Navarro";
                 end
-                if ((cur_map_index == 129) or (cur_map_index == 128) or (cur_map_index == 130) or (cur_map_index == 131) or (cur_map_index == 132) or (cur_map_index == 133) or (cur_map_index == 134) or (cur_map_index == 243) or (cur_map_index == 244)) then begin
+                if ((CUR_MAP_ENCDOCK) or (CUR_MAP_ENCDET) or (CUR_MAP_ENCFITE) or (CUR_MAP_ENCGD) or (CUR_MAP_ENCPRES) or (CUR_MAP_ENCRCTR) or (CUR_MAP_ENCTRP) or (CUR_MAP_ENCVERT) or (CUR_MAP_ENCFT2)) then begin
                     current_town := "Enclave";
                 end
-                if ((cur_map_index == 238) or (cur_map_index == 229) or (cur_map_index == 240)) then begin
+                if ((CUR_MAP_BROHDENT) or (CUR_MAP_CITYCH3) or (CUR_MAP_BROHD34)) then begin
                     current_town := "BoS Bunker";
                 end
-                if (cur_map_index == 241) then begin
+                if (CUR_MAP_BRHDHLP) then begin
                     current_town := "BoS Help";
                 end
-                if ((cur_map_index == 242) or (cur_map_index == 151)) then begin
+                if ((CUR_MAP_EPAENT) or (CUR_MAP_EPAX)) then begin
                     current_town := "BOS Facility";
                 end
-                if (cur_map_index == 96) then begin
+                if (CUR_MAP_RNDWHALE) then begin
                     current_town := "Special Whale";
                 end
-                if (cur_map_index == 97) then begin
+                if (CUR_MAP_RNDTINWD) then begin
                     current_town := "Special Woodsman";
                 end
-                if (cur_map_index == 98) then begin
+                if (CUR_MAP_RNDBHEAD) then begin
                     current_town := "Special Head";
                 end
-                if (cur_map_index == 99) then begin
+                if (CUR_MAP_RNDSHUTL) then begin
                     current_town := "Special Shuttle";
                 end
-                if (cur_map_index == 100) then begin
+                if (CUR_MAP_RNDUVILG) then begin
                     current_town := "Special Unwashed";
                 end
-                if (cur_map_index == 101) then begin
+                if (CUR_MAP_RNDBRIDG) then begin
                     current_town := "Special Bridge";
                 end
-                if (cur_map_index == 102) then begin
+                if (CUR_MAP_RNDCAFE) then begin
                     current_town := "Special Cafe";
                 end
-                if (cur_map_index == 103) then begin
+                if (CUR_MAP_RNDHOLY1) then begin
                     current_town := "Special Holy 1";
                 end
-                if (cur_map_index == 104) then begin
+                if (CUR_MAP_RNDHOLY2) then begin
                     current_town := "Special Holy 2";
                 end
-                if (cur_map_index == 105) then begin
+                if (CUR_MAP_RNDFORVR) then begin
                     current_town := "Special Guardian";
                 end
-                if (cur_map_index == 106) then begin
+                if (CUR_MAP_RNDTOXIC) then begin
                     current_town := "Special Toxic";
                 end
-                if (cur_map_index == 107) then begin
+                if (CUR_MAP_RNDPARIH) then begin
                     current_town := "Special Pariah";
                 end
-                if (cur_map_index == 108) then begin
+                if (CUR_MAP_RNDEXCOW) then begin
                     current_town := "Special Brahmin";
                 end
-                if (cur_map_index == 164) then begin
+                if (CUR_MAP_RNDPOSTM) then begin
                     current_town := "Special Postman";
                 end
-                if (cur_map_index == 225) then begin
+                if (CUR_MAP_MODOCT3) then begin
                     current_town := "Special Salvator";
                 end
-                if (cur_map_index == 216) then begin
+                if (CUR_MAP_RNDMSTR) then begin
                     current_town := "Dead Soldiers of Master Army";
                 end
-                if ((cur_map_index == 95) or (cur_map_index == 94)) then begin
+                if ((CUR_MAP_BHRNDMNT) or (CUR_MAP_BHRNDDST)) then begin
                     current_town := "Caravan Encounters";
                 end
-                if (cur_map_index == 149) then begin
+                if (CUR_MAP_GAMMOVIE) then begin
                     current_town := "In Game Movie";
                 end
-                if (cur_map_index == 150) then begin
+                if (CUR_MAP_RNDBESS) then begin
                     current_town := "Bess Dead";
                 end
-                if ((cur_map_index == 152) or (cur_map_index == 159)) then begin
+                if ((CUR_MAP_RNDBD) or (CUR_MAP_RNDBD)) then begin
                     current_town := "DeathClaw Encounters";
                 end
-                if ((cur_map_index == 0) or (cur_map_index == 1) or (cur_map_index == 2) or (cur_map_index == 81) or (cur_map_index == 82) or (cur_map_index == 83) or (cur_map_index == 84) or (cur_map_index == 113) or (cur_map_index == 114) or (cur_map_index == 115) or (cur_map_index == 116) or (cur_map_index == 117)) then begin
+                if ((CUR_MAP_DESERT1) or (CUR_MAP_DESERT2) or (CUR_MAP_DESERT3) or (CUR_MAP_DESERT4) or (CUR_MAP_DESERT5) or (CUR_MAP_DESERT6) or (CUR_MAP_DESERT7) or (CUR_MAP_DESERT213) or (CUR_MAP_DESERT214) or (CUR_MAP_DESERT215) or (CUR_MAP_DESERT216) or (CUR_MAP_DESERT217)) then begin
                     current_town := "Random Encounter Desert";
                 end
-                if ((cur_map_index == 74) or (cur_map_index == 75) or (cur_map_index == 121) or (cur_map_index == 122) or (cur_map_index == 123) or (cur_map_index == 124)) then begin
+                if ((CUR_MAP_MOUNTN1) or (CUR_MAP_MOUNTN2) or (CUR_MAP_MOUNTN3) or (CUR_MAP_MOUNTN4) or (CUR_MAP_MOUNTN5) or (CUR_MAP_MOUNTN6)) then begin
                     current_town := "Random Encounter Mountain";
                 end
-                if ((cur_map_index == 68) or (cur_map_index == 125) or (cur_map_index == 141) or (cur_map_index == 142) or (cur_map_index == 143) or (cur_map_index == 144) or (cur_map_index == 145) or (cur_map_index == 146)) then begin
+                if ((CUR_MAP_CITY1) or (CUR_MAP_CITY2) or (CUR_MAP_CITY3) or (CUR_MAP_CITY4) or (CUR_MAP_CITY5) or (CUR_MAP_CITY6) or (CUR_MAP_CITY7) or (CUR_MAP_CITY8)) then begin
                     current_town := "Random Encounter City";
                 end
-                if ((cur_map_index == 76) or (cur_map_index == 77) or (cur_map_index == 85) or (cur_map_index == 86) or (cur_map_index == 87) or (cur_map_index == 88) or (cur_map_index == 89) or (cur_map_index == 90) or (cur_map_index == 91) or (cur_map_index == 110) or (cur_map_index == 111) or (cur_map_index == 112)) then begin
+                if ((CUR_MAP_COAST1) or (CUR_MAP_COAST2) or (CUR_MAP_COAST3) or (CUR_MAP_COAST4) or (CUR_MAP_COAST5) or (CUR_MAP_COAST6) or (CUR_MAP_COAST7) or (CUR_MAP_COAST8) or (CUR_MAP_COAST9) or (CUR_MAP_COAST10) or (CUR_MAP_COAST11) or (CUR_MAP_07DESERT)) then begin
                     current_town := "Random Encounter Coast";
                 end
-                if ((cur_map_index == 69) or (cur_map_index == 70) or (cur_map_index == 71) or (cur_map_index == 72) or (cur_map_index == 73) or (cur_map_index == 80) or (cur_map_index == 119) or (cur_map_index == 120)) then begin
+                if ((CUR_MAP_CAVE0) or (CUR_MAP_CAVE1) or (CUR_MAP_CAVE2) or (CUR_MAP_CAVE3) or (CUR_MAP_CAVE4) or (CUR_MAP_CAVE5) or (CUR_MAP_CAVE6) or (CUR_MAP_CAVE7)) then begin
                     current_town := "Random Encounter Cavern";
                 end
                 if ((current_town == "Arroyo") or (current_town == "Klamath") or (current_town == "Klamath Toxic Caves") or (current_town == "Mad Dog Area")) then begin
@@ -9825,7 +9825,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                         if (percent >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -9838,17 +9838,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -9866,7 +9866,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                            restock_obj := create_object_sid(case, 0, 0, -1);
+                            restock_obj := create_object(case, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                         end
                         else begin
@@ -9879,17 +9879,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -10130,7 +10130,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                         if (percent >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -10143,17 +10143,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -10171,7 +10171,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                            restock_obj := create_object_sid(case, 0, 0, -1);
+                            restock_obj := create_object(case, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                         end
                         else begin
@@ -10184,17 +10184,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -10435,7 +10435,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                         if (percent >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -10448,17 +10448,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -10476,7 +10476,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                            restock_obj := create_object_sid(case, 0, 0, -1);
+                            restock_obj := create_object(case, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                         end
                         else begin
@@ -10489,17 +10489,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -10740,7 +10740,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                         if (percent >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -10753,17 +10753,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -10781,7 +10781,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                            restock_obj := create_object_sid(case, 0, 0, -1);
+                            restock_obj := create_object(case, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                         end
                         else begin
@@ -10794,17 +10794,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -11045,7 +11045,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                         if (percent >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -11058,17 +11058,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -11086,7 +11086,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                            restock_obj := create_object_sid(case, 0, 0, -1);
+                            restock_obj := create_object(case, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                         end
                         else begin
@@ -11099,17 +11099,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -11353,7 +11353,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                             if (percent >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                    restock_obj := create_object_sid(case, 0, 0, -1);
+                                    restock_obj := create_object(case, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                 end
                                 else begin
@@ -11366,17 +11366,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -11394,7 +11394,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -11407,17 +11407,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -11658,7 +11658,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                             if (percent >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                    restock_obj := create_object_sid(case, 0, 0, -1);
+                                    restock_obj := create_object(case, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                 end
                                 else begin
@@ -11671,17 +11671,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -11699,7 +11699,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -11712,17 +11712,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -11963,7 +11963,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                             if (percent >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                    restock_obj := create_object_sid(case, 0, 0, -1);
+                                    restock_obj := create_object(case, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                 end
                                 else begin
@@ -11976,17 +11976,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -12004,7 +12004,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -12017,17 +12017,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -12268,7 +12268,7 @@ begin
                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                             if (percent >= random(1, 100)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                    restock_obj := create_object_sid(case, 0, 0, -1);
+                                    restock_obj := create_object(case, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                 end
                                 else begin
@@ -12281,17 +12281,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -12309,7 +12309,7 @@ begin
                         end
                         else begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                restock_obj := create_object(case, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                             end
                             else begin
@@ -12322,17 +12322,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -12576,7 +12576,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                                 if (percent >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                        restock_obj := create_object_sid(case, 0, 0, -1);
+                                        restock_obj := create_object(case, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                     end
                                     else begin
@@ -12589,17 +12589,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -12617,7 +12617,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                    restock_obj := create_object_sid(case, 0, 0, -1);
+                                    restock_obj := create_object(case, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                 end
                                 else begin
@@ -12630,17 +12630,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -12881,7 +12881,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                                 if (percent >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                        restock_obj := create_object_sid(case, 0, 0, -1);
+                                        restock_obj := create_object(case, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                     end
                                     else begin
@@ -12894,17 +12894,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -12922,7 +12922,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                    restock_obj := create_object_sid(case, 0, 0, -1);
+                                    restock_obj := create_object(case, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                 end
                                 else begin
@@ -12935,17 +12935,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -13186,7 +13186,7 @@ begin
                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                                 if (percent >= random(1, 100)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                        restock_obj := create_object_sid(case, 0, 0, -1);
+                                        restock_obj := create_object(case, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                     end
                                     else begin
@@ -13199,17 +13199,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -13227,7 +13227,7 @@ begin
                             end
                             else begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                    restock_obj := create_object_sid(case, 0, 0, -1);
+                                    restock_obj := create_object(case, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                 end
                                 else begin
@@ -13240,17 +13240,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -13494,7 +13494,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                                     if (percent >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                            restock_obj := create_object_sid(case, 0, 0, -1);
+                                            restock_obj := create_object(case, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                         end
                                         else begin
@@ -13507,17 +13507,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -13535,7 +13535,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                        restock_obj := create_object_sid(case, 0, 0, -1);
+                                        restock_obj := create_object(case, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                     end
                                     else begin
@@ -13548,17 +13548,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -13799,7 +13799,7 @@ begin
                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                                     if (percent >= random(1, 100)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                            restock_obj := create_object_sid(case, 0, 0, -1);
+                                            restock_obj := create_object(case, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                         end
                                         else begin
@@ -13812,17 +13812,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -13840,7 +13840,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                        restock_obj := create_object_sid(case, 0, 0, -1);
+                                        restock_obj := create_object(case, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                     end
                                     else begin
@@ -13853,17 +13853,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -14107,7 +14107,7 @@ begin
                                     if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                                         if (percent >= random(1, 100)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                                restock_obj := create_object(case, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                             end
                                             else begin
@@ -14120,17 +14120,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -14148,7 +14148,7 @@ begin
                                     end
                                     else begin
                                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                            restock_obj := create_object_sid(case, 0, 0, -1);
+                                            restock_obj := create_object(case, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                         end
                                         else begin
@@ -14161,17 +14161,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -14415,7 +14415,7 @@ begin
                                         if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
                                             if (0 >= random(1, 100)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                                    restock_obj := create_object_sid(case, 0, 0, -1);
+                                                    restock_obj := create_object(case, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                                 end
                                                 else begin
@@ -14428,17 +14428,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -14456,7 +14456,7 @@ begin
                                         end
                                         else begin
                                             if (obj_is_carrying_obj_pid(self_obj, case) < restock_amt) then begin
-                                                restock_obj := create_object_sid(case, 0, 0, -1);
+                                                restock_obj := create_object(case, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, case));
                                             end
                                             else begin
@@ -14469,17 +14469,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, case);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, case);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -14522,7 +14522,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
-                            restock_obj := create_object_sid(360, 0, 0, -1);
+                            restock_obj := create_object(360, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 360));
                         end
                         else begin
@@ -14535,17 +14535,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -14563,7 +14563,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
-                        restock_obj := create_object_sid(360, 0, 0, -1);
+                        restock_obj := create_object(360, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 360));
                     end
                     else begin
@@ -14576,17 +14576,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -14605,7 +14605,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 163) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 163) < restock_amt) then begin
-                            restock_obj := create_object_sid(163, 0, 0, -1);
+                            restock_obj := create_object(163, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 163));
                         end
                         else begin
@@ -14618,17 +14618,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -14646,7 +14646,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 163) < restock_amt) then begin
-                        restock_obj := create_object_sid(163, 0, 0, -1);
+                        restock_obj := create_object(163, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 163));
                     end
                     else begin
@@ -14659,17 +14659,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -14688,7 +14688,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
-                            restock_obj := create_object_sid(35, 0, 0, -1);
+                            restock_obj := create_object(35, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 35));
                         end
                         else begin
@@ -14701,17 +14701,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -14729,7 +14729,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 35) < restock_amt) then begin
-                        restock_obj := create_object_sid(35, 0, 0, -1);
+                        restock_obj := create_object(35, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 35));
                     end
                     else begin
@@ -14742,17 +14742,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -14771,7 +14771,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 31) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 31) < restock_amt) then begin
-                            restock_obj := create_object_sid(31, 0, 0, -1);
+                            restock_obj := create_object(31, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 31));
                         end
                         else begin
@@ -14784,17 +14784,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -14812,7 +14812,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 31) < restock_amt) then begin
-                        restock_obj := create_object_sid(31, 0, 0, -1);
+                        restock_obj := create_object(31, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 31));
                     end
                     else begin
@@ -14825,17 +14825,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -14854,7 +14854,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
-                            restock_obj := create_object_sid(34, 0, 0, -1);
+                            restock_obj := create_object(34, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 34));
                         end
                         else begin
@@ -14867,17 +14867,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -14895,7 +14895,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
-                        restock_obj := create_object_sid(34, 0, 0, -1);
+                        restock_obj := create_object(34, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 34));
                     end
                     else begin
@@ -14908,17 +14908,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -14937,7 +14937,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
-                            restock_obj := create_object_sid(33, 0, 0, -1);
+                            restock_obj := create_object(33, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 33));
                         end
                         else begin
@@ -14950,17 +14950,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -14978,7 +14978,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
-                        restock_obj := create_object_sid(33, 0, 0, -1);
+                        restock_obj := create_object(33, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 33));
                     end
                     else begin
@@ -14991,17 +14991,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15020,7 +15020,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 95) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 95) < restock_amt) then begin
-                            restock_obj := create_object_sid(95, 0, 0, -1);
+                            restock_obj := create_object(95, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 95));
                         end
                         else begin
@@ -15033,17 +15033,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15061,7 +15061,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 95) < restock_amt) then begin
-                        restock_obj := create_object_sid(95, 0, 0, -1);
+                        restock_obj := create_object(95, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 95));
                     end
                     else begin
@@ -15074,17 +15074,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15103,7 +15103,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
-                            restock_obj := create_object_sid(363, 0, 0, -1);
+                            restock_obj := create_object(363, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 363));
                         end
                         else begin
@@ -15116,17 +15116,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15144,7 +15144,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
-                        restock_obj := create_object_sid(363, 0, 0, -1);
+                        restock_obj := create_object(363, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 363));
                     end
                     else begin
@@ -15157,17 +15157,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15186,7 +15186,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 500) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 500) < restock_amt) then begin
-                            restock_obj := create_object_sid(500, 0, 0, -1);
+                            restock_obj := create_object(500, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 500));
                         end
                         else begin
@@ -15199,17 +15199,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 500);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 500);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15227,7 +15227,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 500) < restock_amt) then begin
-                        restock_obj := create_object_sid(500, 0, 0, -1);
+                        restock_obj := create_object(500, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 500));
                     end
                     else begin
@@ -15240,17 +15240,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 500);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 500);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15269,7 +15269,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
-                            restock_obj := create_object_sid(296, 0, 0, -1);
+                            restock_obj := create_object(296, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 296));
                         end
                         else begin
@@ -15282,17 +15282,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 296);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 296);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15310,7 +15310,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
-                        restock_obj := create_object_sid(296, 0, 0, -1);
+                        restock_obj := create_object(296, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 296));
                     end
                     else begin
@@ -15323,17 +15323,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 296);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 296);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15352,7 +15352,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 235) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 235) < restock_amt) then begin
-                            restock_obj := create_object_sid(235, 0, 0, -1);
+                            restock_obj := create_object(235, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 235));
                         end
                         else begin
@@ -15365,17 +15365,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 235);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 235);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15393,7 +15393,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 235) < restock_amt) then begin
-                        restock_obj := create_object_sid(235, 0, 0, -1);
+                        restock_obj := create_object(235, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 235));
                     end
                     else begin
@@ -15406,17 +15406,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 235);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 235);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15435,7 +15435,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                            restock_obj := create_object_sid(30, 0, 0, -1);
+                            restock_obj := create_object(30, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
                         end
                         else begin
@@ -15448,17 +15448,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 30);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 30);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15476,7 +15476,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                        restock_obj := create_object_sid(30, 0, 0, -1);
+                        restock_obj := create_object(30, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
                     end
                     else begin
@@ -15489,17 +15489,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 30);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 30);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15518,7 +15518,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 25) < restock_amt) then begin
                     if (60 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 25) < restock_amt) then begin
-                            restock_obj := create_object_sid(25, 0, 0, -1);
+                            restock_obj := create_object(25, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 25));
                         end
                         else begin
@@ -15531,17 +15531,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 25);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 25);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15559,7 +15559,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 25) < restock_amt) then begin
-                        restock_obj := create_object_sid(25, 0, 0, -1);
+                        restock_obj := create_object(25, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 25));
                     end
                     else begin
@@ -15572,17 +15572,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 25);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 25);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15601,7 +15601,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 45) < restock_amt) then begin
                     if (45 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 45) < restock_amt) then begin
-                            restock_obj := create_object_sid(45, 0, 0, -1);
+                            restock_obj := create_object(45, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 45));
                         end
                         else begin
@@ -15614,17 +15614,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 45);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 45);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15642,7 +15642,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 45) < restock_amt) then begin
-                        restock_obj := create_object_sid(45, 0, 0, -1);
+                        restock_obj := create_object(45, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 45));
                     end
                     else begin
@@ -15655,17 +15655,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 45);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 45);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15684,7 +15684,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
                     if (50 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
-                            restock_obj := create_object_sid(234, 0, 0, -1);
+                            restock_obj := create_object(234, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 234));
                         end
                         else begin
@@ -15697,17 +15697,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 234);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 234);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15725,7 +15725,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
-                        restock_obj := create_object_sid(234, 0, 0, -1);
+                        restock_obj := create_object(234, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 234));
                     end
                     else begin
@@ -15738,17 +15738,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 234);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 234);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15767,7 +15767,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 236) < restock_amt) then begin
                     if (50 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 236) < restock_amt) then begin
-                            restock_obj := create_object_sid(236, 0, 0, -1);
+                            restock_obj := create_object(236, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 236));
                         end
                         else begin
@@ -15780,17 +15780,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 236);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 236);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15808,7 +15808,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 236) < restock_amt) then begin
-                        restock_obj := create_object_sid(236, 0, 0, -1);
+                        restock_obj := create_object(236, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 236));
                     end
                     else begin
@@ -15821,17 +15821,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 236);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 236);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15850,7 +15850,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 292) < restock_amt) then begin
                     if (25 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 292) < restock_amt) then begin
-                            restock_obj := create_object_sid(292, 0, 0, -1);
+                            restock_obj := create_object(292, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 292));
                         end
                         else begin
@@ -15863,17 +15863,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 292);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 292);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15891,7 +15891,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 292) < restock_amt) then begin
-                        restock_obj := create_object_sid(292, 0, 0, -1);
+                        restock_obj := create_object(292, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 292));
                     end
                     else begin
@@ -15904,17 +15904,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 292);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 292);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -15933,7 +15933,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 17) < restock_amt) then begin
                     if (25 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 17) < restock_amt) then begin
-                            restock_obj := create_object_sid(17, 0, 0, -1);
+                            restock_obj := create_object(17, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 17));
                         end
                         else begin
@@ -15946,17 +15946,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 17);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 17);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -15974,7 +15974,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 17) < restock_amt) then begin
-                        restock_obj := create_object_sid(17, 0, 0, -1);
+                        restock_obj := create_object(17, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 17));
                     end
                     else begin
@@ -15987,17 +15987,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 17);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 17);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -16048,36 +16048,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 102));
+                            display_msg(message_str(SCRIPT_CONTAINR, 102));
                         end
                         else begin
-                            display_msg(message_str(16, 103));
+                            display_msg(message_str(SCRIPT_CONTAINR, 103));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 104));
+                            display_msg(message_str(SCRIPT_CONTAINR, 104));
                         end
                         else begin
-                            display_msg(message_str(16, 105));
+                            display_msg(message_str(SCRIPT_CONTAINR, 105));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 106));
+                            display_msg(message_str(SCRIPT_CONTAINR, 106));
                         end
                         else begin
-                            display_msg(message_str(16, 107));
+                            display_msg(message_str(SCRIPT_CONTAINR, 107));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 108));
+                            display_msg(message_str(SCRIPT_CONTAINR, 108));
                         end
                         else begin
-                            display_msg(message_str(16, 109));
+                            display_msg(message_str(SCRIPT_CONTAINR, 109));
                         end
                     end
                 end
@@ -16086,36 +16086,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 110));
+                            display_msg(message_str(SCRIPT_CONTAINR, 110));
                         end
                         else begin
-                            display_msg(message_str(16, 111));
+                            display_msg(message_str(SCRIPT_CONTAINR, 111));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 112));
+                            display_msg(message_str(SCRIPT_CONTAINR, 112));
                         end
                         else begin
-                            display_msg(message_str(16, 113));
+                            display_msg(message_str(SCRIPT_CONTAINR, 113));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 114));
+                            display_msg(message_str(SCRIPT_CONTAINR, 114));
                         end
                         else begin
-                            display_msg(message_str(16, 115));
+                            display_msg(message_str(SCRIPT_CONTAINR, 115));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 116));
+                            display_msg(message_str(SCRIPT_CONTAINR, 116));
                         end
                         else begin
-                            display_msg(message_str(16, 117));
+                            display_msg(message_str(SCRIPT_CONTAINR, 117));
                         end
                     end
                 end
@@ -16127,36 +16127,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 118));
+                            display_msg(message_str(SCRIPT_CONTAINR, 118));
                         end
                         else begin
-                            display_msg(message_str(16, 119));
+                            display_msg(message_str(SCRIPT_CONTAINR, 119));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 120));
+                            display_msg(message_str(SCRIPT_CONTAINR, 120));
                         end
                         else begin
-                            display_msg(message_str(16, 121));
+                            display_msg(message_str(SCRIPT_CONTAINR, 121));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 122));
+                            display_msg(message_str(SCRIPT_CONTAINR, 122));
                         end
                         else begin
-                            display_msg(message_str(16, 123));
+                            display_msg(message_str(SCRIPT_CONTAINR, 123));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 124));
+                            display_msg(message_str(SCRIPT_CONTAINR, 124));
                         end
                         else begin
-                            display_msg(message_str(16, 125));
+                            display_msg(message_str(SCRIPT_CONTAINR, 125));
                         end
                     end
                 end
@@ -16165,36 +16165,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 126));
+                            display_msg(message_str(SCRIPT_CONTAINR, 126));
                         end
                         else begin
-                            display_msg(message_str(16, 127));
+                            display_msg(message_str(SCRIPT_CONTAINR, 127));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 128));
+                            display_msg(message_str(SCRIPT_CONTAINR, 128));
                         end
                         else begin
-                            display_msg(message_str(16, 129));
+                            display_msg(message_str(SCRIPT_CONTAINR, 129));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 130));
+                            display_msg(message_str(SCRIPT_CONTAINR, 130));
                         end
                         else begin
-                            display_msg(message_str(16, 131));
+                            display_msg(message_str(SCRIPT_CONTAINR, 131));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 132));
+                            display_msg(message_str(SCRIPT_CONTAINR, 132));
                         end
                         else begin
-                            display_msg(message_str(16, 133));
+                            display_msg(message_str(SCRIPT_CONTAINR, 133));
                         end
                     end
                 end
@@ -16208,36 +16208,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 134));
+                            display_msg(message_str(SCRIPT_CONTAINR, 134));
                         end
                         else begin
-                            display_msg(message_str(16, 135));
+                            display_msg(message_str(SCRIPT_CONTAINR, 135));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 136));
+                            display_msg(message_str(SCRIPT_CONTAINR, 136));
                         end
                         else begin
-                            display_msg(message_str(16, 137));
+                            display_msg(message_str(SCRIPT_CONTAINR, 137));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 138));
+                            display_msg(message_str(SCRIPT_CONTAINR, 138));
                         end
                         else begin
-                            display_msg(message_str(16, 139));
+                            display_msg(message_str(SCRIPT_CONTAINR, 139));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 140));
+                            display_msg(message_str(SCRIPT_CONTAINR, 140));
                         end
                         else begin
-                            display_msg(message_str(16, 141));
+                            display_msg(message_str(SCRIPT_CONTAINR, 141));
                         end
                     end
                 end
@@ -16246,36 +16246,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 142));
+                            display_msg(message_str(SCRIPT_CONTAINR, 142));
                         end
                         else begin
-                            display_msg(message_str(16, 143));
+                            display_msg(message_str(SCRIPT_CONTAINR, 143));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 144));
+                            display_msg(message_str(SCRIPT_CONTAINR, 144));
                         end
                         else begin
-                            display_msg(message_str(16, 145));
+                            display_msg(message_str(SCRIPT_CONTAINR, 145));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 146));
+                            display_msg(message_str(SCRIPT_CONTAINR, 146));
                         end
                         else begin
-                            display_msg(message_str(16, 147));
+                            display_msg(message_str(SCRIPT_CONTAINR, 147));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 148));
+                            display_msg(message_str(SCRIPT_CONTAINR, 148));
                         end
                         else begin
-                            display_msg(message_str(16, 149));
+                            display_msg(message_str(SCRIPT_CONTAINR, 149));
                         end
                     end
                 end
@@ -16287,36 +16287,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 150));
+                            display_msg(message_str(SCRIPT_CONTAINR, 150));
                         end
                         else begin
-                            display_msg(message_str(16, 151));
+                            display_msg(message_str(SCRIPT_CONTAINR, 151));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 152));
+                            display_msg(message_str(SCRIPT_CONTAINR, 152));
                         end
                         else begin
-                            display_msg(message_str(16, 153));
+                            display_msg(message_str(SCRIPT_CONTAINR, 153));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 154));
+                            display_msg(message_str(SCRIPT_CONTAINR, 154));
                         end
                         else begin
-                            display_msg(message_str(16, 155));
+                            display_msg(message_str(SCRIPT_CONTAINR, 155));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 156));
+                            display_msg(message_str(SCRIPT_CONTAINR, 156));
                         end
                         else begin
-                            display_msg(message_str(16, 157));
+                            display_msg(message_str(SCRIPT_CONTAINR, 157));
                         end
                     end
                 end
@@ -16325,36 +16325,36 @@ begin
                 if (is_critical(LVar1)) then begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 158));
+                            display_msg(message_str(SCRIPT_CONTAINR, 158));
                         end
                         else begin
-                            display_msg(message_str(16, 159));
+                            display_msg(message_str(SCRIPT_CONTAINR, 159));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 160));
+                            display_msg(message_str(SCRIPT_CONTAINR, 160));
                         end
                         else begin
-                            display_msg(message_str(16, 161));
+                            display_msg(message_str(SCRIPT_CONTAINR, 161));
                         end
                     end
                 end
                 else begin
                     if (is_success(LVar2)) then begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 162));
+                            display_msg(message_str(SCRIPT_CONTAINR, 162));
                         end
                         else begin
-                            display_msg(message_str(16, 163));
+                            display_msg(message_str(SCRIPT_CONTAINR, 163));
                         end
                     end
                     else begin
                         if (is_critical(LVar2)) then begin
-                            display_msg(message_str(16, 164));
+                            display_msg(message_str(SCRIPT_CONTAINR, 164));
                         end
                         else begin
-                            display_msg(message_str(16, 165));
+                            display_msg(message_str(SCRIPT_CONTAINR, 165));
                         end
                     end
                 end
@@ -16377,36 +16377,36 @@ begin
         if (is_critical(LVar0)) then begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 104));
+                    display_msg(message_str(SCRIPT_CONTAINR, 104));
                 end
                 else begin
-                    display_msg(message_str(16, 108));
+                    display_msg(message_str(SCRIPT_CONTAINR, 108));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 112));
+                    display_msg(message_str(SCRIPT_CONTAINR, 112));
                 end
                 else begin
-                    display_msg(message_str(16, 116));
+                    display_msg(message_str(SCRIPT_CONTAINR, 116));
                 end
             end
         end
         else begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 120));
+                    display_msg(message_str(SCRIPT_CONTAINR, 120));
                 end
                 else begin
-                    display_msg(message_str(16, 124));
+                    display_msg(message_str(SCRIPT_CONTAINR, 124));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 128));
+                    display_msg(message_str(SCRIPT_CONTAINR, 128));
                 end
                 else begin
-                    display_msg(message_str(16, 132));
+                    display_msg(message_str(SCRIPT_CONTAINR, 132));
                 end
             end
         end
@@ -16415,36 +16415,36 @@ begin
         if (is_critical(LVar0)) then begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 136));
+                    display_msg(message_str(SCRIPT_CONTAINR, 136));
                 end
                 else begin
-                    display_msg(message_str(16, 140));
+                    display_msg(message_str(SCRIPT_CONTAINR, 140));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 144));
+                    display_msg(message_str(SCRIPT_CONTAINR, 144));
                 end
                 else begin
-                    display_msg(message_str(16, 148));
+                    display_msg(message_str(SCRIPT_CONTAINR, 148));
                 end
             end
         end
         else begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 152));
+                    display_msg(message_str(SCRIPT_CONTAINR, 152));
                 end
                 else begin
-                    display_msg(message_str(16, 156));
+                    display_msg(message_str(SCRIPT_CONTAINR, 156));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 160));
+                    display_msg(message_str(SCRIPT_CONTAINR, 160));
                 end
                 else begin
-                    display_msg(message_str(16, 164));
+                    display_msg(message_str(SCRIPT_CONTAINR, 164));
                 end
             end
         end
@@ -16464,36 +16464,36 @@ begin
         if (is_critical(LVar0)) then begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 114));
+                    display_msg(message_str(SCRIPT_CONTAINR, 114));
                 end
                 else begin
-                    display_msg(message_str(16, 115));
+                    display_msg(message_str(SCRIPT_CONTAINR, 115));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 116));
+                    display_msg(message_str(SCRIPT_CONTAINR, 116));
                 end
                 else begin
-                    display_msg(message_str(16, 117));
+                    display_msg(message_str(SCRIPT_CONTAINR, 117));
                 end
             end
         end
         else begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 130));
+                    display_msg(message_str(SCRIPT_CONTAINR, 130));
                 end
                 else begin
-                    display_msg(message_str(16, 131));
+                    display_msg(message_str(SCRIPT_CONTAINR, 131));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 132));
+                    display_msg(message_str(SCRIPT_CONTAINR, 132));
                 end
                 else begin
-                    display_msg(message_str(16, 133));
+                    display_msg(message_str(SCRIPT_CONTAINR, 133));
                 end
             end
         end
@@ -16502,36 +16502,36 @@ begin
         if (is_critical(LVar0)) then begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 146));
+                    display_msg(message_str(SCRIPT_CONTAINR, 146));
                 end
                 else begin
-                    display_msg(message_str(16, 147));
+                    display_msg(message_str(SCRIPT_CONTAINR, 147));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 148));
+                    display_msg(message_str(SCRIPT_CONTAINR, 148));
                 end
                 else begin
-                    display_msg(message_str(16, 149));
+                    display_msg(message_str(SCRIPT_CONTAINR, 149));
                 end
             end
         end
         else begin
             if (is_success(LVar1)) then begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 162));
+                    display_msg(message_str(SCRIPT_CONTAINR, 162));
                 end
                 else begin
-                    display_msg(message_str(16, 163));
+                    display_msg(message_str(SCRIPT_CONTAINR, 163));
                 end
             end
             else begin
                 if (is_critical(LVar1)) then begin
-                    display_msg(message_str(16, 164));
+                    display_msg(message_str(SCRIPT_CONTAINR, 164));
                 end
                 else begin
-                    display_msg(message_str(16, 165));
+                    display_msg(message_str(SCRIPT_CONTAINR, 165));
                 end
             end
         end
@@ -16553,24 +16553,24 @@ begin
         if (local_var(2) == 0) then begin
             set_local_var(2, 1);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 194));
+                display_msg(message_str(SCRIPT_CONTAINR, 194));
             end
             else begin
-                display_msg(message_str(16, 199));
+                display_msg(message_str(SCRIPT_CONTAINR, 199));
             end
             if (local_var(6) == 0) then begin
                 set_local_var(6, 1);
                 give_exp_points(25);
-                display_msg(message_str(14, 100) + 25 + message_str(14, 101));
+                display_msg(g_mstr(100) + 25 + g_mstr(101));
             end
         end
         else begin
             set_local_var(1, 1);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 196));
+                display_msg(message_str(SCRIPT_CONTAINR, 196));
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 201));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 201));
             end
         end
     end
@@ -16581,14 +16581,14 @@ begin
         else begin
             if (local_var(2) == 0) then begin
                 if (source_obj == dude_obj) then begin
-                    display_msg(message_str(16, 195));
+                    display_msg(message_str(SCRIPT_CONTAINR, 195));
                 end
                 else begin
-                    display_msg(obj_name(source_obj) + message_str(16, 200));
+                    display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 200));
                 end
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 202));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 202));
             end
         end
     end
@@ -16612,33 +16612,33 @@ begin
         set_local_var(0, 1);
         obj_unlock(self_obj);
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 170));
+            display_msg(message_str(SCRIPT_CONTAINR, 170));
         end
         else begin
-            display_msg(obj_name(source_obj) + message_str(16, 173));
+            display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 173));
         end
         if (local_var(5) == 0) then begin
             set_local_var(5, 1);
             give_exp_points(25);
-            display_msg(message_str(14, 100) + 25 + message_str(14, 101));
+            display_msg(g_mstr(100) + 25 + g_mstr(101));
         end
     end
     else begin
         if (is_critical(Locks_Roll)) then begin
             jam_lock(self_obj);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 171));
+                display_msg(message_str(SCRIPT_CONTAINR, 171));
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 174));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 174));
             end
         end
         else begin
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 172));
+                display_msg(message_str(SCRIPT_CONTAINR, 172));
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 175));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 175));
             end
         end
     end
@@ -16650,23 +16650,23 @@ begin
         set_local_var(0, 0);
         obj_lock(self_obj);
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 189));
+            display_msg(message_str(SCRIPT_CONTAINR, 189));
         end
         else begin
-            display_msg(obj_name(source_obj) + message_str(16, 191));
+            display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 191));
         end
         if (local_var(5) == 0) then begin
             set_local_var(5, 1);
             give_exp_points(25);
-            display_msg(message_str(14, 100) + 25 + message_str(14, 101));
+            display_msg(g_mstr(100) + 25 + g_mstr(101));
         end
     end
     else begin
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 190));
+            display_msg(message_str(SCRIPT_CONTAINR, 190));
         end
         else begin
-            display_msg(obj_name(source_obj) + message_str(16, 192));
+            display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 192));
         end
     end
 end
@@ -16692,10 +16692,10 @@ begin
     if (obj_is_open(self_obj)) then begin
         script_overrides;
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 206));
+            display_msg(message_str(SCRIPT_CONTAINR, 206));
         end
         else begin
-            display_msg(obj_name(source_obj) + message_str(16, 207));
+            display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 207));
         end
     end
     else begin
@@ -16704,10 +16704,10 @@ begin
         if (is_success(Traps_Roll)) then begin
             set_local_var(1, 0);
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 208));
+                display_msg(message_str(SCRIPT_CONTAINR, 208));
             end
             else begin
-                display_msg(obj_name(source_obj) + message_str(16, 210));
+                display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 210));
             end
         end
         else begin
@@ -16716,10 +16716,10 @@ begin
             end
             else begin
                 if (source_obj == dude_obj) then begin
-                    display_msg(message_str(16, 209));
+                    display_msg(message_str(SCRIPT_CONTAINR, 209));
                 end
                 else begin
-                    display_msg(obj_name(source_obj) + message_str(16, 211));
+                    display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 211));
                 end
             end
         end
@@ -16737,10 +16737,10 @@ begin
         set_local_var(0, 1);
         obj_unlock(self_obj);
         if (source_obj == dude_obj) then begin
-            display_msg(message_str(16, 176));
+            display_msg(message_str(SCRIPT_CONTAINR, 176));
         end
         else begin
-            display_msg(message_str(16, 181));
+            display_msg(message_str(SCRIPT_CONTAINR, 181));
         end
     end
     else begin
@@ -16748,37 +16748,37 @@ begin
             critter_dmg(source_obj, 2, 0 bwor 256);
             if (source_obj == dude_obj) then begin
                 if (2 == 1) then begin
-                    display_msg(message_str(16, 177));
+                    display_msg(message_str(SCRIPT_CONTAINR, 177));
                 end
                 else begin
-                    display_msg(message_str(16, 178) + 2 + message_str(16, 179));
+                    display_msg(message_str(SCRIPT_CONTAINR, 178) + 2 + message_str(SCRIPT_CONTAINR, 179));
                 end
             end
             else begin
-                if (get_critter_stat(source_obj, 34) == 0) then begin
+                if (get_critter_stat(source_obj, STAT_gender) == 0) then begin
                     if (2 == 1) then begin
-                        display_msg(message_str(16, 182));
+                        display_msg(message_str(SCRIPT_CONTAINR, 182));
                     end
                     else begin
-                        display_msg(message_str(16, 183) + 2 + message_str(16, 184));
+                        display_msg(message_str(SCRIPT_CONTAINR, 183) + 2 + message_str(SCRIPT_CONTAINR, 184));
                     end
                 end
                 else begin
                     if (2 == 1) then begin
-                        display_msg(message_str(16, 186));
+                        display_msg(message_str(SCRIPT_CONTAINR, 186));
                     end
                     else begin
-                        display_msg(message_str(16, 187) + 2 + message_str(16, 188));
+                        display_msg(message_str(SCRIPT_CONTAINR, 187) + 2 + message_str(SCRIPT_CONTAINR, 188));
                     end
                 end
             end
         end
         else begin
             if (source_obj == dude_obj) then begin
-                display_msg(message_str(16, 180));
+                display_msg(message_str(SCRIPT_CONTAINR, 180));
             end
             else begin
-                display_msg(message_str(16, 185));
+                display_msg(message_str(SCRIPT_CONTAINR, 185));
             end
         end
     end
@@ -16792,11 +16792,11 @@ begin
     LVar0 := random(10, 20);
     if (source_obj == dude_obj) then begin
         critter_dmg(dude_obj, LVar0, 6 bwor 256);
-        display_msg(message_str(16, 166) + LVar0 + message_str(16, 167));
+        display_msg(message_str(SCRIPT_CONTAINR, 166) + LVar0 + message_str(SCRIPT_CONTAINR, 167));
     end
     else begin
         critter_dmg(source_obj, LVar0, 6 bwor 256);
-        display_msg(obj_name(source_obj) + message_str(16, 168) + LVar0 + message_str(16, 169));
+        display_msg(obj_name(source_obj) + message_str(SCRIPT_CONTAINR, 168) + LVar0 + message_str(SCRIPT_CONTAINR, 169));
     end
     set_local_var(1, 1);
     return 0;
@@ -16814,4 +16814,3 @@ begin
     Locks_Roll := roll_vs_skill(source_obj, 9, 20);
     call Lock_Door();
 end
-
