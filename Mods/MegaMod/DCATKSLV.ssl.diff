diff --git a/Mods/MegaMod/Original/DCATKSLV.ssl b/Mods/MegaMod/ReDefine/DCATKSLV.ssl
index c39e4ce..0789ce1 100644
--- a/Mods/MegaMod/Original/DCATKSLV.ssl
+++ b/Mods/MegaMod/ReDefine/DCATKSLV.ssl
@@ -40,19 +40,19 @@ procedure critter_p_proc
 begin
     if (obj_can_see_obj(self_obj, dude_obj)) then begin
         if ((obj_pid(self_obj) == 16777219) or (obj_pid(self_obj) == 16777220)) then begin
-            float_msg(self_obj, message_str(933, random(300, 308)), 8);
+            float_msg(self_obj, mstr(random(300, 308)), FLOAT_MSG_YELLOW);
         end
         else begin
-            float_msg(self_obj, message_str(933, random(350, 358)), 8);
+            float_msg(self_obj, mstr(random(350, 358)), FLOAT_MSG_YELLOW);
         end
         if (critter_is_fleeing(self_obj)) then begin
             if (anim_busy(self_obj) == 0) then begin
                 if ((tile_distance_objs(self_obj, dude_obj) < 8) or obj_can_see_obj(self_obj, dude_obj)) then begin
                     if (anim_busy(self_obj) == 0) then begin
-                        global_temp := rotation_to_tile(tile_num(dude_obj), tile_num(self_obj));
+                        global_temp := rotation_to_tile(dude_tile, tile_num(self_obj));
                         animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(self_obj), global_temp, random(3, 10)), 1);
                         global_temp := (global_temp + 1) % 6;
-                        while ((anim_busy(self_obj) == 0) and (global_temp != rotation_to_tile(tile_num(dude_obj), tile_num(self_obj)))) do begin
+                        while ((anim_busy(self_obj) == 0) and (global_temp != rotation_to_tile(dude_tile, tile_num(self_obj)))) do begin
                             debug_msg("flee loop: rot == " + global_temp);
                             animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(self_obj), global_temp, random(3, 10)), 1);
                             global_temp := (global_temp + 1) % 6;
@@ -62,13 +62,13 @@ begin
             end
         end
         else begin
-            attack_complex(dude_obj, 0, 1, 0, 0, 30000, 0, 0);
+            attack(dude_obj);
         end
     end
     else begin
-        if ((global_var(446) bwand 33554432) != 0) then begin
+        if ((global_var(GVAR_DEN_FLAG_2) bwand 33554432) != 0) then begin
             if (tile_distance_objs(self_obj, dude_obj) > 1) then begin
-                animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), 1);
+                animate_move_obj_to_tile(self_obj, tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), 1);
             end
         end
         else begin
@@ -77,7 +77,7 @@ begin
                     if (obj_can_see_obj(self_obj, slaver_1_obj) and (tile_distance_objs(slaver_1_obj, self_obj) < tile_distance_objs(dude_obj, self_obj))) then begin
                         debug_msg("setting slave to attack slaver");
                         set_attack := slaver_1_obj;
-                        attack_complex(slaver_1_obj, 0, 1, 0, 0, 30000, 0, 0);
+                        attack(slaver_1_obj);
                     end
                 end
                 if (set_attack == 0) then begin
@@ -85,7 +85,7 @@ begin
                         if (obj_can_see_obj(self_obj, slaver_2_obj) and (tile_distance_objs(slaver_2_obj, self_obj) < tile_distance_objs(dude_obj, self_obj))) then begin
                             debug_msg("setting slave to attack slaver");
                             set_attack := slaver_2_obj;
-                            attack_complex(slaver_2_obj, 0, 1, 0, 0, 30000, 0, 0);
+                            attack(slaver_2_obj);
                         end
                     end
                 end
@@ -114,58 +114,58 @@ end
 
 procedure destroy_p_proc
 begin
-    set_global_var(125, global_var(125) - 1);
-    set_global_var(445, global_var(445) bwor 67108864);
-    debug_msg("current hostile slave count is " + global_var(125));
+    set_global_var(GVAR_MODOC_POST_FLAG, global_var(GVAR_MODOC_POST_FLAG) - 1);
+    set_global_var(GVAR_DEN_FLAG_1, global_var(GVAR_DEN_FLAG_1) bwor 67108864);
+    debug_msg("current hostile slave count is " + global_var(GVAR_MODOC_POST_FLAG));
     if (source_obj == dude_obj) then begin
-        set_global_var(5, global_var(5) + 1);
-        if (metarule(51, self_obj) == 2) then begin
+        set_global_var(GVAR_GOOD_MONSTER, global_var(GVAR_GOOD_MONSTER) + 1);
+        if (critter_kill_type(self_obj) == KILL_TYPE_children_kills) then begin
             if (source_obj == dude_obj) then begin
-                set_global_var(2, 0);
-                set_global_var(1, global_var(1) + 1);
-                set_global_var(0, global_var(0) - -15);
-                set_global_var(37, 0);
-                set_global_var(38, 0);
-                set_global_var(39, 0);
-                set_global_var(40, 0);
-                set_global_var(41, 0);
-                set_global_var(42, 0);
-                set_global_var(43, 0);
-                set_global_var(44, 0);
-                set_global_var(45, 0);
-                if (global_var(0) >= 1000) then begin
-                    set_global_var(37, 1);
+                set_global_var(GVAR_CHAMPION_REPUTATION, 0);
+                set_global_var(GVAR_CHILDKILLER_REPUTATION, global_var(GVAR_CHILDKILLER_REPUTATION) + 1);
+                set_global_var(GVAR_PLAYER_REPUTATION, global_var(GVAR_PLAYER_REPUTATION) - -15);
+                set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
+                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
+                set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
+                set_global_var(GVAR_KARMA_DEFENDER, 0);
+                set_global_var(GVAR_KARMA_WANDERER, 0);
+                set_global_var(GVAR_KARMA_BETRAYER, 0);
+                set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
+                set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
+                set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
+                if (global_var(GVAR_PLAYER_REPUTATION) >= 1000) then begin
+                    set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
                 end
                 else begin
-                    if (global_var(0) >= 750) then begin
-                        set_global_var(38, 1);
+                    if (global_var(GVAR_PLAYER_REPUTATION) >= 750) then begin
+                        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
                     end
                     else begin
-                        if (global_var(0) >= 500) then begin
-                            set_global_var(39, 1);
+                        if (global_var(GVAR_PLAYER_REPUTATION) >= 500) then begin
+                            set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                         end
                         else begin
-                            if (global_var(0) >= 250) then begin
-                                set_global_var(40, 1);
+                            if (global_var(GVAR_PLAYER_REPUTATION) >= 250) then begin
+                                set_global_var(GVAR_KARMA_DEFENDER, 1);
                             end
                             else begin
-                                if (global_var(0) > -250) then begin
-                                    set_global_var(41, 1);
+                                if (global_var(GVAR_PLAYER_REPUTATION) > -250) then begin
+                                    set_global_var(GVAR_KARMA_WANDERER, 1);
                                 end
                                 else begin
-                                    if (global_var(0) > -500) then begin
-                                        set_global_var(42, 1);
+                                    if (global_var(GVAR_PLAYER_REPUTATION) > -500) then begin
+                                        set_global_var(GVAR_KARMA_BETRAYER, 1);
                                     end
                                     else begin
-                                        if (global_var(0) > -750) then begin
-                                            set_global_var(43, 1);
+                                        if (global_var(GVAR_PLAYER_REPUTATION) > -750) then begin
+                                            set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                         end
                                         else begin
-                                            if (global_var(0) > -1000) then begin
-                                                set_global_var(44, 1);
+                                            if (global_var(GVAR_PLAYER_REPUTATION) > -1000) then begin
+                                                set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                             end
                                             else begin
-                                                set_global_var(45, 1);
+                                                set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                             end
                                         end
                                     end
@@ -176,58 +176,58 @@ begin
                 end
             end
         end
-        if (((global_var(4) + global_var(5)) >= 25) and ((global_var(4) > (3 * global_var(5))) or (global_var(2) == 1)) and (global_var(1) == 0)) then begin
-            set_global_var(2, 1);
-            set_global_var(3, 0);
+        if (((global_var(GVAR_BAD_MONSTER) + global_var(GVAR_GOOD_MONSTER)) >= 25) and ((global_var(4) > (3 * global_var(GVAR_GOOD_MONSTER))) or (global_var(GVAR_CHAMPION_REPUTATION) == 1)) and (global_var(GVAR_CHILDKILLER_REPUTATION) == 0)) then begin
+            set_global_var(GVAR_CHAMPION_REPUTATION, 1);
+            set_global_var(GVAR_BERSERKER_REPUTATION, 0);
         end
-        if (((global_var(4) + global_var(5)) >= 25) and ((global_var(5) > (2 * global_var(4))) or (global_var(3) == 1))) then begin
-            set_global_var(3, 1);
-            set_global_var(2, 0);
+        if (((global_var(GVAR_BAD_MONSTER) + global_var(GVAR_GOOD_MONSTER)) >= 25) and ((global_var(GVAR_GOOD_MONSTER) > (2 * global_var(GVAR_BAD_MONSTER))) or (global_var(GVAR_BERSERKER_REPUTATION) == 1))) then begin
+            set_global_var(GVAR_BERSERKER_REPUTATION, 1);
+            set_global_var(GVAR_CHAMPION_REPUTATION, 0);
         end
-        set_global_var(0, global_var(0) + -10);
+        set_global_var(GVAR_PLAYER_REPUTATION, global_var(GVAR_PLAYER_REPUTATION) + -10);
         debug_msg("Player gains " + -10 + " Karma Points.");
-        set_global_var(37, 0);
-        set_global_var(38, 0);
-        set_global_var(39, 0);
-        set_global_var(40, 0);
-        set_global_var(41, 0);
-        set_global_var(42, 0);
-        set_global_var(43, 0);
-        set_global_var(44, 0);
-        set_global_var(45, 0);
-        if (global_var(0) >= 1000) then begin
-            set_global_var(37, 1);
+        set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
+        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
+        set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
+        set_global_var(GVAR_KARMA_DEFENDER, 0);
+        set_global_var(GVAR_KARMA_WANDERER, 0);
+        set_global_var(GVAR_KARMA_BETRAYER, 0);
+        set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
+        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
+        set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
+        if (global_var(GVAR_PLAYER_REPUTATION) >= 1000) then begin
+            set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
         end
         else begin
-            if (global_var(0) >= 750) then begin
-                set_global_var(38, 1);
+            if (global_var(GVAR_PLAYER_REPUTATION) >= 750) then begin
+                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
             end
             else begin
-                if (global_var(0) >= 500) then begin
-                    set_global_var(39, 1);
+                if (global_var(GVAR_PLAYER_REPUTATION) >= 500) then begin
+                    set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                 end
                 else begin
-                    if (global_var(0) >= 250) then begin
-                        set_global_var(40, 1);
+                    if (global_var(GVAR_PLAYER_REPUTATION) >= 250) then begin
+                        set_global_var(GVAR_KARMA_DEFENDER, 1);
                     end
                     else begin
-                        if (global_var(0) > -250) then begin
-                            set_global_var(41, 1);
+                        if (global_var(GVAR_PLAYER_REPUTATION) > -250) then begin
+                            set_global_var(GVAR_KARMA_WANDERER, 1);
                         end
                         else begin
-                            if (global_var(0) > -500) then begin
-                                set_global_var(42, 1);
+                            if (global_var(GVAR_PLAYER_REPUTATION) > -500) then begin
+                                set_global_var(GVAR_KARMA_BETRAYER, 1);
                             end
                             else begin
-                                if (global_var(0) > -750) then begin
-                                    set_global_var(43, 1);
+                                if (global_var(GVAR_PLAYER_REPUTATION) > -750) then begin
+                                    set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                 end
                                 else begin
-                                    if (global_var(0) > -1000) then begin
-                                        set_global_var(44, 1);
+                                    if (global_var(GVAR_PLAYER_REPUTATION) > -1000) then begin
+                                        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                     end
                                     else begin
-                                        set_global_var(45, 1);
+                                        set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                     end
                                 end
                             end
@@ -243,10 +243,10 @@ procedure look_at_p_proc
 begin
     script_overrides;
     if ((obj_pid(self_obj) == 16777219) or (obj_pid(self_obj) == 16777220)) then begin
-        display_msg(message_str(933, 100 + (get_critter_stat(self_obj, 34) == 1)));
+        display_mstr(100 + (self_gender == 1));
     end
     else begin
-        display_msg(message_str(933, 200 + (10 * (get_critter_stat(self_obj, 34) == 1)) + local_var(1)));
+        display_mstr(200 + (10 * (self_gender == 1)) + local_var(1));
     end
 end
 
@@ -254,10 +254,10 @@ procedure description_p_proc
 begin
     script_overrides;
     if ((obj_pid(self_obj) == 16777219) or (obj_pid(self_obj) == 16777220)) then begin
-        display_msg(message_str(933, 100 + (get_critter_stat(self_obj, 34) == 1)));
+        display_mstr(100 + (self_gender == 1));
     end
     else begin
-        display_msg(message_str(933, 200 + (10 * (get_critter_stat(self_obj, 34) == 1)) + local_var(1)));
+        display_mstr(200 + (10 * (self_gender == 1)) + local_var(1));
     end
     set_local_var(0, local_var(0) bwor 4);
 end
@@ -286,7 +286,7 @@ begin
             if (elevation(self_obj) != 2) then begin
                 if (random(0, 1)) then begin
                     if (obj_is_carrying_obj_pid(self_obj, 7) < 1) then begin
-                        restock_obj := create_object_sid(7, 0, 0, -1);
+                        restock_obj := create_object(7, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 7));
                     end
                     else begin
@@ -299,17 +299,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 7);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 7);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -325,7 +325,7 @@ begin
                     end
                     if (1) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 7)) then begin
-                            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 7));
+                            wield_obj(obj_carrying_pid_obj(self_obj, 7));
                         end
                         else begin
                             debug_msg("NOT ARMING THE WEAPON!!!");
@@ -333,7 +333,7 @@ begin
                     end
                     if (0 != 0) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 0) < 0) then begin
-                            restock_obj := create_object_sid(0, 0, 0, -1);
+                            restock_obj := create_object(0, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 0));
                         end
                         else begin
@@ -346,17 +346,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 0);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 0);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -374,7 +374,7 @@ begin
                     else begin
                         if ((7 == 8) or (7 == 300) or (7 == 9)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 29) < 0) then begin
-                                restock_obj := create_object_sid(29, 0, 0, -1);
+                                restock_obj := create_object(29, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 29));
                             end
                             else begin
@@ -387,17 +387,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -415,7 +415,7 @@ begin
                         else begin
                             if ((7 == 10) or (7 == 350) or (7 == 355) or (7 == 143) or (7 == 241) or (7 == 287)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 34) < 0) then begin
-                                    restock_obj := create_object_sid(34, 0, 0, -1);
+                                    restock_obj := create_object(34, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 34));
                                 end
                                 else begin
@@ -428,17 +428,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -456,7 +456,7 @@ begin
                             else begin
                                 if ((7 == 11) or (7 == 400)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 32) < 0) then begin
-                                        restock_obj := create_object_sid(32, 0, 0, -1);
+                                        restock_obj := create_object(32, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 32));
                                     end
                                     else begin
@@ -469,17 +469,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -497,7 +497,7 @@ begin
                                 else begin
                                     if ((7 == 12) or (7 == 353) or (7 == 389) or (7 == 405) or (7 == 23)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 35) < 0) then begin
-                                            restock_obj := create_object_sid(35, 0, 0, -1);
+                                            restock_obj := create_object(35, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 35));
                                         end
                                         else begin
@@ -510,17 +510,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -538,7 +538,7 @@ begin
                                     else begin
                                         if (7 == 13) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 14) < 0) then begin
-                                                restock_obj := create_object_sid(14, 0, 0, -1);
+                                                restock_obj := create_object(14, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 14));
                                             end
                                             else begin
@@ -551,17 +551,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 14);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 14);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -579,7 +579,7 @@ begin
                                         else begin
                                             if ((7 == 15) or (7 == 397) or (7 == 28) or (7 == 118) or (7 == 401) or (7 == 233)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 39) < 0) then begin
-                                                    restock_obj := create_object_sid(39, 0, 0, -1);
+                                                    restock_obj := create_object(39, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 39));
                                                 end
                                                 else begin
@@ -592,17 +592,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -620,7 +620,7 @@ begin
                                             else begin
                                                 if ((7 == 16) or (7 == 235) or (7 == 407) or (7 == 116) or (7 == 160) or (7 == 399) or (7 == 24) or (7 == 406) or (7 == 393) or (7 == 396) or (7 == 120) or (7 == 402)) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 38) < 0) then begin
-                                                        restock_obj := create_object_sid(38, 0, 0, -1);
+                                                        restock_obj := create_object(38, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 38));
                                                     end
                                                     else begin
@@ -633,17 +633,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 38);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 38);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -661,7 +661,7 @@ begin
                                                 else begin
                                                     if ((7 == 18) or (7 == 398) or (7 == 404) or (7 == 313)) then begin
                                                         if (obj_is_carrying_obj_pid(self_obj, 31) < 0) then begin
-                                                            restock_obj := create_object_sid(31, 0, 0, -1);
+                                                            restock_obj := create_object(31, 0, 0);
                                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 31));
                                                         end
                                                         else begin
@@ -674,17 +674,17 @@ begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                                                     if (obj_type(self_obj) == 1) then begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                             end
                                                                         end
                                                                         else begin
-                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                metarule(43, self_obj);
+                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                inven_unwield(self_obj);
                                                                             end
                                                                         end
                                                                     end
@@ -702,7 +702,7 @@ begin
                                                     else begin
                                                         if (7 == 22) then begin
                                                             if (obj_is_carrying_obj_pid(self_obj, 33) < 0) then begin
-                                                                restock_obj := create_object_sid(33, 0, 0, -1);
+                                                                restock_obj := create_object(33, 0, 0);
                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 33));
                                                             end
                                                             else begin
@@ -715,17 +715,17 @@ begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                                                         if (obj_type(self_obj) == 1) then begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                 end
                                                                             end
                                                                             else begin
-                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                    metarule(43, self_obj);
+                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                    inven_unwield(self_obj);
                                                                                 end
                                                                             end
                                                                         end
@@ -743,7 +743,7 @@ begin
                                                         else begin
                                                             if ((7 == 94) or (7 == 354) or (7 == 385) or (7 == 242) or (7 == 268)) then begin
                                                                 if (obj_is_carrying_obj_pid(self_obj, 95) < 0) then begin
-                                                                    restock_obj := create_object_sid(95, 0, 0, -1);
+                                                                    restock_obj := create_object(95, 0, 0);
                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 95));
                                                                 end
                                                                 else begin
@@ -756,17 +756,17 @@ begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                     end
                                                                                 end
                                                                                 else begin
-                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                        metarule(43, self_obj);
+                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                        inven_unwield(self_obj);
                                                                                     end
                                                                                 end
                                                                             end
@@ -784,7 +784,7 @@ begin
                                                             else begin
                                                                 if (7 == 122) then begin
                                                                     if (obj_is_carrying_obj_pid(self_obj, 121) < 0) then begin
-                                                                        restock_obj := create_object_sid(121, 0, 0, -1);
+                                                                        restock_obj := create_object(121, 0, 0);
                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 121));
                                                                     end
                                                                     else begin
@@ -797,17 +797,17 @@ begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 121);
                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 121);
-                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                         end
                                                                                     end
                                                                                     else begin
-                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                            metarule(43, self_obj);
+                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                            inven_unwield(self_obj);
                                                                                         end
                                                                                     end
                                                                                 end
@@ -825,7 +825,7 @@ begin
                                                                 else begin
                                                                     if (7 == 296) then begin
                                                                         if (obj_is_carrying_obj_pid(self_obj, 360) < 0) then begin
-                                                                            restock_obj := create_object_sid(360, 0, 0, -1);
+                                                                            restock_obj := create_object(360, 0, 0);
                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 360));
                                                                         end
                                                                         else begin
@@ -838,17 +838,17 @@ begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                             end
                                                                                         end
                                                                                         else begin
-                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                metarule(43, self_obj);
+                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                inven_unwield(self_obj);
                                                                                             end
                                                                                         end
                                                                                     end
@@ -866,7 +866,7 @@ begin
                                                                     else begin
                                                                         if (7 == 270) then begin
                                                                             if (obj_is_carrying_obj_pid(self_obj, 274) < 0) then begin
-                                                                                restock_obj := create_object_sid(274, 0, 0, -1);
+                                                                                restock_obj := create_object(274, 0, 0);
                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 274));
                                                                             end
                                                                             else begin
@@ -879,17 +879,17 @@ begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 274);
                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 274);
-                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                 end
                                                                                             end
                                                                                             else begin
-                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                    metarule(43, self_obj);
+                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                    inven_unwield(self_obj);
                                                                                                 end
                                                                                             end
                                                                                         end
@@ -907,7 +907,7 @@ begin
                                                                         else begin
                                                                             if (7 == 299) then begin
                                                                                 if (obj_is_carrying_obj_pid(self_obj, 19) < 0) then begin
-                                                                                    restock_obj := create_object_sid(19, 0, 0, -1);
+                                                                                    restock_obj := create_object(19, 0, 0);
                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 19));
                                                                                 end
                                                                                 else begin
@@ -920,17 +920,17 @@ begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 19);
                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 19);
-                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                        metarule(43, self_obj);
+                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                        inven_unwield(self_obj);
                                                                                                     end
                                                                                                 end
                                                                                             end
@@ -948,7 +948,7 @@ begin
                                                                             else begin
                                                                                 if ((7 == 161) or (7 == 162) or (7 == 261)) then begin
                                                                                     if (obj_is_carrying_obj_pid(self_obj, 163) < 0) then begin
-                                                                                        restock_obj := create_object_sid(163, 0, 0, -1);
+                                                                                        restock_obj := create_object(163, 0, 0);
                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 163));
                                                                                     end
                                                                                     else begin
@@ -961,17 +961,17 @@ begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                         end
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                            metarule(43, self_obj);
+                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                            inven_unwield(self_obj);
                                                                                                         end
                                                                                                     end
                                                                                                 end
@@ -989,7 +989,7 @@ begin
                                                                                 else begin
                                                                                     if ((7 == 283) or (7 == 332)) then begin
                                                                                         if (obj_is_carrying_obj_pid(self_obj, 357) < 0) then begin
-                                                                                            restock_obj := create_object_sid(357, 0, 0, -1);
+                                                                                            restock_obj := create_object(357, 0, 0);
                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 357));
                                                                                         end
                                                                                         else begin
@@ -1002,17 +1002,17 @@ begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                             end
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                metarule(43, self_obj);
+                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                inven_unwield(self_obj);
                                                                                                             end
                                                                                                         end
                                                                                                     end
@@ -1030,7 +1030,7 @@ begin
                                                                                     else begin
                                                                                         if ((7 == 351) or (7 == 403) or (7 == 387)) then begin
                                                                                             if (obj_is_carrying_obj_pid(self_obj, 363) < 0) then begin
-                                                                                                restock_obj := create_object_sid(363, 0, 0, -1);
+                                                                                                restock_obj := create_object(363, 0, 0);
                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 363));
                                                                                             end
                                                                                             else begin
@@ -1043,17 +1043,17 @@ begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                    metarule(43, self_obj);
+                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                    inven_unwield(self_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                         end
@@ -1071,7 +1071,7 @@ begin
                                                                                         else begin
                                                                                             if ((7 == 392) or (7 == 394)) then begin
                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 358) < 0) then begin
-                                                                                                    restock_obj := create_object_sid(358, 0, 0, -1);
+                                                                                                    restock_obj := create_object(358, 0, 0);
                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 358));
                                                                                                 end
                                                                                                 else begin
@@ -1084,17 +1084,17 @@ begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 358);
                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 358);
-                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                        metarule(43, self_obj);
+                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                        inven_unwield(self_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                             end
@@ -1112,7 +1112,7 @@ begin
                                                                                             else begin
                                                                                                 if ((7 == 352) or (7 == 391) or (7 == 395)) then begin
                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 359) < 0) then begin
-                                                                                                        restock_obj := create_object_sid(359, 0, 0, -1);
+                                                                                                        restock_obj := create_object(359, 0, 0);
                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 359));
                                                                                                     end
                                                                                                     else begin
@@ -1125,17 +1125,17 @@ begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 359);
                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 359);
-                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                            metarule(43, self_obj);
+                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                            inven_unwield(self_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                 end
@@ -1153,7 +1153,7 @@ begin
                                                                                                 else begin
                                                                                                     if (7 == 388) then begin
                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 361) < 0) then begin
-                                                                                                            restock_obj := create_object_sid(361, 0, 0, -1);
+                                                                                                            restock_obj := create_object(361, 0, 0);
                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 361));
                                                                                                         end
                                                                                                         else begin
@@ -1166,17 +1166,17 @@ begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                metarule(43, self_obj);
+                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                inven_unwield(self_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                     end
@@ -1214,7 +1214,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 4) < 1) then begin
-                        restock_obj := create_object_sid(4, 0, 0, -1);
+                        restock_obj := create_object(4, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 4));
                     end
                     else begin
@@ -1227,17 +1227,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 4);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 4);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1253,7 +1253,7 @@ begin
                     end
                     if (1) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 4)) then begin
-                            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 4));
+                            wield_obj(obj_carrying_pid_obj(self_obj, 4));
                         end
                         else begin
                             debug_msg("NOT ARMING THE WEAPON!!!");
@@ -1261,7 +1261,7 @@ begin
                     end
                     if (0 != 0) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 0) < 0) then begin
-                            restock_obj := create_object_sid(0, 0, 0, -1);
+                            restock_obj := create_object(0, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 0));
                         end
                         else begin
@@ -1274,17 +1274,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 0);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 0);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1302,7 +1302,7 @@ begin
                     else begin
                         if ((4 == 8) or (4 == 300) or (4 == 9)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 29) < 0) then begin
-                                restock_obj := create_object_sid(29, 0, 0, -1);
+                                restock_obj := create_object(29, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 29));
                             end
                             else begin
@@ -1315,17 +1315,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1343,7 +1343,7 @@ begin
                         else begin
                             if ((4 == 10) or (4 == 350) or (4 == 355) or (4 == 143) or (4 == 241) or (4 == 287)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 34) < 0) then begin
-                                    restock_obj := create_object_sid(34, 0, 0, -1);
+                                    restock_obj := create_object(34, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 34));
                                 end
                                 else begin
@@ -1356,17 +1356,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -1384,7 +1384,7 @@ begin
                             else begin
                                 if ((4 == 11) or (4 == 400)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 32) < 0) then begin
-                                        restock_obj := create_object_sid(32, 0, 0, -1);
+                                        restock_obj := create_object(32, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 32));
                                     end
                                     else begin
@@ -1397,17 +1397,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -1425,7 +1425,7 @@ begin
                                 else begin
                                     if ((4 == 12) or (4 == 353) or (4 == 389) or (4 == 405) or (4 == 23)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 35) < 0) then begin
-                                            restock_obj := create_object_sid(35, 0, 0, -1);
+                                            restock_obj := create_object(35, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 35));
                                         end
                                         else begin
@@ -1438,17 +1438,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -1466,7 +1466,7 @@ begin
                                     else begin
                                         if (4 == 13) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 14) < 0) then begin
-                                                restock_obj := create_object_sid(14, 0, 0, -1);
+                                                restock_obj := create_object(14, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 14));
                                             end
                                             else begin
@@ -1479,17 +1479,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 14);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 14);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -1507,7 +1507,7 @@ begin
                                         else begin
                                             if ((4 == 15) or (4 == 397) or (4 == 28) or (4 == 118) or (4 == 401) or (4 == 233)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 39) < 0) then begin
-                                                    restock_obj := create_object_sid(39, 0, 0, -1);
+                                                    restock_obj := create_object(39, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 39));
                                                 end
                                                 else begin
@@ -1520,17 +1520,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -1548,7 +1548,7 @@ begin
                                             else begin
                                                 if ((4 == 16) or (4 == 235) or (4 == 407) or (4 == 116) or (4 == 160) or (4 == 399) or (4 == 24) or (4 == 406) or (4 == 393) or (4 == 396) or (4 == 120) or (4 == 402)) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 38) < 0) then begin
-                                                        restock_obj := create_object_sid(38, 0, 0, -1);
+                                                        restock_obj := create_object(38, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 38));
                                                     end
                                                     else begin
@@ -1561,17 +1561,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 38);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 38);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -1589,7 +1589,7 @@ begin
                                                 else begin
                                                     if ((4 == 18) or (4 == 398) or (4 == 404) or (4 == 313)) then begin
                                                         if (obj_is_carrying_obj_pid(self_obj, 31) < 0) then begin
-                                                            restock_obj := create_object_sid(31, 0, 0, -1);
+                                                            restock_obj := create_object(31, 0, 0);
                                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 31));
                                                         end
                                                         else begin
@@ -1602,17 +1602,17 @@ begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                                                     if (obj_type(self_obj) == 1) then begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                             end
                                                                         end
                                                                         else begin
-                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                metarule(43, self_obj);
+                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                inven_unwield(self_obj);
                                                                             end
                                                                         end
                                                                     end
@@ -1630,7 +1630,7 @@ begin
                                                     else begin
                                                         if (4 == 22) then begin
                                                             if (obj_is_carrying_obj_pid(self_obj, 33) < 0) then begin
-                                                                restock_obj := create_object_sid(33, 0, 0, -1);
+                                                                restock_obj := create_object(33, 0, 0);
                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 33));
                                                             end
                                                             else begin
@@ -1643,17 +1643,17 @@ begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                                                         if (obj_type(self_obj) == 1) then begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                 end
                                                                             end
                                                                             else begin
-                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                    metarule(43, self_obj);
+                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                    inven_unwield(self_obj);
                                                                                 end
                                                                             end
                                                                         end
@@ -1671,7 +1671,7 @@ begin
                                                         else begin
                                                             if ((4 == 94) or (4 == 354) or (4 == 385) or (4 == 242) or (4 == 268)) then begin
                                                                 if (obj_is_carrying_obj_pid(self_obj, 95) < 0) then begin
-                                                                    restock_obj := create_object_sid(95, 0, 0, -1);
+                                                                    restock_obj := create_object(95, 0, 0);
                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 95));
                                                                 end
                                                                 else begin
@@ -1684,17 +1684,17 @@ begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                     end
                                                                                 end
                                                                                 else begin
-                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                        metarule(43, self_obj);
+                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                        inven_unwield(self_obj);
                                                                                     end
                                                                                 end
                                                                             end
@@ -1712,7 +1712,7 @@ begin
                                                             else begin
                                                                 if (4 == 122) then begin
                                                                     if (obj_is_carrying_obj_pid(self_obj, 121) < 0) then begin
-                                                                        restock_obj := create_object_sid(121, 0, 0, -1);
+                                                                        restock_obj := create_object(121, 0, 0);
                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 121));
                                                                     end
                                                                     else begin
@@ -1725,17 +1725,17 @@ begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 121);
                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 121);
-                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                         end
                                                                                     end
                                                                                     else begin
-                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                            metarule(43, self_obj);
+                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                            inven_unwield(self_obj);
                                                                                         end
                                                                                     end
                                                                                 end
@@ -1753,7 +1753,7 @@ begin
                                                                 else begin
                                                                     if (4 == 296) then begin
                                                                         if (obj_is_carrying_obj_pid(self_obj, 360) < 0) then begin
-                                                                            restock_obj := create_object_sid(360, 0, 0, -1);
+                                                                            restock_obj := create_object(360, 0, 0);
                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 360));
                                                                         end
                                                                         else begin
@@ -1766,17 +1766,17 @@ begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                             end
                                                                                         end
                                                                                         else begin
-                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                metarule(43, self_obj);
+                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                inven_unwield(self_obj);
                                                                                             end
                                                                                         end
                                                                                     end
@@ -1794,7 +1794,7 @@ begin
                                                                     else begin
                                                                         if (4 == 270) then begin
                                                                             if (obj_is_carrying_obj_pid(self_obj, 274) < 0) then begin
-                                                                                restock_obj := create_object_sid(274, 0, 0, -1);
+                                                                                restock_obj := create_object(274, 0, 0);
                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 274));
                                                                             end
                                                                             else begin
@@ -1807,17 +1807,17 @@ begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 274);
                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 274);
-                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                 end
                                                                                             end
                                                                                             else begin
-                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                    metarule(43, self_obj);
+                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                    inven_unwield(self_obj);
                                                                                                 end
                                                                                             end
                                                                                         end
@@ -1835,7 +1835,7 @@ begin
                                                                         else begin
                                                                             if (4 == 299) then begin
                                                                                 if (obj_is_carrying_obj_pid(self_obj, 19) < 0) then begin
-                                                                                    restock_obj := create_object_sid(19, 0, 0, -1);
+                                                                                    restock_obj := create_object(19, 0, 0);
                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 19));
                                                                                 end
                                                                                 else begin
@@ -1848,17 +1848,17 @@ begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 19);
                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 19);
-                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                        metarule(43, self_obj);
+                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                        inven_unwield(self_obj);
                                                                                                     end
                                                                                                 end
                                                                                             end
@@ -1876,7 +1876,7 @@ begin
                                                                             else begin
                                                                                 if ((4 == 161) or (4 == 162) or (4 == 261)) then begin
                                                                                     if (obj_is_carrying_obj_pid(self_obj, 163) < 0) then begin
-                                                                                        restock_obj := create_object_sid(163, 0, 0, -1);
+                                                                                        restock_obj := create_object(163, 0, 0);
                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 163));
                                                                                     end
                                                                                     else begin
@@ -1889,17 +1889,17 @@ begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                         end
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                            metarule(43, self_obj);
+                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                            inven_unwield(self_obj);
                                                                                                         end
                                                                                                     end
                                                                                                 end
@@ -1917,7 +1917,7 @@ begin
                                                                                 else begin
                                                                                     if ((4 == 283) or (4 == 332)) then begin
                                                                                         if (obj_is_carrying_obj_pid(self_obj, 357) < 0) then begin
-                                                                                            restock_obj := create_object_sid(357, 0, 0, -1);
+                                                                                            restock_obj := create_object(357, 0, 0);
                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 357));
                                                                                         end
                                                                                         else begin
@@ -1930,17 +1930,17 @@ begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                             end
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                metarule(43, self_obj);
+                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                inven_unwield(self_obj);
                                                                                                             end
                                                                                                         end
                                                                                                     end
@@ -1958,7 +1958,7 @@ begin
                                                                                     else begin
                                                                                         if ((4 == 351) or (4 == 403) or (4 == 387)) then begin
                                                                                             if (obj_is_carrying_obj_pid(self_obj, 363) < 0) then begin
-                                                                                                restock_obj := create_object_sid(363, 0, 0, -1);
+                                                                                                restock_obj := create_object(363, 0, 0);
                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 363));
                                                                                             end
                                                                                             else begin
@@ -1971,17 +1971,17 @@ begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                    metarule(43, self_obj);
+                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                    inven_unwield(self_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                         end
@@ -1999,7 +1999,7 @@ begin
                                                                                         else begin
                                                                                             if ((4 == 392) or (4 == 394)) then begin
                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 358) < 0) then begin
-                                                                                                    restock_obj := create_object_sid(358, 0, 0, -1);
+                                                                                                    restock_obj := create_object(358, 0, 0);
                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 358));
                                                                                                 end
                                                                                                 else begin
@@ -2012,17 +2012,17 @@ begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 358);
                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 358);
-                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                        metarule(43, self_obj);
+                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                        inven_unwield(self_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                             end
@@ -2040,7 +2040,7 @@ begin
                                                                                             else begin
                                                                                                 if ((4 == 352) or (4 == 391) or (4 == 395)) then begin
                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 359) < 0) then begin
-                                                                                                        restock_obj := create_object_sid(359, 0, 0, -1);
+                                                                                                        restock_obj := create_object(359, 0, 0);
                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 359));
                                                                                                     end
                                                                                                     else begin
@@ -2053,17 +2053,17 @@ begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 359);
                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 359);
-                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                            metarule(43, self_obj);
+                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                            inven_unwield(self_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                 end
@@ -2081,7 +2081,7 @@ begin
                                                                                                 else begin
                                                                                                     if (4 == 388) then begin
                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 361) < 0) then begin
-                                                                                                            restock_obj := create_object_sid(361, 0, 0, -1);
+                                                                                                            restock_obj := create_object(361, 0, 0);
                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 0 - obj_is_carrying_obj_pid(self_obj, 361));
                                                                                                         end
                                                                                                         else begin
@@ -2094,17 +2094,17 @@ begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                metarule(43, self_obj);
+                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                inven_unwield(self_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                     end
@@ -2145,7 +2145,7 @@ begin
                 temp := random(1, 4);
                 if ((temp == 1) and (obj_art_fid(self_obj) == 16777249)) then begin
                     if (obj_is_carrying_obj_pid(self_obj, 8) < 1) then begin
-                        restock_obj := create_object_sid(8, 0, 0, -1);
+                        restock_obj := create_object(8, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 8));
                     end
                     else begin
@@ -2158,17 +2158,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 8);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 8);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -2184,7 +2184,7 @@ begin
                     end
                     if (1) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 8)) then begin
-                            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 8));
+                            wield_obj(obj_carrying_pid_obj(self_obj, 8));
                         end
                         else begin
                             debug_msg("NOT ARMING THE WEAPON!!!");
@@ -2192,7 +2192,7 @@ begin
                     end
                     if (0 != 0) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 0) < 1) then begin
-                            restock_obj := create_object_sid(0, 0, 0, -1);
+                            restock_obj := create_object(0, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 0));
                         end
                         else begin
@@ -2205,17 +2205,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 0);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 0);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2233,7 +2233,7 @@ begin
                     else begin
                         if ((8 == 8) or (8 == 300) or (8 == 9)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 29) < 1) then begin
-                                restock_obj := create_object_sid(29, 0, 0, -1);
+                                restock_obj := create_object(29, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 29));
                             end
                             else begin
@@ -2246,17 +2246,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2274,7 +2274,7 @@ begin
                         else begin
                             if ((8 == 10) or (8 == 350) or (8 == 355) or (8 == 143) or (8 == 241) or (8 == 287)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 34) < 1) then begin
-                                    restock_obj := create_object_sid(34, 0, 0, -1);
+                                    restock_obj := create_object(34, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 34));
                                 end
                                 else begin
@@ -2287,17 +2287,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -2315,7 +2315,7 @@ begin
                             else begin
                                 if ((8 == 11) or (8 == 400)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 32) < 1) then begin
-                                        restock_obj := create_object_sid(32, 0, 0, -1);
+                                        restock_obj := create_object(32, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 32));
                                     end
                                     else begin
@@ -2328,17 +2328,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -2356,7 +2356,7 @@ begin
                                 else begin
                                     if ((8 == 12) or (8 == 353) or (8 == 389) or (8 == 405) or (8 == 23)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 35) < 1) then begin
-                                            restock_obj := create_object_sid(35, 0, 0, -1);
+                                            restock_obj := create_object(35, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 35));
                                         end
                                         else begin
@@ -2369,17 +2369,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -2397,7 +2397,7 @@ begin
                                     else begin
                                         if (8 == 13) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 14) < 1) then begin
-                                                restock_obj := create_object_sid(14, 0, 0, -1);
+                                                restock_obj := create_object(14, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 14));
                                             end
                                             else begin
@@ -2410,17 +2410,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 14);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 14);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -2438,7 +2438,7 @@ begin
                                         else begin
                                             if ((8 == 15) or (8 == 397) or (8 == 28) or (8 == 118) or (8 == 401) or (8 == 233)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 39) < 1) then begin
-                                                    restock_obj := create_object_sid(39, 0, 0, -1);
+                                                    restock_obj := create_object(39, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 39));
                                                 end
                                                 else begin
@@ -2451,17 +2451,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -2479,7 +2479,7 @@ begin
                                             else begin
                                                 if ((8 == 16) or (8 == 235) or (8 == 407) or (8 == 116) or (8 == 160) or (8 == 399) or (8 == 24) or (8 == 406) or (8 == 393) or (8 == 396) or (8 == 120) or (8 == 402)) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 38) < 1) then begin
-                                                        restock_obj := create_object_sid(38, 0, 0, -1);
+                                                        restock_obj := create_object(38, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 38));
                                                     end
                                                     else begin
@@ -2492,17 +2492,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 38);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 38);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -2520,7 +2520,7 @@ begin
                                                 else begin
                                                     if ((8 == 18) or (8 == 398) or (8 == 404) or (8 == 313)) then begin
                                                         if (obj_is_carrying_obj_pid(self_obj, 31) < 1) then begin
-                                                            restock_obj := create_object_sid(31, 0, 0, -1);
+                                                            restock_obj := create_object(31, 0, 0);
                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 31));
                                                         end
                                                         else begin
@@ -2533,17 +2533,17 @@ begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                                                     if (obj_type(self_obj) == 1) then begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                             end
                                                                         end
                                                                         else begin
-                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                metarule(43, self_obj);
+                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                inven_unwield(self_obj);
                                                                             end
                                                                         end
                                                                     end
@@ -2561,7 +2561,7 @@ begin
                                                     else begin
                                                         if (8 == 22) then begin
                                                             if (obj_is_carrying_obj_pid(self_obj, 33) < 1) then begin
-                                                                restock_obj := create_object_sid(33, 0, 0, -1);
+                                                                restock_obj := create_object(33, 0, 0);
                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 33));
                                                             end
                                                             else begin
@@ -2574,17 +2574,17 @@ begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                                                         if (obj_type(self_obj) == 1) then begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                 end
                                                                             end
                                                                             else begin
-                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                    metarule(43, self_obj);
+                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                    inven_unwield(self_obj);
                                                                                 end
                                                                             end
                                                                         end
@@ -2602,7 +2602,7 @@ begin
                                                         else begin
                                                             if ((8 == 94) or (8 == 354) or (8 == 385) or (8 == 242) or (8 == 268)) then begin
                                                                 if (obj_is_carrying_obj_pid(self_obj, 95) < 1) then begin
-                                                                    restock_obj := create_object_sid(95, 0, 0, -1);
+                                                                    restock_obj := create_object(95, 0, 0);
                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 95));
                                                                 end
                                                                 else begin
@@ -2615,17 +2615,17 @@ begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                     end
                                                                                 end
                                                                                 else begin
-                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                        metarule(43, self_obj);
+                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                        inven_unwield(self_obj);
                                                                                     end
                                                                                 end
                                                                             end
@@ -2643,7 +2643,7 @@ begin
                                                             else begin
                                                                 if (8 == 122) then begin
                                                                     if (obj_is_carrying_obj_pid(self_obj, 121) < 1) then begin
-                                                                        restock_obj := create_object_sid(121, 0, 0, -1);
+                                                                        restock_obj := create_object(121, 0, 0);
                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 121));
                                                                     end
                                                                     else begin
@@ -2656,17 +2656,17 @@ begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 121);
                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 121);
-                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                         end
                                                                                     end
                                                                                     else begin
-                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                            metarule(43, self_obj);
+                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                            inven_unwield(self_obj);
                                                                                         end
                                                                                     end
                                                                                 end
@@ -2684,7 +2684,7 @@ begin
                                                                 else begin
                                                                     if (8 == 296) then begin
                                                                         if (obj_is_carrying_obj_pid(self_obj, 360) < 1) then begin
-                                                                            restock_obj := create_object_sid(360, 0, 0, -1);
+                                                                            restock_obj := create_object(360, 0, 0);
                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 360));
                                                                         end
                                                                         else begin
@@ -2697,17 +2697,17 @@ begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                             end
                                                                                         end
                                                                                         else begin
-                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                metarule(43, self_obj);
+                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                inven_unwield(self_obj);
                                                                                             end
                                                                                         end
                                                                                     end
@@ -2725,7 +2725,7 @@ begin
                                                                     else begin
                                                                         if (8 == 270) then begin
                                                                             if (obj_is_carrying_obj_pid(self_obj, 274) < 1) then begin
-                                                                                restock_obj := create_object_sid(274, 0, 0, -1);
+                                                                                restock_obj := create_object(274, 0, 0);
                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 274));
                                                                             end
                                                                             else begin
@@ -2738,17 +2738,17 @@ begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 274);
                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 274);
-                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                 end
                                                                                             end
                                                                                             else begin
-                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                    metarule(43, self_obj);
+                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                    inven_unwield(self_obj);
                                                                                                 end
                                                                                             end
                                                                                         end
@@ -2766,7 +2766,7 @@ begin
                                                                         else begin
                                                                             if (8 == 299) then begin
                                                                                 if (obj_is_carrying_obj_pid(self_obj, 19) < 1) then begin
-                                                                                    restock_obj := create_object_sid(19, 0, 0, -1);
+                                                                                    restock_obj := create_object(19, 0, 0);
                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 19));
                                                                                 end
                                                                                 else begin
@@ -2779,17 +2779,17 @@ begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 19);
                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 19);
-                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                        metarule(43, self_obj);
+                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                        inven_unwield(self_obj);
                                                                                                     end
                                                                                                 end
                                                                                             end
@@ -2807,7 +2807,7 @@ begin
                                                                             else begin
                                                                                 if ((8 == 161) or (8 == 162) or (8 == 261)) then begin
                                                                                     if (obj_is_carrying_obj_pid(self_obj, 163) < 1) then begin
-                                                                                        restock_obj := create_object_sid(163, 0, 0, -1);
+                                                                                        restock_obj := create_object(163, 0, 0);
                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 163));
                                                                                     end
                                                                                     else begin
@@ -2820,17 +2820,17 @@ begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                         end
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                            metarule(43, self_obj);
+                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                            inven_unwield(self_obj);
                                                                                                         end
                                                                                                     end
                                                                                                 end
@@ -2848,7 +2848,7 @@ begin
                                                                                 else begin
                                                                                     if ((8 == 283) or (8 == 332)) then begin
                                                                                         if (obj_is_carrying_obj_pid(self_obj, 357) < 1) then begin
-                                                                                            restock_obj := create_object_sid(357, 0, 0, -1);
+                                                                                            restock_obj := create_object(357, 0, 0);
                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 357));
                                                                                         end
                                                                                         else begin
@@ -2861,17 +2861,17 @@ begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                             end
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                metarule(43, self_obj);
+                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                inven_unwield(self_obj);
                                                                                                             end
                                                                                                         end
                                                                                                     end
@@ -2889,7 +2889,7 @@ begin
                                                                                     else begin
                                                                                         if ((8 == 351) or (8 == 403) or (8 == 387)) then begin
                                                                                             if (obj_is_carrying_obj_pid(self_obj, 363) < 1) then begin
-                                                                                                restock_obj := create_object_sid(363, 0, 0, -1);
+                                                                                                restock_obj := create_object(363, 0, 0);
                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 363));
                                                                                             end
                                                                                             else begin
@@ -2902,17 +2902,17 @@ begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                    metarule(43, self_obj);
+                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                    inven_unwield(self_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                         end
@@ -2930,7 +2930,7 @@ begin
                                                                                         else begin
                                                                                             if ((8 == 392) or (8 == 394)) then begin
                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 358) < 1) then begin
-                                                                                                    restock_obj := create_object_sid(358, 0, 0, -1);
+                                                                                                    restock_obj := create_object(358, 0, 0);
                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 358));
                                                                                                 end
                                                                                                 else begin
@@ -2943,17 +2943,17 @@ begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 358);
                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 358);
-                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                        metarule(43, self_obj);
+                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                        inven_unwield(self_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                             end
@@ -2971,7 +2971,7 @@ begin
                                                                                             else begin
                                                                                                 if ((8 == 352) or (8 == 391) or (8 == 395)) then begin
                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 359) < 1) then begin
-                                                                                                        restock_obj := create_object_sid(359, 0, 0, -1);
+                                                                                                        restock_obj := create_object(359, 0, 0);
                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 359));
                                                                                                     end
                                                                                                     else begin
@@ -2984,17 +2984,17 @@ begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 359);
                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 359);
-                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                            metarule(43, self_obj);
+                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                            inven_unwield(self_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                 end
@@ -3012,7 +3012,7 @@ begin
                                                                                                 else begin
                                                                                                     if (8 == 388) then begin
                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 361) < 1) then begin
-                                                                                                            restock_obj := create_object_sid(361, 0, 0, -1);
+                                                                                                            restock_obj := create_object(361, 0, 0);
                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 361));
                                                                                                         end
                                                                                                         else begin
@@ -3025,17 +3025,17 @@ begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                metarule(43, self_obj);
+                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                inven_unwield(self_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                     end
@@ -3074,7 +3074,7 @@ begin
                 else begin
                     if ((temp == 2) and (obj_art_fid(self_obj) != 16777252)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 10) < 1) then begin
-                            restock_obj := create_object_sid(10, 0, 0, -1);
+                            restock_obj := create_object(10, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 10));
                         end
                         else begin
@@ -3087,17 +3087,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 10);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 10);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3113,7 +3113,7 @@ begin
                         end
                         if (1) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 10)) then begin
-                                wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 10));
+                                wield_obj(obj_carrying_pid_obj(self_obj, 10));
                             end
                             else begin
                                 debug_msg("NOT ARMING THE WEAPON!!!");
@@ -3121,7 +3121,7 @@ begin
                         end
                         if (0 != 0) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 0) < 1) then begin
-                                restock_obj := create_object_sid(0, 0, 0, -1);
+                                restock_obj := create_object(0, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 0));
                             end
                             else begin
@@ -3134,17 +3134,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 0);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 0);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3162,7 +3162,7 @@ begin
                         else begin
                             if ((10 == 8) or (10 == 300) or (10 == 9)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 29) < 1) then begin
-                                    restock_obj := create_object_sid(29, 0, 0, -1);
+                                    restock_obj := create_object(29, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 29));
                                 end
                                 else begin
@@ -3175,17 +3175,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -3203,7 +3203,7 @@ begin
                             else begin
                                 if ((10 == 10) or (10 == 350) or (10 == 355) or (10 == 143) or (10 == 241) or (10 == 287)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 34) < 1) then begin
-                                        restock_obj := create_object_sid(34, 0, 0, -1);
+                                        restock_obj := create_object(34, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 34));
                                     end
                                     else begin
@@ -3216,17 +3216,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -3244,7 +3244,7 @@ begin
                                 else begin
                                     if ((10 == 11) or (10 == 400)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 32) < 1) then begin
-                                            restock_obj := create_object_sid(32, 0, 0, -1);
+                                            restock_obj := create_object(32, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 32));
                                         end
                                         else begin
@@ -3257,17 +3257,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -3285,7 +3285,7 @@ begin
                                     else begin
                                         if ((10 == 12) or (10 == 353) or (10 == 389) or (10 == 405) or (10 == 23)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 35) < 1) then begin
-                                                restock_obj := create_object_sid(35, 0, 0, -1);
+                                                restock_obj := create_object(35, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 35));
                                             end
                                             else begin
@@ -3298,17 +3298,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -3326,7 +3326,7 @@ begin
                                         else begin
                                             if (10 == 13) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 14) < 1) then begin
-                                                    restock_obj := create_object_sid(14, 0, 0, -1);
+                                                    restock_obj := create_object(14, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 14));
                                                 end
                                                 else begin
@@ -3339,17 +3339,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 14);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 14);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -3367,7 +3367,7 @@ begin
                                             else begin
                                                 if ((10 == 15) or (10 == 397) or (10 == 28) or (10 == 118) or (10 == 401) or (10 == 233)) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 39) < 1) then begin
-                                                        restock_obj := create_object_sid(39, 0, 0, -1);
+                                                        restock_obj := create_object(39, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 39));
                                                     end
                                                     else begin
@@ -3380,17 +3380,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -3408,7 +3408,7 @@ begin
                                                 else begin
                                                     if ((10 == 16) or (10 == 235) or (10 == 407) or (10 == 116) or (10 == 160) or (10 == 399) or (10 == 24) or (10 == 406) or (10 == 393) or (10 == 396) or (10 == 120) or (10 == 402)) then begin
                                                         if (obj_is_carrying_obj_pid(self_obj, 38) < 1) then begin
-                                                            restock_obj := create_object_sid(38, 0, 0, -1);
+                                                            restock_obj := create_object(38, 0, 0);
                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 38));
                                                         end
                                                         else begin
@@ -3421,17 +3421,17 @@ begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 38);
                                                                     if (obj_type(self_obj) == 1) then begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 38);
-                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                             end
                                                                         end
                                                                         else begin
-                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                metarule(43, self_obj);
+                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                inven_unwield(self_obj);
                                                                             end
                                                                         end
                                                                     end
@@ -3449,7 +3449,7 @@ begin
                                                     else begin
                                                         if ((10 == 18) or (10 == 398) or (10 == 404) or (10 == 313)) then begin
                                                             if (obj_is_carrying_obj_pid(self_obj, 31) < 1) then begin
-                                                                restock_obj := create_object_sid(31, 0, 0, -1);
+                                                                restock_obj := create_object(31, 0, 0);
                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 31));
                                                             end
                                                             else begin
@@ -3462,17 +3462,17 @@ begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                                                         if (obj_type(self_obj) == 1) then begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                 end
                                                                             end
                                                                             else begin
-                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                    metarule(43, self_obj);
+                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                    inven_unwield(self_obj);
                                                                                 end
                                                                             end
                                                                         end
@@ -3490,7 +3490,7 @@ begin
                                                         else begin
                                                             if (10 == 22) then begin
                                                                 if (obj_is_carrying_obj_pid(self_obj, 33) < 1) then begin
-                                                                    restock_obj := create_object_sid(33, 0, 0, -1);
+                                                                    restock_obj := create_object(33, 0, 0);
                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 33));
                                                                 end
                                                                 else begin
@@ -3503,17 +3503,17 @@ begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                     end
                                                                                 end
                                                                                 else begin
-                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                        metarule(43, self_obj);
+                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                        inven_unwield(self_obj);
                                                                                     end
                                                                                 end
                                                                             end
@@ -3531,7 +3531,7 @@ begin
                                                             else begin
                                                                 if ((10 == 94) or (10 == 354) or (10 == 385) or (10 == 242) or (10 == 268)) then begin
                                                                     if (obj_is_carrying_obj_pid(self_obj, 95) < 1) then begin
-                                                                        restock_obj := create_object_sid(95, 0, 0, -1);
+                                                                        restock_obj := create_object(95, 0, 0);
                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 95));
                                                                     end
                                                                     else begin
@@ -3544,17 +3544,17 @@ begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                         end
                                                                                     end
                                                                                     else begin
-                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                            metarule(43, self_obj);
+                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                            inven_unwield(self_obj);
                                                                                         end
                                                                                     end
                                                                                 end
@@ -3572,7 +3572,7 @@ begin
                                                                 else begin
                                                                     if (10 == 122) then begin
                                                                         if (obj_is_carrying_obj_pid(self_obj, 121) < 1) then begin
-                                                                            restock_obj := create_object_sid(121, 0, 0, -1);
+                                                                            restock_obj := create_object(121, 0, 0);
                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 121));
                                                                         end
                                                                         else begin
@@ -3585,17 +3585,17 @@ begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 121);
                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 121);
-                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                             end
                                                                                         end
                                                                                         else begin
-                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                metarule(43, self_obj);
+                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                inven_unwield(self_obj);
                                                                                             end
                                                                                         end
                                                                                     end
@@ -3613,7 +3613,7 @@ begin
                                                                     else begin
                                                                         if (10 == 296) then begin
                                                                             if (obj_is_carrying_obj_pid(self_obj, 360) < 1) then begin
-                                                                                restock_obj := create_object_sid(360, 0, 0, -1);
+                                                                                restock_obj := create_object(360, 0, 0);
                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 360));
                                                                             end
                                                                             else begin
@@ -3626,17 +3626,17 @@ begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                 end
                                                                                             end
                                                                                             else begin
-                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                    metarule(43, self_obj);
+                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                    inven_unwield(self_obj);
                                                                                                 end
                                                                                             end
                                                                                         end
@@ -3654,7 +3654,7 @@ begin
                                                                         else begin
                                                                             if (10 == 270) then begin
                                                                                 if (obj_is_carrying_obj_pid(self_obj, 274) < 1) then begin
-                                                                                    restock_obj := create_object_sid(274, 0, 0, -1);
+                                                                                    restock_obj := create_object(274, 0, 0);
                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 274));
                                                                                 end
                                                                                 else begin
@@ -3667,17 +3667,17 @@ begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 274);
                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 274);
-                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                        metarule(43, self_obj);
+                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                        inven_unwield(self_obj);
                                                                                                     end
                                                                                                 end
                                                                                             end
@@ -3695,7 +3695,7 @@ begin
                                                                             else begin
                                                                                 if (10 == 299) then begin
                                                                                     if (obj_is_carrying_obj_pid(self_obj, 19) < 1) then begin
-                                                                                        restock_obj := create_object_sid(19, 0, 0, -1);
+                                                                                        restock_obj := create_object(19, 0, 0);
                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 19));
                                                                                     end
                                                                                     else begin
@@ -3708,17 +3708,17 @@ begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 19);
                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 19);
-                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                         end
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                            metarule(43, self_obj);
+                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                            inven_unwield(self_obj);
                                                                                                         end
                                                                                                     end
                                                                                                 end
@@ -3736,7 +3736,7 @@ begin
                                                                                 else begin
                                                                                     if ((10 == 161) or (10 == 162) or (10 == 261)) then begin
                                                                                         if (obj_is_carrying_obj_pid(self_obj, 163) < 1) then begin
-                                                                                            restock_obj := create_object_sid(163, 0, 0, -1);
+                                                                                            restock_obj := create_object(163, 0, 0);
                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 163));
                                                                                         end
                                                                                         else begin
@@ -3749,17 +3749,17 @@ begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                             end
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                metarule(43, self_obj);
+                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                inven_unwield(self_obj);
                                                                                                             end
                                                                                                         end
                                                                                                     end
@@ -3777,7 +3777,7 @@ begin
                                                                                     else begin
                                                                                         if ((10 == 283) or (10 == 332)) then begin
                                                                                             if (obj_is_carrying_obj_pid(self_obj, 357) < 1) then begin
-                                                                                                restock_obj := create_object_sid(357, 0, 0, -1);
+                                                                                                restock_obj := create_object(357, 0, 0);
                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 357));
                                                                                             end
                                                                                             else begin
@@ -3790,17 +3790,17 @@ begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                    metarule(43, self_obj);
+                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                    inven_unwield(self_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                         end
@@ -3818,7 +3818,7 @@ begin
                                                                                         else begin
                                                                                             if ((10 == 351) or (10 == 403) or (10 == 387)) then begin
                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 363) < 1) then begin
-                                                                                                    restock_obj := create_object_sid(363, 0, 0, -1);
+                                                                                                    restock_obj := create_object(363, 0, 0);
                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 363));
                                                                                                 end
                                                                                                 else begin
@@ -3831,17 +3831,17 @@ begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                        metarule(43, self_obj);
+                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                        inven_unwield(self_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                             end
@@ -3859,7 +3859,7 @@ begin
                                                                                             else begin
                                                                                                 if ((10 == 392) or (10 == 394)) then begin
                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 358) < 1) then begin
-                                                                                                        restock_obj := create_object_sid(358, 0, 0, -1);
+                                                                                                        restock_obj := create_object(358, 0, 0);
                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 358));
                                                                                                     end
                                                                                                     else begin
@@ -3872,17 +3872,17 @@ begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 358);
                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 358);
-                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                            metarule(43, self_obj);
+                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                            inven_unwield(self_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                 end
@@ -3900,7 +3900,7 @@ begin
                                                                                                 else begin
                                                                                                     if ((10 == 352) or (10 == 391) or (10 == 395)) then begin
                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 359) < 1) then begin
-                                                                                                            restock_obj := create_object_sid(359, 0, 0, -1);
+                                                                                                            restock_obj := create_object(359, 0, 0);
                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 359));
                                                                                                         end
                                                                                                         else begin
@@ -3913,17 +3913,17 @@ begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 359);
                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 359);
-                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                metarule(43, self_obj);
+                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                inven_unwield(self_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                     end
@@ -3941,7 +3941,7 @@ begin
                                                                                                     else begin
                                                                                                         if (10 == 388) then begin
                                                                                                             if (obj_is_carrying_obj_pid(self_obj, 361) < 1) then begin
-                                                                                                                restock_obj := create_object_sid(361, 0, 0, -1);
+                                                                                                                restock_obj := create_object(361, 0, 0);
                                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 361));
                                                                                                             end
                                                                                                             else begin
@@ -3954,17 +3954,17 @@ begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                             else begin
-                                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                    metarule(43, self_obj);
+                                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                    inven_unwield(self_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                         end
@@ -4003,7 +4003,7 @@ begin
                     else begin
                         if ((temp == 3) and (obj_art_fid(self_obj) != 16777252)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 94) < 1) then begin
-                                restock_obj := create_object_sid(94, 0, 0, -1);
+                                restock_obj := create_object(94, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 94));
                             end
                             else begin
@@ -4016,17 +4016,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 94);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 94);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4042,7 +4042,7 @@ begin
                             end
                             if (1) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 94)) then begin
-                                    wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 94));
+                                    wield_obj(obj_carrying_pid_obj(self_obj, 94));
                                 end
                                 else begin
                                     debug_msg("NOT ARMING THE WEAPON!!!");
@@ -4050,7 +4050,7 @@ begin
                             end
                             if (0 != 0) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 0) < 1) then begin
-                                    restock_obj := create_object_sid(0, 0, 0, -1);
+                                    restock_obj := create_object(0, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 0));
                                 end
                                 else begin
@@ -4063,17 +4063,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 0);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 0);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -4091,7 +4091,7 @@ begin
                             else begin
                                 if ((94 == 8) or (94 == 300) or (94 == 9)) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 29) < 1) then begin
-                                        restock_obj := create_object_sid(29, 0, 0, -1);
+                                        restock_obj := create_object(29, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 29));
                                     end
                                     else begin
@@ -4104,17 +4104,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -4132,7 +4132,7 @@ begin
                                 else begin
                                     if ((94 == 10) or (94 == 350) or (94 == 355) or (94 == 143) or (94 == 241) or (94 == 287)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 34) < 1) then begin
-                                            restock_obj := create_object_sid(34, 0, 0, -1);
+                                            restock_obj := create_object(34, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 34));
                                         end
                                         else begin
@@ -4145,17 +4145,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -4173,7 +4173,7 @@ begin
                                     else begin
                                         if ((94 == 11) or (94 == 400)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 32) < 1) then begin
-                                                restock_obj := create_object_sid(32, 0, 0, -1);
+                                                restock_obj := create_object(32, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 32));
                                             end
                                             else begin
@@ -4186,17 +4186,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -4214,7 +4214,7 @@ begin
                                         else begin
                                             if ((94 == 12) or (94 == 353) or (94 == 389) or (94 == 405) or (94 == 23)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 35) < 1) then begin
-                                                    restock_obj := create_object_sid(35, 0, 0, -1);
+                                                    restock_obj := create_object(35, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 35));
                                                 end
                                                 else begin
@@ -4227,17 +4227,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -4255,7 +4255,7 @@ begin
                                             else begin
                                                 if (94 == 13) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 14) < 1) then begin
-                                                        restock_obj := create_object_sid(14, 0, 0, -1);
+                                                        restock_obj := create_object(14, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 14));
                                                     end
                                                     else begin
@@ -4268,17 +4268,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 14);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 14);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -4296,7 +4296,7 @@ begin
                                                 else begin
                                                     if ((94 == 15) or (94 == 397) or (94 == 28) or (94 == 118) or (94 == 401) or (94 == 233)) then begin
                                                         if (obj_is_carrying_obj_pid(self_obj, 39) < 1) then begin
-                                                            restock_obj := create_object_sid(39, 0, 0, -1);
+                                                            restock_obj := create_object(39, 0, 0);
                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 39));
                                                         end
                                                         else begin
@@ -4309,17 +4309,17 @@ begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                                                     if (obj_type(self_obj) == 1) then begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                             end
                                                                         end
                                                                         else begin
-                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                metarule(43, self_obj);
+                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                inven_unwield(self_obj);
                                                                             end
                                                                         end
                                                                     end
@@ -4337,7 +4337,7 @@ begin
                                                     else begin
                                                         if ((94 == 16) or (94 == 235) or (94 == 407) or (94 == 116) or (94 == 160) or (94 == 399) or (94 == 24) or (94 == 406) or (94 == 393) or (94 == 396) or (94 == 120) or (94 == 402)) then begin
                                                             if (obj_is_carrying_obj_pid(self_obj, 38) < 1) then begin
-                                                                restock_obj := create_object_sid(38, 0, 0, -1);
+                                                                restock_obj := create_object(38, 0, 0);
                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 38));
                                                             end
                                                             else begin
@@ -4350,17 +4350,17 @@ begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 38);
                                                                         if (obj_type(self_obj) == 1) then begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 38);
-                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                 end
                                                                             end
                                                                             else begin
-                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                    metarule(43, self_obj);
+                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                    inven_unwield(self_obj);
                                                                                 end
                                                                             end
                                                                         end
@@ -4378,7 +4378,7 @@ begin
                                                         else begin
                                                             if ((94 == 18) or (94 == 398) or (94 == 404) or (94 == 313)) then begin
                                                                 if (obj_is_carrying_obj_pid(self_obj, 31) < 1) then begin
-                                                                    restock_obj := create_object_sid(31, 0, 0, -1);
+                                                                    restock_obj := create_object(31, 0, 0);
                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 31));
                                                                 end
                                                                 else begin
@@ -4391,17 +4391,17 @@ begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                     end
                                                                                 end
                                                                                 else begin
-                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                        metarule(43, self_obj);
+                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                        inven_unwield(self_obj);
                                                                                     end
                                                                                 end
                                                                             end
@@ -4419,7 +4419,7 @@ begin
                                                             else begin
                                                                 if (94 == 22) then begin
                                                                     if (obj_is_carrying_obj_pid(self_obj, 33) < 1) then begin
-                                                                        restock_obj := create_object_sid(33, 0, 0, -1);
+                                                                        restock_obj := create_object(33, 0, 0);
                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 33));
                                                                     end
                                                                     else begin
@@ -4432,17 +4432,17 @@ begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                         end
                                                                                     end
                                                                                     else begin
-                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                            metarule(43, self_obj);
+                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                            inven_unwield(self_obj);
                                                                                         end
                                                                                     end
                                                                                 end
@@ -4460,7 +4460,7 @@ begin
                                                                 else begin
                                                                     if ((94 == 94) or (94 == 354) or (94 == 385) or (94 == 242) or (94 == 268)) then begin
                                                                         if (obj_is_carrying_obj_pid(self_obj, 95) < 1) then begin
-                                                                            restock_obj := create_object_sid(95, 0, 0, -1);
+                                                                            restock_obj := create_object(95, 0, 0);
                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 95));
                                                                         end
                                                                         else begin
@@ -4473,17 +4473,17 @@ begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                             end
                                                                                         end
                                                                                         else begin
-                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                metarule(43, self_obj);
+                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                inven_unwield(self_obj);
                                                                                             end
                                                                                         end
                                                                                     end
@@ -4501,7 +4501,7 @@ begin
                                                                     else begin
                                                                         if (94 == 122) then begin
                                                                             if (obj_is_carrying_obj_pid(self_obj, 121) < 1) then begin
-                                                                                restock_obj := create_object_sid(121, 0, 0, -1);
+                                                                                restock_obj := create_object(121, 0, 0);
                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 121));
                                                                             end
                                                                             else begin
@@ -4514,17 +4514,17 @@ begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 121);
                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 121);
-                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                 end
                                                                                             end
                                                                                             else begin
-                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                    metarule(43, self_obj);
+                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                    inven_unwield(self_obj);
                                                                                                 end
                                                                                             end
                                                                                         end
@@ -4542,7 +4542,7 @@ begin
                                                                         else begin
                                                                             if (94 == 296) then begin
                                                                                 if (obj_is_carrying_obj_pid(self_obj, 360) < 1) then begin
-                                                                                    restock_obj := create_object_sid(360, 0, 0, -1);
+                                                                                    restock_obj := create_object(360, 0, 0);
                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 360));
                                                                                 end
                                                                                 else begin
@@ -4555,17 +4555,17 @@ begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                        metarule(43, self_obj);
+                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                        inven_unwield(self_obj);
                                                                                                     end
                                                                                                 end
                                                                                             end
@@ -4583,7 +4583,7 @@ begin
                                                                             else begin
                                                                                 if (94 == 270) then begin
                                                                                     if (obj_is_carrying_obj_pid(self_obj, 274) < 1) then begin
-                                                                                        restock_obj := create_object_sid(274, 0, 0, -1);
+                                                                                        restock_obj := create_object(274, 0, 0);
                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 274));
                                                                                     end
                                                                                     else begin
@@ -4596,17 +4596,17 @@ begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 274);
                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 274);
-                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                         end
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                            metarule(43, self_obj);
+                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                            inven_unwield(self_obj);
                                                                                                         end
                                                                                                     end
                                                                                                 end
@@ -4624,7 +4624,7 @@ begin
                                                                                 else begin
                                                                                     if (94 == 299) then begin
                                                                                         if (obj_is_carrying_obj_pid(self_obj, 19) < 1) then begin
-                                                                                            restock_obj := create_object_sid(19, 0, 0, -1);
+                                                                                            restock_obj := create_object(19, 0, 0);
                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 19));
                                                                                         end
                                                                                         else begin
@@ -4637,17 +4637,17 @@ begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 19);
                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 19);
-                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                             end
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                metarule(43, self_obj);
+                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                inven_unwield(self_obj);
                                                                                                             end
                                                                                                         end
                                                                                                     end
@@ -4665,7 +4665,7 @@ begin
                                                                                     else begin
                                                                                         if ((94 == 161) or (94 == 162) or (94 == 261)) then begin
                                                                                             if (obj_is_carrying_obj_pid(self_obj, 163) < 1) then begin
-                                                                                                restock_obj := create_object_sid(163, 0, 0, -1);
+                                                                                                restock_obj := create_object(163, 0, 0);
                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 163));
                                                                                             end
                                                                                             else begin
@@ -4678,17 +4678,17 @@ begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                    metarule(43, self_obj);
+                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                    inven_unwield(self_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                         end
@@ -4706,7 +4706,7 @@ begin
                                                                                         else begin
                                                                                             if ((94 == 283) or (94 == 332)) then begin
                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 357) < 1) then begin
-                                                                                                    restock_obj := create_object_sid(357, 0, 0, -1);
+                                                                                                    restock_obj := create_object(357, 0, 0);
                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 357));
                                                                                                 end
                                                                                                 else begin
@@ -4719,17 +4719,17 @@ begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                        metarule(43, self_obj);
+                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                        inven_unwield(self_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                             end
@@ -4747,7 +4747,7 @@ begin
                                                                                             else begin
                                                                                                 if ((94 == 351) or (94 == 403) or (94 == 387)) then begin
                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 363) < 1) then begin
-                                                                                                        restock_obj := create_object_sid(363, 0, 0, -1);
+                                                                                                        restock_obj := create_object(363, 0, 0);
                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 363));
                                                                                                     end
                                                                                                     else begin
@@ -4760,17 +4760,17 @@ begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                            metarule(43, self_obj);
+                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                            inven_unwield(self_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                 end
@@ -4788,7 +4788,7 @@ begin
                                                                                                 else begin
                                                                                                     if ((94 == 392) or (94 == 394)) then begin
                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 358) < 1) then begin
-                                                                                                            restock_obj := create_object_sid(358, 0, 0, -1);
+                                                                                                            restock_obj := create_object(358, 0, 0);
                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 358));
                                                                                                         end
                                                                                                         else begin
@@ -4801,17 +4801,17 @@ begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 358);
                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 358);
-                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                metarule(43, self_obj);
+                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                inven_unwield(self_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                     end
@@ -4829,7 +4829,7 @@ begin
                                                                                                     else begin
                                                                                                         if ((94 == 352) or (94 == 391) or (94 == 395)) then begin
                                                                                                             if (obj_is_carrying_obj_pid(self_obj, 359) < 1) then begin
-                                                                                                                restock_obj := create_object_sid(359, 0, 0, -1);
+                                                                                                                restock_obj := create_object(359, 0, 0);
                                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 359));
                                                                                                             end
                                                                                                             else begin
@@ -4842,17 +4842,17 @@ begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 359);
                                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 359);
-                                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                             else begin
-                                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                    metarule(43, self_obj);
+                                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                    inven_unwield(self_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                         end
@@ -4870,7 +4870,7 @@ begin
                                                                                                         else begin
                                                                                                             if (94 == 388) then begin
                                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 361) < 1) then begin
-                                                                                                                    restock_obj := create_object_sid(361, 0, 0, -1);
+                                                                                                                    restock_obj := create_object(361, 0, 0);
                                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 361));
                                                                                                                 end
                                                                                                                 else begin
@@ -4883,17 +4883,17 @@ begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                     end
                                                                                                                                 end
                                                                                                                                 else begin
-                                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                        metarule(43, self_obj);
+                                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                        inven_unwield(self_obj);
                                                                                                                                     end
                                                                                                                                 end
                                                                                                                             end
@@ -4932,7 +4932,7 @@ begin
                         else begin
                             if ((temp == 4) and (obj_art_fid(self_obj) != 16777249)) then begin
                                 if (obj_is_carrying_obj_pid(self_obj, 236) < 1) then begin
-                                    restock_obj := create_object_sid(236, 0, 0, -1);
+                                    restock_obj := create_object(236, 0, 0);
                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 236));
                                 end
                                 else begin
@@ -4945,17 +4945,17 @@ begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 236);
                                             if (obj_type(self_obj) == 1) then begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 236);
-                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                         add_obj_to_inven(self_obj, restock_obj);
                                                     end
                                                 end
                                                 else begin
-                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                        metarule(43, self_obj);
+                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                        inven_unwield(self_obj);
                                                     end
                                                 end
                                             end
@@ -4971,7 +4971,7 @@ begin
                                 end
                                 if (1) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 236)) then begin
-                                        wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 236));
+                                        wield_obj(obj_carrying_pid_obj(self_obj, 236));
                                     end
                                     else begin
                                         debug_msg("NOT ARMING THE WEAPON!!!");
@@ -4979,7 +4979,7 @@ begin
                                 end
                                 if (0 != 0) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 0) < 1) then begin
-                                        restock_obj := create_object_sid(0, 0, 0, -1);
+                                        restock_obj := create_object(0, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 0));
                                     end
                                     else begin
@@ -4992,17 +4992,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 0);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 0);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -5020,7 +5020,7 @@ begin
                                 else begin
                                     if ((236 == 8) or (236 == 300) or (236 == 9)) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 29) < 1) then begin
-                                            restock_obj := create_object_sid(29, 0, 0, -1);
+                                            restock_obj := create_object(29, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 29));
                                         end
                                         else begin
@@ -5033,17 +5033,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -5061,7 +5061,7 @@ begin
                                     else begin
                                         if ((236 == 10) or (236 == 350) or (236 == 355) or (236 == 143) or (236 == 241) or (236 == 287)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 34) < 1) then begin
-                                                restock_obj := create_object_sid(34, 0, 0, -1);
+                                                restock_obj := create_object(34, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 34));
                                             end
                                             else begin
@@ -5074,17 +5074,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -5102,7 +5102,7 @@ begin
                                         else begin
                                             if ((236 == 11) or (236 == 400)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 32) < 1) then begin
-                                                    restock_obj := create_object_sid(32, 0, 0, -1);
+                                                    restock_obj := create_object(32, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 32));
                                                 end
                                                 else begin
@@ -5115,17 +5115,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -5143,7 +5143,7 @@ begin
                                             else begin
                                                 if ((236 == 12) or (236 == 353) or (236 == 389) or (236 == 405) or (236 == 23)) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 35) < 1) then begin
-                                                        restock_obj := create_object_sid(35, 0, 0, -1);
+                                                        restock_obj := create_object(35, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 35));
                                                     end
                                                     else begin
@@ -5156,17 +5156,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -5184,7 +5184,7 @@ begin
                                                 else begin
                                                     if (236 == 13) then begin
                                                         if (obj_is_carrying_obj_pid(self_obj, 14) < 1) then begin
-                                                            restock_obj := create_object_sid(14, 0, 0, -1);
+                                                            restock_obj := create_object(14, 0, 0);
                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 14));
                                                         end
                                                         else begin
@@ -5197,17 +5197,17 @@ begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 14);
                                                                     if (obj_type(self_obj) == 1) then begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 14);
-                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                             end
                                                                         end
                                                                         else begin
-                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                metarule(43, self_obj);
+                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                inven_unwield(self_obj);
                                                                             end
                                                                         end
                                                                     end
@@ -5225,7 +5225,7 @@ begin
                                                     else begin
                                                         if ((236 == 15) or (236 == 397) or (236 == 28) or (236 == 118) or (236 == 401) or (236 == 233)) then begin
                                                             if (obj_is_carrying_obj_pid(self_obj, 39) < 1) then begin
-                                                                restock_obj := create_object_sid(39, 0, 0, -1);
+                                                                restock_obj := create_object(39, 0, 0);
                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 39));
                                                             end
                                                             else begin
@@ -5238,17 +5238,17 @@ begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                                                         if (obj_type(self_obj) == 1) then begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                 end
                                                                             end
                                                                             else begin
-                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                    metarule(43, self_obj);
+                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                    inven_unwield(self_obj);
                                                                                 end
                                                                             end
                                                                         end
@@ -5266,7 +5266,7 @@ begin
                                                         else begin
                                                             if ((236 == 16) or (236 == 235) or (236 == 407) or (236 == 116) or (236 == 160) or (236 == 399) or (236 == 24) or (236 == 406) or (236 == 393) or (236 == 396) or (236 == 120) or (236 == 402)) then begin
                                                                 if (obj_is_carrying_obj_pid(self_obj, 38) < 1) then begin
-                                                                    restock_obj := create_object_sid(38, 0, 0, -1);
+                                                                    restock_obj := create_object(38, 0, 0);
                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 38));
                                                                 end
                                                                 else begin
@@ -5279,17 +5279,17 @@ begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 38);
                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 38);
-                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                     end
                                                                                 end
                                                                                 else begin
-                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                        metarule(43, self_obj);
+                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                        inven_unwield(self_obj);
                                                                                     end
                                                                                 end
                                                                             end
@@ -5307,7 +5307,7 @@ begin
                                                             else begin
                                                                 if ((236 == 18) or (236 == 398) or (236 == 404) or (236 == 313)) then begin
                                                                     if (obj_is_carrying_obj_pid(self_obj, 31) < 1) then begin
-                                                                        restock_obj := create_object_sid(31, 0, 0, -1);
+                                                                        restock_obj := create_object(31, 0, 0);
                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 31));
                                                                     end
                                                                     else begin
@@ -5320,17 +5320,17 @@ begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                         end
                                                                                     end
                                                                                     else begin
-                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                            metarule(43, self_obj);
+                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                            inven_unwield(self_obj);
                                                                                         end
                                                                                     end
                                                                                 end
@@ -5348,7 +5348,7 @@ begin
                                                                 else begin
                                                                     if (236 == 22) then begin
                                                                         if (obj_is_carrying_obj_pid(self_obj, 33) < 1) then begin
-                                                                            restock_obj := create_object_sid(33, 0, 0, -1);
+                                                                            restock_obj := create_object(33, 0, 0);
                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 33));
                                                                         end
                                                                         else begin
@@ -5361,17 +5361,17 @@ begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                             end
                                                                                         end
                                                                                         else begin
-                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                metarule(43, self_obj);
+                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                inven_unwield(self_obj);
                                                                                             end
                                                                                         end
                                                                                     end
@@ -5389,7 +5389,7 @@ begin
                                                                     else begin
                                                                         if ((236 == 94) or (236 == 354) or (236 == 385) or (236 == 242) or (236 == 268)) then begin
                                                                             if (obj_is_carrying_obj_pid(self_obj, 95) < 1) then begin
-                                                                                restock_obj := create_object_sid(95, 0, 0, -1);
+                                                                                restock_obj := create_object(95, 0, 0);
                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 95));
                                                                             end
                                                                             else begin
@@ -5402,17 +5402,17 @@ begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                 end
                                                                                             end
                                                                                             else begin
-                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                    metarule(43, self_obj);
+                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                    inven_unwield(self_obj);
                                                                                                 end
                                                                                             end
                                                                                         end
@@ -5430,7 +5430,7 @@ begin
                                                                         else begin
                                                                             if (236 == 122) then begin
                                                                                 if (obj_is_carrying_obj_pid(self_obj, 121) < 1) then begin
-                                                                                    restock_obj := create_object_sid(121, 0, 0, -1);
+                                                                                    restock_obj := create_object(121, 0, 0);
                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 121));
                                                                                 end
                                                                                 else begin
@@ -5443,17 +5443,17 @@ begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 121);
                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 121);
-                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                        metarule(43, self_obj);
+                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                        inven_unwield(self_obj);
                                                                                                     end
                                                                                                 end
                                                                                             end
@@ -5471,7 +5471,7 @@ begin
                                                                             else begin
                                                                                 if (236 == 296) then begin
                                                                                     if (obj_is_carrying_obj_pid(self_obj, 360) < 1) then begin
-                                                                                        restock_obj := create_object_sid(360, 0, 0, -1);
+                                                                                        restock_obj := create_object(360, 0, 0);
                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 360));
                                                                                     end
                                                                                     else begin
@@ -5484,17 +5484,17 @@ begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                         end
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                            metarule(43, self_obj);
+                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                            inven_unwield(self_obj);
                                                                                                         end
                                                                                                     end
                                                                                                 end
@@ -5512,7 +5512,7 @@ begin
                                                                                 else begin
                                                                                     if (236 == 270) then begin
                                                                                         if (obj_is_carrying_obj_pid(self_obj, 274) < 1) then begin
-                                                                                            restock_obj := create_object_sid(274, 0, 0, -1);
+                                                                                            restock_obj := create_object(274, 0, 0);
                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 274));
                                                                                         end
                                                                                         else begin
@@ -5525,17 +5525,17 @@ begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 274);
                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 274);
-                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                             end
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                metarule(43, self_obj);
+                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                inven_unwield(self_obj);
                                                                                                             end
                                                                                                         end
                                                                                                     end
@@ -5553,7 +5553,7 @@ begin
                                                                                     else begin
                                                                                         if (236 == 299) then begin
                                                                                             if (obj_is_carrying_obj_pid(self_obj, 19) < 1) then begin
-                                                                                                restock_obj := create_object_sid(19, 0, 0, -1);
+                                                                                                restock_obj := create_object(19, 0, 0);
                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 19));
                                                                                             end
                                                                                             else begin
@@ -5566,17 +5566,17 @@ begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 19);
                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 19);
-                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                    metarule(43, self_obj);
+                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                    inven_unwield(self_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                         end
@@ -5594,7 +5594,7 @@ begin
                                                                                         else begin
                                                                                             if ((236 == 161) or (236 == 162) or (236 == 261)) then begin
                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 163) < 1) then begin
-                                                                                                    restock_obj := create_object_sid(163, 0, 0, -1);
+                                                                                                    restock_obj := create_object(163, 0, 0);
                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 163));
                                                                                                 end
                                                                                                 else begin
@@ -5607,17 +5607,17 @@ begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                        metarule(43, self_obj);
+                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                        inven_unwield(self_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                             end
@@ -5635,7 +5635,7 @@ begin
                                                                                             else begin
                                                                                                 if ((236 == 283) or (236 == 332)) then begin
                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 357) < 1) then begin
-                                                                                                        restock_obj := create_object_sid(357, 0, 0, -1);
+                                                                                                        restock_obj := create_object(357, 0, 0);
                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 357));
                                                                                                     end
                                                                                                     else begin
@@ -5648,17 +5648,17 @@ begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                            metarule(43, self_obj);
+                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                            inven_unwield(self_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                 end
@@ -5676,7 +5676,7 @@ begin
                                                                                                 else begin
                                                                                                     if ((236 == 351) or (236 == 403) or (236 == 387)) then begin
                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 363) < 1) then begin
-                                                                                                            restock_obj := create_object_sid(363, 0, 0, -1);
+                                                                                                            restock_obj := create_object(363, 0, 0);
                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 363));
                                                                                                         end
                                                                                                         else begin
@@ -5689,17 +5689,17 @@ begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                metarule(43, self_obj);
+                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                inven_unwield(self_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                     end
@@ -5717,7 +5717,7 @@ begin
                                                                                                     else begin
                                                                                                         if ((236 == 392) or (236 == 394)) then begin
                                                                                                             if (obj_is_carrying_obj_pid(self_obj, 358) < 1) then begin
-                                                                                                                restock_obj := create_object_sid(358, 0, 0, -1);
+                                                                                                                restock_obj := create_object(358, 0, 0);
                                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 358));
                                                                                                             end
                                                                                                             else begin
@@ -5730,17 +5730,17 @@ begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 358);
                                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 358);
-                                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                             else begin
-                                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                    metarule(43, self_obj);
+                                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                    inven_unwield(self_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                         end
@@ -5758,7 +5758,7 @@ begin
                                                                                                         else begin
                                                                                                             if ((236 == 352) or (236 == 391) or (236 == 395)) then begin
                                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 359) < 1) then begin
-                                                                                                                    restock_obj := create_object_sid(359, 0, 0, -1);
+                                                                                                                    restock_obj := create_object(359, 0, 0);
                                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 359));
                                                                                                                 end
                                                                                                                 else begin
@@ -5771,17 +5771,17 @@ begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 359);
                                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 359);
-                                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                     end
                                                                                                                                 end
                                                                                                                                 else begin
-                                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                        metarule(43, self_obj);
+                                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                        inven_unwield(self_obj);
                                                                                                                                     end
                                                                                                                                 end
                                                                                                                             end
@@ -5799,7 +5799,7 @@ begin
                                                                                                             else begin
                                                                                                                 if (236 == 388) then begin
                                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 361) < 1) then begin
-                                                                                                                        restock_obj := create_object_sid(361, 0, 0, -1);
+                                                                                                                        restock_obj := create_object(361, 0, 0);
                                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 361));
                                                                                                                     end
                                                                                                                     else begin
@@ -5812,17 +5812,17 @@ begin
                                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                         end
                                                                                                                                     end
                                                                                                                                     else begin
-                                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                            metarule(43, self_obj);
+                                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                            inven_unwield(self_obj);
                                                                                                                                         end
                                                                                                                                     end
                                                                                                                                 end
@@ -5861,7 +5861,7 @@ begin
                             else begin
                                 if (obj_art_fid(self_obj) != 16777249) then begin
                                     if (obj_is_carrying_obj_pid(self_obj, 4) < 1) then begin
-                                        restock_obj := create_object_sid(4, 0, 0, -1);
+                                        restock_obj := create_object(4, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 4));
                                     end
                                     else begin
@@ -5874,17 +5874,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 4);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 4);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -5900,7 +5900,7 @@ begin
                                     end
                                     if (1) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 4)) then begin
-                                            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 4));
+                                            wield_obj(obj_carrying_pid_obj(self_obj, 4));
                                         end
                                         else begin
                                             debug_msg("NOT ARMING THE WEAPON!!!");
@@ -5908,7 +5908,7 @@ begin
                                     end
                                     if (0 != 0) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 0) < 1) then begin
-                                            restock_obj := create_object_sid(0, 0, 0, -1);
+                                            restock_obj := create_object(0, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 0));
                                         end
                                         else begin
@@ -5921,17 +5921,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 0);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 0);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -5949,7 +5949,7 @@ begin
                                     else begin
                                         if ((4 == 8) or (4 == 300) or (4 == 9)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 29) < 1) then begin
-                                                restock_obj := create_object_sid(29, 0, 0, -1);
+                                                restock_obj := create_object(29, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 29));
                                             end
                                             else begin
@@ -5962,17 +5962,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -5990,7 +5990,7 @@ begin
                                         else begin
                                             if ((4 == 10) or (4 == 350) or (4 == 355) or (4 == 143) or (4 == 241) or (4 == 287)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 34) < 1) then begin
-                                                    restock_obj := create_object_sid(34, 0, 0, -1);
+                                                    restock_obj := create_object(34, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 34));
                                                 end
                                                 else begin
@@ -6003,17 +6003,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -6031,7 +6031,7 @@ begin
                                             else begin
                                                 if ((4 == 11) or (4 == 400)) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 32) < 1) then begin
-                                                        restock_obj := create_object_sid(32, 0, 0, -1);
+                                                        restock_obj := create_object(32, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 32));
                                                     end
                                                     else begin
@@ -6044,17 +6044,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -6072,7 +6072,7 @@ begin
                                                 else begin
                                                     if ((4 == 12) or (4 == 353) or (4 == 389) or (4 == 405) or (4 == 23)) then begin
                                                         if (obj_is_carrying_obj_pid(self_obj, 35) < 1) then begin
-                                                            restock_obj := create_object_sid(35, 0, 0, -1);
+                                                            restock_obj := create_object(35, 0, 0);
                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 35));
                                                         end
                                                         else begin
@@ -6085,17 +6085,17 @@ begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                                                     if (obj_type(self_obj) == 1) then begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                             end
                                                                         end
                                                                         else begin
-                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                metarule(43, self_obj);
+                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                inven_unwield(self_obj);
                                                                             end
                                                                         end
                                                                     end
@@ -6113,7 +6113,7 @@ begin
                                                     else begin
                                                         if (4 == 13) then begin
                                                             if (obj_is_carrying_obj_pid(self_obj, 14) < 1) then begin
-                                                                restock_obj := create_object_sid(14, 0, 0, -1);
+                                                                restock_obj := create_object(14, 0, 0);
                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 14));
                                                             end
                                                             else begin
@@ -6126,17 +6126,17 @@ begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 14);
                                                                         if (obj_type(self_obj) == 1) then begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 14);
-                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                 end
                                                                             end
                                                                             else begin
-                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                    metarule(43, self_obj);
+                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                    inven_unwield(self_obj);
                                                                                 end
                                                                             end
                                                                         end
@@ -6154,7 +6154,7 @@ begin
                                                         else begin
                                                             if ((4 == 15) or (4 == 397) or (4 == 28) or (4 == 118) or (4 == 401) or (4 == 233)) then begin
                                                                 if (obj_is_carrying_obj_pid(self_obj, 39) < 1) then begin
-                                                                    restock_obj := create_object_sid(39, 0, 0, -1);
+                                                                    restock_obj := create_object(39, 0, 0);
                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 39));
                                                                 end
                                                                 else begin
@@ -6167,17 +6167,17 @@ begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                     end
                                                                                 end
                                                                                 else begin
-                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                        metarule(43, self_obj);
+                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                        inven_unwield(self_obj);
                                                                                     end
                                                                                 end
                                                                             end
@@ -6195,7 +6195,7 @@ begin
                                                             else begin
                                                                 if ((4 == 16) or (4 == 235) or (4 == 407) or (4 == 116) or (4 == 160) or (4 == 399) or (4 == 24) or (4 == 406) or (4 == 393) or (4 == 396) or (4 == 120) or (4 == 402)) then begin
                                                                     if (obj_is_carrying_obj_pid(self_obj, 38) < 1) then begin
-                                                                        restock_obj := create_object_sid(38, 0, 0, -1);
+                                                                        restock_obj := create_object(38, 0, 0);
                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 38));
                                                                     end
                                                                     else begin
@@ -6208,17 +6208,17 @@ begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 38);
                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 38);
-                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                         end
                                                                                     end
                                                                                     else begin
-                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                            metarule(43, self_obj);
+                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                            inven_unwield(self_obj);
                                                                                         end
                                                                                     end
                                                                                 end
@@ -6236,7 +6236,7 @@ begin
                                                                 else begin
                                                                     if ((4 == 18) or (4 == 398) or (4 == 404) or (4 == 313)) then begin
                                                                         if (obj_is_carrying_obj_pid(self_obj, 31) < 1) then begin
-                                                                            restock_obj := create_object_sid(31, 0, 0, -1);
+                                                                            restock_obj := create_object(31, 0, 0);
                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 31));
                                                                         end
                                                                         else begin
@@ -6249,17 +6249,17 @@ begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                             end
                                                                                         end
                                                                                         else begin
-                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                metarule(43, self_obj);
+                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                inven_unwield(self_obj);
                                                                                             end
                                                                                         end
                                                                                     end
@@ -6277,7 +6277,7 @@ begin
                                                                     else begin
                                                                         if (4 == 22) then begin
                                                                             if (obj_is_carrying_obj_pid(self_obj, 33) < 1) then begin
-                                                                                restock_obj := create_object_sid(33, 0, 0, -1);
+                                                                                restock_obj := create_object(33, 0, 0);
                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 33));
                                                                             end
                                                                             else begin
@@ -6290,17 +6290,17 @@ begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                 end
                                                                                             end
                                                                                             else begin
-                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                    metarule(43, self_obj);
+                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                    inven_unwield(self_obj);
                                                                                                 end
                                                                                             end
                                                                                         end
@@ -6318,7 +6318,7 @@ begin
                                                                         else begin
                                                                             if ((4 == 94) or (4 == 354) or (4 == 385) or (4 == 242) or (4 == 268)) then begin
                                                                                 if (obj_is_carrying_obj_pid(self_obj, 95) < 1) then begin
-                                                                                    restock_obj := create_object_sid(95, 0, 0, -1);
+                                                                                    restock_obj := create_object(95, 0, 0);
                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 95));
                                                                                 end
                                                                                 else begin
@@ -6331,17 +6331,17 @@ begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                        metarule(43, self_obj);
+                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                        inven_unwield(self_obj);
                                                                                                     end
                                                                                                 end
                                                                                             end
@@ -6359,7 +6359,7 @@ begin
                                                                             else begin
                                                                                 if (4 == 122) then begin
                                                                                     if (obj_is_carrying_obj_pid(self_obj, 121) < 1) then begin
-                                                                                        restock_obj := create_object_sid(121, 0, 0, -1);
+                                                                                        restock_obj := create_object(121, 0, 0);
                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 121));
                                                                                     end
                                                                                     else begin
@@ -6372,17 +6372,17 @@ begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 121);
                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 121);
-                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                         end
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                            metarule(43, self_obj);
+                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                            inven_unwield(self_obj);
                                                                                                         end
                                                                                                     end
                                                                                                 end
@@ -6400,7 +6400,7 @@ begin
                                                                                 else begin
                                                                                     if (4 == 296) then begin
                                                                                         if (obj_is_carrying_obj_pid(self_obj, 360) < 1) then begin
-                                                                                            restock_obj := create_object_sid(360, 0, 0, -1);
+                                                                                            restock_obj := create_object(360, 0, 0);
                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 360));
                                                                                         end
                                                                                         else begin
@@ -6413,17 +6413,17 @@ begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                             end
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                metarule(43, self_obj);
+                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                inven_unwield(self_obj);
                                                                                                             end
                                                                                                         end
                                                                                                     end
@@ -6441,7 +6441,7 @@ begin
                                                                                     else begin
                                                                                         if (4 == 270) then begin
                                                                                             if (obj_is_carrying_obj_pid(self_obj, 274) < 1) then begin
-                                                                                                restock_obj := create_object_sid(274, 0, 0, -1);
+                                                                                                restock_obj := create_object(274, 0, 0);
                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 274));
                                                                                             end
                                                                                             else begin
@@ -6454,17 +6454,17 @@ begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 274);
                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 274);
-                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                    metarule(43, self_obj);
+                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                    inven_unwield(self_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                         end
@@ -6482,7 +6482,7 @@ begin
                                                                                         else begin
                                                                                             if (4 == 299) then begin
                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 19) < 1) then begin
-                                                                                                    restock_obj := create_object_sid(19, 0, 0, -1);
+                                                                                                    restock_obj := create_object(19, 0, 0);
                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 19));
                                                                                                 end
                                                                                                 else begin
@@ -6495,17 +6495,17 @@ begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 19);
                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 19);
-                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                        metarule(43, self_obj);
+                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                        inven_unwield(self_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                             end
@@ -6523,7 +6523,7 @@ begin
                                                                                             else begin
                                                                                                 if ((4 == 161) or (4 == 162) or (4 == 261)) then begin
                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 163) < 1) then begin
-                                                                                                        restock_obj := create_object_sid(163, 0, 0, -1);
+                                                                                                        restock_obj := create_object(163, 0, 0);
                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 163));
                                                                                                     end
                                                                                                     else begin
@@ -6536,17 +6536,17 @@ begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                            metarule(43, self_obj);
+                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                            inven_unwield(self_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                 end
@@ -6564,7 +6564,7 @@ begin
                                                                                                 else begin
                                                                                                     if ((4 == 283) or (4 == 332)) then begin
                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 357) < 1) then begin
-                                                                                                            restock_obj := create_object_sid(357, 0, 0, -1);
+                                                                                                            restock_obj := create_object(357, 0, 0);
                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 357));
                                                                                                         end
                                                                                                         else begin
@@ -6577,17 +6577,17 @@ begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                metarule(43, self_obj);
+                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                inven_unwield(self_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                     end
@@ -6605,7 +6605,7 @@ begin
                                                                                                     else begin
                                                                                                         if ((4 == 351) or (4 == 403) or (4 == 387)) then begin
                                                                                                             if (obj_is_carrying_obj_pid(self_obj, 363) < 1) then begin
-                                                                                                                restock_obj := create_object_sid(363, 0, 0, -1);
+                                                                                                                restock_obj := create_object(363, 0, 0);
                                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 363));
                                                                                                             end
                                                                                                             else begin
@@ -6618,17 +6618,17 @@ begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                             else begin
-                                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                    metarule(43, self_obj);
+                                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                    inven_unwield(self_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                         end
@@ -6646,7 +6646,7 @@ begin
                                                                                                         else begin
                                                                                                             if ((4 == 392) or (4 == 394)) then begin
                                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 358) < 1) then begin
-                                                                                                                    restock_obj := create_object_sid(358, 0, 0, -1);
+                                                                                                                    restock_obj := create_object(358, 0, 0);
                                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 358));
                                                                                                                 end
                                                                                                                 else begin
@@ -6659,17 +6659,17 @@ begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 358);
                                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 358);
-                                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                     end
                                                                                                                                 end
                                                                                                                                 else begin
-                                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                        metarule(43, self_obj);
+                                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                        inven_unwield(self_obj);
                                                                                                                                     end
                                                                                                                                 end
                                                                                                                             end
@@ -6687,7 +6687,7 @@ begin
                                                                                                             else begin
                                                                                                                 if ((4 == 352) or (4 == 391) or (4 == 395)) then begin
                                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 359) < 1) then begin
-                                                                                                                        restock_obj := create_object_sid(359, 0, 0, -1);
+                                                                                                                        restock_obj := create_object(359, 0, 0);
                                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 359));
                                                                                                                     end
                                                                                                                     else begin
@@ -6700,17 +6700,17 @@ begin
                                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 359);
                                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 359);
-                                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                         end
                                                                                                                                     end
                                                                                                                                     else begin
-                                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                            metarule(43, self_obj);
+                                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                            inven_unwield(self_obj);
                                                                                                                                         end
                                                                                                                                     end
                                                                                                                                 end
@@ -6728,7 +6728,7 @@ begin
                                                                                                                 else begin
                                                                                                                     if (4 == 388) then begin
                                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 361) < 1) then begin
-                                                                                                                            restock_obj := create_object_sid(361, 0, 0, -1);
+                                                                                                                            restock_obj := create_object(361, 0, 0);
                                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 361));
                                                                                                                         end
                                                                                                                         else begin
@@ -6741,17 +6741,17 @@ begin
                                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                             end
                                                                                                                                         end
                                                                                                                                         else begin
-                                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                                metarule(43, self_obj);
+                                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                                inven_unwield(self_obj);
                                                                                                                                             end
                                                                                                                                         end
                                                                                                                                     end
@@ -6789,7 +6789,7 @@ begin
                                 end
                                 else begin
                                     if (obj_is_carrying_obj_pid(self_obj, 234) < 1) then begin
-                                        restock_obj := create_object_sid(234, 0, 0, -1);
+                                        restock_obj := create_object(234, 0, 0);
                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 234));
                                     end
                                     else begin
@@ -6802,17 +6802,17 @@ begin
                                                 restock_obj := obj_carrying_pid_obj(self_obj, 234);
                                                 if (obj_type(self_obj) == 1) then begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 234);
-                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                             add_obj_to_inven(self_obj, restock_obj);
                                                         end
                                                     end
                                                     else begin
-                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                            metarule(43, self_obj);
+                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                            inven_unwield(self_obj);
                                                         end
                                                     end
                                                 end
@@ -6828,7 +6828,7 @@ begin
                                     end
                                     if (1) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 234)) then begin
-                                            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 234));
+                                            wield_obj(obj_carrying_pid_obj(self_obj, 234));
                                         end
                                         else begin
                                             debug_msg("NOT ARMING THE WEAPON!!!");
@@ -6836,7 +6836,7 @@ begin
                                     end
                                     if (0 != 0) then begin
                                         if (obj_is_carrying_obj_pid(self_obj, 0) < 1) then begin
-                                            restock_obj := create_object_sid(0, 0, 0, -1);
+                                            restock_obj := create_object(0, 0, 0);
                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 0));
                                         end
                                         else begin
@@ -6849,17 +6849,17 @@ begin
                                                     restock_obj := obj_carrying_pid_obj(self_obj, 0);
                                                     if (obj_type(self_obj) == 1) then begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 0);
-                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                             end
                                                         end
                                                         else begin
-                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                metarule(43, self_obj);
+                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                inven_unwield(self_obj);
                                                             end
                                                         end
                                                     end
@@ -6877,7 +6877,7 @@ begin
                                     else begin
                                         if ((234 == 8) or (234 == 300) or (234 == 9)) then begin
                                             if (obj_is_carrying_obj_pid(self_obj, 29) < 1) then begin
-                                                restock_obj := create_object_sid(29, 0, 0, -1);
+                                                restock_obj := create_object(29, 0, 0);
                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 29));
                                             end
                                             else begin
@@ -6890,17 +6890,17 @@ begin
                                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                                         if (obj_type(self_obj) == 1) then begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                 end
                                                             end
                                                             else begin
-                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                    metarule(43, self_obj);
+                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                    inven_unwield(self_obj);
                                                                 end
                                                             end
                                                         end
@@ -6918,7 +6918,7 @@ begin
                                         else begin
                                             if ((234 == 10) or (234 == 350) or (234 == 355) or (234 == 143) or (234 == 241) or (234 == 287)) then begin
                                                 if (obj_is_carrying_obj_pid(self_obj, 34) < 1) then begin
-                                                    restock_obj := create_object_sid(34, 0, 0, -1);
+                                                    restock_obj := create_object(34, 0, 0);
                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 34));
                                                 end
                                                 else begin
@@ -6931,17 +6931,17 @@ begin
                                                             restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                                             if (obj_type(self_obj) == 1) then begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                     end
                                                                 end
                                                                 else begin
-                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                        metarule(43, self_obj);
+                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                        inven_unwield(self_obj);
                                                                     end
                                                                 end
                                                             end
@@ -6959,7 +6959,7 @@ begin
                                             else begin
                                                 if ((234 == 11) or (234 == 400)) then begin
                                                     if (obj_is_carrying_obj_pid(self_obj, 32) < 1) then begin
-                                                        restock_obj := create_object_sid(32, 0, 0, -1);
+                                                        restock_obj := create_object(32, 0, 0);
                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 32));
                                                     end
                                                     else begin
@@ -6972,17 +6972,17 @@ begin
                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                                                 if (obj_type(self_obj) == 1) then begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                         end
                                                                     end
                                                                     else begin
-                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                            metarule(43, self_obj);
+                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                            inven_unwield(self_obj);
                                                                         end
                                                                     end
                                                                 end
@@ -7000,7 +7000,7 @@ begin
                                                 else begin
                                                     if ((234 == 12) or (234 == 353) or (234 == 389) or (234 == 405) or (234 == 23)) then begin
                                                         if (obj_is_carrying_obj_pid(self_obj, 35) < 1) then begin
-                                                            restock_obj := create_object_sid(35, 0, 0, -1);
+                                                            restock_obj := create_object(35, 0, 0);
                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 35));
                                                         end
                                                         else begin
@@ -7013,17 +7013,17 @@ begin
                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 35);
                                                                     if (obj_type(self_obj) == 1) then begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 35);
-                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                             end
                                                                         end
                                                                         else begin
-                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                metarule(43, self_obj);
+                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                inven_unwield(self_obj);
                                                                             end
                                                                         end
                                                                     end
@@ -7041,7 +7041,7 @@ begin
                                                     else begin
                                                         if (234 == 13) then begin
                                                             if (obj_is_carrying_obj_pid(self_obj, 14) < 1) then begin
-                                                                restock_obj := create_object_sid(14, 0, 0, -1);
+                                                                restock_obj := create_object(14, 0, 0);
                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 14));
                                                             end
                                                             else begin
@@ -7054,17 +7054,17 @@ begin
                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 14);
                                                                         if (obj_type(self_obj) == 1) then begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 14);
-                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                 end
                                                                             end
                                                                             else begin
-                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                    metarule(43, self_obj);
+                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                    inven_unwield(self_obj);
                                                                                 end
                                                                             end
                                                                         end
@@ -7082,7 +7082,7 @@ begin
                                                         else begin
                                                             if ((234 == 15) or (234 == 397) or (234 == 28) or (234 == 118) or (234 == 401) or (234 == 233)) then begin
                                                                 if (obj_is_carrying_obj_pid(self_obj, 39) < 1) then begin
-                                                                    restock_obj := create_object_sid(39, 0, 0, -1);
+                                                                    restock_obj := create_object(39, 0, 0);
                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 39));
                                                                 end
                                                                 else begin
@@ -7095,17 +7095,17 @@ begin
                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                     end
                                                                                 end
                                                                                 else begin
-                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                        metarule(43, self_obj);
+                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                        inven_unwield(self_obj);
                                                                                     end
                                                                                 end
                                                                             end
@@ -7123,7 +7123,7 @@ begin
                                                             else begin
                                                                 if ((234 == 16) or (234 == 235) or (234 == 407) or (234 == 116) or (234 == 160) or (234 == 399) or (234 == 24) or (234 == 406) or (234 == 393) or (234 == 396) or (234 == 120) or (234 == 402)) then begin
                                                                     if (obj_is_carrying_obj_pid(self_obj, 38) < 1) then begin
-                                                                        restock_obj := create_object_sid(38, 0, 0, -1);
+                                                                        restock_obj := create_object(38, 0, 0);
                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 38));
                                                                     end
                                                                     else begin
@@ -7136,17 +7136,17 @@ begin
                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 38);
                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 38);
-                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                         end
                                                                                     end
                                                                                     else begin
-                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                            metarule(43, self_obj);
+                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                            inven_unwield(self_obj);
                                                                                         end
                                                                                     end
                                                                                 end
@@ -7164,7 +7164,7 @@ begin
                                                                 else begin
                                                                     if ((234 == 18) or (234 == 398) or (234 == 404) or (234 == 313)) then begin
                                                                         if (obj_is_carrying_obj_pid(self_obj, 31) < 1) then begin
-                                                                            restock_obj := create_object_sid(31, 0, 0, -1);
+                                                                            restock_obj := create_object(31, 0, 0);
                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 31));
                                                                         end
                                                                         else begin
@@ -7177,17 +7177,17 @@ begin
                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 31);
                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 31);
-                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                             end
                                                                                         end
                                                                                         else begin
-                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                metarule(43, self_obj);
+                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                inven_unwield(self_obj);
                                                                                             end
                                                                                         end
                                                                                     end
@@ -7205,7 +7205,7 @@ begin
                                                                     else begin
                                                                         if (234 == 22) then begin
                                                                             if (obj_is_carrying_obj_pid(self_obj, 33) < 1) then begin
-                                                                                restock_obj := create_object_sid(33, 0, 0, -1);
+                                                                                restock_obj := create_object(33, 0, 0);
                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 33));
                                                                             end
                                                                             else begin
@@ -7218,17 +7218,17 @@ begin
                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                 end
                                                                                             end
                                                                                             else begin
-                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                    metarule(43, self_obj);
+                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                    inven_unwield(self_obj);
                                                                                                 end
                                                                                             end
                                                                                         end
@@ -7246,7 +7246,7 @@ begin
                                                                         else begin
                                                                             if ((234 == 94) or (234 == 354) or (234 == 385) or (234 == 242) or (234 == 268)) then begin
                                                                                 if (obj_is_carrying_obj_pid(self_obj, 95) < 1) then begin
-                                                                                    restock_obj := create_object_sid(95, 0, 0, -1);
+                                                                                    restock_obj := create_object(95, 0, 0);
                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 95));
                                                                                 end
                                                                                 else begin
@@ -7259,17 +7259,17 @@ begin
                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 95);
                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 95);
-                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                        metarule(43, self_obj);
+                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                        inven_unwield(self_obj);
                                                                                                     end
                                                                                                 end
                                                                                             end
@@ -7287,7 +7287,7 @@ begin
                                                                             else begin
                                                                                 if (234 == 122) then begin
                                                                                     if (obj_is_carrying_obj_pid(self_obj, 121) < 1) then begin
-                                                                                        restock_obj := create_object_sid(121, 0, 0, -1);
+                                                                                        restock_obj := create_object(121, 0, 0);
                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 121));
                                                                                     end
                                                                                     else begin
@@ -7300,17 +7300,17 @@ begin
                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 121);
                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 121);
-                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                         end
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                            metarule(43, self_obj);
+                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                            inven_unwield(self_obj);
                                                                                                         end
                                                                                                     end
                                                                                                 end
@@ -7328,7 +7328,7 @@ begin
                                                                                 else begin
                                                                                     if (234 == 296) then begin
                                                                                         if (obj_is_carrying_obj_pid(self_obj, 360) < 1) then begin
-                                                                                            restock_obj := create_object_sid(360, 0, 0, -1);
+                                                                                            restock_obj := create_object(360, 0, 0);
                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 360));
                                                                                         end
                                                                                         else begin
@@ -7341,17 +7341,17 @@ begin
                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                             end
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                metarule(43, self_obj);
+                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                inven_unwield(self_obj);
                                                                                                             end
                                                                                                         end
                                                                                                     end
@@ -7369,7 +7369,7 @@ begin
                                                                                     else begin
                                                                                         if (234 == 270) then begin
                                                                                             if (obj_is_carrying_obj_pid(self_obj, 274) < 1) then begin
-                                                                                                restock_obj := create_object_sid(274, 0, 0, -1);
+                                                                                                restock_obj := create_object(274, 0, 0);
                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 274));
                                                                                             end
                                                                                             else begin
@@ -7382,17 +7382,17 @@ begin
                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 274);
                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 274);
-                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                    metarule(43, self_obj);
+                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                    inven_unwield(self_obj);
                                                                                                                 end
                                                                                                             end
                                                                                                         end
@@ -7410,7 +7410,7 @@ begin
                                                                                         else begin
                                                                                             if (234 == 299) then begin
                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 19) < 1) then begin
-                                                                                                    restock_obj := create_object_sid(19, 0, 0, -1);
+                                                                                                    restock_obj := create_object(19, 0, 0);
                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 19));
                                                                                                 end
                                                                                                 else begin
@@ -7423,17 +7423,17 @@ begin
                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 19);
                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 19);
-                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                        metarule(43, self_obj);
+                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                        inven_unwield(self_obj);
                                                                                                                     end
                                                                                                                 end
                                                                                                             end
@@ -7451,7 +7451,7 @@ begin
                                                                                             else begin
                                                                                                 if ((234 == 161) or (234 == 162) or (234 == 261)) then begin
                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 163) < 1) then begin
-                                                                                                        restock_obj := create_object_sid(163, 0, 0, -1);
+                                                                                                        restock_obj := create_object(163, 0, 0);
                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 163));
                                                                                                     end
                                                                                                     else begin
@@ -7464,17 +7464,17 @@ begin
                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 163);
                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 163);
-                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                            metarule(43, self_obj);
+                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                            inven_unwield(self_obj);
                                                                                                                         end
                                                                                                                     end
                                                                                                                 end
@@ -7492,7 +7492,7 @@ begin
                                                                                                 else begin
                                                                                                     if ((234 == 283) or (234 == 332)) then begin
                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 357) < 1) then begin
-                                                                                                            restock_obj := create_object_sid(357, 0, 0, -1);
+                                                                                                            restock_obj := create_object(357, 0, 0);
                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 357));
                                                                                                         end
                                                                                                         else begin
@@ -7505,17 +7505,17 @@ begin
                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                metarule(43, self_obj);
+                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                inven_unwield(self_obj);
                                                                                                                             end
                                                                                                                         end
                                                                                                                     end
@@ -7533,7 +7533,7 @@ begin
                                                                                                     else begin
                                                                                                         if ((234 == 351) or (234 == 403) or (234 == 387)) then begin
                                                                                                             if (obj_is_carrying_obj_pid(self_obj, 363) < 1) then begin
-                                                                                                                restock_obj := create_object_sid(363, 0, 0, -1);
+                                                                                                                restock_obj := create_object(363, 0, 0);
                                                                                                                 add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 363));
                                                                                                             end
                                                                                                             else begin
@@ -7546,17 +7546,17 @@ begin
                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                                                                                                         if (obj_type(self_obj) == 1) then begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                                                                                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                     add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                             else begin
-                                                                                                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                    metarule(43, self_obj);
+                                                                                                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                    inven_unwield(self_obj);
                                                                                                                                 end
                                                                                                                             end
                                                                                                                         end
@@ -7574,7 +7574,7 @@ begin
                                                                                                         else begin
                                                                                                             if ((234 == 392) or (234 == 394)) then begin
                                                                                                                 if (obj_is_carrying_obj_pid(self_obj, 358) < 1) then begin
-                                                                                                                    restock_obj := create_object_sid(358, 0, 0, -1);
+                                                                                                                    restock_obj := create_object(358, 0, 0);
                                                                                                                     add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 358));
                                                                                                                 end
                                                                                                                 else begin
@@ -7587,17 +7587,17 @@ begin
                                                                                                                             restock_obj := obj_carrying_pid_obj(self_obj, 358);
                                                                                                                             if (obj_type(self_obj) == 1) then begin
                                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 358);
-                                                                                                                                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                        restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                    if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                        restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                         debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                         rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                         add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                     end
                                                                                                                                 end
                                                                                                                                 else begin
-                                                                                                                                    if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                        metarule(43, self_obj);
+                                                                                                                                    if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                        inven_unwield(self_obj);
                                                                                                                                     end
                                                                                                                                 end
                                                                                                                             end
@@ -7615,7 +7615,7 @@ begin
                                                                                                             else begin
                                                                                                                 if ((234 == 352) or (234 == 391) or (234 == 395)) then begin
                                                                                                                     if (obj_is_carrying_obj_pid(self_obj, 359) < 1) then begin
-                                                                                                                        restock_obj := create_object_sid(359, 0, 0, -1);
+                                                                                                                        restock_obj := create_object(359, 0, 0);
                                                                                                                         add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 359));
                                                                                                                     end
                                                                                                                     else begin
@@ -7628,17 +7628,17 @@ begin
                                                                                                                                 restock_obj := obj_carrying_pid_obj(self_obj, 359);
                                                                                                                                 if (obj_type(self_obj) == 1) then begin
                                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 359);
-                                                                                                                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                             rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                             add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                         end
                                                                                                                                     end
                                                                                                                                     else begin
-                                                                                                                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                            metarule(43, self_obj);
+                                                                                                                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                            inven_unwield(self_obj);
                                                                                                                                         end
                                                                                                                                     end
                                                                                                                                 end
@@ -7656,7 +7656,7 @@ begin
                                                                                                                 else begin
                                                                                                                     if (234 == 388) then begin
                                                                                                                         if (obj_is_carrying_obj_pid(self_obj, 361) < 1) then begin
-                                                                                                                            restock_obj := create_object_sid(361, 0, 0, -1);
+                                                                                                                            restock_obj := create_object(361, 0, 0);
                                                                                                                             add_mult_objs_to_inven(self_obj, restock_obj, 1 - obj_is_carrying_obj_pid(self_obj, 361));
                                                                                                                         end
                                                                                                                         else begin
@@ -7669,17 +7669,17 @@ begin
                                                                                                                                     restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                                                                                                                     if (obj_type(self_obj) == 1) then begin
                                                                                                                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                                                                                                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                                                                                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                                                                                                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                                                                                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                                                                                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                                                                                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                                                                                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                                                                                                                 add_obj_to_inven(self_obj, restock_obj);
                                                                                                                                             end
                                                                                                                                         end
                                                                                                                                         else begin
-                                                                                                                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                                                                                                                metarule(43, self_obj);
+                                                                                                                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                                                                                                                inven_unwield(self_obj);
                                                                                                                                             end
                                                                                                                                         end
                                                                                                                                     end
@@ -7722,10 +7722,10 @@ begin
             end
         end
     end
-    if (metarule(22, 0) == 0) then begin
-        metarule3(100, self_obj, 0, 0);
+    if (is_loading_game == 0) then begin
+        rm_fixed_timer_event(self_obj, 0);
         add_timer_event(self_obj, game_ticks(random(10, 45)), 0);
-        metarule3(100, self_obj, 1, 0);
+        rm_fixed_timer_event(self_obj, 1);
         add_timer_event(self_obj, game_ticks(random(15, 60)), 1);
     end
 end
@@ -7741,14 +7741,14 @@ begin
         if (combat_is_initialized == 0) then begin
             if (random(1, 3) == 1) then begin
                 if ((obj_pid(self_obj) == 16777219) or (obj_pid(self_obj) == 16777220)) then begin
-                    float_msg(self_obj, message_str(933, random(245, 250)), 8);
+                    float_msg(self_obj, mstr(random(245, 250)), FLOAT_MSG_YELLOW);
                 end
                 else begin
-                    float_msg(self_obj, message_str(933, random(260, 265)), 8);
+                    float_msg(self_obj, mstr(random(260, 265)), FLOAT_MSG_YELLOW);
                 end
             end
         end
-        metarule3(100, self_obj, 0, 0);
+        rm_fixed_timer_event(self_obj, 0);
         add_timer_event(self_obj, game_ticks(random(10, 45)), 0);
     end
     else begin
@@ -7759,14 +7759,14 @@ begin
                         set_local_var(2, tile_num(self_obj));
                     end
                     if (tile_distance(tile_num(self_obj), local_var(2)) > 10) then begin
-                        animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(self_obj), (has_trait(1, self_obj, 10) + random(5, 7)) % 6, random(5, 10)), 0);
+                        animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(self_obj), (obj_get_rot(self_obj) + random(5, 7)) % 6, random(5, 10)), 0);
                     end
                     else begin
                         animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(self_obj), rotation_to_tile(tile_num(self_obj), local_var(2)), random(5, 10)), 0);
                     end
                 end
             end
-            metarule3(100, self_obj, 1, 0);
+            rm_fixed_timer_event(self_obj, 1);
             add_timer_event(self_obj, game_ticks(random(15, 60)), 1);
         end
     end
@@ -7792,7 +7792,7 @@ begin
             if (obj_can_see_obj(self_obj, slaver_1_obj) and (tile_distance_objs(slaver_1_obj, self_obj) < tile_distance_objs(dude_obj, self_obj))) then begin
                 debug_msg("setting slave to attack slaver");
                 set_attack := slaver_1_obj;
-                attack_complex(slaver_1_obj, 0, 1, 0, 0, 30000, 0, 0);
+                attack(slaver_1_obj);
             end
         end
         if (set_attack == 0) then begin
@@ -7800,7 +7800,7 @@ begin
                 if (obj_can_see_obj(self_obj, slaver_2_obj) and (tile_distance_objs(slaver_2_obj, self_obj) < tile_distance_objs(dude_obj, self_obj))) then begin
                     debug_msg("setting slave to attack slaver");
                     set_attack := slaver_2_obj;
-                    attack_complex(slaver_2_obj, 0, 1, 0, 0, 30000, 0, 0);
+                    attack(slaver_2_obj);
                 end
             end
         end
@@ -7815,4 +7815,3 @@ end
 procedure map_update_p_proc
 begin
 end
-
