diff --git a/Mods/MegaMod/Original/FILAOTBL.ssl b/Mods/MegaMod/ReDefine/FILAOTBL.ssl
index 6de0efa..9654271 100644
--- a/Mods/MegaMod/Original/FILAOTBL.ssl
+++ b/Mods/MegaMod/ReDefine/FILAOTBL.ssl
@@ -190,7 +190,7 @@ begin
     if (validHandle(i_lao_merchant)) then begin
         if (local_var(0) < game_time) then begin
             if (tile_num(self_obj) == 24719) then begin
-                LVar0 := create_object_sid(128, 5, 0, -1);
+                LVar0 := create_object(128, 5, 0);
                 if (obj_is_carrying_obj_pid(self_obj, 479) > 0) then begin
                     LVar1 := obj_carrying_pid_obj(self_obj, 479);
                     rm_obj_from_inven(self_obj, LVar1);
@@ -436,14 +436,14 @@ begin
                     rm_obj_from_inven(self_obj, LVar1);
                     add_obj_to_inven(LVar0, LVar1);
                 end
-                global_temp := create_object_sid(128, 0, 0, -1);
+                global_temp := create_object(128, 0, 0);
                 move_obj_inven_to_obj(self_obj, global_temp);
                 destroy_object(global_temp);
                 restock_amt := random(1000, 2000);
                 if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                     if (100 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                            restock_obj := create_object_sid(41, 0, 0, -1);
+                            restock_obj := create_object(41, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                         end
                         else begin
@@ -456,17 +456,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -484,7 +484,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                        restock_obj := create_object_sid(41, 0, 0, -1);
+                        restock_obj := create_object(41, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                     end
                     else begin
@@ -497,17 +497,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -526,7 +526,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 13) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 13) < restock_amt) then begin
-                            restock_obj := create_object_sid(13, 0, 0, -1);
+                            restock_obj := create_object(13, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 13));
                         end
                         else begin
@@ -539,17 +539,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 13);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 13);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -567,7 +567,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 13) < restock_amt) then begin
-                        restock_obj := create_object_sid(13, 0, 0, -1);
+                        restock_obj := create_object(13, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 13));
                     end
                     else begin
@@ -580,17 +580,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 13);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 13);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -609,7 +609,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 16) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 16) < restock_amt) then begin
-                            restock_obj := create_object_sid(16, 0, 0, -1);
+                            restock_obj := create_object(16, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 16));
                         end
                         else begin
@@ -622,17 +622,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 16);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 16);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -650,7 +650,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 16) < restock_amt) then begin
-                        restock_obj := create_object_sid(16, 0, 0, -1);
+                        restock_obj := create_object(16, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 16));
                     end
                     else begin
@@ -663,17 +663,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 16);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 16);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -692,7 +692,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
                     if (80 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
-                            restock_obj := create_object_sid(234, 0, 0, -1);
+                            restock_obj := create_object(234, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 234));
                         end
                         else begin
@@ -705,17 +705,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 234);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 234);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -733,7 +733,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
-                        restock_obj := create_object_sid(234, 0, 0, -1);
+                        restock_obj := create_object(234, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 234));
                     end
                     else begin
@@ -746,17 +746,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 234);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 234);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -775,7 +775,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 241) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 241) < restock_amt) then begin
-                            restock_obj := create_object_sid(241, 0, 0, -1);
+                            restock_obj := create_object(241, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 241));
                         end
                         else begin
@@ -788,17 +788,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 241);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 241);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -816,7 +816,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 241) < restock_amt) then begin
-                        restock_obj := create_object_sid(241, 0, 0, -1);
+                        restock_obj := create_object(241, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 241));
                     end
                     else begin
@@ -829,17 +829,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 241);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 241);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -858,7 +858,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
                     if (55 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
-                            restock_obj := create_object_sid(296, 0, 0, -1);
+                            restock_obj := create_object(296, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 296));
                         end
                         else begin
@@ -871,17 +871,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 296);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 296);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -899,7 +899,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
-                        restock_obj := create_object_sid(296, 0, 0, -1);
+                        restock_obj := create_object(296, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 296));
                     end
                     else begin
@@ -912,17 +912,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 296);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 296);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -941,7 +941,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 387) < restock_amt) then begin
                     if (45 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 387) < restock_amt) then begin
-                            restock_obj := create_object_sid(387, 0, 0, -1);
+                            restock_obj := create_object(387, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 387));
                         end
                         else begin
@@ -954,17 +954,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 387);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 387);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -982,7 +982,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 387) < restock_amt) then begin
-                        restock_obj := create_object_sid(387, 0, 0, -1);
+                        restock_obj := create_object(387, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 387));
                     end
                     else begin
@@ -995,17 +995,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 387);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 387);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1024,7 +1024,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 401) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 401) < restock_amt) then begin
-                            restock_obj := create_object_sid(401, 0, 0, -1);
+                            restock_obj := create_object(401, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 401));
                         end
                         else begin
@@ -1037,17 +1037,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 401);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 401);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1065,7 +1065,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 401) < restock_amt) then begin
-                        restock_obj := create_object_sid(401, 0, 0, -1);
+                        restock_obj := create_object(401, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 401));
                     end
                     else begin
@@ -1078,17 +1078,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 401);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 401);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1107,7 +1107,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 402) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 402) < restock_amt) then begin
-                            restock_obj := create_object_sid(402, 0, 0, -1);
+                            restock_obj := create_object(402, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 402));
                         end
                         else begin
@@ -1120,17 +1120,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 402);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 402);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1148,7 +1148,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 402) < restock_amt) then begin
-                        restock_obj := create_object_sid(402, 0, 0, -1);
+                        restock_obj := create_object(402, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 402));
                     end
                     else begin
@@ -1161,17 +1161,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 402);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 402);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1190,7 +1190,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 289) < restock_amt) then begin
                     if (30 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 289) < restock_amt) then begin
-                            restock_obj := create_object_sid(289, 0, 0, -1);
+                            restock_obj := create_object(289, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 289));
                         end
                         else begin
@@ -1203,17 +1203,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 289);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 289);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1231,7 +1231,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 289) < restock_amt) then begin
-                        restock_obj := create_object_sid(289, 0, 0, -1);
+                        restock_obj := create_object(289, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 289));
                     end
                     else begin
@@ -1244,17 +1244,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 289);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 289);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1273,7 +1273,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 308) < restock_amt) then begin
                     if (25 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 308) < restock_amt) then begin
-                            restock_obj := create_object_sid(308, 0, 0, -1);
+                            restock_obj := create_object(308, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 308));
                         end
                         else begin
@@ -1286,17 +1286,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 308);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 308);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1314,7 +1314,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 308) < restock_amt) then begin
-                        restock_obj := create_object_sid(308, 0, 0, -1);
+                        restock_obj := create_object(308, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 308));
                     end
                     else begin
@@ -1327,17 +1327,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 308);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 308);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1356,7 +1356,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 314) < restock_amt) then begin
                     if (78 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 314) < restock_amt) then begin
-                            restock_obj := create_object_sid(314, 0, 0, -1);
+                            restock_obj := create_object(314, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 314));
                         end
                         else begin
@@ -1369,17 +1369,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 314);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 314);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1397,7 +1397,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 314) < restock_amt) then begin
-                        restock_obj := create_object_sid(314, 0, 0, -1);
+                        restock_obj := create_object(314, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 314));
                     end
                     else begin
@@ -1410,17 +1410,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 314);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 314);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1439,7 +1439,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 315) < restock_amt) then begin
                     if (90 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 315) < restock_amt) then begin
-                            restock_obj := create_object_sid(315, 0, 0, -1);
+                            restock_obj := create_object(315, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 315));
                         end
                         else begin
@@ -1452,17 +1452,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 315);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 315);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1480,7 +1480,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 315) < restock_amt) then begin
-                        restock_obj := create_object_sid(315, 0, 0, -1);
+                        restock_obj := create_object(315, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 315));
                     end
                     else begin
@@ -1493,17 +1493,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 315);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 315);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1522,7 +1522,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 240) < restock_amt) then begin
                     if (60 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 240) < restock_amt) then begin
-                            restock_obj := create_object_sid(240, 0, 0, -1);
+                            restock_obj := create_object(240, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 240));
                         end
                         else begin
@@ -1535,17 +1535,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 240);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 240);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1563,7 +1563,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 240) < restock_amt) then begin
-                        restock_obj := create_object_sid(240, 0, 0, -1);
+                        restock_obj := create_object(240, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 240));
                     end
                     else begin
@@ -1576,17 +1576,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 240);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 240);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1605,7 +1605,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 74) < restock_amt) then begin
                     if (60 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 74) < restock_amt) then begin
-                            restock_obj := create_object_sid(74, 0, 0, -1);
+                            restock_obj := create_object(74, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 74));
                         end
                         else begin
@@ -1618,17 +1618,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 74);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 74);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1646,7 +1646,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 74) < restock_amt) then begin
-                        restock_obj := create_object_sid(74, 0, 0, -1);
+                        restock_obj := create_object(74, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 74));
                     end
                     else begin
@@ -1659,17 +1659,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 74);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 74);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1688,7 +1688,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 3) < restock_amt) then begin
                     if (60 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 3) < restock_amt) then begin
-                            restock_obj := create_object_sid(3, 0, 0, -1);
+                            restock_obj := create_object(3, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 3));
                         end
                         else begin
@@ -1701,17 +1701,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 3);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 3);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1729,7 +1729,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 3) < restock_amt) then begin
-                        restock_obj := create_object_sid(3, 0, 0, -1);
+                        restock_obj := create_object(3, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 3));
                     end
                     else begin
@@ -1742,17 +1742,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 3);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 3);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1771,7 +1771,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
                     if (65 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
-                            restock_obj := create_object_sid(380, 0, 0, -1);
+                            restock_obj := create_object(380, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 380));
                         end
                         else begin
@@ -1784,17 +1784,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 380);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 380);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1812,7 +1812,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
-                        restock_obj := create_object_sid(380, 0, 0, -1);
+                        restock_obj := create_object(380, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 380));
                     end
                     else begin
@@ -1825,17 +1825,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 380);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 380);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1855,7 +1855,7 @@ begin
             end
             else begin
                 if (tile_num(self_obj) == 25519) then begin
-                    LVar0 := create_object_sid(128, 5, 0, -1);
+                    LVar0 := create_object(128, 5, 0);
                     if (obj_is_carrying_obj_pid(self_obj, 479) > 0) then begin
                         LVar1 := obj_carrying_pid_obj(self_obj, 479);
                         rm_obj_from_inven(self_obj, LVar1);
@@ -2101,14 +2101,14 @@ begin
                         rm_obj_from_inven(self_obj, LVar1);
                         add_obj_to_inven(LVar0, LVar1);
                     end
-                    global_temp := create_object_sid(128, 0, 0, -1);
+                    global_temp := create_object(128, 0, 0);
                     move_obj_inven_to_obj(self_obj, global_temp);
                     destroy_object(global_temp);
                     restock_amt := random(1000, 2000);
                     if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                                restock_obj := create_object_sid(41, 0, 0, -1);
+                                restock_obj := create_object(41, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                             end
                             else begin
@@ -2121,17 +2121,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2149,7 +2149,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 41) < restock_amt) then begin
-                            restock_obj := create_object_sid(41, 0, 0, -1);
+                            restock_obj := create_object(41, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 41));
                         end
                         else begin
@@ -2162,17 +2162,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 41);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 41);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2191,7 +2191,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
-                                restock_obj := create_object_sid(20, 0, 0, -1);
+                                restock_obj := create_object(20, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 20));
                             end
                             else begin
@@ -2204,17 +2204,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 20);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 20);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2232,7 +2232,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
-                            restock_obj := create_object_sid(20, 0, 0, -1);
+                            restock_obj := create_object(20, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 20));
                         end
                         else begin
@@ -2245,17 +2245,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 20);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 20);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2274,7 +2274,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 383) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 383) < restock_amt) then begin
-                                restock_obj := create_object_sid(383, 0, 0, -1);
+                                restock_obj := create_object(383, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 383));
                             end
                             else begin
@@ -2287,17 +2287,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 383);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 383);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2315,7 +2315,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 383) < restock_amt) then begin
-                            restock_obj := create_object_sid(383, 0, 0, -1);
+                            restock_obj := create_object(383, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 383));
                         end
                         else begin
@@ -2328,17 +2328,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 383);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 383);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2357,7 +2357,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 384) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 384) < restock_amt) then begin
-                                restock_obj := create_object_sid(384, 0, 0, -1);
+                                restock_obj := create_object(384, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 384));
                             end
                             else begin
@@ -2370,17 +2370,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 384);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 384);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2398,7 +2398,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 384) < restock_amt) then begin
-                            restock_obj := create_object_sid(384, 0, 0, -1);
+                            restock_obj := create_object(384, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 384));
                         end
                         else begin
@@ -2411,17 +2411,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 384);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 384);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2440,7 +2440,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                                restock_obj := create_object_sid(40, 0, 0, -1);
+                                restock_obj := create_object(40, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                             end
                             else begin
@@ -2453,17 +2453,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2481,7 +2481,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                            restock_obj := create_object_sid(40, 0, 0, -1);
+                            restock_obj := create_object(40, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                         end
                         else begin
@@ -2494,17 +2494,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2523,7 +2523,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 47) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 47) < restock_amt) then begin
-                                restock_obj := create_object_sid(47, 0, 0, -1);
+                                restock_obj := create_object(47, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 47));
                             end
                             else begin
@@ -2536,17 +2536,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 47);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 47);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2564,7 +2564,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 47) < restock_amt) then begin
-                            restock_obj := create_object_sid(47, 0, 0, -1);
+                            restock_obj := create_object(47, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 47));
                         end
                         else begin
@@ -2577,17 +2577,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 47);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 47);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2606,7 +2606,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-                                restock_obj := create_object_sid(49, 0, 0, -1);
+                                restock_obj := create_object(49, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
                             end
                             else begin
@@ -2619,17 +2619,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 49);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 49);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2647,7 +2647,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-                            restock_obj := create_object_sid(49, 0, 0, -1);
+                            restock_obj := create_object(49, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
                         end
                         else begin
@@ -2660,17 +2660,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 49);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 49);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2689,7 +2689,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 48) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 48) < restock_amt) then begin
-                                restock_obj := create_object_sid(48, 0, 0, -1);
+                                restock_obj := create_object(48, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 48));
                             end
                             else begin
@@ -2702,17 +2702,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 48);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 48);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2730,7 +2730,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 48) < restock_amt) then begin
-                            restock_obj := create_object_sid(48, 0, 0, -1);
+                            restock_obj := create_object(48, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 48));
                         end
                         else begin
@@ -2743,17 +2743,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 48);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 48);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2772,7 +2772,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 53) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 53) < restock_amt) then begin
-                                restock_obj := create_object_sid(53, 0, 0, -1);
+                                restock_obj := create_object(53, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 53));
                             end
                             else begin
@@ -2785,17 +2785,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 53);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 53);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2813,7 +2813,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 53) < restock_amt) then begin
-                            restock_obj := create_object_sid(53, 0, 0, -1);
+                            restock_obj := create_object(53, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 53));
                         end
                         else begin
@@ -2826,17 +2826,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 53);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 53);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2855,7 +2855,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                restock_obj := create_object_sid(71, 0, 0, -1);
+                                restock_obj := create_object(71, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                             end
                             else begin
@@ -2868,17 +2868,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2896,7 +2896,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                            restock_obj := create_object_sid(71, 0, 0, -1);
+                            restock_obj := create_object(71, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                         end
                         else begin
@@ -2909,17 +2909,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2938,7 +2938,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 87) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 87) < restock_amt) then begin
-                                restock_obj := create_object_sid(87, 0, 0, -1);
+                                restock_obj := create_object(87, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 87));
                             end
                             else begin
@@ -2951,17 +2951,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 87);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 87);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2979,7 +2979,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 87) < restock_amt) then begin
-                            restock_obj := create_object_sid(87, 0, 0, -1);
+                            restock_obj := create_object(87, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 87));
                         end
                         else begin
@@ -2992,17 +2992,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 87);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 87);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3021,7 +3021,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 91) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 91) < restock_amt) then begin
-                                restock_obj := create_object_sid(91, 0, 0, -1);
+                                restock_obj := create_object(91, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 91));
                             end
                             else begin
@@ -3034,17 +3034,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 91);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 91);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3062,7 +3062,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 91) < restock_amt) then begin
-                            restock_obj := create_object_sid(91, 0, 0, -1);
+                            restock_obj := create_object(91, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 91));
                         end
                         else begin
@@ -3075,17 +3075,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 91);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 91);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3104,7 +3104,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 109) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 109) < restock_amt) then begin
-                                restock_obj := create_object_sid(109, 0, 0, -1);
+                                restock_obj := create_object(109, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 109));
                             end
                             else begin
@@ -3117,17 +3117,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 109);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 109);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3145,7 +3145,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 109) < restock_amt) then begin
-                            restock_obj := create_object_sid(109, 0, 0, -1);
+                            restock_obj := create_object(109, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 109));
                         end
                         else begin
@@ -3158,17 +3158,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 109);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 109);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3187,7 +3187,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 110) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 110) < restock_amt) then begin
-                                restock_obj := create_object_sid(110, 0, 0, -1);
+                                restock_obj := create_object(110, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 110));
                             end
                             else begin
@@ -3200,17 +3200,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 110);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 110);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3228,7 +3228,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 110) < restock_amt) then begin
-                            restock_obj := create_object_sid(110, 0, 0, -1);
+                            restock_obj := create_object(110, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 110));
                         end
                         else begin
@@ -3241,17 +3241,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 110);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 110);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3270,7 +3270,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
-                                restock_obj := create_object_sid(144, 0, 0, -1);
+                                restock_obj := create_object(144, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 144));
                             end
                             else begin
@@ -3283,17 +3283,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 144);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 144);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3311,7 +3311,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
-                            restock_obj := create_object_sid(144, 0, 0, -1);
+                            restock_obj := create_object(144, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 144));
                         end
                         else begin
@@ -3324,17 +3324,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 144);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 144);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3353,7 +3353,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
-                                restock_obj := create_object_sid(271, 0, 0, -1);
+                                restock_obj := create_object(271, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 271));
                             end
                             else begin
@@ -3366,17 +3366,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 271);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 271);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3394,7 +3394,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
-                            restock_obj := create_object_sid(271, 0, 0, -1);
+                            restock_obj := create_object(271, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 271));
                         end
                         else begin
@@ -3407,17 +3407,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 271);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 271);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3436,7 +3436,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
-                                restock_obj := create_object_sid(272, 0, 0, -1);
+                                restock_obj := create_object(272, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 272));
                             end
                             else begin
@@ -3449,17 +3449,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 272);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 272);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3477,7 +3477,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
-                            restock_obj := create_object_sid(272, 0, 0, -1);
+                            restock_obj := create_object(272, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 272));
                         end
                         else begin
@@ -3490,17 +3490,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 272);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 272);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3519,7 +3519,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
                         if (35 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                restock_obj := create_object_sid(273, 0, 0, -1);
+                                restock_obj := create_object(273, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                             end
                             else begin
@@ -3532,17 +3532,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3560,7 +3560,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                            restock_obj := create_object_sid(273, 0, 0, -1);
+                            restock_obj := create_object(273, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                         end
                         else begin
@@ -3573,17 +3573,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3602,7 +3602,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 284) < restock_amt) then begin
                         if (45 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 284) < restock_amt) then begin
-                                restock_obj := create_object_sid(284, 0, 0, -1);
+                                restock_obj := create_object(284, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 284));
                             end
                             else begin
@@ -3615,17 +3615,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 284);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 284);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3643,7 +3643,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 284) < restock_amt) then begin
-                            restock_obj := create_object_sid(284, 0, 0, -1);
+                            restock_obj := create_object(284, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 284));
                         end
                         else begin
@@ -3656,17 +3656,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 284);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 284);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3685,7 +3685,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 408) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 408) < restock_amt) then begin
-                                restock_obj := create_object_sid(408, 0, 0, -1);
+                                restock_obj := create_object(408, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 408));
                             end
                             else begin
@@ -3698,17 +3698,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 408);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 408);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3726,7 +3726,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 408) < restock_amt) then begin
-                            restock_obj := create_object_sid(408, 0, 0, -1);
+                            restock_obj := create_object(408, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 408));
                         end
                         else begin
@@ -3739,17 +3739,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 408);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 408);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3768,7 +3768,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 73) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 73) < restock_amt) then begin
-                                restock_obj := create_object_sid(73, 0, 0, -1);
+                                restock_obj := create_object(73, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 73));
                             end
                             else begin
@@ -3781,17 +3781,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 73);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 73);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3809,7 +3809,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 73) < restock_amt) then begin
-                            restock_obj := create_object_sid(73, 0, 0, -1);
+                            restock_obj := create_object(73, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 73));
                         end
                         else begin
@@ -3822,17 +3822,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 73);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 73);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3851,7 +3851,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 76) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 76) < restock_amt) then begin
-                                restock_obj := create_object_sid(76, 0, 0, -1);
+                                restock_obj := create_object(76, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 76));
                             end
                             else begin
@@ -3864,17 +3864,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 76);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 76);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3892,7 +3892,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 76) < restock_amt) then begin
-                            restock_obj := create_object_sid(76, 0, 0, -1);
+                            restock_obj := create_object(76, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 76));
                         end
                         else begin
@@ -3905,17 +3905,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 76);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 76);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3934,7 +3934,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 80) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 80) < restock_amt) then begin
-                                restock_obj := create_object_sid(80, 0, 0, -1);
+                                restock_obj := create_object(80, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 80));
                             end
                             else begin
@@ -3947,17 +3947,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 80);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 80);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3975,7 +3975,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 80) < restock_amt) then begin
-                            restock_obj := create_object_sid(80, 0, 0, -1);
+                            restock_obj := create_object(80, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 80));
                         end
                         else begin
@@ -3988,17 +3988,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 80);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 80);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4017,7 +4017,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 86) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 86) < restock_amt) then begin
-                                restock_obj := create_object_sid(86, 0, 0, -1);
+                                restock_obj := create_object(86, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 86));
                             end
                             else begin
@@ -4030,17 +4030,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 86);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 86);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4058,7 +4058,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 86) < restock_amt) then begin
-                            restock_obj := create_object_sid(86, 0, 0, -1);
+                            restock_obj := create_object(86, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 86));
                         end
                         else begin
@@ -4071,17 +4071,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 86);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 86);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4100,7 +4100,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 102) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 102) < restock_amt) then begin
-                                restock_obj := create_object_sid(102, 0, 0, -1);
+                                restock_obj := create_object(102, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 102));
                             end
                             else begin
@@ -4113,17 +4113,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 102);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 102);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4141,7 +4141,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 102) < restock_amt) then begin
-                            restock_obj := create_object_sid(102, 0, 0, -1);
+                            restock_obj := create_object(102, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 102));
                         end
                         else begin
@@ -4154,17 +4154,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 102);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 102);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4183,7 +4183,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 228) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 228) < restock_amt) then begin
-                                restock_obj := create_object_sid(228, 0, 0, -1);
+                                restock_obj := create_object(228, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 228));
                             end
                             else begin
@@ -4196,17 +4196,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 228);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 228);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4224,7 +4224,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 228) < restock_amt) then begin
-                            restock_obj := create_object_sid(228, 0, 0, -1);
+                            restock_obj := create_object(228, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 228));
                         end
                         else begin
@@ -4237,17 +4237,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 228);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 228);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4266,7 +4266,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 237) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 237) < restock_amt) then begin
-                                restock_obj := create_object_sid(237, 0, 0, -1);
+                                restock_obj := create_object(237, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 237));
                             end
                             else begin
@@ -4279,17 +4279,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 237);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 237);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4307,7 +4307,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 237) < restock_amt) then begin
-                            restock_obj := create_object_sid(237, 0, 0, -1);
+                            restock_obj := create_object(237, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 237));
                         end
                         else begin
@@ -4320,17 +4320,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 237);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 237);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4349,7 +4349,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 51) < restock_amt) then begin
                         if (33 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 51) < restock_amt) then begin
-                                restock_obj := create_object_sid(51, 0, 0, -1);
+                                restock_obj := create_object(51, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 51));
                             end
                             else begin
@@ -4362,17 +4362,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 51);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 51);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4390,7 +4390,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 51) < restock_amt) then begin
-                            restock_obj := create_object_sid(51, 0, 0, -1);
+                            restock_obj := create_object(51, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 51));
                         end
                         else begin
@@ -4403,17 +4403,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 51);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 51);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4432,7 +4432,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
-                                restock_obj := create_object_sid(52, 0, 0, -1);
+                                restock_obj := create_object(52, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 52));
                             end
                             else begin
@@ -4445,17 +4445,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 52);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 52);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4473,7 +4473,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
-                            restock_obj := create_object_sid(52, 0, 0, -1);
+                            restock_obj := create_object(52, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 52));
                         end
                         else begin
@@ -4486,17 +4486,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 52);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 52);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4515,7 +4515,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 59) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 59) < restock_amt) then begin
-                                restock_obj := create_object_sid(59, 0, 0, -1);
+                                restock_obj := create_object(59, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 59));
                             end
                             else begin
@@ -4528,17 +4528,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 59);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 59);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4556,7 +4556,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 59) < restock_amt) then begin
-                            restock_obj := create_object_sid(59, 0, 0, -1);
+                            restock_obj := create_object(59, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 59));
                         end
                         else begin
@@ -4569,17 +4569,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 59);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 59);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4598,7 +4598,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 75) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 75) < restock_amt) then begin
-                                restock_obj := create_object_sid(75, 0, 0, -1);
+                                restock_obj := create_object(75, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 75));
                             end
                             else begin
@@ -4611,17 +4611,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 75);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 75);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4639,7 +4639,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 75) < restock_amt) then begin
-                            restock_obj := create_object_sid(75, 0, 0, -1);
+                            restock_obj := create_object(75, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 75));
                         end
                         else begin
@@ -4652,17 +4652,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 75);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 75);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4681,7 +4681,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 77) < restock_amt) then begin
                         if (20 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 77) < restock_amt) then begin
-                                restock_obj := create_object_sid(77, 0, 0, -1);
+                                restock_obj := create_object(77, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 77));
                             end
                             else begin
@@ -4694,17 +4694,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 77);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 77);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4722,7 +4722,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 77) < restock_amt) then begin
-                            restock_obj := create_object_sid(77, 0, 0, -1);
+                            restock_obj := create_object(77, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 77));
                         end
                         else begin
@@ -4735,17 +4735,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 77);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 77);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4764,7 +4764,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 84) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 84) < restock_amt) then begin
-                                restock_obj := create_object_sid(84, 0, 0, -1);
+                                restock_obj := create_object(84, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 84));
                             end
                             else begin
@@ -4777,17 +4777,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 84);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 84);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4805,7 +4805,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 84) < restock_amt) then begin
-                            restock_obj := create_object_sid(84, 0, 0, -1);
+                            restock_obj := create_object(84, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 84));
                         end
                         else begin
@@ -4818,17 +4818,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 84);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 84);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4847,7 +4847,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
-                                restock_obj := create_object_sid(85, 0, 0, -1);
+                                restock_obj := create_object(85, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 85));
                             end
                             else begin
@@ -4860,17 +4860,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 85);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 85);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4888,7 +4888,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
-                            restock_obj := create_object_sid(85, 0, 0, -1);
+                            restock_obj := create_object(85, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 85));
                         end
                         else begin
@@ -4901,17 +4901,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 85);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 85);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4930,7 +4930,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
-                                restock_obj := create_object_sid(127, 0, 0, -1);
+                                restock_obj := create_object(127, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 127));
                             end
                             else begin
@@ -4943,17 +4943,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 127);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 127);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4971,7 +4971,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
-                            restock_obj := create_object_sid(127, 0, 0, -1);
+                            restock_obj := create_object(127, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 127));
                         end
                         else begin
@@ -4984,17 +4984,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 127);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 127);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5013,7 +5013,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 410) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 410) < restock_amt) then begin
-                                restock_obj := create_object_sid(410, 0, 0, -1);
+                                restock_obj := create_object(410, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 410));
                             end
                             else begin
@@ -5026,17 +5026,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 410);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 410);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5054,7 +5054,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 410) < restock_amt) then begin
-                            restock_obj := create_object_sid(410, 0, 0, -1);
+                            restock_obj := create_object(410, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 410));
                         end
                         else begin
@@ -5067,17 +5067,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 410);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 410);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5096,7 +5096,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 411) < restock_amt) then begin
                         if (35 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 411) < restock_amt) then begin
-                                restock_obj := create_object_sid(411, 0, 0, -1);
+                                restock_obj := create_object(411, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 411));
                             end
                             else begin
@@ -5109,17 +5109,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 411);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 411);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5137,7 +5137,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 411) < restock_amt) then begin
-                            restock_obj := create_object_sid(411, 0, 0, -1);
+                            restock_obj := create_object(411, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 411));
                         end
                         else begin
@@ -5150,17 +5150,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 411);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 411);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5179,7 +5179,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 226) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 226) < restock_amt) then begin
-                                restock_obj := create_object_sid(226, 0, 0, -1);
+                                restock_obj := create_object(226, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 226));
                             end
                             else begin
@@ -5192,17 +5192,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 226);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 226);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5220,7 +5220,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 226) < restock_amt) then begin
-                            restock_obj := create_object_sid(226, 0, 0, -1);
+                            restock_obj := create_object(226, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 226));
                         end
                         else begin
@@ -5233,17 +5233,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 226);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 226);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5262,7 +5262,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
-                                restock_obj := create_object_sid(363, 0, 0, -1);
+                                restock_obj := create_object(363, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 363));
                             end
                             else begin
@@ -5275,17 +5275,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5303,7 +5303,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
-                            restock_obj := create_object_sid(363, 0, 0, -1);
+                            restock_obj := create_object(363, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 363));
                         end
                         else begin
@@ -5316,17 +5316,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5345,7 +5345,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 382) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 382) < restock_amt) then begin
-                                restock_obj := create_object_sid(382, 0, 0, -1);
+                                restock_obj := create_object(382, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 382));
                             end
                             else begin
@@ -5358,17 +5358,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 382);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 382);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5386,7 +5386,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 382) < restock_amt) then begin
-                            restock_obj := create_object_sid(382, 0, 0, -1);
+                            restock_obj := create_object(382, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 382));
                         end
                         else begin
@@ -5399,17 +5399,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 382);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 382);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5428,7 +5428,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
-                                restock_obj := create_object_sid(39, 0, 0, -1);
+                                restock_obj := create_object(39, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 39));
                             end
                             else begin
@@ -5441,17 +5441,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5469,7 +5469,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
-                            restock_obj := create_object_sid(39, 0, 0, -1);
+                            restock_obj := create_object(39, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 39));
                         end
                         else begin
@@ -5482,17 +5482,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5511,7 +5511,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 37) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 37) < restock_amt) then begin
-                                restock_obj := create_object_sid(37, 0, 0, -1);
+                                restock_obj := create_object(37, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 37));
                             end
                             else begin
@@ -5524,17 +5524,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 37);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 37);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5552,7 +5552,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 37) < restock_amt) then begin
-                            restock_obj := create_object_sid(37, 0, 0, -1);
+                            restock_obj := create_object(37, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 37));
                         end
                         else begin
@@ -5565,17 +5565,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 37);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 37);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5594,7 +5594,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
-                                restock_obj := create_object_sid(33, 0, 0, -1);
+                                restock_obj := create_object(33, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 33));
                             end
                             else begin
@@ -5607,17 +5607,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5635,7 +5635,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
-                            restock_obj := create_object_sid(33, 0, 0, -1);
+                            restock_obj := create_object(33, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 33));
                         end
                         else begin
@@ -5648,17 +5648,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5677,7 +5677,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 32) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 32) < restock_amt) then begin
-                                restock_obj := create_object_sid(32, 0, 0, -1);
+                                restock_obj := create_object(32, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 32));
                             end
                             else begin
@@ -5690,17 +5690,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5718,7 +5718,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 32) < restock_amt) then begin
-                            restock_obj := create_object_sid(32, 0, 0, -1);
+                            restock_obj := create_object(32, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 32));
                         end
                         else begin
@@ -5731,17 +5731,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5760,7 +5760,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 357) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 357) < restock_amt) then begin
-                                restock_obj := create_object_sid(357, 0, 0, -1);
+                                restock_obj := create_object(357, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 357));
                             end
                             else begin
@@ -5773,17 +5773,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5801,7 +5801,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 357) < restock_amt) then begin
-                            restock_obj := create_object_sid(357, 0, 0, -1);
+                            restock_obj := create_object(357, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 357));
                         end
                         else begin
@@ -5814,17 +5814,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5843,7 +5843,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 361) < restock_amt) then begin
                         if (65 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 361) < restock_amt) then begin
-                                restock_obj := create_object_sid(361, 0, 0, -1);
+                                restock_obj := create_object(361, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 361));
                             end
                             else begin
@@ -5856,17 +5856,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5884,7 +5884,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 361) < restock_amt) then begin
-                            restock_obj := create_object_sid(361, 0, 0, -1);
+                            restock_obj := create_object(361, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 361));
                         end
                         else begin
@@ -5897,17 +5897,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5926,7 +5926,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 362) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 362) < restock_amt) then begin
-                                restock_obj := create_object_sid(362, 0, 0, -1);
+                                restock_obj := create_object(362, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 362));
                             end
                             else begin
@@ -5939,17 +5939,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 362);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 362);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5967,7 +5967,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 362) < restock_amt) then begin
-                            restock_obj := create_object_sid(362, 0, 0, -1);
+                            restock_obj := create_object(362, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 362));
                         end
                         else begin
@@ -5980,17 +5980,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 362);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 362);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6009,7 +6009,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
-                                restock_obj := create_object_sid(29, 0, 0, -1);
+                                restock_obj := create_object(29, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 29));
                             end
                             else begin
@@ -6022,17 +6022,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6050,7 +6050,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
-                            restock_obj := create_object_sid(29, 0, 0, -1);
+                            restock_obj := create_object(29, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 29));
                         end
                         else begin
@@ -6063,17 +6063,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6092,7 +6092,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                                restock_obj := create_object_sid(30, 0, 0, -1);
+                                restock_obj := create_object(30, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
                             end
                             else begin
@@ -6105,17 +6105,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 30);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 30);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6133,7 +6133,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                            restock_obj := create_object_sid(30, 0, 0, -1);
+                            restock_obj := create_object(30, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
                         end
                         else begin
@@ -6146,17 +6146,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 30);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 30);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6175,7 +6175,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
-                                restock_obj := create_object_sid(360, 0, 0, -1);
+                                restock_obj := create_object(360, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 360));
                             end
                             else begin
@@ -6188,17 +6188,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6216,7 +6216,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
-                            restock_obj := create_object_sid(360, 0, 0, -1);
+                            restock_obj := create_object(360, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 360));
                         end
                         else begin
@@ -6229,17 +6229,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6258,7 +6258,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
-                                restock_obj := create_object_sid(34, 0, 0, -1);
+                                restock_obj := create_object(34, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 34));
                             end
                             else begin
@@ -6271,17 +6271,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6299,7 +6299,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
-                            restock_obj := create_object_sid(34, 0, 0, -1);
+                            restock_obj := create_object(34, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 34));
                         end
                         else begin
@@ -6312,17 +6312,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6341,7 +6341,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 761) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 761) < restock_amt) then begin
-                                restock_obj := create_object_sid(761, 0, 0, -1);
+                                restock_obj := create_object(761, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 761));
                             end
                             else begin
@@ -6354,17 +6354,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 761);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 761);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6382,7 +6382,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 761) < restock_amt) then begin
-                            restock_obj := create_object_sid(761, 0, 0, -1);
+                            restock_obj := create_object(761, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 761));
                         end
                         else begin
@@ -6395,17 +6395,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 761);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 761);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6424,7 +6424,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 762) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 762) < restock_amt) then begin
-                                restock_obj := create_object_sid(762, 0, 0, -1);
+                                restock_obj := create_object(762, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 762));
                             end
                             else begin
@@ -6437,17 +6437,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 762);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 762);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6465,7 +6465,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 762) < restock_amt) then begin
-                            restock_obj := create_object_sid(762, 0, 0, -1);
+                            restock_obj := create_object(762, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 762));
                         end
                         else begin
@@ -6478,17 +6478,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 762);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 762);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6507,7 +6507,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 763) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 763) < restock_amt) then begin
-                                restock_obj := create_object_sid(763, 0, 0, -1);
+                                restock_obj := create_object(763, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 763));
                             end
                             else begin
@@ -6520,17 +6520,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 763);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 763);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6548,7 +6548,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 763) < restock_amt) then begin
-                            restock_obj := create_object_sid(763, 0, 0, -1);
+                            restock_obj := create_object(763, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 763));
                         end
                         else begin
@@ -6561,17 +6561,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 763);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 763);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6590,7 +6590,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 767) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 767) < restock_amt) then begin
-                                restock_obj := create_object_sid(767, 0, 0, -1);
+                                restock_obj := create_object(767, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 767));
                             end
                             else begin
@@ -6603,17 +6603,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 767);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 767);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6631,7 +6631,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 767) < restock_amt) then begin
-                            restock_obj := create_object_sid(767, 0, 0, -1);
+                            restock_obj := create_object(767, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 767));
                         end
                         else begin
@@ -6644,17 +6644,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 767);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 767);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6673,7 +6673,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 768) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 768) < restock_amt) then begin
-                                restock_obj := create_object_sid(768, 0, 0, -1);
+                                restock_obj := create_object(768, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 768));
                             end
                             else begin
@@ -6686,17 +6686,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 768);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 768);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6714,7 +6714,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 768) < restock_amt) then begin
-                            restock_obj := create_object_sid(768, 0, 0, -1);
+                            restock_obj := create_object(768, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 768));
                         end
                         else begin
@@ -6727,17 +6727,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 768);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 768);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6756,7 +6756,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 769) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 769) < restock_amt) then begin
-                                restock_obj := create_object_sid(769, 0, 0, -1);
+                                restock_obj := create_object(769, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 769));
                             end
                             else begin
@@ -6769,17 +6769,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 769);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 769);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6797,7 +6797,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 769) < restock_amt) then begin
-                            restock_obj := create_object_sid(769, 0, 0, -1);
+                            restock_obj := create_object(769, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 769));
                         end
                         else begin
@@ -6810,17 +6810,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 769);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 769);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6839,7 +6839,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 770) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 770) < restock_amt) then begin
-                                restock_obj := create_object_sid(770, 0, 0, -1);
+                                restock_obj := create_object(770, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 770));
                             end
                             else begin
@@ -6852,17 +6852,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 770);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 770);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6880,7 +6880,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 770) < restock_amt) then begin
-                            restock_obj := create_object_sid(770, 0, 0, -1);
+                            restock_obj := create_object(770, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 770));
                         end
                         else begin
@@ -6893,17 +6893,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 770);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 770);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -6922,7 +6922,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 771) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 771) < restock_amt) then begin
-                                restock_obj := create_object_sid(771, 0, 0, -1);
+                                restock_obj := create_object(771, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 771));
                             end
                             else begin
@@ -6935,17 +6935,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 771);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 771);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -6963,7 +6963,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 771) < restock_amt) then begin
-                            restock_obj := create_object_sid(771, 0, 0, -1);
+                            restock_obj := create_object(771, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 771));
                         end
                         else begin
@@ -6976,17 +6976,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 771);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 771);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7005,7 +7005,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 772) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 772) < restock_amt) then begin
-                                restock_obj := create_object_sid(772, 0, 0, -1);
+                                restock_obj := create_object(772, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 772));
                             end
                             else begin
@@ -7018,17 +7018,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 772);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 772);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -7046,7 +7046,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 772) < restock_amt) then begin
-                            restock_obj := create_object_sid(772, 0, 0, -1);
+                            restock_obj := create_object(772, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 772));
                         end
                         else begin
@@ -7059,17 +7059,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 772);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 772);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7088,7 +7088,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 773) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 773) < restock_amt) then begin
-                                restock_obj := create_object_sid(773, 0, 0, -1);
+                                restock_obj := create_object(773, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 773));
                             end
                             else begin
@@ -7101,17 +7101,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 773);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 773);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -7129,7 +7129,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 773) < restock_amt) then begin
-                            restock_obj := create_object_sid(773, 0, 0, -1);
+                            restock_obj := create_object(773, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 773));
                         end
                         else begin
@@ -7142,17 +7142,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 773);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 773);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7171,7 +7171,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 774) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 774) < restock_amt) then begin
-                                restock_obj := create_object_sid(774, 0, 0, -1);
+                                restock_obj := create_object(774, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 774));
                             end
                             else begin
@@ -7184,17 +7184,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 774);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 774);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -7212,7 +7212,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 774) < restock_amt) then begin
-                            restock_obj := create_object_sid(774, 0, 0, -1);
+                            restock_obj := create_object(774, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 774));
                         end
                         else begin
@@ -7225,17 +7225,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 774);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 774);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7254,7 +7254,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 775) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 775) < restock_amt) then begin
-                                restock_obj := create_object_sid(775, 0, 0, -1);
+                                restock_obj := create_object(775, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 775));
                             end
                             else begin
@@ -7267,17 +7267,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 775);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 775);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -7295,7 +7295,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 775) < restock_amt) then begin
-                            restock_obj := create_object_sid(775, 0, 0, -1);
+                            restock_obj := create_object(775, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 775));
                         end
                         else begin
@@ -7308,17 +7308,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 775);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 775);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7337,7 +7337,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 776) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 776) < restock_amt) then begin
-                                restock_obj := create_object_sid(776, 0, 0, -1);
+                                restock_obj := create_object(776, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 776));
                             end
                             else begin
@@ -7350,17 +7350,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 776);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 776);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -7378,7 +7378,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 776) < restock_amt) then begin
-                            restock_obj := create_object_sid(776, 0, 0, -1);
+                            restock_obj := create_object(776, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 776));
                         end
                         else begin
@@ -7391,17 +7391,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 776);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 776);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7420,7 +7420,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 777) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 777) < restock_amt) then begin
-                                restock_obj := create_object_sid(777, 0, 0, -1);
+                                restock_obj := create_object(777, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 777));
                             end
                             else begin
@@ -7433,17 +7433,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 777);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 777);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -7461,7 +7461,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 777) < restock_amt) then begin
-                            restock_obj := create_object_sid(777, 0, 0, -1);
+                            restock_obj := create_object(777, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 777));
                         end
                         else begin
@@ -7474,17 +7474,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 777);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 777);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7503,7 +7503,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 98) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 98) < restock_amt) then begin
-                                restock_obj := create_object_sid(98, 0, 0, -1);
+                                restock_obj := create_object(98, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 98));
                             end
                             else begin
@@ -7516,17 +7516,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 98);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 98);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -7544,7 +7544,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 98) < restock_amt) then begin
-                            restock_obj := create_object_sid(98, 0, 0, -1);
+                            restock_obj := create_object(98, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 98));
                         end
                         else begin
@@ -7557,17 +7557,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 98);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 98);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -7605,4 +7605,3 @@ end
 procedure timed_event_p_proc
 begin
 end
-
