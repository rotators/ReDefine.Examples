diff --git a/Mods/MegaMod/Original/RAFAEL.ssl b/Mods/MegaMod/ReDefine/RAFAEL.ssl
index 9c0cd62..5c8be28 100644
--- a/Mods/MegaMod/Original/RAFAEL.ssl
+++ b/Mods/MegaMod/ReDefine/RAFAEL.ssl
@@ -217,10 +217,10 @@ procedure critter_p_proc
 begin
     if ((local_var(5) == 2) and obj_can_see_obj(self_obj, dude_obj)) then begin
         set_local_var(5, 1);
-        attack_complex(dude_obj, 0, 1, 0, 0, 30000, 0, 0);
+        attack(dude_obj);
     end
     if ((local_var(5) == 1) and obj_can_see_obj(self_obj, dude_obj)) then begin
-        attack_complex(dude_obj, 0, 1, 0, 0, 30000, 0, 0);
+        attack(dude_obj);
     end
     if ((local_var(7) bwand 16384) != 0) then begin
         if ((local_var(9) + (24 * (60 * (60 * 10)))) < game_time) then begin
@@ -246,8 +246,8 @@ begin
     end
     else begin
         if (local_var(8) == 1) then begin
-            if (((global_var(830) bwand 2048) != 0) == 0) then begin
-                if ((global_var(830) bwand 1024) != 0) then begin
+            if (((global_var(GVAR_TOWN_REP_COLLY) bwand 2048) != 0) == 0) then begin
+                if ((global_var(GVAR_TOWN_REP_COLLY) bwand 1024) != 0) then begin
                     if ((local_var(7) bwand 1048576) != 0) then begin
                         if (in_dialog == 0) then begin
                             in_dialog := 1;
@@ -324,7 +324,7 @@ begin
             end
         end
         else begin
-            set_global_var(830, global_var(830) bwor 512);
+            set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwor 512);
             if (in_dialog == 0) then begin
                 in_dialog := 1;
                 start_gdialog(1309, self_obj, 4, -1, -1);
@@ -344,62 +344,62 @@ end
 
 procedure destroy_p_proc
 begin
-    set_global_var(842, 2);
-    set_global_var(830, global_var(830) bwor 8192);
+    set_global_var(GVAR_COLLY_QUEST_7, 2);
+    set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwor 8192);
     if (source_obj == dude_obj) then begin
-        set_global_var(5, global_var(5) + 1);
-        if (((global_var(4) + global_var(5)) >= 25) and ((global_var(4) > (3 * global_var(5))) or (global_var(2) == 1)) and (global_var(1) == 0)) then begin
-            set_global_var(2, 1);
-            set_global_var(3, 0);
+        set_global_var(GVAR_GOOD_MONSTER, global_var(GVAR_GOOD_MONSTER) + 1);
+        if (((global_var(GVAR_BAD_MONSTER) + global_var(GVAR_GOOD_MONSTER)) >= 25) and ((global_var(4) > (3 * global_var(GVAR_GOOD_MONSTER))) or (global_var(GVAR_CHAMPION_REPUTATION) == 1)) and (global_var(GVAR_CHILDKILLER_REPUTATION) == 0)) then begin
+            set_global_var(GVAR_CHAMPION_REPUTATION, 1);
+            set_global_var(GVAR_BERSERKER_REPUTATION, 0);
         end
-        if (metarule(51, self_obj) == 2) then begin
+        if (critter_kill_type(self_obj) == KILL_TYPE_children_kills) then begin
             if (source_obj == dude_obj) then begin
-                set_global_var(2, 0);
-                set_global_var(1, global_var(1) + 1);
-                set_global_var(0, global_var(0) + -15);
+                set_global_var(GVAR_CHAMPION_REPUTATION, 0);
+                set_global_var(GVAR_CHILDKILLER_REPUTATION, global_var(GVAR_CHILDKILLER_REPUTATION) + 1);
+                set_global_var(GVAR_PLAYER_REPUTATION, global_var(GVAR_PLAYER_REPUTATION) + -15);
                 debug_msg("Player gains " + -15 + " Karma Points.");
-                set_global_var(37, 0);
-                set_global_var(38, 0);
-                set_global_var(39, 0);
-                set_global_var(40, 0);
-                set_global_var(41, 0);
-                set_global_var(42, 0);
-                set_global_var(43, 0);
-                set_global_var(44, 0);
-                set_global_var(45, 0);
-                if (global_var(0) >= 1000) then begin
-                    set_global_var(37, 1);
+                set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
+                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
+                set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
+                set_global_var(GVAR_KARMA_DEFENDER, 0);
+                set_global_var(GVAR_KARMA_WANDERER, 0);
+                set_global_var(GVAR_KARMA_BETRAYER, 0);
+                set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
+                set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
+                set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
+                if (global_var(GVAR_PLAYER_REPUTATION) >= 1000) then begin
+                    set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
                 end
                 else begin
-                    if (global_var(0) >= 750) then begin
-                        set_global_var(38, 1);
+                    if (global_var(GVAR_PLAYER_REPUTATION) >= 750) then begin
+                        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
                     end
                     else begin
-                        if (global_var(0) >= 500) then begin
-                            set_global_var(39, 1);
+                        if (global_var(GVAR_PLAYER_REPUTATION) >= 500) then begin
+                            set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                         end
                         else begin
-                            if (global_var(0) >= 250) then begin
-                                set_global_var(40, 1);
+                            if (global_var(GVAR_PLAYER_REPUTATION) >= 250) then begin
+                                set_global_var(GVAR_KARMA_DEFENDER, 1);
                             end
                             else begin
-                                if (global_var(0) > -250) then begin
-                                    set_global_var(41, 1);
+                                if (global_var(GVAR_PLAYER_REPUTATION) > -250) then begin
+                                    set_global_var(GVAR_KARMA_WANDERER, 1);
                                 end
                                 else begin
-                                    if (global_var(0) > -500) then begin
-                                        set_global_var(42, 1);
+                                    if (global_var(GVAR_PLAYER_REPUTATION) > -500) then begin
+                                        set_global_var(GVAR_KARMA_BETRAYER, 1);
                                     end
                                     else begin
-                                        if (global_var(0) > -750) then begin
-                                            set_global_var(43, 1);
+                                        if (global_var(GVAR_PLAYER_REPUTATION) > -750) then begin
+                                            set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                         end
                                         else begin
-                                            if (global_var(0) > -1000) then begin
-                                                set_global_var(44, 1);
+                                            if (global_var(GVAR_PLAYER_REPUTATION) > -1000) then begin
+                                                set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                             end
                                             else begin
-                                                set_global_var(45, 1);
+                                                set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                             end
                                         end
                                     end
@@ -408,58 +408,58 @@ begin
                         end
                     end
                 end
-                set_global_var(832, global_var(832) + -8);
+                set_global_var(GVAR_GANG_OUT, global_var(GVAR_GANG_OUT) + -8);
                 debug_msg("Added " + -8 + " to Town Rep");
             end
         end
-        if (((global_var(4) + global_var(5)) >= 25) and ((global_var(5) > (2 * global_var(4))) or (global_var(3) == 1))) then begin
-            set_global_var(3, 1);
-            set_global_var(2, 0);
+        if (((global_var(GVAR_BAD_MONSTER) + global_var(GVAR_GOOD_MONSTER)) >= 25) and ((global_var(GVAR_GOOD_MONSTER) > (2 * global_var(GVAR_BAD_MONSTER))) or (global_var(GVAR_BERSERKER_REPUTATION) == 1))) then begin
+            set_global_var(GVAR_BERSERKER_REPUTATION, 1);
+            set_global_var(GVAR_CHAMPION_REPUTATION, 0);
         end
-        set_global_var(0, global_var(0) + -10);
+        set_global_var(GVAR_PLAYER_REPUTATION, global_var(GVAR_PLAYER_REPUTATION) + -10);
         debug_msg("Player gains " + -10 + " Karma Points.");
-        set_global_var(37, 0);
-        set_global_var(38, 0);
-        set_global_var(39, 0);
-        set_global_var(40, 0);
-        set_global_var(41, 0);
-        set_global_var(42, 0);
-        set_global_var(43, 0);
-        set_global_var(44, 0);
-        set_global_var(45, 0);
-        if (global_var(0) >= 1000) then begin
-            set_global_var(37, 1);
+        set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
+        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
+        set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
+        set_global_var(GVAR_KARMA_DEFENDER, 0);
+        set_global_var(GVAR_KARMA_WANDERER, 0);
+        set_global_var(GVAR_KARMA_BETRAYER, 0);
+        set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
+        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
+        set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
+        if (global_var(GVAR_PLAYER_REPUTATION) >= 1000) then begin
+            set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
         end
         else begin
-            if (global_var(0) >= 750) then begin
-                set_global_var(38, 1);
+            if (global_var(GVAR_PLAYER_REPUTATION) >= 750) then begin
+                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
             end
             else begin
-                if (global_var(0) >= 500) then begin
-                    set_global_var(39, 1);
+                if (global_var(GVAR_PLAYER_REPUTATION) >= 500) then begin
+                    set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                 end
                 else begin
-                    if (global_var(0) >= 250) then begin
-                        set_global_var(40, 1);
+                    if (global_var(GVAR_PLAYER_REPUTATION) >= 250) then begin
+                        set_global_var(GVAR_KARMA_DEFENDER, 1);
                     end
                     else begin
-                        if (global_var(0) > -250) then begin
-                            set_global_var(41, 1);
+                        if (global_var(GVAR_PLAYER_REPUTATION) > -250) then begin
+                            set_global_var(GVAR_KARMA_WANDERER, 1);
                         end
                         else begin
-                            if (global_var(0) > -500) then begin
-                                set_global_var(42, 1);
+                            if (global_var(GVAR_PLAYER_REPUTATION) > -500) then begin
+                                set_global_var(GVAR_KARMA_BETRAYER, 1);
                             end
                             else begin
-                                if (global_var(0) > -750) then begin
-                                    set_global_var(43, 1);
+                                if (global_var(GVAR_PLAYER_REPUTATION) > -750) then begin
+                                    set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                 end
                                 else begin
-                                    if (global_var(0) > -1000) then begin
-                                        set_global_var(44, 1);
+                                    if (global_var(GVAR_PLAYER_REPUTATION) > -1000) then begin
+                                        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                     end
                                     else begin
-                                        set_global_var(45, 1);
+                                        set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                     end
                                 end
                             end
@@ -468,7 +468,7 @@ begin
                 end
             end
         end
-        set_global_var(832, global_var(832) + -5);
+        set_global_var(GVAR_GANG_OUT, global_var(GVAR_GANG_OUT) + -5);
         debug_msg("Added " + -5 + " to Town Rep");
     end
 end
@@ -477,25 +477,25 @@ procedure look_at_p_proc
 begin
     script_overrides;
     if (local_var(8) == 0) then begin
-        display_msg(message_str(1309, 4100));
+        display_msg(message_str(SCRIPT_AITEM6, 4100));
     end
     else begin
-        display_msg(message_str(1309, 4101));
+        display_msg(message_str(SCRIPT_AITEM6, 4101));
     end
 end
 
 procedure description_p_proc
 begin
     script_overrides;
-    if ((global_var(830) bwand 2048) != 0) then begin
-        display_msg(message_str(1309, 4107));
+    if ((global_var(GVAR_TOWN_REP_COLLY) bwand 2048) != 0) then begin
+        display_msg(message_str(SCRIPT_AITEM6, 4107));
     end
     else begin
-        if ((global_var(830) bwand 1024) != 0) then begin
-            display_msg(message_str(1309, 4106));
+        if ((global_var(GVAR_TOWN_REP_COLLY) bwand 1024) != 0) then begin
+            display_msg(message_str(SCRIPT_AITEM6, 4106));
         end
         else begin
-            display_msg(message_str(1309, 4105));
+            display_msg(message_str(SCRIPT_AITEM6, 4105));
         end
     end
 end
@@ -505,24 +505,24 @@ begin
     variable LVar0 := 0;
     variable LVar1 := 0;
     LVar0 := action_being_used;
-    if (((global_var(830) bwand 2048) != 0) == 0) then begin
+    if (((global_var(GVAR_TOWN_REP_COLLY) bwand 2048) != 0) == 0) then begin
         if (LVar0 == 7) then begin
             script_overrides;
             LVar1 := roll_vs_skill(dude_obj, 7, -22);
             if (is_success(LVar1)) then begin
-                set_global_var(830, global_var(830) bwor 2048);
-                set_global_var(830, global_var(830) bwand (-1 - 1024));
+                set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwor 2048);
+                set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwand (-1 - 1024));
                 give_exp_points(350);
-                display_msg(message_str(1309, 4713));
-                set_global_var(842, 2);
+                display_msg(message_str(SCRIPT_AITEM6, 4713));
+                set_global_var(GVAR_COLLY_QUEST_7, 2);
             end
             else begin
-                display_msg(message_str(1309, random(4714, 4716)));
+                display_msg(message_str(SCRIPT_AITEM6, random(4714, 4716)));
             end
         end
         if (LVar0 == 6) then begin
             script_overrides;
-            display_msg(message_str(1309, 4717));
+            display_msg(message_str(SCRIPT_AITEM6, 4717));
         end
     end
     return 0;
@@ -539,19 +539,19 @@ end
 
 procedure map_enter_p_proc
 begin
-    if (metarule(14, 0)) then begin
+    if (map_first_run) then begin
         set_local_var(6, (3 * (7 * (24 * (60 * (60 * 10))))) + game_time);
     end
-    if ((((global_var(830) bwand 2048) != 0) == 0) and (local_var(6) < game_time)) then begin
+    if ((((global_var(GVAR_TOWN_REP_COLLY) bwand 2048) != 0) == 0) and (local_var(6) < game_time)) then begin
         kill_critter(self_obj, 49);
     end
 end
 
 procedure fade_for_minute
 begin
-    gfade_out(1);
+    fade_out;
     game_time_advance(60 * 10);
-    gfade_in(1);
+    fade_in;
     call Node999();
 end
 
@@ -577,112 +577,112 @@ end
 
 procedure Node001
 begin
-    gsay_reply(1309, message_str(1309, 4200));
-    giq_option(4, 1309, 4201, Node002, 50);
-    giq_option(4, 1309, 4202, Node002, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4200));
+    giq_option(4, SCRIPT_AITEM6, 4201, Node002, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4202, Node002, NEUTRAL_REACTION);
 end
 
 procedure Node002
 begin
-    gsay_reply(1309, message_str(1309, 4210));
-    giq_option(4, 1309, 4211, Node003, 50);
-    giq_option(4, 1309, 4212, Node004, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4210));
+    giq_option(4, SCRIPT_AITEM6, 4211, Node003, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4212, Node004, NEUTRAL_REACTION);
 end
 
 procedure Node003
 begin
-    gsay_reply(1309, message_str(1309, 4221));
-    giq_option(4, 1309, 4222, Node005, 50);
-    giq_option(4, 1309, 4225, Node999, 50);
-    giq_option(4, 1309, 4226, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4221));
+    giq_option(4, SCRIPT_AITEM6, 4222, Node005, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4225, Node999, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4226, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node004
 begin
-    gsay_reply(1309, message_str(1309, 4220));
-    giq_option(4, 1309, 4223, Node005, 50);
-    giq_option(4, 1309, 4225, Node999, 50);
-    giq_option(4, 1309, 4226, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4220));
+    giq_option(4, SCRIPT_AITEM6, 4223, Node005, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4225, Node999, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4226, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node005
 begin
-    set_global_var(830, global_var(830) bwor 1024);
-    gsay_reply(1309, message_str(1309, 4230));
-    giq_option(4, 1309, 4231, Node006, 50);
-    giq_option(4, 1309, 4232, Node007, 50);
+    set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwor 1024);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4230));
+    giq_option(4, SCRIPT_AITEM6, 4231, Node006, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4232, Node007, NEUTRAL_REACTION);
 end
 
 procedure Node006
 begin
-    gsay_reply(1309, message_str(1309, 4240));
-    giq_option(4, 1309, 4241, Node008, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4240));
+    giq_option(4, SCRIPT_AITEM6, 4241, Node008, NEUTRAL_REACTION);
 end
 
 procedure Node007
 begin
     set_local_var(7, local_var(7) bwor 4096);
-    gsay_reply(1309, message_str(1309, 4250));
-    giq_option(4, 1309, 4251, Node009, 50);
-    giq_option(4, 1309, 4252, prom_proc, 50);
-    giq_option(4, 1309, 4253, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4250));
+    giq_option(4, SCRIPT_AITEM6, 4251, Node009, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4252, prom_proc, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4253, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node008
 begin
-    gsay_reply(1309, message_str(1309, 4260));
-    if (has_skill(dude_obj, 7) > 19) then begin
-        giq_option(4, 1309, 4261, Node010, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4260));
+    if (dude_skill(SKILL_DOCTOR) > 19) then begin
+        giq_option(4, SCRIPT_AITEM6, 4261, Node010, NEUTRAL_REACTION);
     end
-    giq_option(4, 1309, 4262, prom_proc, 50);
-    giq_option(4, 1309, 4264, Node998, 50);
-    giq_option(4, 1309, 4272, Node999, 50);
+    giq_option(4, SCRIPT_AITEM6, 4262, prom_proc, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4264, Node998, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4272, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node009
 begin
-    gsay_reply(1309, message_str(1309, 4270));
-    giq_option(4, 1309, 4271, Node998, 50);
-    giq_option(4, 1309, 4272, prom_proc, 50);
-    giq_option(4, 1309, 4273, Node011, 50);
-    if (has_skill(dude_obj, 7) > 19) then begin
-        giq_option(4, 1309, 4274, Node010, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4270));
+    giq_option(4, SCRIPT_AITEM6, 4271, Node998, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4272, prom_proc, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4273, Node011, NEUTRAL_REACTION);
+    if (dude_skill(SKILL_DOCTOR) > 19) then begin
+        giq_option(4, SCRIPT_AITEM6, 4274, Node010, NEUTRAL_REACTION);
     end
 end
 
 procedure Node010
 begin
-    set_global_var(842, 1);
+    set_global_var(GVAR_COLLY_QUEST_7, 1);
     set_local_var(7, local_var(7) bwor 8192);
-    gsay_reply(1309, message_str(1309, 4280));
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4280));
     if ((local_var(7) bwand 4096) != 0) then begin
-        giq_option(4, 1309, 4286, Node999, 50);
-        giq_option(4, 1309, 4285, Node052, 50);
-        giq_option(4, 1309, 4284, Node999, 50);
+        giq_option(4, SCRIPT_AITEM6, 4286, Node999, NEUTRAL_REACTION);
+        giq_option(4, SCRIPT_AITEM6, 4285, Node052, NEUTRAL_REACTION);
+        giq_option(4, SCRIPT_AITEM6, 4284, Node999, NEUTRAL_REACTION);
     end
     else begin
-        giq_option(4, 1309, 4281, Node999, 50);
-        giq_option(4, 1309, 4285, Node052, 50);
-        giq_option(4, 1309, 4284, Node999, 50);
+        giq_option(4, SCRIPT_AITEM6, 4281, Node999, NEUTRAL_REACTION);
+        giq_option(4, SCRIPT_AITEM6, 4285, Node052, NEUTRAL_REACTION);
+        giq_option(4, SCRIPT_AITEM6, 4284, Node999, NEUTRAL_REACTION);
     end
 end
 
 procedure Node011
 begin
-    gsay_reply(1309, message_str(1309, 4290));
-    giq_option(4, 1309, 4291, Node012, 50);
-    giq_option(4, 1309, 4292, Node013, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4290));
+    giq_option(4, SCRIPT_AITEM6, 4291, Node012, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4292, Node013, NEUTRAL_REACTION);
 end
 
 procedure Node012
 begin
-    gsay_reply(1309, message_str(1309, 4300));
-    giq_option(4, 1309, 4301, prom_proc, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4300));
+    giq_option(4, SCRIPT_AITEM6, 4301, prom_proc, NEUTRAL_REACTION);
 end
 
 procedure Node013
 begin
-    gsay_message(1309, message_str(1309, 4310), 51);
+    gsay_message(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4310), BAD_REACTION);
     call Node998();
 end
 
@@ -690,125 +690,125 @@ procedure Node014
 begin
     variable LVar0 := 0;
     LVar0 := random(4320, 4321);
-    gsay_reply(1309, message_str(1309, LVar0));
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, LVar0));
     if (LVar0 == 320) then begin
-        giq_option(4, 1309, 4323, Node005, 50);
+        giq_option(4, SCRIPT_AITEM6, 4323, Node005, NEUTRAL_REACTION);
     end
     else begin
-        giq_option(4, 1309, 4322, Node005, 50);
+        giq_option(4, SCRIPT_AITEM6, 4322, Node005, NEUTRAL_REACTION);
     end
-    if (((global_var(830) bwand 16) != 0) and (((global_var(830) bwand 4) != 0) == 0) and (((global_var(830) bwand 64) != 0) == 0)) then begin
-        giq_option(4, 1309, 4324, Node998, 50);
+    if (((global_var(GVAR_TOWN_REP_COLLY) bwand 16) != 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 4) != 0) == 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 64) != 0) == 0)) then begin
+        giq_option(4, SCRIPT_AITEM6, 4324, Node998, NEUTRAL_REACTION);
     end
-    giq_option(4, 1309, 4325, Node999, 50);
+    giq_option(4, SCRIPT_AITEM6, 4325, Node999, NEUTRAL_REACTION);
     return 0;
     LVar0 := 0;
 end
 
 procedure Node015
 begin
-    gsay_reply(1309, message_str(1309, random(4330, 4333)));
-    giq_option(4, 1309, message_str(1309, random(4334, 4338)), Node020, 50);
-    if ((((local_var(7) bwand 8192) != 0) == 0) and (has_skill(dude_obj, 7) > 19)) then begin
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, random(4330, 4333)));
+    giq_option(4, SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, random(4334, 4338)), Node020, NEUTRAL_REACTION);
+    if ((((local_var(7) bwand 8192) != 0) == 0) and (dude_skill(SKILL_DOCTOR) > 19)) then begin
         if ((local_var(7) bwand 4096) != 0) then begin
-            giq_option(4, 1309, message_str(1309, 4274), Node010, 50);
+            giq_option(4, SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4274), Node010, NEUTRAL_REACTION);
         end
         else begin
-            giq_option(4, 1309, message_str(1309, 4340), Node010, 50);
+            giq_option(4, SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4340), Node010, NEUTRAL_REACTION);
         end
     end
-    if (((global_var(830) bwand 16) != 0) and (((global_var(830) bwand 4) != 0) == 0) and (((global_var(830) bwand 64) != 0) == 0)) then begin
-        giq_option(4, 1309, message_str(1309, 4342 - ((local_var(7) bwand 4096) != 0)), Node998, 50);
+    if (((global_var(GVAR_TOWN_REP_COLLY) bwand 16) != 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 4) != 0) == 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 64) != 0) == 0)) then begin
+        giq_option(4, SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4342 - ((local_var(7) bwand 4096) != 0)), Node998, NEUTRAL_REACTION);
     end
-    giq_option(4, 1309, message_str(1309, 4339), Node999, 50);
+    giq_option(4, SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4339), Node999, NEUTRAL_REACTION);
 end
 
 procedure Node016
 begin
-    gsay_reply(1309, message_str(1309, random(4350, 4351)));
-    giq_option(4, 1309, 4352, prom_proc, 50);
-    giq_option(4, 1309, 4353, Node998, 50);
-    giq_option(4, 1309, 4354, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, random(4350, 4351)));
+    giq_option(4, SCRIPT_AITEM6, 4352, prom_proc, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4353, Node998, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4354, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node017
 begin
     if ((local_var(7) bwand 65536) != 0) then begin
-        gsay_reply(1309, message_str(1309, random(4365, 4367)));
+        gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, random(4365, 4367)));
         if (((local_var(7) bwand 32768) != 0) == 0) then begin
             if ((local_var(7) bwand 131072) != 0) then begin
-                giq_option(4, 1309, 4409, Node051, 50);
+                giq_option(4, SCRIPT_AITEM6, 4409, Node051, NEUTRAL_REACTION);
             end
             else begin
-                giq_option(4, 1309, 4409, Node045, 50);
+                giq_option(4, SCRIPT_AITEM6, 4409, Node045, NEUTRAL_REACTION);
             end
         end
-        giq_option(4, 1309, 4363, Node020, 50);
+        giq_option(4, SCRIPT_AITEM6, 4363, Node020, NEUTRAL_REACTION);
         if ((local_var(7) bwand 131072) != 0) then begin
-            giq_option(4, 1309, 4364, go_secret_place, 50);
+            giq_option(4, SCRIPT_AITEM6, 4364, go_secret_place, NEUTRAL_REACTION);
         end
-        if (((global_var(830) bwand 16) != 0) and (((global_var(830) bwand 4) != 0) == 0) and (((global_var(830) bwand 64) != 0) == 0)) then begin
-            giq_option(4, 1309, 4342, Node998, 50);
+        if (((global_var(GVAR_TOWN_REP_COLLY) bwand 16) != 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 4) != 0) == 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 64) != 0) == 0)) then begin
+            giq_option(4, SCRIPT_AITEM6, 4342, Node998, NEUTRAL_REACTION);
         end
-        giq_option(4, 1309, 4368, Node999, 50);
+        giq_option(4, SCRIPT_AITEM6, 4368, Node999, NEUTRAL_REACTION);
     end
     else begin
         set_local_var(7, local_var(7) bwor 65536);
-        gsay_reply(1309, message_str(1309, 4360));
-        giq_option(4, 1309, 4409, Node045, 50);
-        giq_option(4, 1309, 4363, Node020, 50);
-        if (((global_var(830) bwand 16) != 0) and (((global_var(830) bwand 4) != 0) == 0) and (((global_var(830) bwand 64) != 0) == 0)) then begin
-            giq_option(4, 1309, 4342, Node998, 50);
+        gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4360));
+        giq_option(4, SCRIPT_AITEM6, 4409, Node045, NEUTRAL_REACTION);
+        giq_option(4, SCRIPT_AITEM6, 4363, Node020, NEUTRAL_REACTION);
+        if (((global_var(GVAR_TOWN_REP_COLLY) bwand 16) != 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 4) != 0) == 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 64) != 0) == 0)) then begin
+            giq_option(4, SCRIPT_AITEM6, 4342, Node998, NEUTRAL_REACTION);
         end
         if (((local_var(7) bwand 4096) != 0) == 0) then begin
-            giq_option(4, 1309, 4361, Node999, 50);
+            giq_option(4, SCRIPT_AITEM6, 4361, Node999, NEUTRAL_REACTION);
         end
         else begin
-            giq_option(4, 1309, 4362, Node999, 50);
+            giq_option(4, SCRIPT_AITEM6, 4362, Node999, NEUTRAL_REACTION);
         end
     end
 end
 
 procedure Node018
 begin
-    set_global_var(830, global_var(830) bwor 65536);
-    gsay_reply(1309, message_str(1309, 4370));
-    giq_option(4, 1309, 4371, Node019, 50);
-    giq_option(4, 1309, 4372, Node999, 50);
+    set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwor 65536);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4370));
+    giq_option(4, SCRIPT_AITEM6, 4371, Node019, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4372, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node019
 begin
-    gsay_reply(1309, message_str(1309, 4380));
-    giq_option(4, 1309, 4382, Node020, 50);
-    giq_option(4, 1309, 4383, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4380));
+    giq_option(4, SCRIPT_AITEM6, 4382, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4383, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node020
 begin
-    gsay_reply(1309, message_str(1309, random(4400 + ((global_var(830) bwand 2048) != 0), 4403)));
-    if ((global_var(830) bwand 2048) != 0) then begin
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, random(4400 + ((global_var(GVAR_TOWN_REP_COLLY) bwand 2048) != 0), 4403)));
+    if ((global_var(GVAR_TOWN_REP_COLLY) bwand 2048) != 0) then begin
         if (((local_var(7) bwand 32768) != 0) == 0) then begin
             if ((local_var(7) bwand 131072) != 0) then begin
-                giq_option(4, 1309, 4409, Node051, 50);
+                giq_option(4, SCRIPT_AITEM6, 4409, Node051, NEUTRAL_REACTION);
             end
             else begin
-                giq_option(4, 1309, 4409, Node045, 50);
+                giq_option(4, SCRIPT_AITEM6, 4409, Node045, NEUTRAL_REACTION);
             end
         end
     end
-    giq_option(4, 1309, 4404, Node032, 50);
-    if ((((global_var(831) bwand 2) != 0) == 0) and (((global_var(830) bwand 64) != 0) == 0)) then begin
-        giq_option(4, 1309, 4405, Node035, 50);
+    giq_option(4, SCRIPT_AITEM6, 4404, Node032, NEUTRAL_REACTION);
+    if ((((global_var(GVAR_RED_ACCEPT_TO_GANG) bwand 2) != 0) == 0) and (((global_var(GVAR_TOWN_REP_COLLY) bwand 64) != 0) == 0)) then begin
+        giq_option(4, SCRIPT_AITEM6, 4405, Node035, NEUTRAL_REACTION);
     end
-    giq_option(4, 1309, 4406, Node021, 50);
-    giq_option(4, 1309, 4408, Node020a, 50);
-    giq_option(4, 1309, 4407, Node999, 50);
+    giq_option(4, SCRIPT_AITEM6, 4406, Node021, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4408, Node020a, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4407, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node020a
 begin
-    if ((global_var(830) bwand 2048) != 0) then begin
+    if ((global_var(GVAR_TOWN_REP_COLLY) bwand 2048) != 0) then begin
         call Node044();
     end
     else begin
@@ -818,272 +818,272 @@ end
 
 procedure Node021
 begin
-    gsay_reply(1309, message_str(1309, 4420));
-    giq_option(4, 1309, 4421, Node022, 50);
-    giq_option(4, 1309, 4422, Node018, 50);
-    giq_option(4, 1309, 4423, Node020, 50);
-    giq_option(4, 1309, 4424, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4420));
+    giq_option(4, SCRIPT_AITEM6, 4421, Node022, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4422, Node018, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4423, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4424, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node022
 begin
-    set_global_var(830, global_var(830) bwor 16384);
-    gsay_reply(1309, message_str(1309, 4430));
-    giq_option(4, 1309, 4431, Node024, 50);
-    giq_option(4, 1309, 4432, Node025, 50);
-    giq_option(4, 1309, 4433, Node023, 50);
-    giq_option(4, 1309, 4434, Node020, 50);
-    giq_option(4, 1309, 4435, Node999, 50);
+    set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwor 16384);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4430));
+    giq_option(4, SCRIPT_AITEM6, 4431, Node024, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4432, Node025, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4433, Node023, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4434, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4435, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node023
 begin
-    gsay_reply(1309, message_str(1309, 4440));
-    giq_option(4, 1309, 4443, Node025, 50);
-    giq_option(4, 1309, 4444, Node024, 50);
-    giq_option(4, 1309, 4441, Node020, 50);
-    giq_option(4, 1309, 4442, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4440));
+    giq_option(4, SCRIPT_AITEM6, 4443, Node025, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4444, Node024, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4441, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4442, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node024
 begin
-    gsay_reply(1309, message_str(1309, 4450));
-    giq_option(4, 1309, 4443, Node025, 50);
-    giq_option(4, 1309, 4433, Node023, 50);
-    giq_option(4, 1309, 4451, Node020, 50);
-    giq_option(4, 1309, 4452, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4450));
+    giq_option(4, SCRIPT_AITEM6, 4443, Node025, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4433, Node023, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4451, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4452, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node025
 begin
-    gsay_reply(1309, message_str(1309, 4460));
-    giq_option(4, 1309, 4461, Node026, 50);
-    giq_option(4, 1309, 4451, Node020, 50);
-    giq_option(4, 1309, 4442, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4460));
+    giq_option(4, SCRIPT_AITEM6, 4461, Node026, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4451, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4442, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node026
 begin
-    gsay_reply(1309, message_str(1309, 4462));
-    giq_option(4, 1309, 4463, Node027, 50);
-    giq_option(4, 1309, 4434, Node020, 50);
-    giq_option(4, 1309, 4435, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4462));
+    giq_option(4, SCRIPT_AITEM6, 4463, Node027, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4434, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4435, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node027
 begin
-    gsay_reply(1309, message_str(1309, 4464));
-    giq_option(4, 1309, 4465, Node028, 50);
-    giq_option(4, 1309, 4434, Node020, 50);
-    giq_option(4, 1309, 4435, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4464));
+    giq_option(4, SCRIPT_AITEM6, 4465, Node028, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4434, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4435, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node028
 begin
-    gsay_reply(1309, message_str(1309, 4466));
-    giq_option(4, 1309, 4467, Node029, 50);
-    giq_option(4, 1309, 4468, Node020, 50);
-    giq_option(4, 1309, 4435, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4466));
+    giq_option(4, SCRIPT_AITEM6, 4467, Node029, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4468, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4435, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node029
 begin
-    gsay_reply(1309, message_str(1309, 4469));
-    giq_option(4, 1309, 4470, Node030, 50);
-    giq_option(4, 1309, 4468, Node020, 50);
-    giq_option(4, 1309, 4442, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4469));
+    giq_option(4, SCRIPT_AITEM6, 4470, Node030, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4468, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4442, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node030
 begin
-    gsay_reply(1309, message_str(1309, 4471));
-    giq_option(4, 1309, 4472, Node031, 50);
-    giq_option(4, 1309, 4434, Node020, 50);
-    giq_option(4, 1309, 4442, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4471));
+    giq_option(4, SCRIPT_AITEM6, 4472, Node031, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4434, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4442, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node031
 begin
-    set_global_var(830, global_var(830) bwor 32768);
-    gsay_reply(1309, message_str(1309, 4473));
-    giq_option(4, 1309, 4474, Node999, 50);
+    set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwor 32768);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4473));
+    giq_option(4, SCRIPT_AITEM6, 4474, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node032
 begin
-    gsay_reply(1309, message_str(1309, 4479));
-    giq_option(4, 1309, 4480, Node033, 50);
-    giq_option(4, 1309, 4481, Node020, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4479));
+    giq_option(4, SCRIPT_AITEM6, 4480, Node033, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4481, Node020, NEUTRAL_REACTION);
 end
 
 procedure Node033
 begin
-    gsay_reply(1309, message_str(1309, 4482));
-    giq_option(4, 1309, 4483, Node034, 50);
-    giq_option(4, 1309, 4484, Node020, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4482));
+    giq_option(4, SCRIPT_AITEM6, 4483, Node034, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4484, Node020, NEUTRAL_REACTION);
 end
 
 procedure Node034
 begin
-    gsay_reply(1309, message_str(1309, 4485));
-    giq_option(4, 1309, 4486, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4485));
+    giq_option(4, SCRIPT_AITEM6, 4486, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node035
 begin
-    gsay_reply(1309, message_str(1309, 4490));
-    giq_option(4, 1309, 4422, Node018, 50);
-    giq_option(4, 1309, 4491, Node036, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4490));
+    giq_option(4, SCRIPT_AITEM6, 4422, Node018, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4491, Node036, NEUTRAL_REACTION);
 end
 
 procedure Node036
 begin
-    gsay_reply(1309, message_str(1309, 4492));
-    giq_option(4, 1309, 4493, Node020, 50);
-    giq_option(4, 1309, 4494, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4492));
+    giq_option(4, SCRIPT_AITEM6, 4493, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4494, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node037
 begin
-    gsay_reply(1309, message_str(1309, 4500));
-    giq_option(4, 1309, 4501, Node038, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4500));
+    giq_option(4, SCRIPT_AITEM6, 4501, Node038, NEUTRAL_REACTION);
 end
 
 procedure Node038
 begin
-    gsay_reply(1309, message_str(1309, 4502));
-    giq_option(4, 1309, 4503, Node039, 50);
-    giq_option(4, 1309, 4505, Node041, 50);
-    giq_option(8, 1309, 4504, Node999, 50);
-    giq_option(4, 1309, 4506, Node020, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4502));
+    giq_option(4, SCRIPT_AITEM6, 4503, Node039, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4505, Node041, NEUTRAL_REACTION);
+    giq_option(8, SCRIPT_AITEM6, 4504, Node999, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4506, Node020, NEUTRAL_REACTION);
 end
 
 procedure Node039
 begin
-    gsay_reply(1309, message_str(1309, 4507));
-    giq_option(4, 1309, 4508, Node040, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4507));
+    giq_option(4, SCRIPT_AITEM6, 4508, Node040, NEUTRAL_REACTION);
 end
 
 procedure Node040
 begin
-    gsay_reply(1309, message_str(1309, 4509));
-    giq_option(4, 1309, 4510, Node999, 50);
-    giq_option(4, 1309, 4522, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4509));
+    giq_option(4, SCRIPT_AITEM6, 4510, Node999, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4522, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node041
 begin
-    gsay_reply(1309, message_str(1309, 4511));
-    giq_option(4, 1309, 4512, Node042, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4511));
+    giq_option(4, SCRIPT_AITEM6, 4512, Node042, NEUTRAL_REACTION);
 end
 
 procedure Node042
 begin
-    gsay_reply(1309, message_str(1309, 4513));
-    giq_option(4, 1309, 4514, Node043, 50);
-    giq_option(4, 1309, 4515, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4513));
+    giq_option(4, SCRIPT_AITEM6, 4514, Node043, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4515, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node043
 begin
-    gsay_reply(1309, message_str(1309, 4516));
-    giq_option(4, 1309, 4517, Node020, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4516));
+    giq_option(4, SCRIPT_AITEM6, 4517, Node020, NEUTRAL_REACTION);
 end
 
 procedure Node044
 begin
-    gsay_reply(1309, message_str(1309, 4518));
-    giq_option(4, 1309, 4519, Node020, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4518));
+    giq_option(4, SCRIPT_AITEM6, 4519, Node020, NEUTRAL_REACTION);
 end
 
 procedure Node045
 begin
-    gsay_reply(1309, message_str(1309, 4520));
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4520));
     if (((local_var(7) bwand 524288) != 0) == 0) then begin
-        giq_option(4, 1309, 4523, Node046, 50);
+        giq_option(4, SCRIPT_AITEM6, 4523, Node046, NEUTRAL_REACTION);
     end
-    giq_option(4, 1309, 4521, Node020, 50);
-    giq_option(4, 1309, 4524, Node999, 50);
+    giq_option(4, SCRIPT_AITEM6, 4521, Node020, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4524, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node046
 begin
-    gsay_reply(1309, message_str(1309, 4530));
-    if (((global_var(830) bwand 131072) != 0) or ((global_var(830) bwand 2097152) != 0)) then begin
-        if ((global_var(830) bwand 2097152) != 0) then begin
-            giq_option(4, 1309, 4531, Node048, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4530));
+    if (((global_var(GVAR_TOWN_REP_COLLY) bwand 131072) != 0) or ((global_var(GVAR_TOWN_REP_COLLY) bwand 2097152) != 0)) then begin
+        if ((global_var(GVAR_TOWN_REP_COLLY) bwand 2097152) != 0) then begin
+            giq_option(4, SCRIPT_AITEM6, 4531, Node048, NEUTRAL_REACTION);
         end
         else begin
-            giq_option(4, 1309, 4532, Node047, 50);
+            giq_option(4, SCRIPT_AITEM6, 4532, Node047, NEUTRAL_REACTION);
         end
     end
-    giq_option(4, 1309, 4533, Node047, 50);
+    giq_option(4, SCRIPT_AITEM6, 4533, Node047, NEUTRAL_REACTION);
 end
 
 procedure Node047
 begin
-    gsay_reply(1309, message_str(1309, 4540));
-    giq_option(4, 1309, 4541, Node048, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4540));
+    giq_option(4, SCRIPT_AITEM6, 4541, Node048, NEUTRAL_REACTION);
 end
 
 procedure Node048
 begin
     set_local_var(7, local_var(7) bwor 16384);
     set_local_var(9, game_time);
-    gsay_reply(1309, message_str(1309, 4550));
-    if ((global_var(830) bwand 524288) != 0) then begin
-        giq_option(4, 1309, 4551, Node049, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4550));
+    if ((global_var(GVAR_TOWN_REP_COLLY) bwand 524288) != 0) then begin
+        giq_option(4, SCRIPT_AITEM6, 4551, Node049, NEUTRAL_REACTION);
     end
-    giq_option(4, 1309, 4552, fade_for_minute, 50);
-    giq_option(4, 1309, 4553, fade_for_minute, 50);
+    giq_option(4, SCRIPT_AITEM6, 4552, fade_for_minute, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4553, fade_for_minute, NEUTRAL_REACTION);
 end
 
 procedure Node049
 begin
     set_local_var(7, local_var(7) bwand (-1 - 16384));
     set_local_var(7, local_var(7) bwor 32768);
-    gsay_reply(1309, message_str(1309, 4560));
-    giq_option(4, 1309, 4561, Node999, 50);
-    giq_option(4, 1309, 4562, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4560));
+    giq_option(4, SCRIPT_AITEM6, 4561, Node999, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4562, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node050
 begin
     set_local_var(7, local_var(7) bwor 131072);
-    if (((global_var(830) bwand 524288) != 0) == 0) then begin
+    if (((global_var(GVAR_TOWN_REP_COLLY) bwand 524288) != 0) == 0) then begin
         give_exp_points(250);
-        display_msg(message_str(1309, 4718));
+        display_msg(message_str(SCRIPT_AITEM6, 4718));
     end
-    gsay_reply(1309, message_str(1309, 4570));
-    if ((global_var(830) bwand 524288) != 0) then begin
-        giq_option(4, 1309, 4573, Node049, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4570));
+    if ((global_var(GVAR_TOWN_REP_COLLY) bwand 524288) != 0) then begin
+        giq_option(4, SCRIPT_AITEM6, 4573, Node049, NEUTRAL_REACTION);
     end
-    giq_option(4, 1309, 4571, go_secret_place, 50);
-    giq_option(4, 1309, 4572, Node999, 50);
+    giq_option(4, SCRIPT_AITEM6, 4571, go_secret_place, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4572, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node051
 begin
     set_local_var(7, local_var(7) bwor 262144);
     animate_move_obj_to_tile(self_obj, 31302, 0);
-    gsay_reply(1309, message_str(1309, 4580));
-    giq_option(4, 1309, 4581, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4580));
+    giq_option(4, SCRIPT_AITEM6, 4581, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node052
 begin
-    gsay_reply(1309, message_str(1309, 4590));
-    giq_option(4, 1309, 4591, Node052a, 50);
-    giq_option(4, 1309, 4592, Node053, 50);
-    giq_option(6, 1309, 4593, Node054, 50);
-    giq_option(4, 1309, 4594, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4590));
+    giq_option(4, SCRIPT_AITEM6, 4591, Node052a, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4592, Node053, NEUTRAL_REACTION);
+    giq_option(6, SCRIPT_AITEM6, 4593, Node054, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4594, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node052a
 begin
     variable LVar0 := 0;
     set_local_var(7, local_var(7) bwor 524288);
-    LVar0 := create_object_sid(429, 1, 0, -1);
+    LVar0 := create_object(429, 1, 0);
     add_mult_objs_to_inven(dude_obj, LVar0, 1);
     call Node999();
     return 0;
@@ -1092,24 +1092,23 @@ end
 
 procedure Node053
 begin
-    gsay_reply(1309, message_str(1309, 4600));
-    giq_option(4, 1309, 4601, Node999, 50);
-    giq_option(6, 1309, 4602, Node054, 50);
-    giq_option(4, 1309, 4603, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4600));
+    giq_option(4, SCRIPT_AITEM6, 4601, Node999, NEUTRAL_REACTION);
+    giq_option(6, SCRIPT_AITEM6, 4602, Node054, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4603, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node054
 begin
     set_local_var(7, local_var(7) bwor 524288);
-    set_global_var(830, global_var(830) bwor 131072);
-    gsay_reply(1309, message_str(1309, 4610));
-    giq_option(4, 1309, 4611, Node055, 50);
+    set_global_var(GVAR_TOWN_REP_COLLY, global_var(GVAR_TOWN_REP_COLLY) bwor 131072);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4610));
+    giq_option(4, SCRIPT_AITEM6, 4611, Node055, NEUTRAL_REACTION);
 end
 
 procedure Node055
 begin
-    gsay_reply(1309, message_str(1309, 4620));
-    giq_option(4, 1309, 4621, Node999, 50);
-    giq_option(4, 1309, 4622, Node999, 50);
+    gsay_reply(SCRIPT_AITEM6, message_str(SCRIPT_AITEM6, 4620));
+    giq_option(4, SCRIPT_AITEM6, 4621, Node999, NEUTRAL_REACTION);
+    giq_option(4, SCRIPT_AITEM6, 4622, Node999, NEUTRAL_REACTION);
 end
-
