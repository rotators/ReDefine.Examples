diff --git a/Mods/MegaMod/Original/RNDCOAST.ssl b/Mods/MegaMod/ReDefine/RNDCOAST.ssl
index b14cec0..c97a952 100644
--- a/Mods/MegaMod/Original/RNDCOAST.ssl
+++ b/Mods/MegaMod/ReDefine/RNDCOAST.ssl
@@ -55,226 +55,226 @@ procedure choose_pid_sid;
 
 procedure Exit_Grid_Give_Car
 begin
-    if ((global_var(633) == Get_Car_Hex()) and (global_var(18) != 0) and (metarule(30, 0) == Get_Current_Town()) and (global_var(1176) == 0) and (global_var(1645) == cur_map_index)) then begin
+    if ((global_var(GVAR_CAR_PLACED_TILE) == Get_Car_Hex()) and (global_var(GVAR_PLAYER_GOT_CAR) != 0) and (car_current_town == Get_Current_Town()) and (global_var(GVAR_BREAKDOWN_TIMER) == 0) and (global_var(GVAR_CAR_CURRENT_TOWN) == cur_map_index)) then begin
         if ((Get_Current_Town() >= 26) and (Get_Current_Town() <= 29) or (Get_Current_Town() == 47) or ((Get_Current_Town() >= 31) and (Get_Current_Town() <= 43)) or (Get_Current_Town() == 55)) then begin
-            while (global_var(633) != -1) do begin
-                set_global_var(633, -1);
+            while (global_var(GVAR_CAR_PLACED_TILE) != -1) do begin
+                set_global_var(GVAR_CAR_PLACED_TILE, -1);
             end
-            while (global_var(1645) != -1) do begin
-                set_global_var(1645, -1);
+            while (global_var(GVAR_CAR_CURRENT_TOWN) != -1) do begin
+                set_global_var(GVAR_CAR_CURRENT_TOWN, -1);
             end
-            while (global_var(1646) != -1) do begin
-                set_global_var(1646, -1);
+            while (global_var(GVAR_CAR_HAS_BEEN_DRIVEN) != -1) do begin
+                set_global_var(GVAR_CAR_HAS_BEEN_DRIVEN, -1);
             end
-            while (global_var(1647) != -1) do begin
-                set_global_var(1647, -1);
+            while (global_var(GVAR_ABANDONED_MAP_252_CLEARED) != -1) do begin
+                set_global_var(GVAR_ABANDONED_MAP_252_CLEARED, -1);
             end
-            while (global_var(1648) != 1) do begin
-                set_global_var(1648, 1);
+            while (global_var(GVAR_ABANDONED_MAP_251_CLEARED) != 1) do begin
+                set_global_var(GVAR_ABANDONED_MAP_251_CLEARED, 1);
             end
-            metarule(31, 0);
+            car_give_to_party;
         end
     end
 end
 
 procedure Get_Car_Hex
 begin
-    if (cur_map_index == 0) then begin
+    if (CUR_MAP_DESERT1) then begin
         return 19094;
     end
     else begin
-        if (cur_map_index == 179) then begin
+        if (CUR_MAP_A12) then begin
             return 11508;
         end
         else begin
-            if (cur_map_index == 198) then begin
+            if (CUR_MAP_A10) then begin
                 return 21273;
             end
             else begin
-                if (cur_map_index == 242) then begin
+                if (CUR_MAP_EPAENT) then begin
                     return 22713;
                 end
                 else begin
-                    if (cur_map_index == 127) then begin
+                    if (CUR_MAP_ARDEAD) then begin
                         return 27312;
                     end
                     else begin
-                        if (cur_map_index == 232) then begin
+                        if (CUR_MAP_CRSNMAIN) then begin
                             return 19144;
                         end
                         else begin
-                            if (cur_map_index == 6) then begin
-                                if ((global_var(1648) == 1) and (global_var(18) != 0)) then begin
+                            if (CUR_MAP_DENBUS1) then begin
+                                if ((global_var(GVAR_ABANDONED_MAP_251_CLEARED) == 1) and (global_var(GVAR_PLAYER_GOT_CAR) != 0)) then begin
                                     return 11687;
                                 end
                                 else begin
-                                    if ((global_var(18) == 0) or ((global_var(1648) == 0) and (global_var(18) != 0))) then begin
+                                    if ((global_var(GVAR_PLAYER_GOT_CAR) == 0) or ((global_var(GVAR_ABANDONED_MAP_251_CLEARED) == 0) and (global_var(GVAR_PLAYER_GOT_CAR) != 0))) then begin
                                         return 24548;
                                     end
                                 end
                             end
                             else begin
-                                if (cur_map_index == 7) then begin
+                                if (CUR_MAP_DENBUS2) then begin
                                     return 29103;
                                 end
                                 else begin
-                                    if (cur_map_index == 155) then begin
+                                    if (CUR_MAP_ABBEY) then begin
                                         return 22321;
                                     end
                                     else begin
-                                        if (cur_map_index == 5) then begin
+                                        if (CUR_MAP_ARBRIDGE) then begin
                                             return 27312;
                                         end
                                         else begin
-                                            if (cur_map_index == 127) then begin
+                                            if (CUR_MAP_ARDEAD) then begin
                                                 return 27313;
                                             end
                                             else begin
-                                                if (cur_map_index == 157) then begin
+                                                if (CUR_MAP_B21) then begin
                                                     return 24916;
                                                 end
                                                 else begin
-                                                    if (cur_map_index == 78) then begin
+                                                    if (CUR_MAP_BROKEN1) then begin
                                                         return 17752;
                                                     end
                                                     else begin
-                                                        if (cur_map_index == 220) then begin
+                                                        if (CUR_MAP_COLLY) then begin
                                                             return 26097;
                                                         end
                                                         else begin
-                                                            if (cur_map_index == 27) then begin
+                                                            if (CUR_MAP_DEPOLV1) then begin
                                                                 return 28699;
                                                             end
                                                             else begin
-                                                                if (cur_map_index == 151) then begin
+                                                                if (CUR_MAP_EPAX) then begin
                                                                     return 18242;
                                                                 end
                                                                 else begin
-                                                                    if (cur_map_index == 31) then begin
+                                                                    if (CUR_MAP_GECKSETL) then begin
                                                                         return 25709;
                                                                     end
                                                                     else begin
-                                                                        if (cur_map_index == 24) then begin
+                                                                        if (CUR_MAP_GSTFARM) then begin
                                                                             return 23951;
                                                                         end
                                                                         else begin
-                                                                            if (cur_map_index == 160) then begin
+                                                                            if (CUR_MAP_JENFARM7) then begin
                                                                                 return 9483;
                                                                             end
                                                                             else begin
-                                                                                if (cur_map_index == 9) then begin
+                                                                                if (CUR_MAP_KLADWTWN) then begin
                                                                                     return 25669;
                                                                                 end
                                                                                 else begin
-                                                                                    if (cur_map_index == 12) then begin
+                                                                                    if (CUR_MAP_KLATOXCV) then begin
                                                                                         return 19943;
                                                                                     end
                                                                                     else begin
-                                                                                        if (cur_map_index == 195) then begin
+                                                                                        if (CUR_MAP_LARS1) then begin
                                                                                             return 22677;
                                                                                         end
                                                                                         else begin
-                                                                                            if (cur_map_index == 197) then begin
+                                                                                            if (CUR_MAP_LARS3) then begin
                                                                                                 return 30696;
                                                                                             end
                                                                                             else begin
-                                                                                                if (cur_map_index == 51) then begin
+                                                                                                if (CUR_MAP_MBCLOSE) then begin
                                                                                                     return 22146;
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if (cur_map_index == 18) then begin
+                                                                                                    if (CUR_MAP_MODMAIN) then begin
                                                                                                         return 24531;
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if (cur_map_index == 109) then begin
+                                                                                                        if (CUR_MAP_NAVARRO) then begin
                                                                                                             return 28888;
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if (cur_map_index == 46) then begin
+                                                                                                            if (CUR_MAP_NCRENT) then begin
                                                                                                                 return 23078;
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if (cur_map_index == 54) then begin
+                                                                                                                if (CUR_MAP_NEWR1) then begin
                                                                                                                     return 25321;
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if (cur_map_index == 55) then begin
+                                                                                                                    if (CUR_MAP_NEWR2) then begin
                                                                                                                         return 9509;
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if (cur_map_index == 56) then begin
+                                                                                                                        if (CUR_MAP_NEWR3) then begin
                                                                                                                             return 30894;
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if (cur_map_index == 57) then begin
+                                                                                                                            if (CUR_MAP_NEWR4) then begin
                                                                                                                                 return 16068;
                                                                                                                             end
                                                                                                                             else begin
-                                                                                                                                if (cur_map_index == 58) then begin
+                                                                                                                                if (CUR_MAP_NEWRCS) then begin
                                                                                                                                     return 18699;
                                                                                                                                 end
                                                                                                                                 else begin
-                                                                                                                                    if (cur_map_index == 59) then begin
+                                                                                                                                    if (CUR_MAP_NEWRGO) then begin
                                                                                                                                         return 22500;
                                                                                                                                     end
                                                                                                                                     else begin
-                                                                                                                                        if (cur_map_index == 60) then begin
+                                                                                                                                        if (CUR_MAP_NEWRST) then begin
                                                                                                                                             return 26506;
                                                                                                                                         end
                                                                                                                                         else begin
-                                                                                                                                            if (cur_map_index == 92) then begin
-                                                                                                                                                if (elevation(dude_obj) == 0) then begin
+                                                                                                                                            if (CUR_MAP_RAIDERS1) then begin
+                                                                                                                                                if (dude_elevation == 0) then begin
                                                                                                                                                     return 25304;
                                                                                                                                                 end
                                                                                                                                                 else begin
-                                                                                                                                                    if (elevation(dude_obj) == 1) then begin
+                                                                                                                                                    if (dude_elevation == 1) then begin
                                                                                                                                                         return 21298;
                                                                                                                                                     end
                                                                                                                                                 end
                                                                                                                                             end
                                                                                                                                             else begin
-                                                                                                                                                if (cur_map_index == 64) then begin
+                                                                                                                                                if (CUR_MAP_REDDOWN) then begin
                                                                                                                                                     return 18650;
                                                                                                                                                 end
                                                                                                                                                 else begin
-                                                                                                                                                    if (cur_map_index == 158) then begin
+                                                                                                                                                    if (CUR_MAP_RNDMDDG) then begin
                                                                                                                                                         return 19506;
                                                                                                                                                     end
                                                                                                                                                     else begin
-                                                                                                                                                        if (cur_map_index == 162) then begin
+                                                                                                                                                        if (CUR_MAP_SCRAPT) then begin
                                                                                                                                                             return 26515;
                                                                                                                                                         end
                                                                                                                                                         else begin
-                                                                                                                                                            if (cur_map_index == 137) then begin
+                                                                                                                                                            if (CUR_MAP_SFCHINA) then begin
                                                                                                                                                                 return 31699;
                                                                                                                                                             end
                                                                                                                                                             else begin
-                                                                                                                                                                if (cur_map_index == 254) then begin
+                                                                                                                                                                if (CUR_MAP_SLVCAMP) then begin
                                                                                                                                                                     return 21895;
                                                                                                                                                                 end
                                                                                                                                                                 else begin
-                                                                                                                                                                    if (cur_map_index == 167) then begin
+                                                                                                                                                                    if (CUR_MAP_GLOWENT) then begin
                                                                                                                                                                         return 22737;
                                                                                                                                                                     end
                                                                                                                                                                     else begin
-                                                                                                                                                                        if (cur_map_index == 163) then begin
+                                                                                                                                                                        if (CUR_MAP_TRIBE01) then begin
                                                                                                                                                                             return 29487;
                                                                                                                                                                         end
                                                                                                                                                                         else begin
-                                                                                                                                                                            if (cur_map_index == 156) then begin
+                                                                                                                                                                            if (CUR_MAP_TRUCK) then begin
                                                                                                                                                                                 return 23132;
                                                                                                                                                                             end
                                                                                                                                                                             else begin
-                                                                                                                                                                                if (cur_map_index == 41) then begin
+                                                                                                                                                                                if (CUR_MAP_V13ENT) then begin
                                                                                                                                                                                     return 26354;
                                                                                                                                                                                 end
                                                                                                                                                                                 else begin
-                                                                                                                                                                                    if (cur_map_index == 218) then begin
+                                                                                                                                                                                    if (CUR_MAP_V14ENT) then begin
                                                                                                                                                                                         return 19105;
                                                                                                                                                                                     end
                                                                                                                                                                                     else begin
-                                                                                                                                                                                        if (cur_map_index == 37) then begin
-                                                                                                                                                                                            if ((global_var(475) == 2) and global_var(172)) then begin
+                                                                                                                                                                                        if (CUR_MAP_V15ENT) then begin
+                                                                                                                                                                                            if ((global_var(GVAR_V15_NCR_DEAL) == 2) and global_var(GVAR_NCR_V15_DARION_DEAD)) then begin
                                                                                                                                                                                                 return 29718;
                                                                                                                                                                                             end
                                                                                                                                                                                             else begin
@@ -282,299 +282,299 @@ begin
                                                                                                                                                                                             end
                                                                                                                                                                                         end
                                                                                                                                                                                         else begin
-                                                                                                                                                                                            if (cur_map_index == 15) then begin
+                                                                                                                                                                                            if (CUR_MAP_VCTYCTYD) then begin
                                                                                                                                                                                                 return 28899;
                                                                                                                                                                                             end
                                                                                                                                                                                             else begin
-                                                                                                                                                                                                if (cur_map_index == 202) then begin
+                                                                                                                                                                                                if (CUR_MAP_CRISIENT) then begin
                                                                                                                                                                                                     return 18697;
                                                                                                                                                                                                 end
                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                    if (cur_map_index == 224) then begin
+                                                                                                                                                                                                    if (CUR_MAP_MODOCT2) then begin
                                                                                                                                                                                                         return 26298;
                                                                                                                                                                                                     end
                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                        if (cur_map_index == 238) then begin
+                                                                                                                                                                                                        if (CUR_MAP_BROHDENT) then begin
                                                                                                                                                                                                             return 28313;
                                                                                                                                                                                                         end
                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                            if (cur_map_index == 249) then begin
+                                                                                                                                                                                                            if (CUR_MAP_BREAKDWN) then begin
                                                                                                                                                                                                                 return 18518;
                                                                                                                                                                                                             end
                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                if (cur_map_index == 252) then begin
+                                                                                                                                                                                                                if (CUR_MAP_ABANDON3) then begin
                                                                                                                                                                                                                     return 23754;
                                                                                                                                                                                                                 end
                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                    if (cur_map_index == 94) then begin
+                                                                                                                                                                                                                    if (CUR_MAP_BHRNDDST) then begin
                                                                                                                                                                                                                         return 18909;
                                                                                                                                                                                                                     end
                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                        if (cur_map_index == 95) then begin
+                                                                                                                                                                                                                        if (CUR_MAP_BHRNDMNT) then begin
                                                                                                                                                                                                                             return 18909;
                                                                                                                                                                                                                         end
                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                            if (cur_map_index == 241) then begin
+                                                                                                                                                                                                                            if (CUR_MAP_BRHDHLP) then begin
                                                                                                                                                                                                                                 return 25104;
                                                                                                                                                                                                                             end
                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                if (cur_map_index == 164) then begin
+                                                                                                                                                                                                                                if (CUR_MAP_RNDPOSTM) then begin
                                                                                                                                                                                                                                     return 17890;
                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                    if (cur_map_index == 159) then begin
+                                                                                                                                                                                                                                    if (CUR_MAP_RNDBD) then begin
                                                                                                                                                                                                                                         return 26503;
                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                        if (cur_map_index == 98) then begin
+                                                                                                                                                                                                                                        if (CUR_MAP_RNDBHEAD) then begin
                                                                                                                                                                                                                                             return 22726;
                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                            if (cur_map_index == 101) then begin
+                                                                                                                                                                                                                                            if (CUR_MAP_RNDBRIDG) then begin
                                                                                                                                                                                                                                                 return 18095;
                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                if (cur_map_index == 102) then begin
+                                                                                                                                                                                                                                                if (CUR_MAP_RNDCAFE) then begin
                                                                                                                                                                                                                                                     return 23903;
                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                    if (cur_map_index == 108) then begin
+                                                                                                                                                                                                                                                    if (CUR_MAP_RNDEXCOW) then begin
                                                                                                                                                                                                                                                         return 18889;
                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                        if (cur_map_index == 105) then begin
+                                                                                                                                                                                                                                                        if (CUR_MAP_RNDFORVR) then begin
                                                                                                                                                                                                                                                             return 18904;
                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                            if (cur_map_index == 103) then begin
+                                                                                                                                                                                                                                                            if (CUR_MAP_RNDHOLY1) then begin
                                                                                                                                                                                                                                                                 return 21936;
                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                if (cur_map_index == 104) then begin
+                                                                                                                                                                                                                                                                if (CUR_MAP_RNDHOLY2) then begin
                                                                                                                                                                                                                                                                     return 20880;
                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                    if (cur_map_index == 216) then begin
+                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDMSTR) then begin
                                                                                                                                                                                                                                                                         return 19898;
                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                        if (cur_map_index == 107) then begin
+                                                                                                                                                                                                                                                                        if (CUR_MAP_RNDPARIH) then begin
                                                                                                                                                                                                                                                                             return 23125;
                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                            if (cur_map_index == 99) then begin
+                                                                                                                                                                                                                                                                            if (CUR_MAP_RNDSHUTL) then begin
                                                                                                                                                                                                                                                                                 return 20702;
                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                if (cur_map_index == 97) then begin
+                                                                                                                                                                                                                                                                                if (CUR_MAP_RNDTINWD) then begin
                                                                                                                                                                                                                                                                                     return 18724;
                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                    if (cur_map_index == 106) then begin
+                                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDTOXIC) then begin
                                                                                                                                                                                                                                                                                         return 22101;
                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                        if (cur_map_index == 100) then begin
+                                                                                                                                                                                                                                                                                        if (CUR_MAP_RNDUVILG) then begin
                                                                                                                                                                                                                                                                                             return 19095;
                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                            if (cur_map_index == 96) then begin
+                                                                                                                                                                                                                                                                                            if (CUR_MAP_RNDWHALE) then begin
                                                                                                                                                                                                                                                                                                 return 23109;
                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                if (cur_map_index == 69) then begin
+                                                                                                                                                                                                                                                                                                if (CUR_MAP_CAVE0) then begin
                                                                                                                                                                                                                                                                                                     return 18909;
                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                    if (cur_map_index == 70) then begin
+                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CAVE1) then begin
                                                                                                                                                                                                                                                                                                         return 26508;
                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                        if (cur_map_index == 71) then begin
+                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CAVE2) then begin
                                                                                                                                                                                                                                                                                                             return 24706;
                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                            if (cur_map_index == 72) then begin
+                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CAVE3) then begin
                                                                                                                                                                                                                                                                                                                 return 24915;
                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                if (cur_map_index == 73) then begin
+                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CAVE4) then begin
                                                                                                                                                                                                                                                                                                                     return 27512;
                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 80) then begin
+                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CAVE5) then begin
                                                                                                                                                                                                                                                                                                                         return 26292;
                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 149) then begin
+                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_GAMMOVIE) then begin
                                                                                                                                                                                                                                                                                                                             return 25523;
                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 150) then begin
+                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_RNDBESS) then begin
                                                                                                                                                                                                                                                                                                                                 return 27318;
                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 76) then begin
+                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST1) then begin
                                                                                                                                                                                                                                                                                                                                     return 18086;
                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 77) then begin
+                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST2) then begin
                                                                                                                                                                                                                                                                                                                                         return 19089;
                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 85) then begin
+                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST3) then begin
                                                                                                                                                                                                                                                                                                                                             return 19279;
                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 86) then begin
+                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST4) then begin
                                                                                                                                                                                                                                                                                                                                                 return 19278;
                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 87) then begin
+                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST5) then begin
                                                                                                                                                                                                                                                                                                                                                     return 23500;
                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 88) then begin
+                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST6) then begin
                                                                                                                                                                                                                                                                                                                                                         return 22291;
                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 89) then begin
+                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST7) then begin
                                                                                                                                                                                                                                                                                                                                                             return 16518;
                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 90) then begin
+                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST8) then begin
                                                                                                                                                                                                                                                                                                                                                                 return 23718;
                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 91) then begin
+                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST9) then begin
                                                                                                                                                                                                                                                                                                                                                                     return 21107;
                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 110) then begin
+                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST10) then begin
                                                                                                                                                                                                                                                                                                                                                                         return 17919;
                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 111) then begin
+                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST11) then begin
                                                                                                                                                                                                                                                                                                                                                                             return 20079;
                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 112) then begin
+                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_07DESERT) then begin
                                                                                                                                                                                                                                                                                                                                                                                 return 25515;
                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 149) then begin
+                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_GAMMOVIE) then begin
                                                                                                                                                                                                                                                                                                                                                                                     return 19096;
                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 1) then begin
+                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESERT2) then begin
                                                                                                                                                                                                                                                                                                                                                                                         return 19094;
                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 2) then begin
+                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESERT3) then begin
                                                                                                                                                                                                                                                                                                                                                                                             return 18894;
                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 81) then begin
+                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                 return 19718;
                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 82) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESERT5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                     return 24112;
                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 83) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESERT6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                         return 18914;
                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 84) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESERT7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                             return 24525;
                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 113) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT8) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                 return 17890;
                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 114) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESERT9) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                     return 22880;
                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 115) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESRT10) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                         return 22880;
                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 116) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESRT11) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                             return 20692;
                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 117) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESRT12) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                 return 21308;
                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 68) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CITY1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                     return 12693;
                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 125) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CITY2) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                         return 9898;
                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 141) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CITY3) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                             return 23542;
                                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 142) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CITY4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                 return 28089;
                                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 143) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CITY5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                     return 20464;
                                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 144) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CITY6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                         return 29496;
                                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 145) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CITY7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                             return 19535;
                                                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 146) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CITY8) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 return 21702;
                                                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 119) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CAVE6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                     return 21681;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 120) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CAVE7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         return 19078;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 74) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_MOUNTN1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             return 17875;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 75) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_MOUNTN2) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 return 17876;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 121) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_MOUNTN3) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     return 19478;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 122) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_MOUNTN4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         return 19099;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 123) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_MOUNTN5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             return 20678;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 124) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_MOUNTN6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 return 20073;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 53) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CARDESRT) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     return 19100;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
@@ -703,487 +703,487 @@ end
 
 procedure Get_Current_Town
 begin
-    if (cur_map_index == 127) then begin
+    if (CUR_MAP_ARDEAD) then begin
         return 22;
     end
     else begin
-        if (cur_map_index == 232) then begin
+        if (CUR_MAP_CRSNMAIN) then begin
             return 78;
         end
         else begin
-            if (cur_map_index == 6) then begin
+            if (CUR_MAP_DENBUS1) then begin
                 return 1;
             end
             else begin
-                if (cur_map_index == 7) then begin
+                if (CUR_MAP_DENBUS2) then begin
                     return 1;
                 end
                 else begin
-                    if (cur_map_index == 155) then begin
+                    if (CUR_MAP_ABBEY) then begin
                         return 52;
                     end
                     else begin
-                        if (cur_map_index == 5) then begin
+                        if (CUR_MAP_ARBRIDGE) then begin
                             return 0;
                         end
                         else begin
-                            if (cur_map_index == 127) then begin
+                            if (CUR_MAP_ARDEAD) then begin
                                 return 0;
                             end
                             else begin
-                                if (cur_map_index == 157) then begin
+                                if (CUR_MAP_B21) then begin
                                     return 51;
                                 end
                                 else begin
-                                    if (cur_map_index == 78) then begin
+                                    if (CUR_MAP_BROKEN1) then begin
                                         return 6;
                                     end
                                     else begin
-                                        if (cur_map_index == 220) then begin
+                                        if (CUR_MAP_COLLY) then begin
                                             return 73;
                                         end
                                         else begin
-                                            if (cur_map_index == 27) then begin
+                                            if (CUR_MAP_DEPOLV1) then begin
                                                 return 8;
                                             end
                                             else begin
-                                                if (cur_map_index == 151) then begin
+                                                if (CUR_MAP_EPAX) then begin
                                                     return 49;
                                                 end
                                                 else begin
-                                                    if (cur_map_index == 31) then begin
+                                                    if (CUR_MAP_GECKSETL) then begin
                                                         return 5;
                                                     end
                                                     else begin
-                                                        if (cur_map_index == 24) then begin
+                                                        if (CUR_MAP_GSTFARM) then begin
                                                             return 20;
                                                         end
                                                         else begin
-                                                            if (cur_map_index == 160) then begin
+                                                            if (CUR_MAP_JENFARM7) then begin
                                                                 return 17;
                                                             end
                                                             else begin
-                                                                if (cur_map_index == 9) then begin
+                                                                if (CUR_MAP_KLADWTWN) then begin
                                                                     return 2;
                                                                 end
                                                                 else begin
-                                                                    if (cur_map_index == 12) then begin
+                                                                    if (CUR_MAP_KLATOXCV) then begin
                                                                         return 23;
                                                                     end
                                                                     else begin
-                                                                        if (cur_map_index == 195) then begin
+                                                                        if (CUR_MAP_LARS1) then begin
                                                                             return 67;
                                                                         end
                                                                         else begin
-                                                                            if (cur_map_index == 197) then begin
+                                                                            if (CUR_MAP_LARS3) then begin
                                                                                 return 68;
                                                                             end
                                                                             else begin
-                                                                                if (cur_map_index == 51) then begin
+                                                                                if (CUR_MAP_MBCLOSE) then begin
                                                                                     return 12;
                                                                                 end
                                                                                 else begin
-                                                                                    if (cur_map_index == 18) then begin
+                                                                                    if (CUR_MAP_MODMAIN) then begin
                                                                                         return 3;
                                                                                     end
                                                                                     else begin
-                                                                                        if (cur_map_index == 46) then begin
+                                                                                        if (CUR_MAP_NCRENT) then begin
                                                                                             return 10;
                                                                                         end
                                                                                         else begin
-                                                                                            if (cur_map_index == 54) then begin
+                                                                                            if (CUR_MAP_NEWR1) then begin
                                                                                                 return 7;
                                                                                             end
                                                                                             else begin
-                                                                                                if (cur_map_index == 55) then begin
+                                                                                                if (CUR_MAP_NEWR2) then begin
                                                                                                     return 7;
                                                                                                 end
                                                                                                 else begin
-                                                                                                    if (cur_map_index == 56) then begin
+                                                                                                    if (CUR_MAP_NEWR3) then begin
                                                                                                         return 7;
                                                                                                     end
                                                                                                     else begin
-                                                                                                        if (cur_map_index == 57) then begin
+                                                                                                        if (CUR_MAP_NEWR4) then begin
                                                                                                             return 7;
                                                                                                         end
                                                                                                         else begin
-                                                                                                            if (cur_map_index == 58) then begin
+                                                                                                            if (CUR_MAP_NEWRCS) then begin
                                                                                                                 return 7;
                                                                                                             end
                                                                                                             else begin
-                                                                                                                if (cur_map_index == 59) then begin
+                                                                                                                if (CUR_MAP_NEWRGO) then begin
                                                                                                                     return 30;
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    if (cur_map_index == 60) then begin
+                                                                                                                    if (CUR_MAP_NEWRST) then begin
                                                                                                                         return 48;
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        if (cur_map_index == 92) then begin
+                                                                                                                        if (CUR_MAP_RAIDERS1) then begin
                                                                                                                             return 25;
                                                                                                                         end
                                                                                                                         else begin
-                                                                                                                            if (cur_map_index == 64) then begin
+                                                                                                                            if (CUR_MAP_REDDOWN) then begin
                                                                                                                                 return 13;
                                                                                                                             end
                                                                                                                             else begin
-                                                                                                                                if (cur_map_index == 158) then begin
+                                                                                                                                if (CUR_MAP_RNDMDDG) then begin
                                                                                                                                     return 18;
                                                                                                                                 end
                                                                                                                                 else begin
-                                                                                                                                    if (cur_map_index == 162) then begin
+                                                                                                                                    if (CUR_MAP_SCRAPT) then begin
                                                                                                                                         return 53;
                                                                                                                                     end
                                                                                                                                     else begin
-                                                                                                                                        if (cur_map_index == 137) then begin
+                                                                                                                                        if (CUR_MAP_SFCHINA) then begin
                                                                                                                                             return 14;
                                                                                                                                         end
                                                                                                                                         else begin
-                                                                                                                                            if (cur_map_index == 254) then begin
+                                                                                                                                            if (CUR_MAP_SLVCAMP) then begin
                                                                                                                                                 return 87;
                                                                                                                                             end
                                                                                                                                             else begin
-                                                                                                                                                if (cur_map_index == 167) then begin
+                                                                                                                                                if (CUR_MAP_GLOWENT) then begin
                                                                                                                                                     return 58;
                                                                                                                                                 end
                                                                                                                                                 else begin
-                                                                                                                                                    if (cur_map_index == 163) then begin
+                                                                                                                                                    if (CUR_MAP_TRIBE01) then begin
                                                                                                                                                         return 54;
                                                                                                                                                     end
                                                                                                                                                     else begin
-                                                                                                                                                        if (cur_map_index == 156) then begin
+                                                                                                                                                        if (CUR_MAP_TRUCK) then begin
                                                                                                                                                             return 50;
                                                                                                                                                         end
                                                                                                                                                         else begin
-                                                                                                                                                            if (cur_map_index == 41) then begin
+                                                                                                                                                            if (CUR_MAP_V13ENT) then begin
                                                                                                                                                                 return 11;
                                                                                                                                                             end
                                                                                                                                                             else begin
-                                                                                                                                                                if (cur_map_index == 218) then begin
+                                                                                                                                                                if (CUR_MAP_V14ENT) then begin
                                                                                                                                                                     return 72;
                                                                                                                                                                 end
                                                                                                                                                                 else begin
-                                                                                                                                                                    if (cur_map_index == 37) then begin
+                                                                                                                                                                    if (CUR_MAP_V15ENT) then begin
                                                                                                                                                                         return 9;
                                                                                                                                                                     end
                                                                                                                                                                     else begin
-                                                                                                                                                                        if (cur_map_index == 15) then begin
+                                                                                                                                                                        if (CUR_MAP_VCTYCTYD) then begin
                                                                                                                                                                             return 4;
                                                                                                                                                                         end
                                                                                                                                                                         else begin
-                                                                                                                                                                            if (cur_map_index == 202) then begin
+                                                                                                                                                                            if (CUR_MAP_CRISIENT) then begin
                                                                                                                                                                                 return 56;
                                                                                                                                                                             end
                                                                                                                                                                             else begin
-                                                                                                                                                                                if (cur_map_index == 224) then begin
+                                                                                                                                                                                if (CUR_MAP_MODOCT2) then begin
                                                                                                                                                                                     return 75;
                                                                                                                                                                                 end
                                                                                                                                                                                 else begin
-                                                                                                                                                                                    if (cur_map_index == 238) then begin
+                                                                                                                                                                                    if (CUR_MAP_BROHDENT) then begin
                                                                                                                                                                                         return 81;
                                                                                                                                                                                     end
                                                                                                                                                                                     else begin
-                                                                                                                                                                                        if (cur_map_index == 242) then begin
+                                                                                                                                                                                        if (CUR_MAP_EPAENT) then begin
                                                                                                                                                                                             return 83;
                                                                                                                                                                                         end
                                                                                                                                                                                         else begin
-                                                                                                                                                                                            if (cur_map_index == 109) then begin
+                                                                                                                                                                                            if (CUR_MAP_NAVARRO) then begin
                                                                                                                                                                                                 return 15;
                                                                                                                                                                                             end
                                                                                                                                                                                             else begin
-                                                                                                                                                                                                if (cur_map_index == 249) then begin
+                                                                                                                                                                                                if (CUR_MAP_BREAKDWN) then begin
                                                                                                                                                                                                     return 89;
                                                                                                                                                                                                 end
                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                    if (cur_map_index == 252) then begin
+                                                                                                                                                                                                    if (CUR_MAP_ABANDON3) then begin
                                                                                                                                                                                                         return 88;
                                                                                                                                                                                                     end
                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                        if (cur_map_index == 94) then begin
+                                                                                                                                                                                                        if (CUR_MAP_BHRNDDST) then begin
                                                                                                                                                                                                             return 44;
                                                                                                                                                                                                         end
                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                            if (cur_map_index == 95) then begin
+                                                                                                                                                                                                            if (CUR_MAP_BHRNDMNT) then begin
                                                                                                                                                                                                                 return 44;
                                                                                                                                                                                                             end
                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                if (cur_map_index == 241) then begin
+                                                                                                                                                                                                                if (CUR_MAP_BRHDHLP) then begin
                                                                                                                                                                                                                     return 82;
                                                                                                                                                                                                                 end
                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                    if (cur_map_index == 53) then begin
+                                                                                                                                                                                                                    if (CUR_MAP_CARDESRT) then begin
                                                                                                                                                                                                                         return 21;
                                                                                                                                                                                                                     end
                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                        if (cur_map_index == 164) then begin
+                                                                                                                                                                                                                        if (CUR_MAP_RNDPOSTM) then begin
                                                                                                                                                                                                                             return 55;
                                                                                                                                                                                                                         end
                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                            if (cur_map_index == 159) then begin
+                                                                                                                                                                                                                            if (CUR_MAP_RNDBD) then begin
                                                                                                                                                                                                                                 return 19;
                                                                                                                                                                                                                             end
                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                if (cur_map_index == 98) then begin
+                                                                                                                                                                                                                                if (CUR_MAP_RNDBHEAD) then begin
                                                                                                                                                                                                                                     return 33;
                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                    if (cur_map_index == 101) then begin
+                                                                                                                                                                                                                                    if (CUR_MAP_RNDBRIDG) then begin
                                                                                                                                                                                                                                         return 36;
                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                        if (cur_map_index == 102) then begin
+                                                                                                                                                                                                                                        if (CUR_MAP_RNDCAFE) then begin
                                                                                                                                                                                                                                             return 37;
                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                            if (cur_map_index == 108) then begin
+                                                                                                                                                                                                                                            if (CUR_MAP_RNDEXCOW) then begin
                                                                                                                                                                                                                                                 return 43;
                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                if (cur_map_index == 105) then begin
+                                                                                                                                                                                                                                                if (CUR_MAP_RNDFORVR) then begin
                                                                                                                                                                                                                                                     return 40;
                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                    if (cur_map_index == 103) then begin
+                                                                                                                                                                                                                                                    if (CUR_MAP_RNDHOLY1) then begin
                                                                                                                                                                                                                                                         return 38;
                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                        if (cur_map_index == 104) then begin
+                                                                                                                                                                                                                                                        if (CUR_MAP_RNDHOLY2) then begin
                                                                                                                                                                                                                                                             return 39;
                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                            if (cur_map_index == 216) then begin
+                                                                                                                                                                                                                                                            if (CUR_MAP_RNDMSTR) then begin
                                                                                                                                                                                                                                                                 return 71;
                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                if (cur_map_index == 107) then begin
+                                                                                                                                                                                                                                                                if (CUR_MAP_RNDPARIH) then begin
                                                                                                                                                                                                                                                                     return 42;
                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                    if (cur_map_index == 99) then begin
+                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDSHUTL) then begin
                                                                                                                                                                                                                                                                         return 34;
                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                        if (cur_map_index == 97) then begin
+                                                                                                                                                                                                                                                                        if (CUR_MAP_RNDTINWD) then begin
                                                                                                                                                                                                                                                                             return 32;
                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                            if (cur_map_index == 106) then begin
+                                                                                                                                                                                                                                                                            if (CUR_MAP_RNDTOXIC) then begin
                                                                                                                                                                                                                                                                                 return 41;
                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                if (cur_map_index == 100) then begin
+                                                                                                                                                                                                                                                                                if (CUR_MAP_RNDUVILG) then begin
                                                                                                                                                                                                                                                                                     return 35;
                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                    if (cur_map_index == 96) then begin
+                                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDWHALE) then begin
                                                                                                                                                                                                                                                                                         return 31;
                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                        if (cur_map_index == 69) then begin
+                                                                                                                                                                                                                                                                                        if (CUR_MAP_CAVE0) then begin
                                                                                                                                                                                                                                                                                             return 27;
                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                            if (cur_map_index == 70) then begin
+                                                                                                                                                                                                                                                                                            if (CUR_MAP_CAVE1) then begin
                                                                                                                                                                                                                                                                                                 return 27;
                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                if (cur_map_index == 71) then begin
+                                                                                                                                                                                                                                                                                                if (CUR_MAP_CAVE2) then begin
                                                                                                                                                                                                                                                                                                     return 27;
                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                    if (cur_map_index == 72) then begin
+                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CAVE3) then begin
                                                                                                                                                                                                                                                                                                         return 27;
                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                        if (cur_map_index == 73) then begin
+                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CAVE4) then begin
                                                                                                                                                                                                                                                                                                             return 27;
                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                            if (cur_map_index == 80) then begin
+                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CAVE5) then begin
                                                                                                                                                                                                                                                                                                                 return 27;
                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                if (cur_map_index == 149) then begin
+                                                                                                                                                                                                                                                                                                                if (CUR_MAP_GAMMOVIE) then begin
                                                                                                                                                                                                                                                                                                                     return 47;
                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 150) then begin
+                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDBESS) then begin
                                                                                                                                                                                                                                                                                                                         return 47;
                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 76) then begin
+                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST1) then begin
                                                                                                                                                                                                                                                                                                                             return 29;
                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 77) then begin
+                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST2) then begin
                                                                                                                                                                                                                                                                                                                                 return 29;
                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 85) then begin
+                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST3) then begin
                                                                                                                                                                                                                                                                                                                                     return 29;
                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 86) then begin
+                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST4) then begin
                                                                                                                                                                                                                                                                                                                                         return 29;
                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 87) then begin
+                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST5) then begin
                                                                                                                                                                                                                                                                                                                                             return 29;
                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 88) then begin
+                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST6) then begin
                                                                                                                                                                                                                                                                                                                                                 return 29;
                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 89) then begin
+                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST7) then begin
                                                                                                                                                                                                                                                                                                                                                     return 29;
                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 90) then begin
+                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST8) then begin
                                                                                                                                                                                                                                                                                                                                                         return 29;
                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 91) then begin
+                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST9) then begin
                                                                                                                                                                                                                                                                                                                                                             return 29;
                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 110) then begin
+                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST10) then begin
                                                                                                                                                                                                                                                                                                                                                                 return 29;
                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 111) then begin
+                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST11) then begin
                                                                                                                                                                                                                                                                                                                                                                     return 47;
                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 112) then begin
+                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_07DESERT) then begin
                                                                                                                                                                                                                                                                                                                                                                         return 47;
                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 149) then begin
+                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_GAMMOVIE) then begin
                                                                                                                                                                                                                                                                                                                                                                             return 47;
                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 1) then begin
+                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT2) then begin
                                                                                                                                                                                                                                                                                                                                                                                 return 26;
                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 2) then begin
+                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESERT3) then begin
                                                                                                                                                                                                                                                                                                                                                                                     return 26;
                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 81) then begin
+                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESERT4) then begin
                                                                                                                                                                                                                                                                                                                                                                                         return 26;
                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 82) then begin
+                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESERT5) then begin
                                                                                                                                                                                                                                                                                                                                                                                             return 26;
                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 83) then begin
+                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                 return 26;
                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 84) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESERT7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                     return 26;
                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 113) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESERT8) then begin
                                                                                                                                                                                                                                                                                                                                                                                                         return 26;
                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 114) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESERT9) then begin
                                                                                                                                                                                                                                                                                                                                                                                                             return 26;
                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 115) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESRT10) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                 return 26;
                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 116) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESRT11) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                     return 47;
                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 117) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESRT12) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                         return 47;
                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 68) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CITY1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                             return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 125) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CITY2) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                 return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 141) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CITY3) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                     return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 142) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CITY4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                         return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 143) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CITY5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                             return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 144) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CITY6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                 return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 145) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CITY7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                     return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 146) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CITY8) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                         return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 119) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CAVE6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                             return 45;
                                                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 120) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CAVE7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 return 46;
                                                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 74) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_MOUNTN1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                     return 27;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 75) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_MOUNTN2) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         return 27;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 121) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_MOUNTN3) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             return 27;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 122) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_MOUNTN4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 return 27;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 123) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_MOUNTN5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     return 47;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 124) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_MOUNTN6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         return 47;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (cur_map_index == 53) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CARDESRT) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             return 21;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (cur_map_index == 0) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 return 26;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cur_map_index == 198) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_A10) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     return 69;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 else begin
-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (cur_map_index == 179) then begin
+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_A12) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         return 66;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     else begin
@@ -1321,13 +1321,13 @@ begin
     variable LVar1 := 0;
     variable LVar2 := 0;
     variable LVar3 := 0;
-    wm_area_set_pos(26, metarule(44, 0), metarule(45, 0));
-    wm_area_set_pos(27, metarule(44, 0), metarule(45, 0));
-    wm_area_set_pos(28, metarule(44, 0), metarule(45, 0));
-    wm_area_set_pos(29, metarule(44, 0), metarule(45, 0));
-    wm_area_set_pos(47, metarule(44, 0), metarule(45, 0));
+    wm_area_set_pos(26, worldmap_xpos, worldmap_ypos);
+    wm_area_set_pos(27, worldmap_xpos, worldmap_ypos);
+    wm_area_set_pos(28, worldmap_xpos, worldmap_ypos);
+    wm_area_set_pos(29, worldmap_xpos, worldmap_ypos);
+    wm_area_set_pos(47, worldmap_xpos, worldmap_ypos);
     call Place_Critters();
-    if ((elevation(dude_obj) == 1) or (elevation(dude_obj) == 2)) then begin
+    if ((dude_elevation == 1) or (dude_elevation == 2)) then begin
         set_light_level(50);
     end
     else begin
@@ -1408,68 +1408,68 @@ begin
             end
         end
     end
-    if (metarule(14, 0) and not(global_var(352) bwand 1) and (random(0, 99) < (30 + (2 * get_critter_stat(dude_obj, 6)))) and has_trait(0, dude_obj, 46)) then begin
-        if (not(global_var(352) bwand 2)) then begin
+    if (map_first_run and not(global_var(GVAR_MYSTERIOUS_STRANGER) bwand 1) and (random(0, 99) < (30 + (2 * dude_luck))) and has_trait(TRAIT_PERK, dude_obj, PERK_mysterious_stranger)) then begin
+        if (not(global_var(GVAR_MYSTERIOUS_STRANGER) bwand 2)) then begin
             debug_msg("Set the Stranger Gender");
-            set_global_var(352, global_var(352) bwor 2);
+            set_global_var(GVAR_MYSTERIOUS_STRANGER, global_var(GVAR_MYSTERIOUS_STRANGER) bwor 2);
             if (random(0, 99) < 50) then begin
-                set_global_var(352, global_var(352) bwor 4);
+                set_global_var(GVAR_MYSTERIOUS_STRANGER, global_var(GVAR_MYSTERIOUS_STRANGER) bwor 4);
             end
         end
-        if (global_var(352) bwand 4) then begin
-            if (get_pc_stat(1) > 26) then begin
-                LVar0 := create_object_sid(16777503, 0, 0, 732);
+        if (global_var(GVAR_MYSTERIOUS_STRANGER) bwand 4) then begin
+            if (get_pc_stat(PCSTAT_level) > 26) then begin
+                LVar0 := create_object_sid(16777503, 0, 0, SCRIPT_ECMSTSTR);
             end
             else begin
-                if (get_pc_stat(1) > 22) then begin
-                    LVar0 := create_object_sid(16777501, 0, 0, 732);
+                if (get_pc_stat(PCSTAT_level) > 22) then begin
+                    LVar0 := create_object_sid(16777501, 0, 0, SCRIPT_ECMSTSTR);
                 end
                 else begin
-                    if (get_pc_stat(1) > 18) then begin
-                        LVar0 := create_object_sid(16777499, 0, 0, 732);
+                    if (get_pc_stat(PCSTAT_level) > 18) then begin
+                        LVar0 := create_object_sid(16777499, 0, 0, SCRIPT_ECMSTSTR);
                     end
                     else begin
-                        if (get_pc_stat(1) > 14) then begin
-                            LVar0 := create_object_sid(16777497, 0, 0, 732);
+                        if (get_pc_stat(PCSTAT_level) > 14) then begin
+                            LVar0 := create_object_sid(16777497, 0, 0, SCRIPT_ECMSTSTR);
                         end
                         else begin
-                            LVar0 := create_object_sid(16777487, 0, 0, 732);
+                            LVar0 := create_object_sid(16777487, 0, 0, SCRIPT_ECMSTSTR);
                         end
                     end
                 end
             end
         end
         else begin
-            if (get_pc_stat(1) > 26) then begin
-                LVar0 := create_object_sid(16777502, 0, 0, 732);
+            if (get_pc_stat(PCSTAT_level) > 26) then begin
+                LVar0 := create_object_sid(16777502, 0, 0, SCRIPT_ECMSTSTR);
             end
             else begin
-                if (get_pc_stat(1) > 22) then begin
-                    LVar0 := create_object_sid(16777500, 0, 0, 732);
+                if (get_pc_stat(PCSTAT_level) > 22) then begin
+                    LVar0 := create_object_sid(16777500, 0, 0, SCRIPT_ECMSTSTR);
                 end
                 else begin
-                    if (get_pc_stat(1) > 18) then begin
-                        LVar0 := create_object_sid(16777498, 0, 0, 732);
+                    if (get_pc_stat(PCSTAT_level) > 18) then begin
+                        LVar0 := create_object_sid(16777498, 0, 0, SCRIPT_ECMSTSTR);
                     end
                     else begin
-                        if (get_pc_stat(1) > 14) then begin
-                            LVar0 := create_object_sid(16777496, 0, 0, 732);
+                        if (get_pc_stat(PCSTAT_level) > 14) then begin
+                            LVar0 := create_object_sid(16777496, 0, 0, SCRIPT_ECMSTSTR);
                         end
                         else begin
-                            LVar0 := create_object_sid(16777486, 0, 0, 732);
+                            LVar0 := create_object_sid(16777486, 0, 0, SCRIPT_ECMSTSTR);
                         end
                     end
                 end
             end
         end
-        LVar1 := tile_num_in_direction(tile_num(dude_obj), random(0, 5), random(5, 10));
-        critter_attempt_placement(LVar0, LVar1, elevation(dude_obj));
+        LVar1 := tile_num_in_direction(dude_tile, random(0, 5), random(5, 10));
+        critter_attempt_placement(LVar0, LVar1, dude_elevation);
     end
 end
 
 procedure map_update_p_proc
 begin
-    if ((elevation(dude_obj) == 1) or (elevation(dude_obj) == 2)) then begin
+    if ((dude_elevation == 1) or (dude_elevation == 2)) then begin
         set_light_level(50);
     end
     else begin
@@ -1669,150 +1669,150 @@ end
 procedure Create_Chests_Sewer
 begin
     variable LVar0 := 0;
-    LVar0 := create_object_sid(245, 17327, 1, -1);
+    LVar0 := create_object(245, 17327, 1);
     if (LVar0) then begin
         if (random(1, 2) == 1) then begin
-            add_mult_objs_to_inven(LVar0, create_object_sid(40, 0, 0, -1), random(1, 5));
+            add_mult_objs_to_inven(LVar0, create_object(40, 0, 0), random(1, 5));
         end
         if (random(1, 4) == 1) then begin
-            if (get_pc_stat(1) > 7) then begin
-                add_obj_to_inven(LVar0, create_object_sid(235, 0, 0, -1));
+            if (get_pc_stat(PCSTAT_level) > 7) then begin
+                add_obj_to_inven(LVar0, create_object(235, 0, 0));
             end
             else begin
-                add_obj_to_inven(LVar0, create_object_sid(160, 0, 0, -1));
+                add_obj_to_inven(LVar0, create_object(160, 0, 0));
             end
         end
-        item_caps_adjust(LVar0, 20 * random(1, get_critter_stat(dude_obj, 6)));
+        item_caps_adjust(LVar0, 20 * random(1, dude_luck));
     end
-    LVar0 := create_object_sid(245, 15885, 1, -1);
+    LVar0 := create_object(245, 15885, 1);
     if (LVar0) then begin
         if (random(1, 2) == 1) then begin
-            add_mult_objs_to_inven(LVar0, create_object_sid(40, 0, 0, -1), random(1, 5));
+            add_mult_objs_to_inven(LVar0, create_object(40, 0, 0), random(1, 5));
         end
         if (random(1, 4) == 1) then begin
-            if (get_pc_stat(1) > 5) then begin
-                add_obj_to_inven(LVar0, create_object_sid(115, 0, 0, -1));
+            if (get_pc_stat(PCSTAT_level) > 5) then begin
+                add_obj_to_inven(LVar0, create_object(115, 0, 0));
             end
             else begin
-                add_obj_to_inven(LVar0, create_object_sid(10, 0, 0, -1));
+                add_obj_to_inven(LVar0, create_object(10, 0, 0));
             end
         end
-        item_caps_adjust(LVar0, 20 * random(get_critter_stat(dude_obj, 6), get_critter_stat(dude_obj, 6) * get_critter_stat(dude_obj, 6)));
+        item_caps_adjust(LVar0, 20 * random(dude_luck, dude_luck * dude_luck));
     end
-    LVar0 := create_object_sid(245, 20316, 2, -1);
+    LVar0 := create_object(245, 20316, 2);
     if (LVar0) then begin
         if (random(1, 2) == 1) then begin
-            if (get_pc_stat(1) < 7) then begin
-                add_mult_objs_to_inven(LVar0, create_object_sid(25, 0, 0, -1), random(1, 5));
+            if (get_pc_stat(PCSTAT_level) < 7) then begin
+                add_mult_objs_to_inven(LVar0, create_object(25, 0, 0), random(1, 5));
             end
             else begin
-                add_mult_objs_to_inven(LVar0, create_object_sid(26, 0, 0, -1), random(1, 5));
+                add_mult_objs_to_inven(LVar0, create_object(26, 0, 0), random(1, 5));
             end
         end
         if (random(1, 4) == 1) then begin
-            if (get_pc_stat(1) > 10) then begin
-                add_obj_to_inven(LVar0, create_object_sid(15, 0, 0, -1));
+            if (get_pc_stat(PCSTAT_level) > 10) then begin
+                add_obj_to_inven(LVar0, create_object(15, 0, 0));
             end
             else begin
-                add_obj_to_inven(LVar0, create_object_sid(10, 0, 0, -1));
+                add_obj_to_inven(LVar0, create_object(10, 0, 0));
             end
         end
-        item_caps_adjust(LVar0, 20 * random(get_critter_stat(dude_obj, 6), get_critter_stat(dude_obj, 6) * get_critter_stat(dude_obj, 6)));
+        item_caps_adjust(LVar0, 20 * random(dude_luck, dude_luck * dude_luck));
     end
-    LVar0 := create_object_sid(245, 20871, 2, -1);
+    LVar0 := create_object(245, 20871, 2);
     if (LVar0) then begin
         if (random(1, 2) == 1) then begin
-            if (get_pc_stat(1) < 7) then begin
-                add_mult_objs_to_inven(LVar0, create_object_sid(25, 0, 0, -1), random(1, 5));
+            if (get_pc_stat(PCSTAT_level) < 7) then begin
+                add_mult_objs_to_inven(LVar0, create_object(25, 0, 0), random(1, 5));
             end
             else begin
-                add_mult_objs_to_inven(LVar0, create_object_sid(26, 0, 0, -1), random(1, 5));
+                add_mult_objs_to_inven(LVar0, create_object(26, 0, 0), random(1, 5));
             end
         end
         if (random(1, 4) == 1) then begin
-            if (get_pc_stat(1) > 10) then begin
-                add_obj_to_inven(LVar0, create_object_sid(15, 0, 0, -1));
+            if (get_pc_stat(PCSTAT_level) > 10) then begin
+                add_obj_to_inven(LVar0, create_object(15, 0, 0));
             end
             else begin
-                add_obj_to_inven(LVar0, create_object_sid(10, 0, 0, -1));
+                add_obj_to_inven(LVar0, create_object(10, 0, 0));
             end
         end
-        item_caps_adjust(LVar0, 20 * random(get_critter_stat(dude_obj, 6), get_critter_stat(dude_obj, 6) * get_critter_stat(dude_obj, 6)));
+        item_caps_adjust(LVar0, 20 * random(dude_luck, dude_luck * dude_luck));
     end
 end
 
 procedure Create_Chests_Cave
 begin
     variable LVar0 := 0;
-    LVar0 := create_object_sid(245, 19865, 1, -1);
+    LVar0 := create_object(245, 19865, 1);
     if (LVar0) then begin
         if (random(1, 2) == 1) then begin
-            add_mult_objs_to_inven(LVar0, create_object_sid(40, 0, 0, -1), random(1, 5));
+            add_mult_objs_to_inven(LVar0, create_object(40, 0, 0), random(1, 5));
         end
         if (random(1, 4) == 1) then begin
-            if (get_pc_stat(1) > 7) then begin
-                add_obj_to_inven(LVar0, create_object_sid(235, 0, 0, -1));
+            if (get_pc_stat(PCSTAT_level) > 7) then begin
+                add_obj_to_inven(LVar0, create_object(235, 0, 0));
             end
             else begin
-                add_obj_to_inven(LVar0, create_object_sid(160, 0, 0, -1));
+                add_obj_to_inven(LVar0, create_object(160, 0, 0));
             end
         end
-        item_caps_adjust(LVar0, 20 * random(1, get_critter_stat(dude_obj, 6)));
+        item_caps_adjust(LVar0, 20 * random(1, dude_luck));
     end
-    LVar0 := create_object_sid(245, 28501, 1, -1);
+    LVar0 := create_object(245, 28501, 1);
     if (LVar0) then begin
         if (random(1, 2) == 1) then begin
-            add_mult_objs_to_inven(LVar0, create_object_sid(40, 0, 0, -1), random(1, 5));
+            add_mult_objs_to_inven(LVar0, create_object(40, 0, 0), random(1, 5));
         end
         if (random(1, 4) == 1) then begin
-            if (get_pc_stat(1) > 5) then begin
-                add_obj_to_inven(LVar0, create_object_sid(115, 0, 0, -1));
+            if (get_pc_stat(PCSTAT_level) > 5) then begin
+                add_obj_to_inven(LVar0, create_object(115, 0, 0));
             end
             else begin
-                add_obj_to_inven(LVar0, create_object_sid(10, 0, 0, -1));
+                add_obj_to_inven(LVar0, create_object(10, 0, 0));
             end
         end
-        item_caps_adjust(LVar0, 20 * random(get_critter_stat(dude_obj, 6), get_critter_stat(dude_obj, 6) * get_critter_stat(dude_obj, 6)));
+        item_caps_adjust(LVar0, 20 * random(dude_luck, dude_luck * dude_luck));
     end
-    LVar0 := create_object_sid(245, 20127, 1, -1);
+    LVar0 := create_object(245, 20127, 1);
     if (LVar0) then begin
         if (random(1, 2) == 1) then begin
-            if (get_pc_stat(1) < 7) then begin
-                add_mult_objs_to_inven(LVar0, create_object_sid(25, 0, 0, -1), random(1, 5));
+            if (get_pc_stat(PCSTAT_level) < 7) then begin
+                add_mult_objs_to_inven(LVar0, create_object(25, 0, 0), random(1, 5));
             end
             else begin
-                add_mult_objs_to_inven(LVar0, create_object_sid(26, 0, 0, -1), random(1, 5));
+                add_mult_objs_to_inven(LVar0, create_object(26, 0, 0), random(1, 5));
             end
         end
         if (random(1, 4) == 1) then begin
-            if (get_pc_stat(1) > 10) then begin
-                add_obj_to_inven(LVar0, create_object_sid(15, 0, 0, -1));
+            if (get_pc_stat(PCSTAT_level) > 10) then begin
+                add_obj_to_inven(LVar0, create_object(15, 0, 0));
             end
             else begin
-                add_obj_to_inven(LVar0, create_object_sid(10, 0, 0, -1));
+                add_obj_to_inven(LVar0, create_object(10, 0, 0));
             end
         end
-        item_caps_adjust(LVar0, 20 * random(get_critter_stat(dude_obj, 6), get_critter_stat(dude_obj, 6) * get_critter_stat(dude_obj, 6)));
+        item_caps_adjust(LVar0, 20 * random(dude_luck, dude_luck * dude_luck));
     end
-    LVar0 := create_object_sid(245, 12266, 1, -1);
+    LVar0 := create_object(245, 12266, 1);
     if (LVar0) then begin
         if (random(1, 2) == 1) then begin
-            if (get_pc_stat(1) < 7) then begin
-                add_mult_objs_to_inven(LVar0, create_object_sid(25, 0, 0, -1), random(1, 5));
+            if (get_pc_stat(PCSTAT_level) < 7) then begin
+                add_mult_objs_to_inven(LVar0, create_object(25, 0, 0), random(1, 5));
             end
             else begin
-                add_mult_objs_to_inven(LVar0, create_object_sid(26, 0, 0, -1), random(1, 5));
+                add_mult_objs_to_inven(LVar0, create_object(26, 0, 0), random(1, 5));
             end
         end
         if (random(1, 4) == 1) then begin
-            if (get_pc_stat(1) > 10) then begin
-                add_obj_to_inven(LVar0, create_object_sid(15, 0, 0, -1));
+            if (get_pc_stat(PCSTAT_level) > 10) then begin
+                add_obj_to_inven(LVar0, create_object(15, 0, 0));
             end
             else begin
-                add_obj_to_inven(LVar0, create_object_sid(10, 0, 0, -1));
+                add_obj_to_inven(LVar0, create_object(10, 0, 0));
             end
         end
-        item_caps_adjust(LVar0, 20 * random(get_critter_stat(dude_obj, 6), get_critter_stat(dude_obj, 6) * get_critter_stat(dude_obj, 6)));
+        item_caps_adjust(LVar0, 20 * random(dude_luck, dude_luck * dude_luck));
     end
 end
 
@@ -1892,7 +1892,7 @@ begin
     call choose_pid_sid();
     call Create_Critters_One();
     call Create_Critters_Two();
-    if (random(1, 100) >= (100 - get_critter_stat(dude_obj, 6))) then begin
+    if (random(1, 100) >= (100 - dude_luck)) then begin
         call Create_Chests_Sewer();
     end
 end
@@ -1901,7 +1901,7 @@ procedure Place_Critters_Cave
 begin
     call choose_pid_sid();
     call Create_Critters_Cave();
-    if (random(1, 100) >= (100 - get_critter_stat(dude_obj, 6))) then begin
+    if (random(1, 100) >= (100 - dude_luck)) then begin
         call Create_Chests_Cave();
     end
 end
@@ -1909,7 +1909,7 @@ end
 procedure Place_Critters
 begin
     call choose_pid_sid();
-    if ((cur_map_index == 69) or (cur_map_index == 70) or (cur_map_index == 71) or (cur_map_index == 72) or (cur_map_index == 73) or (cur_map_index == 80)) then begin
+    if ((CUR_MAP_CAVE0) or (CUR_MAP_CAVE1) or (CUR_MAP_CAVE2) or (CUR_MAP_CAVE3) or (CUR_MAP_CAVE4) or (CUR_MAP_CAVE5)) then begin
         call Place_Critters_Cave();
     end
     else begin
@@ -1920,34 +1920,34 @@ end
 procedure Place_Critters_MegaMod
 begin
     call choose_pid_sid();
-    if ((cur_map_index == 68) or (cur_map_index == 125) or (cur_map_index == 141) or (cur_map_index == 142) or (cur_map_index == 143) or (cur_map_index == 144) or (cur_map_index == 145) or (cur_map_index == 146)) then begin
+    if ((CUR_MAP_CITY1) or (CUR_MAP_CITY2) or (CUR_MAP_CITY3) or (CUR_MAP_CITY4) or (CUR_MAP_CITY5) or (CUR_MAP_CITY6) or (CUR_MAP_CITY7) or (CUR_MAP_CITY8)) then begin
         call Place_Critters_Sewer();
     end
 end
 
 procedure Pick_Gecko_PID
 begin
-    if ((get_pc_stat(1) >= 1) and (get_pc_stat(1) <= 5)) then begin
+    if ((get_pc_stat(PCSTAT_level) >= 1) and (get_pc_stat(PCSTAT_level) <= 5)) then begin
         picked := 16777296;
     end
     else begin
-        if ((get_pc_stat(1) >= 6) and (get_pc_stat(1) <= 10)) then begin
+        if ((get_pc_stat(PCSTAT_level) >= 6) and (get_pc_stat(PCSTAT_level) <= 10)) then begin
             picked := 16777297;
         end
         else begin
-            if ((get_pc_stat(1) >= 11) and (get_pc_stat(1) <= 15)) then begin
+            if ((get_pc_stat(PCSTAT_level) >= 11) and (get_pc_stat(PCSTAT_level) <= 15)) then begin
                 picked := 16777299;
             end
             else begin
-                if ((get_pc_stat(1) >= 16) and (get_pc_stat(1) <= 20)) then begin
+                if ((get_pc_stat(PCSTAT_level) >= 16) and (get_pc_stat(PCSTAT_level) <= 20)) then begin
                     picked := 16777302;
                 end
                 else begin
-                    if ((get_pc_stat(1) >= 21) and (get_pc_stat(1) <= 25)) then begin
+                    if ((get_pc_stat(PCSTAT_level) >= 21) and (get_pc_stat(PCSTAT_level) <= 25)) then begin
                         picked := 16777456;
                     end
                     else begin
-                        if (get_pc_stat(1) >= 26) then begin
+                        if (get_pc_stat(PCSTAT_level) >= 26) then begin
                             picked := 16777457;
                         end
                     end
@@ -1960,27 +1960,27 @@ end
 
 procedure Pick_Alien_PID
 begin
-    if ((get_pc_stat(1) >= 1) and (get_pc_stat(1) <= 25)) then begin
+    if ((get_pc_stat(PCSTAT_level) >= 1) and (get_pc_stat(PCSTAT_level) <= 25)) then begin
         picked := 16777458;
     end
     else begin
-        if ((get_pc_stat(1) >= 26) and (get_pc_stat(1) <= 30)) then begin
+        if ((get_pc_stat(PCSTAT_level) >= 26) and (get_pc_stat(PCSTAT_level) <= 30)) then begin
             picked := 16777459;
         end
         else begin
-            if ((get_pc_stat(1) >= 31) and (get_pc_stat(1) <= 35)) then begin
+            if ((get_pc_stat(PCSTAT_level) >= 31) and (get_pc_stat(PCSTAT_level) <= 35)) then begin
                 picked := 16777464;
             end
             else begin
-                if ((get_pc_stat(1) >= 36) and (get_pc_stat(1) <= 40)) then begin
+                if ((get_pc_stat(PCSTAT_level) >= 36) and (get_pc_stat(PCSTAT_level) <= 40)) then begin
                     picked := 16777462;
                 end
                 else begin
-                    if ((get_pc_stat(1) >= 41) and (get_pc_stat(1) <= 45)) then begin
+                    if ((get_pc_stat(PCSTAT_level) >= 41) and (get_pc_stat(PCSTAT_level) <= 45)) then begin
                         picked := 16777465;
                     end
                     else begin
-                        if (get_pc_stat(1) >= 46) then begin
+                        if (get_pc_stat(PCSTAT_level) >= 46) then begin
                             picked := 16777463;
                         end
                     end
@@ -1997,7 +1997,7 @@ begin
     critter_attempt_placement(critter_ptr, arg1, arg3);
     if (not(tile_contains_pid_obj(arg1, arg3, arg0))) then begin
         destroy_object(critter_ptr);
-        if (cur_map_index == 79) then begin
+        if (CUR_MAP_BROKEN2) then begin
             if (arg3 == 1) then begin
                 set_map_var(30, map_var(30) - 1);
             end
@@ -2008,27 +2008,27 @@ begin
             end
         end
         else begin
-            if (cur_map_index == 135) then begin
-                set_global_var(1623, global_var(1623) - 1);
+            if (CUR_MAP_SFTANKER) then begin
+                set_global_var(GVAR_BOZAR_UPGRADE_ONE, global_var(GVAR_BOZAR_UPGRADE_ONE) - 1);
             end
             else begin
-                if (cur_map_index == 21) then begin
-                    set_global_var(1605, global_var(1605) - 1);
+                if (CUR_MAP_MODGARD) then begin
+                    set_global_var(GVAR_MODOC_ORIGINAL_QUEST_DONE, global_var(GVAR_MODOC_ORIGINAL_QUEST_DONE) - 1);
                 end
                 else begin
-                    if (cur_map_index == 66) then begin
-                        set_global_var(1613, global_var(1613) - 1);
+                    if (CUR_MAP_REDDTUN) then begin
+                        set_global_var(GVAR_REDDING_RESPAWN_TIMER, global_var(GVAR_REDDING_RESPAWN_TIMER) - 1);
                     end
                     else begin
-                        if (cur_map_index == 67) then begin
-                            set_global_var(1614, global_var(1614) - 1);
+                        if (CUR_MAP_REDMTUN) then begin
+                            set_global_var(GVAR_ENTERED_MAIN, global_var(GVAR_ENTERED_MAIN) - 1);
                         end
                         else begin
-                            if (cur_map_index == 63) then begin
-                                set_global_var(1612, global_var(1612) - 1);
+                            if (CUR_MAP_REDWAN1) then begin
+                                set_global_var(GVAR_REDDING_M_MOB_COUNTER, global_var(GVAR_REDDING_M_MOB_COUNTER) - 1);
                             end
                             else begin
-                                if (cur_map_index == 250) then begin
+                                if (CUR_MAP_ABANDON1) then begin
                                     if (arg3 == 0) then begin
                                         set_sfall_global("counter1", get_sfall_global_int("counter1") - 1);
                                     end
@@ -2039,7 +2039,7 @@ begin
                                     end
                                 end
                                 else begin
-                                    if (cur_map_index == 251) then begin
+                                    if (CUR_MAP_ABANDON2) then begin
                                         if (arg3 == 0) then begin
                                             set_sfall_global("counter3", get_sfall_global_int("counter3") - 1);
                                         end
@@ -2084,17 +2084,17 @@ begin
     if (get_sfall_global_int("nirran_1") == 0) then begin
         LVar0 := random(1, 13);
         if (LVar0 == 1) then begin
-            if (get_pc_stat(1) < 6) then begin
+            if (get_pc_stat(PCSTAT_level) < 6) then begin
                 encounter_pid := 16777296;
                 encounter_sid := 615;
             end
             else begin
-                if (get_pc_stat(1) < 12) then begin
+                if (get_pc_stat(PCSTAT_level) < 12) then begin
                     encounter_pid := 16777297;
                     encounter_sid := 615;
                 end
                 else begin
-                    if (get_pc_stat(1) < 13) then begin
+                    if (get_pc_stat(PCSTAT_level) < 13) then begin
                         encounter_pid := 16777456;
                         encounter_sid := 615;
                     end
@@ -2107,17 +2107,17 @@ begin
         end
         else begin
             if (LVar0 == 2) then begin
-                if (get_pc_stat(1) < 5) then begin
+                if (get_pc_stat(PCSTAT_level) < 5) then begin
                     encounter_pid := 16777299;
                     encounter_sid := 615;
                 end
                 else begin
-                    if (get_pc_stat(1) < 12) then begin
+                    if (get_pc_stat(PCSTAT_level) < 12) then begin
                         encounter_pid := 16777302;
                         encounter_sid := 615;
                     end
                     else begin
-                        if (get_pc_stat(1) < 13) then begin
+                        if (get_pc_stat(PCSTAT_level) < 13) then begin
                             encounter_pid := 16777456;
                             encounter_sid := 615;
                         end
@@ -2160,17 +2160,17 @@ begin
                                     end
                                     else begin
                                         if (LVar0 == 9) then begin
-                                            if (get_pc_stat(1) < 5) then begin
+                                            if (get_pc_stat(PCSTAT_level) < 5) then begin
                                                 encounter_pid := 16777296;
                                                 encounter_sid := 615;
                                             end
                                             else begin
-                                                if (get_pc_stat(1) > 12) then begin
+                                                if (get_pc_stat(PCSTAT_level) > 12) then begin
                                                     encounter_pid := 16777456;
                                                     encounter_sid := 615;
                                                 end
                                                 else begin
-                                                    if (get_pc_stat(1) > 15) then begin
+                                                    if (get_pc_stat(PCSTAT_level) > 15) then begin
                                                         encounter_pid := 16777457;
                                                         encounter_sid := 615;
                                                     end
@@ -2194,12 +2194,12 @@ begin
                                                     end
                                                     else begin
                                                         if (LVar0 == 13) then begin
-                                                            if (get_pc_stat(1) < 5) then begin
+                                                            if (get_pc_stat(PCSTAT_level) < 5) then begin
                                                                 encounter_pid := 16777486;
                                                                 encounter_sid := 625;
                                                             end
                                                             else begin
-                                                                if (get_pc_stat(1) < 11) then begin
+                                                                if (get_pc_stat(PCSTAT_level) < 11) then begin
                                                                     encounter_pid := 16777400;
                                                                     encounter_sid := 625;
                                                                 end
@@ -2220,7 +2220,7 @@ begin
     end
     else begin
         if (get_sfall_global_int("nirran_1") == 1) then begin
-            if ((get_pc_stat(1) >= 1) and (get_pc_stat(1) <= 3)) then begin
+            if ((get_pc_stat(PCSTAT_level) >= 1) and (get_pc_stat(PCSTAT_level) <= 3)) then begin
                 LVar0 := random(1, 100);
                 if (LVar0 <= 50) then begin
                     encounter_pid := 16777227;
@@ -2245,7 +2245,7 @@ begin
                 end
             end
             else begin
-                if ((get_pc_stat(1) >= 4) and (get_pc_stat(1) <= 6)) then begin
+                if ((get_pc_stat(PCSTAT_level) >= 4) and (get_pc_stat(PCSTAT_level) <= 6)) then begin
                     LVar0 := random(1, 100);
                     if (LVar0 <= 50) then begin
                         encounter_pid := 16777332;
@@ -2257,62 +2257,62 @@ begin
                     end
                 end
                 else begin
-                    if ((get_pc_stat(1) >= 7) and (get_pc_stat(1) <= 8)) then begin
+                    if ((get_pc_stat(PCSTAT_level) >= 7) and (get_pc_stat(PCSTAT_level) <= 8)) then begin
                         encounter_pid := 16777296;
                         encounter_sid := 615;
                     end
                     else begin
-                        if ((get_pc_stat(1) >= 9) and (get_pc_stat(1) <= 10)) then begin
+                        if ((get_pc_stat(PCSTAT_level) >= 9) and (get_pc_stat(PCSTAT_level) <= 10)) then begin
                             encounter_pid := 16777297;
                             encounter_sid := 615;
                         end
                         else begin
-                            if ((get_pc_stat(1) >= 11) and (get_pc_stat(1) <= 15)) then begin
+                            if ((get_pc_stat(PCSTAT_level) >= 11) and (get_pc_stat(PCSTAT_level) <= 15)) then begin
                                 encounter_pid := 16777299;
                                 encounter_sid := 615;
                             end
                             else begin
-                                if ((get_pc_stat(1) >= 16) and (get_pc_stat(1) <= 20)) then begin
+                                if ((get_pc_stat(PCSTAT_level) >= 16) and (get_pc_stat(PCSTAT_level) <= 20)) then begin
                                     encounter_pid := 16777302;
                                     encounter_sid := 615;
                                 end
                                 else begin
-                                    if ((get_pc_stat(1) >= 21) and (get_pc_stat(1) <= 25)) then begin
+                                    if ((get_pc_stat(PCSTAT_level) >= 21) and (get_pc_stat(PCSTAT_level) <= 25)) then begin
                                         encounter_pid := 16777456;
                                         encounter_sid := 615;
                                     end
                                     else begin
-                                        if ((get_pc_stat(1) >= 26) and (get_pc_stat(1) <= 30)) then begin
+                                        if ((get_pc_stat(PCSTAT_level) >= 26) and (get_pc_stat(PCSTAT_level) <= 30)) then begin
                                             encounter_pid := 16777457;
                                             encounter_sid := 615;
                                         end
                                         else begin
-                                            if ((get_pc_stat(1) >= 31) and (get_pc_stat(1) <= 35)) then begin
+                                            if ((get_pc_stat(PCSTAT_level) >= 31) and (get_pc_stat(PCSTAT_level) <= 35)) then begin
                                                 encounter_pid := 16777458;
                                                 encounter_sid := 790;
                                             end
                                             else begin
-                                                if ((get_pc_stat(1) >= 36) and (get_pc_stat(1) <= 40)) then begin
+                                                if ((get_pc_stat(PCSTAT_level) >= 36) and (get_pc_stat(PCSTAT_level) <= 40)) then begin
                                                     encounter_pid := 16777459;
                                                     encounter_sid := 790;
                                                 end
                                                 else begin
-                                                    if ((get_pc_stat(1) >= 41) and (get_pc_stat(1) <= 45)) then begin
+                                                    if ((get_pc_stat(PCSTAT_level) >= 41) and (get_pc_stat(PCSTAT_level) <= 45)) then begin
                                                         encounter_pid := 16777464;
                                                         encounter_sid := 790;
                                                     end
                                                     else begin
-                                                        if ((get_pc_stat(1) >= 46) and (get_pc_stat(1) <= 50)) then begin
+                                                        if ((get_pc_stat(PCSTAT_level) >= 46) and (get_pc_stat(PCSTAT_level) <= 50)) then begin
                                                             encounter_pid := 16777462;
                                                             encounter_sid := 790;
                                                         end
                                                         else begin
-                                                            if ((get_pc_stat(1) >= 51) and (get_pc_stat(1) <= 55)) then begin
+                                                            if ((get_pc_stat(PCSTAT_level) >= 51) and (get_pc_stat(PCSTAT_level) <= 55)) then begin
                                                                 encounter_pid := 16777465;
                                                                 encounter_sid := 790;
                                                             end
                                                             else begin
-                                                                if ((get_pc_stat(1) >= 56) and (get_pc_stat(1) <= 99)) then begin
+                                                                if ((get_pc_stat(PCSTAT_level) >= 56) and (get_pc_stat(PCSTAT_level) <= 99)) then begin
                                                                     encounter_pid := 16777463;
                                                                     encounter_sid := 790;
                                                                 end
@@ -2332,4 +2332,3 @@ begin
         end
     end
 end
-
