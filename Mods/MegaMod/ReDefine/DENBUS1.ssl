procedure Delete_Car(variable arg0);
procedure Place_Car(variable arg0);
procedure Get_Car_Hex;
procedure Get_Current_Town;
procedure Mark_Town_Known(variable arg0);
procedure Set_Viewport_Position;
procedure get_map_wm_y(variable arg0);
procedure get_map_wm_x(variable arg0);
procedure Add_Car_To_Party;
procedure Update_Trunk;

variable x_zero;
variable y_zero;
variable ProtoOfItemGiven;
variable ValueOfRollCheck := 1;
variable How_Many_Party_Members_Are_Injured;
variable How_Many_Party_Members_Armed;
variable PartyHealingItem;
variable trunk_tile;
variable Scenery_Creation;
variable Scenery_Creation_Ptr;
variable Scenery_Creation_Hex;
variable Scenery_Creation_Count;

procedure checkPartyMembersNearDoor;

variable global_temp;
variable dest_tile;
variable step_tile;
variable in_dialog;
variable forced_node;
variable restock_amt;
variable restock_obj;
variable restock_trash;
variable removed_qty;
variable caught_thief;
variable the_follow_obj;

procedure start;
procedure map_exit_p_proc;
procedure map_enter_p_proc;
procedure map_update_p_proc;

export variable den_flick_box_obj;
export variable den_smitty_box_obj;
export variable den_mom_box_obj;
export variable generic_temp_box;
export variable den_metzger_box_obj;
export variable den_tubby_box_obj;
export variable junkie_talker_1;
export variable junkie_talker_2;
export variable gang_1_member_1;
export variable gang_1_member_2;
export variable gang_1_member_3;
export variable gang_1_member_4;
export variable gang_1_member_5;
export variable gang_2_member_1;
export variable gang_2_member_2;
export variable gang_2_member_3;
export variable gang_2_member_4;
export variable gang_2_member_5;
export variable joey_obj;
export variable smitty_obj;
export variable tubby_obj;
export variable flick_obj;
export variable frankie_obj;
export variable becky_guard_obj;
export variable becky_door_guard_obj;
export variable i_brother_obj;
export variable becky_obj;
export variable becky_door_obj;


procedure Delete_Car(variable arg0)
begin
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    variable LVar4 := 0;
    variable LVar5 := 0;
    variable LVar6 := 0;
    while (tile_contains_obj_pid(arg0, dude_elevation, 33556384) != 0) do begin
        destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556384));
    end
    while (tile_contains_obj_pid(arg0, dude_elevation, 33555441) != 0) do begin
        destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33555441));
    end
    while (tile_contains_obj_pid(arg0, dude_elevation, 33556385) != 0) do begin
        destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556385));
    end
    while (tile_contains_obj_pid(arg0, dude_elevation, 33556386) != 0) do begin
        destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556386));
    end
    while (tile_contains_obj_pid(arg0, dude_elevation, 33556387) != 0) do begin
        destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556387));
    end
    while (tile_contains_obj_pid(arg0, dude_elevation, 33556388) != 0) do begin
        destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556388));
    end
    while (tile_contains_obj_pid(arg0, dude_elevation, 33556389) != 0) do begin
        destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556389));
    end
    LVar2 := arg0;
    LVar3 := 0;
    while (LVar3 < 2) do begin
        LVar2 := tile_num_in_direction(LVar2, 1, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 2) do begin
        LVar2 := tile_num_in_direction(LVar2, 2, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 2) do begin
        LVar2 := tile_num_in_direction(LVar2, 3, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 2) do begin
        LVar2 := tile_num_in_direction(LVar2, 4, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 5, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 4, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 5, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 4, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 5, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 4, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 0, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 5, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 2) do begin
        LVar2 := tile_num_in_direction(LVar2, 0, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 1, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 2, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar2 := tile_num_in_direction(tile_num_in_direction(arg0, 5, 2), 4, 1);
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 1, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    LVar3 := 0;
    while (LVar3 < 1) do begin
        LVar2 := tile_num_in_direction(LVar2, 2, 1);
        while (tile_contains_obj_pid(LVar2, dude_elevation, 33554499)) do begin
            LVar5 := tile_contains_pid_obj(LVar2, dude_elevation, 33554499);
            destroy_object(LVar5);
        end
        LVar3 := LVar3 + 1;
    end
    if (party_member_obj(831) != 0) then begin
        set_obj_visibility(party_member_obj(831), 1);
    end
    if (party_member_obj(455) != 0) then begin
        set_obj_visibility(party_member_obj(455), 1);
    end
    if (party_member_obj(832) != 0) then begin
        set_obj_visibility(party_member_obj(832), 1);
    end
    if (party_member_obj(833) != 0) then begin
        set_obj_visibility(party_member_obj(833), 1);
    end
    if (party_member_obj(834) != 0) then begin
        set_obj_visibility(party_member_obj(834), 1);
    end
    if (party_member_obj(835) != 0) then begin
        set_obj_visibility(party_member_obj(835), 1);
    end
    if (party_member_obj(836) != 0) then begin
        set_obj_visibility(party_member_obj(836), 1);
    end
    set_obj_visibility(self_obj, 1);
end

procedure Place_Car(variable arg0)
begin
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    variable LVar4 := 0;
    variable LVar5 := 0;
    variable LVar6 := 0;
    set_global_var(GVAR_NOWA_KARMA2, cur_map_index);
    while (global_var(GVAR_CAR_PLACED_TILE) != Get_Car_Hex()) do begin
        set_global_var(GVAR_CAR_PLACED_TILE, Get_Car_Hex());
    end
    while (global_var(GVAR_CAR_CURRENT_TOWN) != cur_map_index) do begin
        set_global_var(GVAR_CAR_CURRENT_TOWN, cur_map_index);
    end
    while (global_var(GVAR_CAR_HAS_BEEN_DRIVEN) != dude_elevation) do begin
        set_global_var(GVAR_CAR_HAS_BEEN_DRIVEN, dude_elevation);
    end
    while (global_var(GVAR_ABANDONED_MAP_252_CLEARED) != Get_Current_Town()) do begin
        set_global_var(GVAR_ABANDONED_MAP_252_CLEARED, Get_Current_Town());
    end
    if (not(tile_contains_pid_obj(arg0, dude_elevation, 33556384) != 0) and (global_var(GVAR_CAR_CURRENT_ELEVATION) == 0) or (not(tile_contains_pid_obj(arg0, dude_elevation, 33555441) != 0) and (global_var(GVAR_CAR_CURRENT_ELEVATION) == 1)) or (not(tile_contains_pid_obj(arg0, dude_elevation, 33556385) != 0) and (global_var(GVAR_CAR_CURRENT_ELEVATION) == 2)) or (not(tile_contains_pid_obj(arg0, dude_elevation, 33556386) != 0) and (global_var(GVAR_CAR_CURRENT_ELEVATION) == 3)) or (not(tile_contains_pid_obj(arg0, dude_elevation, 33556387) != 0) and (global_var(GVAR_CAR_CURRENT_ELEVATION) == 4)) or (not(tile_contains_pid_obj(arg0, dude_elevation, 33556388) != 0) and (global_var(GVAR_CAR_CURRENT_ELEVATION) == 5)) or (not(tile_contains_pid_obj(arg0, dude_elevation, 33556389) != 0) and (global_var(GVAR_CAR_CURRENT_ELEVATION) == 6))) then begin
        if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 0) then begin
            if (not(tile_contains_pid_obj(arg0, dude_elevation, 33556384) != 0)) then begin
                LVar1 := create_object_sid(33556384, arg0, dude_elevation, SCRIPT_ZSDRVCAR);
            end
        end
        else begin
            while (tile_contains_obj_pid(arg0, dude_elevation, 33556384) != 0) do begin
                destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556384));
            end
        end
        if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 1) then begin
            if (not(tile_contains_pid_obj(arg0, dude_elevation, 33555441) != 0)) then begin
                destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33555441));
            end
            LVar1 := create_object_sid(33555441, arg0, dude_elevation, SCRIPT_ZSDRVCAR);
        end
        else begin
            while (tile_contains_obj_pid(arg0, dude_elevation, 33555441) != 0) do begin
                destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33555441));
            end
        end
        if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 2) then begin
            if (not(tile_contains_pid_obj(arg0, dude_elevation, 33556385) != 0)) then begin
                LVar1 := create_object_sid(33556385, arg0, dude_elevation, SCRIPT_ZSDRVCAR);
            end
        end
        else begin
            while (tile_contains_obj_pid(arg0, dude_elevation, 33556385) != 0) do begin
                destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556385));
            end
        end
        if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 3) then begin
            if (not(tile_contains_pid_obj(arg0, dude_elevation, 33556386) != 0)) then begin
                LVar1 := create_object_sid(33556386, arg0, dude_elevation, SCRIPT_ZSDRVCAR);
            end
        end
        else begin
            while (tile_contains_obj_pid(arg0, dude_elevation, 33556386) != 0) do begin
                destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556386));
            end
        end
        if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 4) then begin
            if (not(tile_contains_pid_obj(arg0, dude_elevation, 33556387) != 0)) then begin
                LVar1 := create_object_sid(33556387, arg0, dude_elevation, SCRIPT_ZSDRVCAR);
            end
        end
        else begin
            while (tile_contains_obj_pid(arg0, dude_elevation, 33556387) != 0) do begin
                destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556387));
            end
        end
        if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 5) then begin
            if (not(tile_contains_pid_obj(arg0, dude_elevation, 33556388) != 0)) then begin
                LVar1 := create_object_sid(33556388, arg0, dude_elevation, SCRIPT_ZSDRVCAR);
            end
        end
        else begin
            while (tile_contains_obj_pid(arg0, dude_elevation, 33556388) != 0) do begin
                destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556388));
            end
        end
        if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 6) then begin
            if (not(tile_contains_pid_obj(arg0, dude_elevation, 33556389) != 0)) then begin
                LVar1 := create_object_sid(33556389, arg0, dude_elevation, SCRIPT_ZSDRVCAR);
            end
        end
        else begin
            while (tile_contains_obj_pid(arg0, dude_elevation, 33556389) != 0) do begin
                destroy_object(tile_contains_pid_obj(arg0, dude_elevation, 33556389));
            end
        end
        LVar2 := arg0;
        LVar3 := 0;
        while (LVar3 < 2) do begin
            LVar2 := tile_num_in_direction(LVar2, 1, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 2) do begin
            LVar2 := tile_num_in_direction(LVar2, 2, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 2) do begin
            LVar2 := tile_num_in_direction(LVar2, 3, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 2) do begin
            LVar2 := tile_num_in_direction(LVar2, 4, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 5, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 4, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 5, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 4, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 5, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 4, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 0, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 5, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 2) do begin
            LVar2 := tile_num_in_direction(LVar2, 0, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 1, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar3 := 0;
        while (LVar3 < 1) do begin
            LVar2 := tile_num_in_direction(LVar2, 2, 1);
            LVar1 := create_object(33554499, LVar2, dude_elevation);
            if (tile_num(LVar1) != LVar2) then begin
                destroy_object(LVar1);
            end
            LVar3 := LVar3 + 1;
        end
        LVar6 := tile_num_in_direction(tile_num_in_direction(arg0, 5, 2), 4, 1);
        if (tile_contains_pid_obj(arg0, dude_elevation, 33556384) != 0) then begin
            LVar5 := 0;
            if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 0) then begin
                if (party_member_obj(831) != 0) then begin
                    LVar5 := party_member_obj(831);
                end
                else begin
                    if (not(tile_contains_pid_obj(LVar6, dude_elevation, 831) != 0)) then begin
                        while (tile_contains_obj_pid(LVar6, dude_elevation, 831) != 0) do begin
                            destroy_object(tile_contains_pid_obj(LVar6, dude_elevation, 831));
                            LVar5 := LVar5 + 1;
                        end
                        LVar5 := create_object_sid(831, 0, 0, SCRIPT_ZICRTRNK);
                        party_add(LVar5);
                    end
                end
            end
            else begin
                set_obj_visibility(party_member_obj(831), 1);
            end
        end
        if (tile_contains_pid_obj(arg0, dude_elevation, 33555441) != 0) then begin
            if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 1) then begin
                if (party_member_obj(455) != 0) then begin
                    LVar5 := party_member_obj(455);
                end
                else begin
                    if (not(tile_contains_pid_obj(LVar6, dude_elevation, 455) != 0)) then begin
                        while (tile_contains_obj_pid(LVar6, dude_elevation, 455) != 0) do begin
                            destroy_object(tile_contains_pid_obj(LVar6, dude_elevation, 455));
                            LVar5 := LVar5 + 1;
                        end
                        LVar5 := create_object_sid(455, 0, 0, SCRIPT_ZICRTRNK);
                        party_add(LVar5);
                    end
                end
            end
            else begin
                set_obj_visibility(party_member_obj(455), 1);
            end
        end
        if (tile_contains_pid_obj(arg0, dude_elevation, 33556385) != 0) then begin
            if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 2) then begin
                if (party_member_obj(832) != 0) then begin
                    LVar5 := party_member_obj(832);
                end
                else begin
                    if (not(tile_contains_pid_obj(LVar6, dude_elevation, 832) != 0)) then begin
                        while (tile_contains_obj_pid(LVar6, dude_elevation, 832) != 0) do begin
                            destroy_object(tile_contains_pid_obj(LVar6, dude_elevation, 832));
                            LVar5 := LVar5 + 1;
                        end
                        LVar5 := create_object_sid(832, 0, 0, SCRIPT_ZICRTRNK);
                        party_add(LVar5);
                    end
                end
            end
            else begin
                set_obj_visibility(party_member_obj(832), 1);
            end
        end
        if (tile_contains_pid_obj(arg0, dude_elevation, 33556386) != 0) then begin
            if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 3) then begin
                if (party_member_obj(833) != 0) then begin
                    LVar5 := party_member_obj(833);
                end
                else begin
                    if (not(tile_contains_pid_obj(LVar6, dude_elevation, 833) != 0)) then begin
                        while (tile_contains_obj_pid(LVar6, dude_elevation, 833) != 0) do begin
                            destroy_object(tile_contains_pid_obj(LVar6, dude_elevation, 833));
                            LVar5 := LVar5 + 1;
                        end
                        LVar5 := create_object_sid(833, 0, 0, SCRIPT_ZICRTRNK);
                        party_add(LVar5);
                    end
                end
            end
            else begin
                set_obj_visibility(party_member_obj(833), 1);
            end
        end
        if (tile_contains_pid_obj(arg0, dude_elevation, 33556387) != 0) then begin
            if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 4) then begin
                if (party_member_obj(834) != 0) then begin
                    LVar5 := party_member_obj(834);
                end
                else begin
                    if (not(tile_contains_pid_obj(LVar6, dude_elevation, 834) != 0)) then begin
                        while (tile_contains_obj_pid(LVar6, dude_elevation, 834) != 0) do begin
                            destroy_object(tile_contains_pid_obj(LVar6, dude_elevation, 834));
                            LVar5 := LVar5 + 1;
                        end
                        LVar5 := create_object_sid(834, 0, 0, SCRIPT_ZICRTRNK);
                        party_add(LVar5);
                    end
                end
            end
            else begin
                set_obj_visibility(party_member_obj(834), 1);
            end
        end
        if (tile_contains_pid_obj(arg0, dude_elevation, 33556388) != 0) then begin
            if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 5) then begin
                if (party_member_obj(835) != 0) then begin
                    LVar5 := party_member_obj(835);
                end
                else begin
                    if (not(tile_contains_pid_obj(LVar6, dude_elevation, 835) != 0)) then begin
                        while (tile_contains_obj_pid(LVar6, dude_elevation, 835) != 0) do begin
                            destroy_object(tile_contains_pid_obj(LVar6, dude_elevation, 835));
                            LVar5 := LVar5 + 1;
                        end
                        LVar5 := create_object_sid(835, 0, 0, SCRIPT_ZICRTRNK);
                        party_add(LVar5);
                    end
                end
            end
            else begin
                set_obj_visibility(party_member_obj(835), 1);
            end
        end
        if (tile_contains_pid_obj(arg0, dude_elevation, 33556389) != 0) then begin
            if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 6) then begin
                if (party_member_obj(836) != 0) then begin
                    LVar5 := party_member_obj(836);
                end
                else begin
                    if (not(tile_contains_pid_obj(LVar6, dude_elevation, 836) != 0)) then begin
                        while (tile_contains_obj_pid(LVar6, dude_elevation, 836) != 0) do begin
                            destroy_object(tile_contains_pid_obj(LVar6, dude_elevation, 836));
                            LVar5 := LVar5 + 1;
                        end
                        LVar5 := create_object_sid(836, 0, 0, SCRIPT_ZICRTRNK);
                        party_add(LVar5);
                    end
                end
            end
            else begin
                set_obj_visibility(party_member_obj(836), 1);
            end
        end
        if (LVar5 != 0) then begin
            LVar2 := LVar6;
            move_to(LVar5, LVar2, 0);
            set_obj_visibility(LVar5, 0);
            LVar3 := 0;
            while (LVar3 < 1) do begin
                LVar2 := tile_num_in_direction(LVar2, 1, 1);
                LVar1 := create_object(33554499, LVar2, dude_elevation);
                if (tile_num(LVar1) != LVar2) then begin
                    destroy_object(LVar1);
                end
                LVar3 := LVar3 + 1;
            end
            LVar3 := 0;
            while (LVar3 < 1) do begin
                LVar2 := tile_num_in_direction(LVar2, 2, 1);
                LVar1 := create_object(33554499, LVar2, dude_elevation);
                if (tile_num(LVar1) != LVar2) then begin
                    destroy_object(LVar1);
                end
                LVar3 := LVar3 + 1;
            end
        end
    end
    set_global_var(GVAR_NOWA_KARMA2, cur_map_index);
    while (global_var(GVAR_CAR_PLACED_TILE) != Get_Car_Hex()) do begin
        set_global_var(GVAR_CAR_PLACED_TILE, Get_Car_Hex());
    end
    while (global_var(GVAR_CAR_CURRENT_TOWN) != cur_map_index) do begin
        set_global_var(GVAR_CAR_CURRENT_TOWN, cur_map_index);
    end
    while (global_var(GVAR_CAR_HAS_BEEN_DRIVEN) != dude_elevation) do begin
        set_global_var(GVAR_CAR_HAS_BEEN_DRIVEN, dude_elevation);
    end
    while (global_var(GVAR_ABANDONED_MAP_252_CLEARED) != Get_Current_Town()) do begin
        set_global_var(GVAR_ABANDONED_MAP_252_CLEARED, Get_Current_Town());
    end
    call Update_Trunk();
end

procedure Get_Car_Hex
begin
    if (CUR_MAP_DESERT1) then begin
        return 19094;
    end
    else begin
        if (CUR_MAP_A12) then begin
            return 11508;
        end
        else begin
            if (CUR_MAP_A10) then begin
                return 21273;
            end
            else begin
                if (CUR_MAP_EPAENT) then begin
                    return 22713;
                end
                else begin
                    if (CUR_MAP_ARDEAD) then begin
                        return 27312;
                    end
                    else begin
                        if (CUR_MAP_CRSNMAIN) then begin
                            return 19144;
                        end
                        else begin
                            if (CUR_MAP_DENBUS1) then begin
                                if ((global_var(GVAR_ABANDONED_MAP_251_CLEARED) == 1) and (global_var(GVAR_PLAYER_GOT_CAR) != 0)) then begin
                                    return 11687;
                                end
                                else begin
                                    if ((global_var(GVAR_PLAYER_GOT_CAR) == 0) or ((global_var(GVAR_ABANDONED_MAP_251_CLEARED) == 0) and (global_var(GVAR_PLAYER_GOT_CAR) != 0))) then begin
                                        return 24548;
                                    end
                                end
                            end
                            else begin
                                if (CUR_MAP_DENBUS2) then begin
                                    return 29103;
                                end
                                else begin
                                    if (CUR_MAP_ABBEY) then begin
                                        return 22321;
                                    end
                                    else begin
                                        if (CUR_MAP_ARBRIDGE) then begin
                                            return 27312;
                                        end
                                        else begin
                                            if (CUR_MAP_ARDEAD) then begin
                                                return 27313;
                                            end
                                            else begin
                                                if (CUR_MAP_B21) then begin
                                                    return 24916;
                                                end
                                                else begin
                                                    if (CUR_MAP_BROKEN1) then begin
                                                        return 17752;
                                                    end
                                                    else begin
                                                        if (CUR_MAP_COLLY) then begin
                                                            return 26097;
                                                        end
                                                        else begin
                                                            if (CUR_MAP_DEPOLV1) then begin
                                                                return 28699;
                                                            end
                                                            else begin
                                                                if (CUR_MAP_EPAX) then begin
                                                                    return 18242;
                                                                end
                                                                else begin
                                                                    if (CUR_MAP_GECKSETL) then begin
                                                                        return 25709;
                                                                    end
                                                                    else begin
                                                                        if (CUR_MAP_GSTFARM) then begin
                                                                            return 23951;
                                                                        end
                                                                        else begin
                                                                            if (CUR_MAP_JENFARM7) then begin
                                                                                return 9483;
                                                                            end
                                                                            else begin
                                                                                if (CUR_MAP_KLADWTWN) then begin
                                                                                    return 25669;
                                                                                end
                                                                                else begin
                                                                                    if (CUR_MAP_KLATOXCV) then begin
                                                                                        return 19943;
                                                                                    end
                                                                                    else begin
                                                                                        if (CUR_MAP_LARS1) then begin
                                                                                            return 22677;
                                                                                        end
                                                                                        else begin
                                                                                            if (CUR_MAP_LARS3) then begin
                                                                                                return 30696;
                                                                                            end
                                                                                            else begin
                                                                                                if (CUR_MAP_MBCLOSE) then begin
                                                                                                    return 22146;
                                                                                                end
                                                                                                else begin
                                                                                                    if (CUR_MAP_MODMAIN) then begin
                                                                                                        return 24531;
                                                                                                    end
                                                                                                    else begin
                                                                                                        if (CUR_MAP_NAVARRO) then begin
                                                                                                            return 28888;
                                                                                                        end
                                                                                                        else begin
                                                                                                            if (CUR_MAP_NCRENT) then begin
                                                                                                                return 23078;
                                                                                                            end
                                                                                                            else begin
                                                                                                                if (CUR_MAP_NEWR1) then begin
                                                                                                                    return 25321;
                                                                                                                end
                                                                                                                else begin
                                                                                                                    if (CUR_MAP_NEWR2) then begin
                                                                                                                        return 9509;
                                                                                                                    end
                                                                                                                    else begin
                                                                                                                        if (CUR_MAP_NEWR3) then begin
                                                                                                                            return 30894;
                                                                                                                        end
                                                                                                                        else begin
                                                                                                                            if (CUR_MAP_NEWR4) then begin
                                                                                                                                return 16068;
                                                                                                                            end
                                                                                                                            else begin
                                                                                                                                if (CUR_MAP_NEWRCS) then begin
                                                                                                                                    return 18699;
                                                                                                                                end
                                                                                                                                else begin
                                                                                                                                    if (CUR_MAP_NEWRGO) then begin
                                                                                                                                        return 22500;
                                                                                                                                    end
                                                                                                                                    else begin
                                                                                                                                        if (CUR_MAP_NEWRST) then begin
                                                                                                                                            return 26506;
                                                                                                                                        end
                                                                                                                                        else begin
                                                                                                                                            if (CUR_MAP_RAIDERS1) then begin
                                                                                                                                                if (dude_elevation == 0) then begin
                                                                                                                                                    return 25304;
                                                                                                                                                end
                                                                                                                                                else begin
                                                                                                                                                    if (dude_elevation == 1) then begin
                                                                                                                                                        return 21298;
                                                                                                                                                    end
                                                                                                                                                end
                                                                                                                                            end
                                                                                                                                            else begin
                                                                                                                                                if (CUR_MAP_REDDOWN) then begin
                                                                                                                                                    return 18650;
                                                                                                                                                end
                                                                                                                                                else begin
                                                                                                                                                    if (CUR_MAP_RNDMDDG) then begin
                                                                                                                                                        return 19506;
                                                                                                                                                    end
                                                                                                                                                    else begin
                                                                                                                                                        if (CUR_MAP_SCRAPT) then begin
                                                                                                                                                            return 26515;
                                                                                                                                                        end
                                                                                                                                                        else begin
                                                                                                                                                            if (CUR_MAP_SFCHINA) then begin
                                                                                                                                                                return 31699;
                                                                                                                                                            end
                                                                                                                                                            else begin
                                                                                                                                                                if (CUR_MAP_SLVCAMP) then begin
                                                                                                                                                                    return 21895;
                                                                                                                                                                end
                                                                                                                                                                else begin
                                                                                                                                                                    if (CUR_MAP_GLOWENT) then begin
                                                                                                                                                                        return 22737;
                                                                                                                                                                    end
                                                                                                                                                                    else begin
                                                                                                                                                                        if (CUR_MAP_TRIBE01) then begin
                                                                                                                                                                            return 29487;
                                                                                                                                                                        end
                                                                                                                                                                        else begin
                                                                                                                                                                            if (CUR_MAP_TRUCK) then begin
                                                                                                                                                                                return 23132;
                                                                                                                                                                            end
                                                                                                                                                                            else begin
                                                                                                                                                                                if (CUR_MAP_V13ENT) then begin
                                                                                                                                                                                    return 26354;
                                                                                                                                                                                end
                                                                                                                                                                                else begin
                                                                                                                                                                                    if (CUR_MAP_V14ENT) then begin
                                                                                                                                                                                        return 19105;
                                                                                                                                                                                    end
                                                                                                                                                                                    else begin
                                                                                                                                                                                        if (CUR_MAP_V15ENT) then begin
                                                                                                                                                                                            if ((global_var(GVAR_V15_NCR_DEAL) == 2) and global_var(GVAR_NCR_V15_DARION_DEAD)) then begin
                                                                                                                                                                                                return 29718;
                                                                                                                                                                                            end
                                                                                                                                                                                            else begin
                                                                                                                                                                                                return 26932;
                                                                                                                                                                                            end
                                                                                                                                                                                        end
                                                                                                                                                                                        else begin
                                                                                                                                                                                            if (CUR_MAP_VCTYCTYD) then begin
                                                                                                                                                                                                return 28899;
                                                                                                                                                                                            end
                                                                                                                                                                                            else begin
                                                                                                                                                                                                if (CUR_MAP_CRISIENT) then begin
                                                                                                                                                                                                    return 18697;
                                                                                                                                                                                                end
                                                                                                                                                                                                else begin
                                                                                                                                                                                                    if (CUR_MAP_MODOCT2) then begin
                                                                                                                                                                                                        return 26298;
                                                                                                                                                                                                    end
                                                                                                                                                                                                    else begin
                                                                                                                                                                                                        if (CUR_MAP_BROHDENT) then begin
                                                                                                                                                                                                            return 28313;
                                                                                                                                                                                                        end
                                                                                                                                                                                                        else begin
                                                                                                                                                                                                            if (CUR_MAP_BREAKDWN) then begin
                                                                                                                                                                                                                return 18518;
                                                                                                                                                                                                            end
                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                if (CUR_MAP_ABANDON3) then begin
                                                                                                                                                                                                                    return 23754;
                                                                                                                                                                                                                end
                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                    if (CUR_MAP_BHRNDDST) then begin
                                                                                                                                                                                                                        return 18909;
                                                                                                                                                                                                                    end
                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                        if (CUR_MAP_BHRNDMNT) then begin
                                                                                                                                                                                                                            return 18909;
                                                                                                                                                                                                                        end
                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                            if (CUR_MAP_BRHDHLP) then begin
                                                                                                                                                                                                                                return 25104;
                                                                                                                                                                                                                            end
                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                if (CUR_MAP_RNDPOSTM) then begin
                                                                                                                                                                                                                                    return 17890;
                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                    if (CUR_MAP_RNDBD) then begin
                                                                                                                                                                                                                                        return 26503;
                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                        if (CUR_MAP_RNDBHEAD) then begin
                                                                                                                                                                                                                                            return 22726;
                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                            if (CUR_MAP_RNDBRIDG) then begin
                                                                                                                                                                                                                                                return 18095;
                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                if (CUR_MAP_RNDCAFE) then begin
                                                                                                                                                                                                                                                    return 23903;
                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                    if (CUR_MAP_RNDEXCOW) then begin
                                                                                                                                                                                                                                                        return 18889;
                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                        if (CUR_MAP_RNDFORVR) then begin
                                                                                                                                                                                                                                                            return 18904;
                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                            if (CUR_MAP_RNDHOLY1) then begin
                                                                                                                                                                                                                                                                return 21936;
                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                if (CUR_MAP_RNDHOLY2) then begin
                                                                                                                                                                                                                                                                    return 20880;
                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDMSTR) then begin
                                                                                                                                                                                                                                                                        return 19898;
                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                        if (CUR_MAP_RNDPARIH) then begin
                                                                                                                                                                                                                                                                            return 23125;
                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                            if (CUR_MAP_RNDSHUTL) then begin
                                                                                                                                                                                                                                                                                return 20702;
                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                if (CUR_MAP_RNDTINWD) then begin
                                                                                                                                                                                                                                                                                    return 18724;
                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDTOXIC) then begin
                                                                                                                                                                                                                                                                                        return 22101;
                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                        if (CUR_MAP_RNDUVILG) then begin
                                                                                                                                                                                                                                                                                            return 19095;
                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                            if (CUR_MAP_RNDWHALE) then begin
                                                                                                                                                                                                                                                                                                return 23109;
                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                if (CUR_MAP_CAVE0) then begin
                                                                                                                                                                                                                                                                                                    return 18909;
                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CAVE1) then begin
                                                                                                                                                                                                                                                                                                        return 26508;
                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CAVE2) then begin
                                                                                                                                                                                                                                                                                                            return 24706;
                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CAVE3) then begin
                                                                                                                                                                                                                                                                                                                return 24915;
                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CAVE4) then begin
                                                                                                                                                                                                                                                                                                                    return 27512;
                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CAVE5) then begin
                                                                                                                                                                                                                                                                                                                        return 26292;
                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_GAMMOVIE) then begin
                                                                                                                                                                                                                                                                                                                            return 25523;
                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_RNDBESS) then begin
                                                                                                                                                                                                                                                                                                                                return 27318;
                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST1) then begin
                                                                                                                                                                                                                                                                                                                                    return 18086;
                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST2) then begin
                                                                                                                                                                                                                                                                                                                                        return 19089;
                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST3) then begin
                                                                                                                                                                                                                                                                                                                                            return 19279;
                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST4) then begin
                                                                                                                                                                                                                                                                                                                                                return 19278;
                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST5) then begin
                                                                                                                                                                                                                                                                                                                                                    return 23500;
                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST6) then begin
                                                                                                                                                                                                                                                                                                                                                        return 22291;
                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST7) then begin
                                                                                                                                                                                                                                                                                                                                                            return 16518;
                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST8) then begin
                                                                                                                                                                                                                                                                                                                                                                return 23718;
                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST9) then begin
                                                                                                                                                                                                                                                                                                                                                                    return 21107;
                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST10) then begin
                                                                                                                                                                                                                                                                                                                                                                        return 17919;
                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST11) then begin
                                                                                                                                                                                                                                                                                                                                                                            return 20079;
                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_07DESERT) then begin
                                                                                                                                                                                                                                                                                                                                                                                return 25515;
                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_GAMMOVIE) then begin
                                                                                                                                                                                                                                                                                                                                                                                    return 19096;
                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESERT2) then begin
                                                                                                                                                                                                                                                                                                                                                                                        return 19094;
                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESERT3) then begin
                                                                                                                                                                                                                                                                                                                                                                                            return 18894;
                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                return 19718;
                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESERT5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                    return 24112;
                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESERT6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                        return 18914;
                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESERT7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                            return 24525;
                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT8) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                return 17890;
                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESERT9) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                    return 22880;
                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESRT10) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                        return 22880;
                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESRT11) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                            return 20692;
                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESRT12) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                return 21308;
                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CITY1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                    return 12693;
                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CITY2) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                        return 9898;
                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CITY3) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                            return 23542;
                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CITY4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                return 28089;
                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CITY5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                    return 20464;
                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CITY6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                        return 29496;
                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CITY7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                            return 19535;
                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CITY8) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                return 21702;
                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CAVE6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return 21681;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CAVE7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        return 19078;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_MOUNTN1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return 17875;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_MOUNTN2) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                return 17876;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_MOUNTN3) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return 19478;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_MOUNTN4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        return 19099;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_MOUNTN5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return 20678;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_MOUNTN6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                return 20073;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CARDESRT) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return 19100;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return -1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                end
                                                                                                                                                                                                                            end
                                                                                                                                                                                                                        end
                                                                                                                                                                                                                    end
                                                                                                                                                                                                                end
                                                                                                                                                                                                            end
                                                                                                                                                                                                        end
                                                                                                                                                                                                    end
                                                                                                                                                                                                end
                                                                                                                                                                                            end
                                                                                                                                                                                        end
                                                                                                                                                                                    end
                                                                                                                                                                                end
                                                                                                                                                                            end
                                                                                                                                                                        end
                                                                                                                                                                    end
                                                                                                                                                                end
                                                                                                                                                            end
                                                                                                                                                        end
                                                                                                                                                    end
                                                                                                                                                end
                                                                                                                                            end
                                                                                                                                        end
                                                                                                                                    end
                                                                                                                                end
                                                                                                                            end
                                                                                                                        end
                                                                                                                    end
                                                                                                                end
                                                                                                            end
                                                                                                        end
                                                                                                    end
                                                                                                end
                                                                                            end
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
end

procedure Get_Current_Town
begin
    if (CUR_MAP_ARDEAD) then begin
        return 22;
    end
    else begin
        if (CUR_MAP_CRSNMAIN) then begin
            return 78;
        end
        else begin
            if (CUR_MAP_DENBUS1) then begin
                return 1;
            end
            else begin
                if (CUR_MAP_DENBUS2) then begin
                    return 1;
                end
                else begin
                    if (CUR_MAP_ABBEY) then begin
                        return 52;
                    end
                    else begin
                        if (CUR_MAP_ARBRIDGE) then begin
                            return 0;
                        end
                        else begin
                            if (CUR_MAP_ARDEAD) then begin
                                return 0;
                            end
                            else begin
                                if (CUR_MAP_B21) then begin
                                    return 51;
                                end
                                else begin
                                    if (CUR_MAP_BROKEN1) then begin
                                        return 6;
                                    end
                                    else begin
                                        if (CUR_MAP_COLLY) then begin
                                            return 73;
                                        end
                                        else begin
                                            if (CUR_MAP_DEPOLV1) then begin
                                                return 8;
                                            end
                                            else begin
                                                if (CUR_MAP_EPAX) then begin
                                                    return 49;
                                                end
                                                else begin
                                                    if (CUR_MAP_GECKSETL) then begin
                                                        return 5;
                                                    end
                                                    else begin
                                                        if (CUR_MAP_GSTFARM) then begin
                                                            return 20;
                                                        end
                                                        else begin
                                                            if (CUR_MAP_JENFARM7) then begin
                                                                return 17;
                                                            end
                                                            else begin
                                                                if (CUR_MAP_KLADWTWN) then begin
                                                                    return 2;
                                                                end
                                                                else begin
                                                                    if (CUR_MAP_KLATOXCV) then begin
                                                                        return 23;
                                                                    end
                                                                    else begin
                                                                        if (CUR_MAP_LARS1) then begin
                                                                            return 67;
                                                                        end
                                                                        else begin
                                                                            if (CUR_MAP_LARS3) then begin
                                                                                return 68;
                                                                            end
                                                                            else begin
                                                                                if (CUR_MAP_MBCLOSE) then begin
                                                                                    return 12;
                                                                                end
                                                                                else begin
                                                                                    if (CUR_MAP_MODMAIN) then begin
                                                                                        return 3;
                                                                                    end
                                                                                    else begin
                                                                                        if (CUR_MAP_NCRENT) then begin
                                                                                            return 10;
                                                                                        end
                                                                                        else begin
                                                                                            if (CUR_MAP_NEWR1) then begin
                                                                                                return 7;
                                                                                            end
                                                                                            else begin
                                                                                                if (CUR_MAP_NEWR2) then begin
                                                                                                    return 7;
                                                                                                end
                                                                                                else begin
                                                                                                    if (CUR_MAP_NEWR3) then begin
                                                                                                        return 7;
                                                                                                    end
                                                                                                    else begin
                                                                                                        if (CUR_MAP_NEWR4) then begin
                                                                                                            return 7;
                                                                                                        end
                                                                                                        else begin
                                                                                                            if (CUR_MAP_NEWRCS) then begin
                                                                                                                return 7;
                                                                                                            end
                                                                                                            else begin
                                                                                                                if (CUR_MAP_NEWRGO) then begin
                                                                                                                    return 30;
                                                                                                                end
                                                                                                                else begin
                                                                                                                    if (CUR_MAP_NEWRST) then begin
                                                                                                                        return 48;
                                                                                                                    end
                                                                                                                    else begin
                                                                                                                        if (CUR_MAP_RAIDERS1) then begin
                                                                                                                            return 25;
                                                                                                                        end
                                                                                                                        else begin
                                                                                                                            if (CUR_MAP_REDDOWN) then begin
                                                                                                                                return 13;
                                                                                                                            end
                                                                                                                            else begin
                                                                                                                                if (CUR_MAP_RNDMDDG) then begin
                                                                                                                                    return 18;
                                                                                                                                end
                                                                                                                                else begin
                                                                                                                                    if (CUR_MAP_SCRAPT) then begin
                                                                                                                                        return 53;
                                                                                                                                    end
                                                                                                                                    else begin
                                                                                                                                        if (CUR_MAP_SFCHINA) then begin
                                                                                                                                            return 14;
                                                                                                                                        end
                                                                                                                                        else begin
                                                                                                                                            if (CUR_MAP_SLVCAMP) then begin
                                                                                                                                                return 87;
                                                                                                                                            end
                                                                                                                                            else begin
                                                                                                                                                if (CUR_MAP_GLOWENT) then begin
                                                                                                                                                    return 58;
                                                                                                                                                end
                                                                                                                                                else begin
                                                                                                                                                    if (CUR_MAP_TRIBE01) then begin
                                                                                                                                                        return 54;
                                                                                                                                                    end
                                                                                                                                                    else begin
                                                                                                                                                        if (CUR_MAP_TRUCK) then begin
                                                                                                                                                            return 50;
                                                                                                                                                        end
                                                                                                                                                        else begin
                                                                                                                                                            if (CUR_MAP_V13ENT) then begin
                                                                                                                                                                return 11;
                                                                                                                                                            end
                                                                                                                                                            else begin
                                                                                                                                                                if (CUR_MAP_V14ENT) then begin
                                                                                                                                                                    return 72;
                                                                                                                                                                end
                                                                                                                                                                else begin
                                                                                                                                                                    if (CUR_MAP_V15ENT) then begin
                                                                                                                                                                        return 9;
                                                                                                                                                                    end
                                                                                                                                                                    else begin
                                                                                                                                                                        if (CUR_MAP_VCTYCTYD) then begin
                                                                                                                                                                            return 4;
                                                                                                                                                                        end
                                                                                                                                                                        else begin
                                                                                                                                                                            if (CUR_MAP_CRISIENT) then begin
                                                                                                                                                                                return 56;
                                                                                                                                                                            end
                                                                                                                                                                            else begin
                                                                                                                                                                                if (CUR_MAP_MODOCT2) then begin
                                                                                                                                                                                    return 75;
                                                                                                                                                                                end
                                                                                                                                                                                else begin
                                                                                                                                                                                    if (CUR_MAP_BROHDENT) then begin
                                                                                                                                                                                        return 81;
                                                                                                                                                                                    end
                                                                                                                                                                                    else begin
                                                                                                                                                                                        if (CUR_MAP_EPAENT) then begin
                                                                                                                                                                                            return 83;
                                                                                                                                                                                        end
                                                                                                                                                                                        else begin
                                                                                                                                                                                            if (CUR_MAP_NAVARRO) then begin
                                                                                                                                                                                                return 15;
                                                                                                                                                                                            end
                                                                                                                                                                                            else begin
                                                                                                                                                                                                if (CUR_MAP_BREAKDWN) then begin
                                                                                                                                                                                                    return 89;
                                                                                                                                                                                                end
                                                                                                                                                                                                else begin
                                                                                                                                                                                                    if (CUR_MAP_ABANDON3) then begin
                                                                                                                                                                                                        return 88;
                                                                                                                                                                                                    end
                                                                                                                                                                                                    else begin
                                                                                                                                                                                                        if (CUR_MAP_BHRNDDST) then begin
                                                                                                                                                                                                            return 44;
                                                                                                                                                                                                        end
                                                                                                                                                                                                        else begin
                                                                                                                                                                                                            if (CUR_MAP_BHRNDMNT) then begin
                                                                                                                                                                                                                return 44;
                                                                                                                                                                                                            end
                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                if (CUR_MAP_BRHDHLP) then begin
                                                                                                                                                                                                                    return 82;
                                                                                                                                                                                                                end
                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                    if (CUR_MAP_CARDESRT) then begin
                                                                                                                                                                                                                        return 21;
                                                                                                                                                                                                                    end
                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                        if (CUR_MAP_RNDPOSTM) then begin
                                                                                                                                                                                                                            return 55;
                                                                                                                                                                                                                        end
                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                            if (CUR_MAP_RNDBD) then begin
                                                                                                                                                                                                                                return 19;
                                                                                                                                                                                                                            end
                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                if (CUR_MAP_RNDBHEAD) then begin
                                                                                                                                                                                                                                    return 33;
                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                    if (CUR_MAP_RNDBRIDG) then begin
                                                                                                                                                                                                                                        return 36;
                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                        if (CUR_MAP_RNDCAFE) then begin
                                                                                                                                                                                                                                            return 37;
                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                            if (CUR_MAP_RNDEXCOW) then begin
                                                                                                                                                                                                                                                return 43;
                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                if (CUR_MAP_RNDFORVR) then begin
                                                                                                                                                                                                                                                    return 40;
                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                    if (CUR_MAP_RNDHOLY1) then begin
                                                                                                                                                                                                                                                        return 38;
                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                        if (CUR_MAP_RNDHOLY2) then begin
                                                                                                                                                                                                                                                            return 39;
                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                            if (CUR_MAP_RNDMSTR) then begin
                                                                                                                                                                                                                                                                return 71;
                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                if (CUR_MAP_RNDPARIH) then begin
                                                                                                                                                                                                                                                                    return 42;
                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDSHUTL) then begin
                                                                                                                                                                                                                                                                        return 34;
                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                        if (CUR_MAP_RNDTINWD) then begin
                                                                                                                                                                                                                                                                            return 32;
                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                            if (CUR_MAP_RNDTOXIC) then begin
                                                                                                                                                                                                                                                                                return 41;
                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                if (CUR_MAP_RNDUVILG) then begin
                                                                                                                                                                                                                                                                                    return 35;
                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDWHALE) then begin
                                                                                                                                                                                                                                                                                        return 31;
                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                        if (CUR_MAP_CAVE0) then begin
                                                                                                                                                                                                                                                                                            return 27;
                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                            if (CUR_MAP_CAVE1) then begin
                                                                                                                                                                                                                                                                                                return 27;
                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                if (CUR_MAP_CAVE2) then begin
                                                                                                                                                                                                                                                                                                    return 27;
                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CAVE3) then begin
                                                                                                                                                                                                                                                                                                        return 27;
                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CAVE4) then begin
                                                                                                                                                                                                                                                                                                            return 27;
                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CAVE5) then begin
                                                                                                                                                                                                                                                                                                                return 27;
                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                if (CUR_MAP_GAMMOVIE) then begin
                                                                                                                                                                                                                                                                                                                    return 47;
                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_RNDBESS) then begin
                                                                                                                                                                                                                                                                                                                        return 47;
                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST1) then begin
                                                                                                                                                                                                                                                                                                                            return 29;
                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST2) then begin
                                                                                                                                                                                                                                                                                                                                return 29;
                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST3) then begin
                                                                                                                                                                                                                                                                                                                                    return 29;
                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST4) then begin
                                                                                                                                                                                                                                                                                                                                        return 29;
                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST5) then begin
                                                                                                                                                                                                                                                                                                                                            return 29;
                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST6) then begin
                                                                                                                                                                                                                                                                                                                                                return 29;
                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST7) then begin
                                                                                                                                                                                                                                                                                                                                                    return 29;
                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_COAST8) then begin
                                                                                                                                                                                                                                                                                                                                                        return 29;
                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_COAST9) then begin
                                                                                                                                                                                                                                                                                                                                                            return 29;
                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_COAST10) then begin
                                                                                                                                                                                                                                                                                                                                                                return 29;
                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_COAST11) then begin
                                                                                                                                                                                                                                                                                                                                                                    return 47;
                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_07DESERT) then begin
                                                                                                                                                                                                                                                                                                                                                                        return 47;
                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_GAMMOVIE) then begin
                                                                                                                                                                                                                                                                                                                                                                            return 47;
                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT2) then begin
                                                                                                                                                                                                                                                                                                                                                                                return 26;
                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESERT3) then begin
                                                                                                                                                                                                                                                                                                                                                                                    return 26;
                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESERT4) then begin
                                                                                                                                                                                                                                                                                                                                                                                        return 26;
                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESERT5) then begin
                                                                                                                                                                                                                                                                                                                                                                                            return 26;
                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                return 26;
                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESERT7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                    return 26;
                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESERT8) then begin
                                                                                                                                                                                                                                                                                                                                                                                                        return 26;
                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_DESERT9) then begin
                                                                                                                                                                                                                                                                                                                                                                                                            return 26;
                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESRT10) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                return 26;
                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_DESRT11) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                    return 47;
                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_DESRT12) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                        return 47;
                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CITY1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                            return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CITY2) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CITY3) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                    return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CITY4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                        return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CITY5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                            return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CITY6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_CITY7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                    return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_CITY8) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                        return 28;
                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CAVE6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                            return 45;
                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_CAVE7) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                return 46;
                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_MOUNTN1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return 27;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_MOUNTN2) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        return 27;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_MOUNTN3) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return 27;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_MOUNTN4) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                return 27;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_MOUNTN5) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return 47;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_MOUNTN6) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        return 47;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (CUR_MAP_CARDESRT) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return 21;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (CUR_MAP_DESERT1) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                return 26;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (CUR_MAP_A10) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return 69;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (CUR_MAP_A12) then begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        return 66;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    else begin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        return -1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                                end
                                                                                                                                                                                                                                            end
                                                                                                                                                                                                                                        end
                                                                                                                                                                                                                                    end
                                                                                                                                                                                                                                end
                                                                                                                                                                                                                            end
                                                                                                                                                                                                                        end
                                                                                                                                                                                                                    end
                                                                                                                                                                                                                end
                                                                                                                                                                                                            end
                                                                                                                                                                                                        end
                                                                                                                                                                                                    end
                                                                                                                                                                                                end
                                                                                                                                                                                            end
                                                                                                                                                                                        end
                                                                                                                                                                                    end
                                                                                                                                                                                end
                                                                                                                                                                            end
                                                                                                                                                                        end
                                                                                                                                                                    end
                                                                                                                                                                end
                                                                                                                                                            end
                                                                                                                                                        end
                                                                                                                                                    end
                                                                                                                                                end
                                                                                                                                            end
                                                                                                                                        end
                                                                                                                                    end
                                                                                                                                end
                                                                                                                            end
                                                                                                                        end
                                                                                                                    end
                                                                                                                end
                                                                                                            end
                                                                                                        end
                                                                                                    end
                                                                                                end
                                                                                            end
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
end

procedure Mark_Town_Known(variable arg0)
begin
    if (arg0 == 198) then begin
        mark_area_known(MARK_TYPE_TOWN, 69, MARK_STATE_VISITED);
    end
    if (arg0 == 179) then begin
        mark_area_known(MARK_TYPE_TOWN, 66, MARK_STATE_VISITED);
    end
    if (arg0 == 242) then begin
        mark_area_known(MARK_TYPE_TOWN, 83, MARK_STATE_VISITED);
    end
    if (arg0 == 127) then begin
        mark_area_known(MARK_TYPE_TOWN, 22, MARK_STATE_VISITED);
    end
    if (arg0 == 232) then begin
        mark_area_known(MARK_TYPE_TOWN, 78, MARK_STATE_VISITED);
    end
    if (arg0 == 5) then begin
        mark_area_known(MARK_TYPE_TOWN, 0, MARK_STATE_VISITED);
    end
    if (arg0 == 22) then begin
        mark_area_known(MARK_TYPE_TOWN, 3, MARK_STATE_VISITED);
    end
    if (arg0 == 157) then begin
        mark_area_known(MARK_TYPE_TOWN, 51, MARK_STATE_VISITED);
    end
    if (arg0 == 238) then begin
        mark_area_known(MARK_TYPE_TOWN, 81, MARK_STATE_VISITED);
    end
    if (arg0 == 78) then begin
        mark_area_known(MARK_TYPE_TOWN, 6, MARK_STATE_VISITED);
    end
    if (arg0 == 220) then begin
        mark_area_known(MARK_TYPE_TOWN, 73, MARK_STATE_VISITED);
    end
    if (arg0 == 6) then begin
        mark_area_known(MARK_TYPE_TOWN, 1, MARK_STATE_VISITED);
    end
    if (arg0 == 7) then begin
        mark_area_known(MARK_TYPE_TOWN, 1, MARK_STATE_VISITED);
    end
    if (arg0 == 27) then begin
        mark_area_known(MARK_TYPE_TOWN, 8, MARK_STATE_VISITED);
    end
    if (arg0 == 151) then begin
        mark_area_known(MARK_TYPE_TOWN, 49, MARK_STATE_VISITED);
    end
    if (arg0 == 31) then begin
        mark_area_known(MARK_TYPE_TOWN, 5, MARK_STATE_VISITED);
    end
    if (arg0 == 24) then begin
        mark_area_known(MARK_TYPE_TOWN, 20, MARK_STATE_VISITED);
    end
    if (arg0 == 160) then begin
        mark_area_known(MARK_TYPE_TOWN, 17, MARK_STATE_VISITED);
    end
    if (arg0 == 9) then begin
        mark_area_known(MARK_TYPE_TOWN, 2, MARK_STATE_VISITED);
    end
    if (arg0 == 12) then begin
        mark_area_known(MARK_TYPE_TOWN, 23, MARK_STATE_VISITED);
    end
    if (arg0 == 195) then begin
        mark_area_known(MARK_TYPE_TOWN, 67, MARK_STATE_VISITED);
    end
    if (arg0 == 197) then begin
        mark_area_known(MARK_TYPE_TOWN, 68, MARK_STATE_VISITED);
    end
    if (arg0 == 51) then begin
        mark_area_known(MARK_TYPE_TOWN, 12, MARK_STATE_VISITED);
    end
    if (arg0 == 18) then begin
        mark_area_known(MARK_TYPE_TOWN, 3, MARK_STATE_VISITED);
    end
    if (arg0 == 109) then begin
        mark_area_known(MARK_TYPE_TOWN, 152, MARK_STATE_VISITED);
    end
    if (arg0 == 46) then begin
        mark_area_known(MARK_TYPE_TOWN, 10, MARK_STATE_VISITED);
    end
    if (arg0 == 60) then begin
        mark_area_known(MARK_TYPE_TOWN, 48, MARK_STATE_VISITED);
    end
    if (arg0 == 92) then begin
        mark_area_known(MARK_TYPE_TOWN, 25, MARK_STATE_VISITED);
    end
    if (arg0 == 64) then begin
        mark_area_known(MARK_TYPE_TOWN, 13, MARK_STATE_VISITED);
    end
    if (arg0 == 158) then begin
        mark_area_known(MARK_TYPE_TOWN, 18, MARK_STATE_VISITED);
    end
    if (arg0 == 162) then begin
        mark_area_known(MARK_TYPE_TOWN, 53, MARK_STATE_VISITED);
    end
    if (arg0 == 137) then begin
        mark_area_known(MARK_TYPE_TOWN, 14, MARK_STATE_VISITED);
    end
    if (arg0 == 254) then begin
        mark_area_known(MARK_TYPE_TOWN, 87, MARK_STATE_VISITED);
    end
    if (arg0 == 167) then begin
        mark_area_known(MARK_TYPE_TOWN, 58, MARK_STATE_VISITED);
    end
    if (arg0 == 163) then begin
        mark_area_known(MARK_TYPE_TOWN, 54, MARK_STATE_VISITED);
    end
    if (arg0 == 156) then begin
        mark_area_known(MARK_TYPE_TOWN, 50, MARK_STATE_VISITED);
    end
    if (arg0 == 41) then begin
        mark_area_known(MARK_TYPE_TOWN, 11, MARK_STATE_VISITED);
    end
    if (arg0 == 218) then begin
        mark_area_known(MARK_TYPE_TOWN, 72, MARK_STATE_VISITED);
    end
    if (arg0 == 37) then begin
        mark_area_known(MARK_TYPE_TOWN, 9, MARK_STATE_VISITED);
    end
    if (arg0 == 15) then begin
        mark_area_known(MARK_TYPE_TOWN, 4, MARK_STATE_VISITED);
    end
    if (arg0 == 202) then begin
        mark_area_known(MARK_TYPE_TOWN, 56, MARK_STATE_VISITED);
    end
    if (arg0 == 224) then begin
        mark_area_known(MARK_TYPE_TOWN, 75, MARK_STATE_VISITED);
    end
    if (arg0 == 252) then begin
        wm_area_set_pos(88, worldmap_xpos, worldmap_ypos);
        mark_area_known(MARK_TYPE_TOWN, 88, MARK_STATE_VISITED);
    end
    if ((arg0 == 54) or (arg0 == 55) or (arg0 == 56) or (arg0 == 57) or (arg0 == 58) or (arg0 == 59)) then begin
        mark_area_known(MARK_TYPE_TOWN, 7, MARK_STATE_VISITED);
    end
end

procedure Set_Viewport_Position
begin
    if ((get_map_wm_x(cur_map_index) > 0) and (get_map_wm_y(cur_map_index) > 0)) then begin
        if ((get_map_wm_x(cur_map_index) - 200) < 0) then begin
            x_zero := 0;
        end
        else begin
            if ((get_map_wm_x(cur_map_index) - 200) > 1900) then begin
                y_zero := 1900;
            end
            else begin
                x_zero := get_map_wm_x(cur_map_index) - 200;
            end
        end
        if ((get_map_wm_y(cur_map_index) - 200) < 0) then begin
            y_zero := 0;
        end
        else begin
            if ((get_map_wm_y(cur_map_index) - 200) > 1900) then begin
                y_zero := 1900;
            end
            else begin
                y_zero := get_map_wm_y(cur_map_index) - 200;
            end
        end
        set_world_map_pos(get_map_wm_x(cur_map_index), get_map_wm_y(cur_map_index));
        set_viewport_x(x_zero);
        set_viewport_y(y_zero);
        call Mark_Town_Known(cur_map_index);
    end
end

procedure get_map_wm_y(variable arg0)
begin
    if (arg0 == 179) then begin
        return 750;
    end
    if (arg0 == 198) then begin
        return 400;
    end
    if (arg0 == 242) then begin
        return 1800;
    end
    if (arg0 == 127) then begin
        return 133;
    end
    if (arg0 == 232) then begin
        return 1075;
    end
    if (arg0 == 5) then begin
        return 133;
    end
    if (arg0 == 22) then begin
        return 133;
    end
    if (arg0 == 157) then begin
        return 433;
    end
    if (arg0 == 238) then begin
        return 1700;
    end
    if (arg0 == 78) then begin
        return 872;
    end
    if (arg0 == 220) then begin
        return 390;
    end
    if (arg0 == 6) then begin
        return 272;
    end
    if (arg0 == 7) then begin
        return 272;
    end
    if (arg0 == 27) then begin
        return 822;
    end
    if (arg0 == 151) then begin
        return 970;
    end
    if (arg0 == 31) then begin
        return 222;
    end
    if (arg0 == 24) then begin
        return 248;
    end
    if (arg0 == 160) then begin
        return 250;
    end
    if (arg0 == 9) then begin
        return 122;
    end
    if (arg0 == 12) then begin
        return 107;
    end
    if (arg0 == 195) then begin
        return 1075;
    end
    if (arg0 == 197) then begin
        return 1120;
    end
    if (arg0 == 51) then begin
        return 1422;
    end
    if (arg0 == 18) then begin
        return 272;
    end
    if (arg0 == 109) then begin
        return 875;
    end
    if (arg0 == 46) then begin
        return 1422;
    end
    if (arg0 == 60) then begin
        return 882;
    end
    if (arg0 == 92) then begin
        return 673;
    end
    if (arg0 == 64) then begin
        return 522;
    end
    if (arg0 == 158) then begin
        return 75;
    end
    if (arg0 == 162) then begin
        return 315;
    end
    if (arg0 == 137) then begin
        return 1322;
    end
    if (arg0 == 254) then begin
        return 400;
    end
    if (arg0 == 167) then begin
        return 2322;
    end
    if (arg0 == 163) then begin
        return 531;
    end
    if (arg0 == 156) then begin
        return 233;
    end
    if (arg0 == 41) then begin
        return 1433;
    end
    if (arg0 == 218) then begin
        return 1322;
    end
    if (arg0 == 37) then begin
        return 1433;
    end
    if (arg0 == 15) then begin
        return 322;
    end
    if (arg0 == 202) then begin
        return 1322;
    end
    if (arg0 == 224) then begin
        return 900;
    end
    if (arg0 == 252) then begin
        return worldmap_ypos;
    end
    if ((arg0 == 54) or (arg0 == 55) or (arg0 == 56) or (arg0 == 57) or (arg0 == 58)) then begin
        return 922;
    end
    if (arg0 == 59) then begin
        return 992;
    end
end

procedure get_map_wm_x(variable arg0)
begin
    if (arg0 == 179) then begin
        return 1750;
    end
    if (arg0 == 198) then begin
        return 1550;
    end
    if (arg0 == 242) then begin
        return 900;
    end
    if (arg0 == 127) then begin
        return 184;
    end
    if (arg0 == 232) then begin
        return 975;
    end
    if (arg0 == 5) then begin
        return 184;
    end
    if (arg0 == 22) then begin
        return 184;
    end
    if (arg0 == 157) then begin
        return 284;
    end
    if (arg0 == 238) then begin
        return 1150;
    end
    if (arg0 == 78) then begin
        return 1173;
    end
    if (arg0 == 220) then begin
        return 325;
    end
    if (arg0 == 6) then begin
        return 473;
    end
    if (arg0 == 7) then begin
        return 473;
    end
    if (arg0 == 27) then begin
        return 923;
    end
    if (arg0 == 151) then begin
        return 621;
    end
    if (arg0 == 31) then begin
        return 1273;
    end
    if (arg0 == 24) then begin
        return 990;
    end
    if (arg0 == 160) then begin
        return 425;
    end
    if (arg0 == 9) then begin
        return 373;
    end
    if (arg0 == 12) then begin
        return 330;
    end
    if (arg0 == 195) then begin
        return 975;
    end
    if (arg0 == 197) then begin
        return 935;
    end
    if (arg0 == 51) then begin
        return 672;
    end
    if (arg0 == 18) then begin
        return 923;
    end
    if (arg0 == 109) then begin
        return 177;
    end
    if (arg0 == 46) then begin
        return 1123;
    end
    if (arg0 == 59) then begin
        return 935;
    end
    if (arg0 == 60) then begin
        return 953;
    end
    if (arg0 == 92) then begin
        return 1172;
    end
    if (arg0 == 64) then begin
        return 673;
    end
    if (arg0 == 158) then begin
        return 375;
    end
    if (arg0 == 162) then begin
        return 540;
    end
    if (arg0 == 137) then begin
        return 472;
    end
    if (arg0 == 254) then begin
        return 237;
    end
    if (arg0 == 167) then begin
        return 1200;
    end
    if (arg0 == 163) then begin
        return 82;
    end
    if (arg0 == 156) then begin
        return 543;
    end
    if (arg0 == 41) then begin
        return 984;
    end
    if (arg0 == 218) then begin
        return 1360;
    end
    if (arg0 == 37) then begin
        return 1284;
    end
    if (arg0 == 15) then begin
        return 1223;
    end
    if (arg0 == 202) then begin
        return 700;
    end
    if (arg0 == 224) then begin
        return 900;
    end
    if (arg0 == 252) then begin
        return worldmap_xpos;
    end
    if ((arg0 == 54) or (arg0 == 55) or (arg0 == 56) or (arg0 == 57) or (arg0 == 58)) then begin
        return 923;
    end
    if (arg0 == 59) then begin
        return 935;
    end
end

procedure Add_Car_To_Party
begin
    if ((party_member_obj(831) == 0) and tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 831)) then begin
        party_add(tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 831));
    end
    if ((party_member_obj(455) == 0) and tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 455)) then begin
        party_add(tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 455));
    end
    if ((party_member_obj(832) == 0) and tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 832)) then begin
        party_add(tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 832));
    end
    if ((party_member_obj(833) == 0) and tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 833)) then begin
        party_add(tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 833));
    end
    if ((party_member_obj(834) == 0) and tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 834)) then begin
        party_add(tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 834));
    end
    if ((party_member_obj(835) == 0) and tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 835)) then begin
        party_add(tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 835));
    end
    if ((party_member_obj(836) == 0) and tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 836)) then begin
        party_add(tile_contains_pid_obj(tile_num_in_direction(tile_num_in_direction(global_var(GVAR_CAR_PLACED_TILE), 5, 2), 4, 1), elevation(self_obj), 836));
    end
end

procedure Update_Trunk
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    LVar0 := tile_num_in_direction(tile_num_in_direction(Get_Car_Hex(), 5, 2), 4, 1);
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 0) then begin
        if (party_member_obj(831) != 0) then begin
            LVar1 := party_member_obj(831);
        end
        else begin
            if (not(tile_contains_pid_obj(LVar0, dude_elevation, 831) != 0)) then begin
                LVar1 := create_object_sid(831, 0, 0, SCRIPT_ZICRTRNK);
                party_add(LVar1);
            end
        end
    end
    else begin
        set_obj_visibility(party_member_obj(831), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 1) then begin
        if (party_member_obj(455) != 0) then begin
            LVar1 := party_member_obj(455);
        end
        else begin
            if (not(tile_contains_pid_obj(LVar0, dude_elevation, 455) != 0)) then begin
                LVar1 := create_object_sid(455, 0, 0, SCRIPT_ZICRTRNK);
                party_add(LVar1);
            end
        end
    end
    else begin
        set_obj_visibility(party_member_obj(455), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 2) then begin
        if (party_member_obj(832) != 0) then begin
            LVar1 := party_member_obj(832);
        end
        else begin
            if (not(tile_contains_pid_obj(LVar0, dude_elevation, 832) != 0)) then begin
                LVar1 := create_object_sid(832, 0, 0, SCRIPT_ZICRTRNK);
                party_add(LVar1);
            end
        end
    end
    else begin
        set_obj_visibility(party_member_obj(832), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 3) then begin
        if (party_member_obj(833) != 0) then begin
            LVar1 := party_member_obj(833);
        end
        else begin
            if (not(tile_contains_pid_obj(LVar0, dude_elevation, 833) != 0)) then begin
                LVar1 := create_object_sid(833, 0, 0, SCRIPT_ZICRTRNK);
                party_add(LVar1);
            end
        end
    end
    else begin
        set_obj_visibility(party_member_obj(833), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 4) then begin
        if (party_member_obj(834) != 0) then begin
            LVar1 := party_member_obj(834);
        end
        else begin
            if (not(tile_contains_pid_obj(LVar0, dude_elevation, 834) != 0)) then begin
                LVar1 := create_object_sid(834, 0, 0, SCRIPT_ZICRTRNK);
                party_add(LVar1);
            end
        end
    end
    else begin
        set_obj_visibility(party_member_obj(834), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 5) then begin
        if (party_member_obj(835) != 0) then begin
            LVar1 := party_member_obj(835);
        end
        else begin
            if (not(tile_contains_pid_obj(LVar0, dude_elevation, 835) != 0)) then begin
                LVar1 := create_object_sid(835, 0, 0, SCRIPT_ZICRTRNK);
                party_add(LVar1);
            end
        end
    end
    else begin
        set_obj_visibility(party_member_obj(835), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 6) then begin
        if (party_member_obj(836) != 0) then begin
            LVar1 := party_member_obj(836);
        end
        else begin
            if (not(tile_contains_pid_obj(LVar0, dude_elevation, 836) != 0)) then begin
                LVar1 := create_object_sid(836, 0, 0, SCRIPT_ZICRTRNK);
                party_add(LVar1);
            end
        end
    end
    else begin
        set_obj_visibility(party_member_obj(836), 1);
    end
    LVar2 := tile_num_in_direction(tile_num_in_direction(Get_Car_Hex(), 5, 2), 4, 1);
    move_to(LVar1, LVar2, global_var(GVAR_CAR_HAS_BEEN_DRIVEN));
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 0) then begin
        set_obj_visibility(party_member_obj(831), 0);
    end
    else begin
        set_obj_visibility(party_member_obj(831), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 1) then begin
        set_obj_visibility(party_member_obj(455), 0);
    end
    else begin
        set_obj_visibility(party_member_obj(455), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 2) then begin
        set_obj_visibility(party_member_obj(832), 0);
    end
    else begin
        set_obj_visibility(party_member_obj(832), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 3) then begin
        set_obj_visibility(party_member_obj(833), 0);
    end
    else begin
        set_obj_visibility(party_member_obj(833), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 4) then begin
        set_obj_visibility(party_member_obj(834), 0);
    end
    else begin
        set_obj_visibility(party_member_obj(834), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 5) then begin
        set_obj_visibility(party_member_obj(835), 0);
    end
    else begin
        set_obj_visibility(party_member_obj(835), 1);
    end
    if (global_var(GVAR_CAR_CURRENT_ELEVATION) == 6) then begin
        set_obj_visibility(party_member_obj(836), 0);
    end
    else begin
        set_obj_visibility(party_member_obj(836), 1);
    end
end

procedure checkPartyMembersNearDoor
begin
    if (party_member_obj(16777278) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777278)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777376) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777376)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777377) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777377)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777305) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777305)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777313) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777313)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777323) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777323)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777352) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777352)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777378) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777378)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777368) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777368)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777379) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777379)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777380) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777380)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777295) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777295)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777381) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777381)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777407) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777407)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777411) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777411)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777412) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777412)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777413) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777413)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777481) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777481)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777558) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777558)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777600) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777600)) <= 5) then begin
            return 1;
        end
    end
    return 0;
end

procedure start
begin
end

procedure map_exit_p_proc
begin
end

procedure map_enter_p_proc
begin
    if (is_loading_game == 0) then begin
        if (map_first_run) then begin
            display_mstr(100);
        end
    end
    if ((global_var(GVAR_PLAYER_GOT_CAR) == 0) or map_first_run) then begin
        call Place_Car(24548);
    end
    if (Get_Car_Hex() != 24548) then begin
        call Delete_Car(24548);
    end
    override_map_start(13292 % 200, 13292 / 200, 0, 2);
    set_global_var(GVAR_MAP_EXIT_TILE, 8285);
    set_global_var(GVAR_MAP_NEXT_TILE, 22658);
    if ((get_month >= 3) and (get_month < 5)) then begin
        if ((game_time_hour >= 600) and (game_time_hour < (600 + 100))) then begin
            set_light_level(game_time_hour - 600 + 40);
        end
        else begin
            if ((game_time_hour >= (600 + 100)) and (game_time_hour < 1800)) then begin
                set_light_level(100);
            end
            else begin
                if ((game_time_hour >= 1800) and (game_time_hour < (1800 + 100))) then begin
                    set_light_level(100 - (game_time_hour - 1800));
                end
                else begin
                    set_light_level(40);
                end
            end
        end
    end
    else begin
        if ((get_month >= 5) and (get_month < 9)) then begin
            if ((game_time_hour >= 500) and (game_time_hour < (500 + 100))) then begin
                set_light_level(game_time_hour - 500 + 40);
            end
            else begin
                if ((game_time_hour >= (500 + 100)) and (game_time_hour < 1900)) then begin
                    set_light_level(100);
                end
                else begin
                    if ((game_time_hour >= 1900) and (game_time_hour < (1900 + 100))) then begin
                        set_light_level(100 - (game_time_hour - 1900));
                    end
                    else begin
                        set_light_level(40);
                    end
                end
            end
        end
        else begin
            if ((get_month >= 9) and (get_month < 11)) then begin
                if ((game_time_hour >= 600) and (game_time_hour < (600 + 100))) then begin
                    set_light_level(game_time_hour - 600 + 40);
                end
                else begin
                    if ((game_time_hour >= (600 + 100)) and (game_time_hour < 1800)) then begin
                        set_light_level(100);
                    end
                    else begin
                        if ((game_time_hour >= 1800) and (game_time_hour < (1800 + 100))) then begin
                            set_light_level(100 - (game_time_hour - 1800));
                        end
                        else begin
                            set_light_level(40);
                        end
                    end
                end
            end
            else begin
                if ((game_time_hour >= 700) and (game_time_hour < (700 + 100))) then begin
                    set_light_level(game_time_hour - 700 + 40);
                end
                else begin
                    if ((game_time_hour >= (700 + 100)) and (game_time_hour < 1700)) then begin
                        set_light_level(100);
                    end
                    else begin
                        if ((game_time_hour >= 1700) and (game_time_hour < (1700 + 100))) then begin
                            set_light_level(100 - (game_time_hour - 1700));
                        end
                        else begin
                            set_light_level(40);
                        end
                    end
                end
            end
        end
    end
end

procedure map_update_p_proc
begin
    if (global_var(GVAR_DEN_GANG_D_DAY) > 0) then begin
        if (game_time > global_var(GVAR_DEN_GANG_D_DAY)) then begin
            set_global_var(GVAR_DEN_GANG_D_DAY, -1);
            if ((global_var(GVAR_DEN_GANGWAR) == 6) or (global_var(GVAR_DEN_GANGWAR) == 7)) then begin
                if (8 == 3) then begin
                    if (global_var(GVAR_DEN_GANGWAR) == 2) then begin
                        display_mstr(1400);
                        give_exp_points(200);
                        display_msg(g_mstr(100) + 200 + g_mstr(101));
                    end
                    set_global_var(GVAR_DEN_FLAG_2, global_var(GVAR_DEN_FLAG_2) bwor 1073741824);
                end
                else begin
                    if (8 == 1) then begin
                        set_global_var(GVAR_DEN_FLAG_3, global_var(GVAR_DEN_FLAG_3) bwor 1);
                    end
                    else begin
                        if (8 == 5) then begin
                            if (global_var(GVAR_DEN_GANG_D_DAY) == 0) then begin
                                set_global_var(GVAR_DEN_GANG_D_DAY, game_time + ((24 * (60 * (60 * 10)) * (game_time_hour > 600)) + (((600 / 100) - (game_time_hour / 100)) * (60 * (60 * 10))) + (((600 % 100) - (game_time_hour % 100)) * (60 * 10))) + (24 * (60 * (60 * 10)) * (game_time < 600)));
                            end
                            if (global_var(GVAR_DEN_GANGWAR) == 4) then begin
                                display_mstr(1300);
                                give_exp_points(200);
                                display_msg(g_mstr(100) + 200 + g_mstr(101));
                            end
                        end
                        else begin
                            if (8 == 11) then begin
                                if (((global_var(GVAR_DEN_GANGWAR) == 10) == 0) and ((global_var(GVAR_DEN_GANGWAR) == 11) == 0)) then begin
                                    display_mstr(200);
                                    give_exp_points(1000);
                                    display_msg(g_mstr(100) + 1000 + g_mstr(101));
                                end
                            end
                            else begin
                                if (8 == 10) then begin
                                    if (((global_var(GVAR_DEN_GANGWAR) == 10) == 0) and ((global_var(GVAR_DEN_GANGWAR) == 11) == 0)) then begin
                                        set_global_var(GVAR_PLAYER_REPUTATION, global_var(GVAR_PLAYER_REPUTATION) + -50);
                                        debug_msg("Player gains " + -50 + " Karma Points.");
                                        set_global_var(GVAR_KARMA_HOLY_WARRIOR, 0);
                                        set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 0);
                                        set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 0);
                                        set_global_var(GVAR_KARMA_DEFENDER, 0);
                                        set_global_var(GVAR_KARMA_WANDERER, 0);
                                        set_global_var(GVAR_KARMA_BETRAYER, 0);
                                        set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 0);
                                        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 0);
                                        set_global_var(GVAR_KARMA_DEMON_SPAWN, 0);
                                        if (global_var(GVAR_PLAYER_REPUTATION) >= 1000) then begin
                                            set_global_var(GVAR_KARMA_HOLY_WARRIOR, 1);
                                        end
                                        else begin
                                            if (global_var(GVAR_PLAYER_REPUTATION) >= 750) then begin
                                                set_global_var(GVAR_KARMA_GUARDIAN_OF_THE_WASTES, 1);
                                            end
                                            else begin
                                                if (global_var(GVAR_PLAYER_REPUTATION) >= 500) then begin
                                                    set_global_var(GVAR_KARMA_SHIELD_OF_HOPE, 1);
                                                end
                                                else begin
                                                    if (global_var(GVAR_PLAYER_REPUTATION) >= 250) then begin
                                                        set_global_var(GVAR_KARMA_DEFENDER, 1);
                                                    end
                                                    else begin
                                                        if (global_var(GVAR_PLAYER_REPUTATION) > -250) then begin
                                                            set_global_var(GVAR_KARMA_WANDERER, 1);
                                                        end
                                                        else begin
                                                            if (global_var(GVAR_PLAYER_REPUTATION) > -500) then begin
                                                                set_global_var(GVAR_KARMA_BETRAYER, 1);
                                                            end
                                                            else begin
                                                                if (global_var(GVAR_PLAYER_REPUTATION) > -750) then begin
                                                                    set_global_var(GVAR_KARMA_SWORD_OF_DESPAIR, 1);
                                                                end
                                                                else begin
                                                                    if (global_var(GVAR_PLAYER_REPUTATION) > -1000) then begin
                                                                        set_global_var(GVAR_KARMA_SCOURGE_OF_THE_WASTE, 1);
                                                                    end
                                                                    else begin
                                                                        set_global_var(GVAR_KARMA_DEMON_SPAWN, 1);
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                        display_mstr(300);
                                        give_exp_points(1100);
                                        display_msg(g_mstr(100) + 1100 + g_mstr(101));
                                    end
                                end
                            end
                        end
                    end
                end
                if (8 > global_var(GVAR_DEN_GANGWAR)) then begin
                    set_global_var(GVAR_DEN_GANGWAR, 8);
                end
                debug_msg("set_gangwar(" + 8 + ") == " + global_var(GVAR_DEN_GANGWAR));
            end
            if (global_var(GVAR_DEN_GANG_TRAP) == 1) then begin
                if (2 > global_var(GVAR_DEN_GANG_TRAP)) then begin
                    set_global_var(GVAR_DEN_GANG_TRAP, 2);
                end
            end
        end
    end
    if ((get_month >= 3) and (get_month < 5)) then begin
        if ((game_time_hour >= 600) and (game_time_hour < (600 + 100))) then begin
            set_light_level(game_time_hour - 600 + 40);
        end
        else begin
            if ((game_time_hour >= (600 + 100)) and (game_time_hour < 1800)) then begin
                set_light_level(100);
            end
            else begin
                if ((game_time_hour >= 1800) and (game_time_hour < (1800 + 100))) then begin
                    set_light_level(100 - (game_time_hour - 1800));
                end
                else begin
                    set_light_level(40);
                end
            end
        end
    end
    else begin
        if ((get_month >= 5) and (get_month < 9)) then begin
            if ((game_time_hour >= 500) and (game_time_hour < (500 + 100))) then begin
                set_light_level(game_time_hour - 500 + 40);
            end
            else begin
                if ((game_time_hour >= (500 + 100)) and (game_time_hour < 1900)) then begin
                    set_light_level(100);
                end
                else begin
                    if ((game_time_hour >= 1900) and (game_time_hour < (1900 + 100))) then begin
                        set_light_level(100 - (game_time_hour - 1900));
                    end
                    else begin
                        set_light_level(40);
                    end
                end
            end
        end
        else begin
            if ((get_month >= 9) and (get_month < 11)) then begin
                if ((game_time_hour >= 600) and (game_time_hour < (600 + 100))) then begin
                    set_light_level(game_time_hour - 600 + 40);
                end
                else begin
                    if ((game_time_hour >= (600 + 100)) and (game_time_hour < 1800)) then begin
                        set_light_level(100);
                    end
                    else begin
                        if ((game_time_hour >= 1800) and (game_time_hour < (1800 + 100))) then begin
                            set_light_level(100 - (game_time_hour - 1800));
                        end
                        else begin
                            set_light_level(40);
                        end
                    end
                end
            end
            else begin
                if ((game_time_hour >= 700) and (game_time_hour < (700 + 100))) then begin
                    set_light_level(game_time_hour - 700 + 40);
                end
                else begin
                    if ((game_time_hour >= (700 + 100)) and (game_time_hour < 1700)) then begin
                        set_light_level(100);
                    end
                    else begin
                        if ((game_time_hour >= 1700) and (game_time_hour < (1700 + 100))) then begin
                            set_light_level(100 - (game_time_hour - 1700));
                        end
                        else begin
                            set_light_level(40);
                        end
                    end
                end
            end
        end
    end
end
