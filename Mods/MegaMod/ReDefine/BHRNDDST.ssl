variable ProtoOfItemGiven;
variable ValueOfRollCheck := 1;
variable Scenery_Creation;
variable Scenery_Creation_Hex;
variable Scenery_Creation_Count;
variable Temp_Scenery_Creation_Hex;
variable Scenery_Creation_Ptr;
variable How_Many_Party_Members_Are_Injured;
variable How_Many_Party_Members_Armed;
variable PartyHealingItem;

procedure checkPartyMembersNearDoor;

variable Finding_New_Tile;
variable global_temp;
variable dest_tile;
variable step_tile;
variable in_dialog;
variable forced_node;
variable restock_amt;
variable restock_obj;
variable restock_trash;
variable removed_qty;

procedure start;
procedure map_enter_p_proc;
procedure map_update_p_proc;
procedure map_exit_p_proc;
procedure Broken_Hills_Caravan;
procedure Broken_VC_Encounters;
procedure Broken_Gecko_Encounters;
procedure Broken_NCR_Encounters;
procedure Broken_Hills_Brok_Encounter;
procedure Broken_Hills_VPat_Encounter;
procedure Broken_Hills_RDRC_Encounter;
procedure Broken_Hills_VNNB_Encounter;
procedure Broken_Hills_NCR_Encounter;
procedure Redding_Caravan;
procedure Red_VC_Encounters;
procedure Red_Reno_Encounters;
procedure Red_NCR_Encounters;
procedure VC_Red_Encounters;
procedure Reno_Red_Encounters;
procedure NCR_Red_Encounters;
procedure Redding_DNRV_Encounter;
procedure Redding_DMRV_Encounter;
procedure Redding_Band_Encounter;
procedure Redding_DVMV_Encounter;
procedure Redding_Red_Encounter;
procedure Redding_SRNRRN_Encounter;
procedure Redding_EPA_Encounter;
procedure Redding_Reno_Encounter;
procedure Redding_NRNR_Encounter;
procedure Redding_NCR_Encounter;
procedure NCR_Cattle_Drive;
procedure Default_Caravan;
procedure Build_Caravan_Team;
procedure Build_Grey_Caravan;
procedure Add_Mysterious_Stranger;
procedure Brok_Rogues;
procedure Red_Wolves;
procedure DMRV_Scorpions;
procedure ARRO_Spore_Plants;
procedure Brok_Unity_Patrol;
procedure VPat_Strong_Slavers;
procedure DVMV_Wild_Dogs;
procedure DMRV_Golden_Geckos;
procedure VPat_Patrol;
procedure RDRC_Raiders;
procedure DNRV_Vault_Caravan;
procedure RDRC_Broken_Hills_Caravan;
procedure RDRC_Gecko_Caravan;
procedure NCR_Marauders;
procedure DNRV_Reno_Caravan;
procedure DNRV_Redding_Caravan;
procedure NCR_Caravan;
procedure V15_Caravan;
procedure New_Traveler;
procedure NCR_Masters_Army;
procedure NCR_Rangers;
procedure KLA_Farmers;
procedure DNRV_Den_Caravan;
procedure DVMV_Highwaymen;
procedure DVMV_Robbers;
procedure DMRV_Caravan;
procedure DMRV_Highwaymen;
procedure DMRV_Robbers;
procedure DVMV_Mantis_Swarm;
procedure DVMV_Caravan;
procedure Red_Claim_Jumper;
procedure Red_Prospector;
procedure Red_Bootlegger;
procedure Red_Trappers;
procedure Red_Homesteaders;
procedure EPA_Deathclaws;
procedure EPA_Fire_Geckos;
procedure EPA_Centaurs;
procedure EPA_Floaters;
procedure Fran2_San_Fran_Caravan;
procedure EPA_Special_Alien;
procedure EPA_Floater_Centaurs;
procedure EPA_Special_Fire_Geckos;
procedure New_Yakuza;
procedure New_Gang;
procedure New_Mobsters;
procedure EPA_Alien;
procedure Klad_Mole_Pig_Rat;

variable Encounter_Counter;
variable Encounter_Rotation;
variable Critter;
variable Combat1;
variable Combat2;


procedure checkPartyMembersNearDoor
begin
    if (party_member_obj(16777278) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777278)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777376) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777376)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777377) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777377)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777305) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777305)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777313) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777313)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777323) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777323)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777352) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777352)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777378) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777378)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777368) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777368)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777379) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777379)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777380) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777380)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777295) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777295)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777381) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777381)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777407) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777407)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777411) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777411)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777412) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777412)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777413) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777413)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777481) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777481)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777558) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777558)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777600) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777600)) <= 5) then begin
            return 1;
        end
    end
    return 0;
end

procedure start
begin
end

procedure map_enter_p_proc
begin
    variable LVar0 := 0;
    if (map_first_run) then begin
        Combat1 := 0;
        Combat2 := 0;
        set_map_var(1, 0);
        if (global_var(GVAR_MEDICINE_CARAVAN) == 4) then begin
            call Redding_Caravan();
            debug_msg("Redding Medicine Caravan.");
        end
        else begin
            if (global_var(GVAR_CATTLE_DRIVE_CARAVAN) == 4) then begin
                call Redding_Caravan();
                debug_msg("Redding Cattle Drive.");
            end
            else begin
                if (global_var(GVAR_JET_CARAVAN) == 4) then begin
                    call Redding_Caravan();
                    debug_msg("Redding Jet Caravan.");
                end
                else begin
                    if (global_var(GVAR_BH_CARAVAN) == 2) then begin
                        call Broken_Hills_Caravan();
                        debug_msg("Broken Hills Caravan.");
                    end
                    else begin
                        if ((global_var(GVAR_NCR_CATTLE_DRIVE) bwand 16) != 0) then begin
                            call NCR_Cattle_Drive();
                            debug_msg("NCR Cattle Drive.");
                        end
                        else begin
                            call Default_Caravan();
                            debug_msg("Default Caravan.");
                        end
                    end
                end
            end
        end
        LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
        debug_msg("Total Encounters == " + global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) + ". Encounters Left == " + global_var(GVAR_CARAVAN_ENCOUNTERS) + ". On Encounter " + LVar0);
        set_global_var(GVAR_CARAVAN_ENCOUNTERS, global_var(GVAR_CARAVAN_ENCOUNTERS) - 1);
        if ((Combat1 != 0) and (Combat2 != 0)) then begin
            attack_setup(Combat1, Combat2);
            debug_msg("Having " + Combat1 + " fighting " + Combat2 + ".");
        end
    end
    if ((get_month >= 3) and (get_month < 5)) then begin
        if ((game_time_hour >= 600) and (game_time_hour < (600 + 100))) then begin
            set_light_level(game_time_hour - 600 + 40);
        end
        else begin
            if ((game_time_hour >= (600 + 100)) and (game_time_hour < 1800)) then begin
                set_light_level(100);
            end
            else begin
                if ((game_time_hour >= 1800) and (game_time_hour < (1800 + 100))) then begin
                    set_light_level(100 - (game_time_hour - 1800));
                end
                else begin
                    set_light_level(40);
                end
            end
        end
    end
    else begin
        if ((get_month >= 5) and (get_month < 9)) then begin
            if ((game_time_hour >= 500) and (game_time_hour < (500 + 100))) then begin
                set_light_level(game_time_hour - 500 + 40);
            end
            else begin
                if ((game_time_hour >= (500 + 100)) and (game_time_hour < 1900)) then begin
                    set_light_level(100);
                end
                else begin
                    if ((game_time_hour >= 1900) and (game_time_hour < (1900 + 100))) then begin
                        set_light_level(100 - (game_time_hour - 1900));
                    end
                    else begin
                        set_light_level(40);
                    end
                end
            end
        end
        else begin
            if ((get_month >= 9) and (get_month < 11)) then begin
                if ((game_time_hour >= 600) and (game_time_hour < (600 + 100))) then begin
                    set_light_level(game_time_hour - 600 + 40);
                end
                else begin
                    if ((game_time_hour >= (600 + 100)) and (game_time_hour < 1800)) then begin
                        set_light_level(100);
                    end
                    else begin
                        if ((game_time_hour >= 1800) and (game_time_hour < (1800 + 100))) then begin
                            set_light_level(100 - (game_time_hour - 1800));
                        end
                        else begin
                            set_light_level(40);
                        end
                    end
                end
            end
            else begin
                if ((game_time_hour >= 700) and (game_time_hour < (700 + 100))) then begin
                    set_light_level(game_time_hour - 700 + 40);
                end
                else begin
                    if ((game_time_hour >= (700 + 100)) and (game_time_hour < 1700)) then begin
                        set_light_level(100);
                    end
                    else begin
                        if ((game_time_hour >= 1700) and (game_time_hour < (1700 + 100))) then begin
                            set_light_level(100 - (game_time_hour - 1700));
                        end
                        else begin
                            set_light_level(40);
                        end
                    end
                end
            end
        end
    end
    set_global_var(GVAR_LOAD_MAP_INDEX, 0);
    return 0;
    LVar0 := 0;
end

procedure map_update_p_proc
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    if ((get_month >= 3) and (get_month < 5)) then begin
        if ((game_time_hour >= 600) and (game_time_hour < (600 + 100))) then begin
            set_light_level(game_time_hour - 600 + 40);
        end
        else begin
            if ((game_time_hour >= (600 + 100)) and (game_time_hour < 1800)) then begin
                set_light_level(100);
            end
            else begin
                if ((game_time_hour >= 1800) and (game_time_hour < (1800 + 100))) then begin
                    set_light_level(100 - (game_time_hour - 1800));
                end
                else begin
                    set_light_level(40);
                end
            end
        end
    end
    else begin
        if ((get_month >= 5) and (get_month < 9)) then begin
            if ((game_time_hour >= 500) and (game_time_hour < (500 + 100))) then begin
                set_light_level(game_time_hour - 500 + 40);
            end
            else begin
                if ((game_time_hour >= (500 + 100)) and (game_time_hour < 1900)) then begin
                    set_light_level(100);
                end
                else begin
                    if ((game_time_hour >= 1900) and (game_time_hour < (1900 + 100))) then begin
                        set_light_level(100 - (game_time_hour - 1900));
                    end
                    else begin
                        set_light_level(40);
                    end
                end
            end
        end
        else begin
            if ((get_month >= 9) and (get_month < 11)) then begin
                if ((game_time_hour >= 600) and (game_time_hour < (600 + 100))) then begin
                    set_light_level(game_time_hour - 600 + 40);
                end
                else begin
                    if ((game_time_hour >= (600 + 100)) and (game_time_hour < 1800)) then begin
                        set_light_level(100);
                    end
                    else begin
                        if ((game_time_hour >= 1800) and (game_time_hour < (1800 + 100))) then begin
                            set_light_level(100 - (game_time_hour - 1800));
                        end
                        else begin
                            set_light_level(40);
                        end
                    end
                end
            end
            else begin
                if ((game_time_hour >= 700) and (game_time_hour < (700 + 100))) then begin
                    set_light_level(game_time_hour - 700 + 40);
                end
                else begin
                    if ((game_time_hour >= (700 + 100)) and (game_time_hour < 1700)) then begin
                        set_light_level(100);
                    end
                    else begin
                        if ((game_time_hour >= 1700) and (game_time_hour < (1700 + 100))) then begin
                            set_light_level(100 - (game_time_hour - 1700));
                        end
                        else begin
                            set_light_level(40);
                        end
                    end
                end
            end
        end
    end
    if (map_var(1) <= 0) then begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS) == 0) then begin
            debug_msg("Caravan_End == " + global_var(GVAR_CARAVAN_END));
            if (global_var(GVAR_CARAVAN_END) == 1) then begin
                set_exit_grids(0, 65, 0, 25494, 0);
            end
            else begin
                if (global_var(GVAR_CARAVAN_END) == 2) then begin
                    set_exit_grids(0, 15, 0, 27704, 0);
                end
                else begin
                    if (global_var(GVAR_CARAVAN_END) == 3) then begin
                        set_exit_grids(0, 54, 0, 27306, 0);
                    end
                    else begin
                        if (global_var(GVAR_CARAVAN_END) == 4) then begin
                            set_exit_grids(0, 46, 0, 18467, 0);
                        end
                        else begin
                            if (global_var(GVAR_CARAVAN_END) == 5) then begin
                                set_exit_grids(0, 6, 0, 22097, 0);
                            end
                            else begin
                                if (global_var(GVAR_CARAVAN_END) == 6) then begin
                                    set_exit_grids(0, 78, 0, 22097, 0);
                                end
                                else begin
                                    if (global_var(GVAR_CARAVAN_END) == 7) then begin
                                        set_exit_grids(0, 31, 0, 22901, 0);
                                    end
                                    else begin
                                        if (global_var(GVAR_CARAVAN_END) == 8) then begin
                                            set_exit_grids(0, 137, 0, 22097, 0);
                                        end
                                        else begin
                                            if (global_var(GVAR_CARAVAN_END) == 9) then begin
                                                set_exit_grids(0, 18, 0, 22097, 0);
                                            end
                                            else begin
                                                if (global_var(GVAR_CARAVAN_END) == 10) then begin
                                                    set_exit_grids(0, 9, 0, 22097, 0);
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            if (global_var(GVAR_MEDICINE_CARAVAN) == 3) then begin
                set_global_var(GVAR_MEDICINE_CARAVAN, 7);
            end
            else begin
                if (global_var(GVAR_CATTLE_DRIVE_CARAVAN) == 3) then begin
                    set_global_var(GVAR_CATTLE_DRIVE_CARAVAN, 7);
                end
                else begin
                    if (global_var(GVAR_JET_CARAVAN) == 3) then begin
                        set_global_var(GVAR_JET_CARAVAN, 7);
                    end
                    else begin
                        if ((global_var(GVAR_NCR_CATTLE_DRIVE) bwand 64) != 0) then begin
                            set_global_var(GVAR_NCR_CATTLE_DRIVE, global_var(GVAR_NCR_CATTLE_DRIVE) bwand (-1 - 64));
                        end
                        else begin
                            if (global_var(GVAR_BH_CARAVAN) == 5) then begin
                                set_global_var(GVAR_BH_CARAVAN, 3);
                            end
                        end
                    end
                end
            end
        end
        else begin
            LVar1 := random(0, 5);
            LVar0 := tile_num_in_direction(22097, LVar1, random(3, 8));
            set_exit_grids(0, 94, 0, LVar0, LVar1);
        end
        if (global_var(GVAR_MEDICINE_CARAVAN) == 3) then begin
            set_global_var(GVAR_MEDICINE_CARAVAN, 4);
        end
        else begin
            if (global_var(GVAR_CATTLE_DRIVE_CARAVAN) == 3) then begin
                set_global_var(GVAR_CATTLE_DRIVE_CARAVAN, 4);
            end
            else begin
                if (global_var(GVAR_JET_CARAVAN) == 3) then begin
                    set_global_var(GVAR_JET_CARAVAN, 4);
                end
                else begin
                    if ((global_var(GVAR_NCR_CATTLE_DRIVE) bwand 64) != 0) then begin
                        set_global_var(GVAR_NCR_CATTLE_DRIVE, global_var(GVAR_NCR_CATTLE_DRIVE) bwor 16);
                    end
                    else begin
                        if (global_var(GVAR_BH_CARAVAN) == 5) then begin
                            set_global_var(GVAR_BH_CARAVAN, 2);
                        end
                    end
                end
            end
        end
    end
    else begin
        set_exit_grids(0, -2, 0, 20100, 0);
        mark_world_subtile_visited(worldmap_xpos, worldmap_ypos, 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
end

procedure map_exit_p_proc
begin
    variable LVar0 := 0;
    if (global_var(GVAR_CARAVAN_ENCOUNTERS) == 0) then begin
        if (global_var(GVAR_CARAVAN_END) == 1) then begin
            if (global_var(GVAR_CARAVAN_START) == 4) then begin
                LVar0 := 3 + (11 - get_day);
                if (LVar0 > 0) then begin
                    game_time_advance(LVar0 * (24 * (60 * (60 * 10))));
                end
                else begin
                    game_time_advance(3 * (24 * (60 * (60 * 10))));
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_START) == 3) then begin
                    LVar0 := 10 - get_day;
                    if (LVar0 > 0) then begin
                        game_time_advance(LVar0 * (24 * (60 * (60 * 10))));
                    end
                    else begin
                        game_time_advance(1 * (24 * (60 * (60 * 10))));
                    end
                end
                else begin
                    LVar0 := 26 - get_day;
                    if (LVar0 > 0) then begin
                        game_time_advance(LVar0 * (24 * (60 * (60 * 10))));
                    end
                    else begin
                        game_time_advance(1 * (24 * (60 * (60 * 10))));
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_END) == 2) then begin
                LVar0 := 26 - get_day;
                if (LVar0 > 0) then begin
                    game_time_advance(LVar0 * (24 * (60 * (60 * 10))));
                end
                else begin
                    game_time_advance(1 * (24 * (60 * (60 * 10))));
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_END) == 3) then begin
                    LVar0 := 10 - get_day;
                    if (LVar0 > 0) then begin
                        game_time_advance(LVar0 * (24 * (60 * (60 * 10))));
                    end
                    else begin
                        game_time_advance(1 * (24 * (60 * (60 * 10))));
                    end
                end
                else begin
                    if (global_var(GVAR_CARAVAN_END) == 4) then begin
                        LVar0 := 3 + (11 - get_day);
                        if (LVar0 > 0) then begin
                            game_time_advance(LVar0 * (24 * (60 * (60 * 10))));
                        end
                        else begin
                            game_time_advance(3 * (24 * (60 * (60 * 10))));
                        end
                    end
                    else begin
                        if (global_var(GVAR_CARAVAN_END) == 5) then begin
                        end
                        else begin
                            if (global_var(GVAR_CARAVAN_END) == 6) then begin
                            end
                            else begin
                                if (global_var(GVAR_CARAVAN_END) == 7) then begin
                                end
                                else begin
                                    if (global_var(GVAR_CARAVAN_END) == 8) then begin
                                    end
                                    else begin
                                        if (global_var(GVAR_CARAVAN_END) == 9) then begin
                                        end
                                        else begin
                                            if (global_var(GVAR_CARAVAN_END) == 10) then begin
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Broken_Hills_Caravan
begin
    call Build_Caravan_Team();
    if (global_var(GVAR_BH_CARAVAN) == 2) then begin
        if (global_var(GVAR_CARAVAN_END) == 2) then begin
            call Broken_VC_Encounters();
        end
        else begin
            if (global_var(GVAR_CARAVAN_END) == 7) then begin
                call Broken_Gecko_Encounters();
            end
            else begin
                if (global_var(GVAR_CARAVAN_END) == 4) then begin
                    call Broken_NCR_Encounters();
                end
            end
        end
        if (map_var(1) > 0) then begin
            set_global_var(GVAR_BH_CARAVAN, 5);
        end
    end
end

procedure Broken_VC_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 1325 + random(-25, 25), 600 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        game_time_advance(7 * (24 * (60 * (60 * 10))));
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 1225 + random(-25, 25), 750 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(3 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 1300 + random(-25, 25), 400 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(8 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 1200 + random(-25, 25), 800 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(2 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 1250 + random(-25, 25), 625 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(4 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 1300 + random(-25, 25), 400 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(5 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 1200 + random(-25, 25), 825 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(2 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 1250 + random(-25, 25), 700 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(3 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 1300 + random(-25, 25), 500 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(4 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 1300 + random(-25, 25), 375 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(3 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Broken_Gecko_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 1375 + random(-25, 25), 600 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        game_time_advance(7 * (24 * (60 * (60 * 10))));
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 1275 + random(-25, 25), 750 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(3 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 1325 + random(-25, 25), 475 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(8 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 1250 + random(-25, 25), 800 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(2 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 1300 + random(-25, 25), 600 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(4 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 1350 + random(-25, 25), 350 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(5 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 1275 + random(-25, 25), 800 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(2 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 1250 + random(-25, 25), 700 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(3 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 1300 + random(-25, 25), 500 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(4 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 1275 + random(-25, 25), 300 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(3 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Broken_NCR_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 1125 + random(-25, 25), 1200 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        game_time_advance(7 * (24 * (60 * (60 * 10))));
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 1125 + random(-25, 25), 1075 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(4 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 1125 + random(-25, 25), 1275 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(4 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 1150 + random(-25, 25), 975 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(2 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 1125 + random(-25, 25), 1100 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(3 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 1125 + random(-25, 25), 1250 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(3 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 1175 + random(-25, 25), 950 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(3 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 1150 + random(-25, 25), 1100 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(2 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 1125 + random(-25, 25), 1225 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(3 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 1125 + random(-25, 25), 1375 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(2 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Broken_Hills_Brok_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 10) then begin
        debug_msg("Brok_Encounter Table, Encounter 00");
        display_mstr(100);
        Encounter_Counter := random(7, 10);
        Encounter_Rotation := obj_get_rot(dude_obj);
        call Brok_Rogues();
        Encounter_Counter := random(3, 5);
        Encounter_Rotation := (obj_get_rot(dude_obj) + 3) % 6;
        call Red_Wolves();
    end
    else begin
        if (LVar0 < 30) then begin
            debug_msg("Brok_Encounter Table, Encounter 01");
            display_mstr(101);
            Encounter_Counter := random(8, 12);
            Encounter_Rotation := (obj_get_rot(dude_obj) + random(0, 3)) % 6;
            call Brok_Rogues();
        end
        else begin
            if (LVar0 < 40) then begin
                debug_msg("Brok_Encounter Table, Encounter 02");
                display_mstr(102);
                Encounter_Counter := random(6, 10);
                Encounter_Rotation := (obj_get_rot(dude_obj) + 2) % 6;
                call Red_Wolves();
            end
            else begin
                if (LVar0 < 50) then begin
                    debug_msg("Brok_Encounter Table, Encounter 03");
                    display_mstr(103);
                    Encounter_Counter := random(6, 12);
                    Encounter_Rotation := obj_get_rot(dude_obj);
                    call DMRV_Scorpions();
                end
                else begin
                    if (LVar0 < 60) then begin
                        debug_msg("Brok_Encounter Table, Encounter 04");
                        display_mstr(104);
                        Encounter_Counter := random(8, 14);
                        Encounter_Rotation := random(0, 5);
                        call ARRO_Spore_Plants();
                    end
                    else begin
                        if (LVar0 < 70) then begin
                            debug_msg("Brok_Encounter Table, Encounter 05");
                            display_mstr(105);
                            Encounter_Counter := random(6, 10);
                            Encounter_Rotation := random(3, 5);
                            call Brok_Unity_Patrol();
                            Combat1 := Critter;
                            Encounter_Counter := random(6, 10);
                            Encounter_Rotation := random(0, 2);
                            call Brok_Rogues();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 80) then begin
                                debug_msg("Brok_Encounter Table, Encounter 06");
                                display_mstr(106);
                                Encounter_Counter := random(6, 10);
                                Encounter_Rotation := random(0, 2);
                                call Brok_Unity_Patrol();
                                Combat1 := Critter;
                                Encounter_Counter := random(8, 12);
                                Encounter_Rotation := random(0, 2);
                                call Red_Wolves();
                                Combat2 := Critter;
                            end
                            else begin
                                if (LVar0 < 100) then begin
                                    debug_msg("Brok_Encounter Table, Encounter 07");
                                    display_mstr(107);
                                    Encounter_Counter := random(8, 14);
                                    Encounter_Rotation := random(0, 5);
                                    call Brok_Unity_Patrol();
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Broken_Hills_VPat_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 10) then begin
        debug_msg("VPat_Encounter Table, Encounter 00");
        display_mstr(150);
        Encounter_Counter := random(4, 7);
        Encounter_Rotation := random(0, 5);
        call VPat_Strong_Slavers();
        Encounter_Counter := random(6, 8);
        Encounter_Rotation := random(0, 5);
        call DVMV_Wild_Dogs();
    end
    else begin
        if (LVar0 < 20) then begin
            debug_msg("VPat_Encounter Table, Encounter 01");
            display_mstr(151);
            Encounter_Counter := random(6, 12);
            Encounter_Rotation := obj_get_rot(dude_obj);
            call VPat_Strong_Slavers();
        end
        else begin
            if (LVar0 < 30) then begin
                debug_msg("VPat_Encounter Table, Encounter 02");
                display_mstr(152);
                Encounter_Counter := random(6, 12);
                Encounter_Rotation := random(3, 5);
                call DMRV_Golden_Geckos();
            end
            else begin
                if (LVar0 < 40) then begin
                    debug_msg("VPat_Encounter Table, Encounter 03");
                    display_mstr(153);
                    Encounter_Counter := random(8, 14);
                    Encounter_Rotation := random(0, 5);
                    call DVMV_Wild_Dogs();
                end
                else begin
                    if (LVar0 < 50) then begin
                        debug_msg("VPat_Encounter Table, Encounter 04");
                        display_mstr(154);
                        Encounter_Counter := random(3, 6);
                        Encounter_Rotation := random(0, 2);
                        call VPat_Patrol();
                        Combat1 := Critter;
                        Encounter_Counter := random(2, 4);
                        Encounter_Rotation := random(3, 5);
                        call DVMV_Wild_Dogs();
                        Encounter_Counter := random(8, 12);
                        Encounter_Rotation := random(3, 5);
                        call VPat_Strong_Slavers();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 60) then begin
                            debug_msg("VPat_Encounter Table, Encounter 05");
                            display_mstr(155);
                            Encounter_Counter := random(4, 7);
                            Encounter_Rotation := obj_get_rot(dude_obj);
                            call VPat_Strong_Slavers();
                            Combat1 := Critter;
                            Encounter_Counter := random(6, 12);
                            Encounter_Rotation := (obj_get_rot(dude_obj) + 1) % 6;
                            call DMRV_Golden_Geckos();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 70) then begin
                                debug_msg("VPat_Encounter Table, Encounter 06");
                                display_mstr(156);
                                Encounter_Counter := random(5, 8);
                                Encounter_Rotation := obj_get_rot(dude_obj);
                                call VPat_Patrol();
                                Combat1 := Critter;
                                Encounter_Counter := random(6, 10);
                                Encounter_Rotation := (obj_get_rot(dude_obj) + 3) % 6;
                                call VPat_Strong_Slavers();
                                Combat2 := Critter;
                            end
                            else begin
                                if (LVar0 < 80) then begin
                                    debug_msg("VPat_Encounter Table, Encounter 07");
                                    display_mstr(157);
                                    Encounter_Counter := random(3, 5);
                                    Encounter_Rotation := 2;
                                    call VPat_Patrol();
                                    Combat1 := Critter;
                                    Encounter_Counter := random(6, 12);
                                    Encounter_Rotation := 3;
                                    call DMRV_Golden_Geckos();
                                    Combat2 := Critter;
                                end
                                else begin
                                    if (LVar0 < 90) then begin
                                        debug_msg("VPat_Encounter Table, Encounter 08");
                                        display_mstr(158);
                                        Encounter_Counter := random(3, 5);
                                        Encounter_Rotation := random(2, 5);
                                        call VPat_Patrol();
                                        Combat1 := Critter;
                                        Encounter_Counter := random(8, 12);
                                        Encounter_Rotation := (Encounter_Rotation + 3) % 6;
                                        call DVMV_Wild_Dogs();
                                        Combat2 := Critter;
                                    end
                                    else begin
                                        if (LVar0 < 100) then begin
                                            debug_msg("VPat_Encounter Table, Encounter 09");
                                            display_mstr(159);
                                            Encounter_Counter := random(6, 12);
                                            Encounter_Rotation := 3;
                                            call VPat_Patrol();
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Broken_Hills_RDRC_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 25) then begin
        debug_msg("RDRC_Encounter Table, Encounter 00");
        display_mstr(200);
        Encounter_Counter := random(7, 12);
        Encounter_Rotation := obj_get_rot(dude_obj);
        call RDRC_Raiders();
    end
    else begin
        if (LVar0 < 40) then begin
            debug_msg("RDRC_Encounter Table, Encounter 01");
            display_mstr(201);
            Encounter_Counter := random(8, 14);
            Encounter_Rotation := random(0, 5);
            call Red_Wolves();
        end
        else begin
            if (LVar0 < 49) then begin
                debug_msg("RDRC_Encounter Table, Encounter 02");
                display_mstr(202);
                Encounter_Counter := random(6, 10);
                Encounter_Rotation := 2;
                call DNRV_Vault_Caravan();
                Combat1 := Critter;
                Encounter_Counter := random(8, 14);
                Encounter_Rotation := 1;
                call RDRC_Raiders();
                Combat2 := Critter;
            end
            else begin
                if (LVar0 < 58) then begin
                    debug_msg("RDRC_Encounter Table, Encounter 03");
                    display_mstr(203);
                    Encounter_Counter := random(4, 6);
                    Encounter_Rotation := 3;
                    call DNRV_Reno_Caravan();
                    Combat1 := Critter;
                    Encounter_Counter := random(8, 12);
                    Encounter_Rotation := 4;
                    call RDRC_Raiders();
                    Combat2 := Critter;
                end
                else begin
                    if (LVar0 < 67) then begin
                        debug_msg("RDRC_Encounter Table, Encounter 04");
                        display_mstr(204);
                        Encounter_Counter := random(6, 8);
                        Encounter_Rotation := 4;
                        call RDRC_Broken_Hills_Caravan();
                        Combat1 := Critter;
                        Encounter_Counter := random(8, 12);
                        Encounter_Rotation := 3;
                        call RDRC_Raiders();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 76) then begin
                            debug_msg("RDRC_Encounter Table, Encounter 05");
                            display_mstr(205);
                            Encounter_Counter := random(6, 10);
                            Encounter_Rotation := 5;
                            call RDRC_Gecko_Caravan();
                            Combat1 := Critter;
                            Encounter_Counter := random(10, 14);
                            Encounter_Rotation := 4;
                            call RDRC_Raiders();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 82) then begin
                                debug_msg("RDRC_Encounter Table, Encounter 06");
                                display_mstr(206);
                                Encounter_Counter := random(6, 10);
                                Encounter_Rotation := 2;
                                call DNRV_Vault_Caravan();
                            end
                            else begin
                                if (LVar0 < 88) then begin
                                    debug_msg("RDRC_Encounter Table, Encounter 07");
                                    display_mstr(207);
                                    Encounter_Counter := random(4, 6);
                                    Encounter_Rotation := 3;
                                    call DNRV_Reno_Caravan();
                                end
                                else begin
                                    if (LVar0 < 94) then begin
                                        debug_msg("RDRC_Encounter Table, Encounter 08");
                                        display_mstr(208);
                                        Encounter_Counter := random(6, 8);
                                        Encounter_Rotation := 4;
                                        call RDRC_Broken_Hills_Caravan();
                                    end
                                    else begin
                                        if (LVar0 < 100) then begin
                                            debug_msg("RDRC_Encounter Table, Encounter 09");
                                            display_mstr(209);
                                            Encounter_Counter := random(6, 10);
                                            Encounter_Rotation := 5;
                                            call RDRC_Gecko_Caravan();
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Broken_Hills_VNNB_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 20) then begin
        debug_msg("VNNB_Encounter Table, Encounter 00");
        display_mstr(250);
        Encounter_Counter := random(8, 14);
        Encounter_Rotation := obj_get_rot(dude_obj);
        call NCR_Marauders();
    end
    else begin
        if (LVar0 < 30) then begin
            debug_msg("VNNB_Encounter Table, Encounter 01");
            display_mstr(251);
            Encounter_Counter := random(8, 15);
            Encounter_Rotation := random(0, 5);
            call Red_Wolves();
        end
        else begin
            if (LVar0 < 40) then begin
                debug_msg("VNNB_Encounter Table, Encounter 02");
                display_mstr(252);
                Encounter_Counter := random(7, 12);
                Encounter_Rotation := random(0, 5);
                call DMRV_Scorpions();
            end
            else begin
                if (LVar0 < 48) then begin
                    debug_msg("VNNB_Encounter Table, Encounter 03");
                    display_mstr(253);
                    Encounter_Counter := random(5, 9);
                    Encounter_Counter := random(2, 4);
                    call RDRC_Broken_Hills_Caravan();
                    Combat1 := Critter;
                    Encounter_Counter := random(3, 9);
                    Encounter_Rotation := (Encounter_Rotation + 2) % 6;
                    call NCR_Marauders();
                    Combat2 := Critter;
                end
                else begin
                    if (LVar0 < 56) then begin
                        debug_msg("VNNB_Encounter Table, Encounter 04");
                        display_mstr(254);
                        Encounter_Counter := random(6, 9);
                        Encounter_Rotation := random(1, 3);
                        call DNRV_Reno_Caravan();
                        Combat1 := Critter;
                        Encounter_Counter := random(5, 9);
                        Encounter_Rotation := (Encounter_Rotation + 2) % 6;
                        call NCR_Marauders();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 64) then begin
                            debug_msg("VNNB_Encounter Table, Encounter 05");
                            display_mstr(255);
                            Encounter_Counter := random(5, 10);
                            Encounter_Rotation := 2;
                            call NCR_Caravan();
                            Combat1 := Critter;
                            Encounter_Counter := random(8, 12);
                            Encounter_Rotation := 2;
                            call Red_Wolves();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 72) then begin
                                debug_msg("VNNB_Encounter Table, Encounter 06");
                                display_mstr(256);
                                Encounter_Counter := random(4, 8);
                                Encounter_Rotation := 3;
                                call V15_Caravan();
                                Combat1 := Critter;
                                Encounter_Counter := random(4, 9);
                                Encounter_Rotation := 4;
                                call DMRV_Scorpions();
                                Combat2 := Critter;
                            end
                            else begin
                                if (LVar0 < 77) then begin
                                    debug_msg("VNNB_Encounter Table, Encounter 07");
                                    display_mstr(257);
                                    Encounter_Counter := random(5, 9);
                                    Encounter_Counter := random(2, 4);
                                    call RDRC_Broken_Hills_Caravan();
                                end
                                else begin
                                    if (LVar0 < 82) then begin
                                        debug_msg("VNNB_Encounter Table, Encounter 08");
                                        display_mstr(258);
                                        Encounter_Counter := random(6, 9);
                                        Encounter_Rotation := random(1, 3);
                                        call DNRV_Reno_Caravan();
                                    end
                                    else begin
                                        if (LVar0 < 87) then begin
                                            debug_msg("VNNB_Encounter Table, Encounter 09");
                                            display_mstr(259);
                                            Encounter_Counter := random(5, 10);
                                            Encounter_Rotation := 2;
                                            call NCR_Caravan();
                                        end
                                        else begin
                                            if (LVar0 < 92) then begin
                                                debug_msg("VNNB_Encounter Table, Encounter 10");
                                                display_mstr(260);
                                                Encounter_Counter := random(4, 8);
                                                Encounter_Rotation := 3;
                                                call V15_Caravan();
                                            end
                                            else begin
                                                if (LVar0 < 100) then begin
                                                    debug_msg("VNNB_Encounter Table, Encounter 11");
                                                    display_mstr(610);
                                                    Encounter_Counter := random(1, 2);
                                                    Encounter_Rotation := random(0, 5);
                                                    call New_Traveler();
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Broken_Hills_NCR_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 15) then begin
        debug_msg("NCR_Encounter Table, Encounter 00");
        display_mstr(300);
        Encounter_Counter := random(6, 9);
        Encounter_Rotation := random(0, 5);
        call NCR_Masters_Army();
    end
    else begin
        if (LVar0 < 30) then begin
            debug_msg("NCR_Encounter Table, Encounter 01");
            display_mstr(301);
            Encounter_Counter := random(8, 14);
            Encounter_Rotation := random(2, 5);
            call NCR_Marauders();
        end
        else begin
            if (LVar0 < 40) then begin
                debug_msg("NCR_Encounter Table, Encounter 02");
                display_mstr(302);
                Encounter_Counter := random(5, 9);
                Encounter_Rotation := 2;
                call NCR_Rangers();
                Combat1 := Critter;
                Encounter_Counter := random(5, 9);
                Encounter_Rotation := 2;
                call NCR_Masters_Army();
                Combat2 := Critter;
            end
            else begin
                if (LVar0 < 50) then begin
                    debug_msg("NCR_Encounter Table, Encounter 03");
                    display_mstr(303);
                    Encounter_Counter := random(5, 10);
                    Encounter_Rotation := 4;
                    call NCR_Rangers();
                    Combat1 := Critter;
                    Encounter_Counter := random(8, 12);
                    Encounter_Rotation := 5;
                    call NCR_Marauders();
                    Combat2 := Critter;
                end
                else begin
                    if (LVar0 < 60) then begin
                        debug_msg("NCR_Encounter Table, Encounter 04");
                        display_mstr(304);
                        Encounter_Counter := random(2, 6);
                        Encounter_Rotation := random(2, 4);
                        call KLA_Farmers();
                        Combat1 := Critter;
                        Encounter_Counter := random(5, 9);
                        Encounter_Rotation := Encounter_Rotation;
                        call NCR_Masters_Army();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 70) then begin
                            debug_msg("NCR_Encounter Table, Encounter 05");
                            display_mstr(305);
                            Encounter_Counter := random(3, 6);
                            Encounter_Rotation := random(2, 5);
                            call KLA_Farmers();
                            Combat1 := Critter;
                            Encounter_Counter := random(6, 9);
                            Encounter_Rotation := (Encounter_Rotation + 3) % 6;
                            call NCR_Marauders();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 90) then begin
                                debug_msg("NCR_Encounter Table, Encounter 06");
                                display_mstr(306);
                                Encounter_Counter := random(6, 10);
                                Encounter_Rotation := random(0, 5);
                                call NCR_Rangers();
                            end
                            else begin
                                if (LVar0 < 100) then begin
                                    debug_msg("NCR_Encounter Table, Encounter 07");
                                    display_mstr(307);
                                    Encounter_Counter := random(3, 5);
                                    Encounter_Rotation := random(0, 5);
                                    call KLA_Farmers();
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_Caravan
begin
    variable LVar0 := 0;
    call Build_Caravan_Team();
    if (global_var(GVAR_MEDICINE_CARAVAN) == 4) then begin
        debug_msg("In Medicine Caravan Encounter Setup.");
        if (global_var(GVAR_CARAVAN_START) == 1) then begin
            call Red_VC_Encounters();
        end
        else begin
            call VC_Red_Encounters();
        end
        if (map_var(1) > 0) then begin
            set_global_var(GVAR_MEDICINE_CARAVAN, 3);
        end
    end
    else begin
        if (global_var(GVAR_CATTLE_DRIVE_CARAVAN) == 4) then begin
            debug_msg("In Cattle Drive Encounter Setup.");
            if (global_var(GVAR_CARAVAN_START) == 1) then begin
                call Red_NCR_Encounters();
            end
            else begin
                call NCR_Red_Encounters();
            end
            if (map_var(1) > 0) then begin
                set_global_var(GVAR_CATTLE_DRIVE_CARAVAN, 3);
            end
        end
        else begin
            if (global_var(GVAR_JET_CARAVAN) == 4) then begin
                debug_msg("In Jet Caravan Encounter Setup.");
                if (global_var(GVAR_CARAVAN_START) == 1) then begin
                    call Red_Reno_Encounters();
                end
                else begin
                    call Reno_Red_Encounters();
                end
                if (map_var(1) > 0) then begin
                    set_global_var(GVAR_JET_CARAVAN, 3);
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Red_VC_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 700 + random(-25, 25), 125 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        game_time_advance(16 * (24 * (60 * (60 * 10))));
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 475 + random(-25, 25), 300 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(8 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 975 + random(-25, 25), 175 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(11 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 475 + random(-25, 25), 525 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(6 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 675 + random(-25, 25), 125 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(7 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 1025 + random(-25, 25), 225 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(9 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 475 + random(-25, 25), 575 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(5 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 575 + random(-25, 25), 175 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(6 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 775 + random(-25, 25), 125 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(4 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 1075 + random(-25, 25), 225 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(6 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Red_Reno_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 775 + random(-25, 25), 775 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        game_time_advance(6 * (24 * (60 * (60 * 10))));
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 700 + random(-25, 25), 700 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(4 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 750 + random(-25, 25), 925 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(4 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 675 + random(-25, 25), 675 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(3 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 725 + random(-25, 25), 875 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(3 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 925 + random(-25, 25), 925 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(3 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 650 + random(-25, 25), 600 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(2 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 725 + random(-25, 25), 800 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(3 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 750 + random(-25, 25), 925 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(2 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 975 + random(-25, 25), 925 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(3 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Red_NCR_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 700 + random(-25, 25), 1000 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        game_time_advance(16 * (24 * (60 * (60 * 10))));
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 675 + random(-25, 25), 925 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(10 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 800 + random(-25, 25), 1200 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(10 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 675 + random(-25, 25), 825 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(8 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 725 + random(-25, 25), 1100 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(8 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 900 + random(-25, 25), 1350 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(8 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 675 + random(-25, 25), 675 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(5 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 675 + random(-25, 25), 825 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(6 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 725 + random(-25, 25), 1175 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(6 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 1050 + random(-25, 25), 1400 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(5 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure VC_Red_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 700 + random(-25, 25), 125 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        game_time_advance(14 * (24 * (60 * (60 * 10))));
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 975 + random(-25, 25), 175 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(11 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 475 + random(-25, 25), 300 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(8 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 1025 + random(-25, 25), 225 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(9 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 675 + random(-25, 25), 125 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(7 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 475 + random(-25, 25), 525 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(6 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 1075 + random(-25, 25), 225 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(6 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 775 + random(-25, 25), 125 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(4 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 575 + random(-25, 25), 175 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(6 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 475 + random(-25, 25), 575 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(5 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Reno_Red_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 775 + random(-25, 25), 775 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        game_time_advance(6 * (24 * (60 * (60 * 10))));
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 750 + random(-25, 25), 925 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(4 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 475 + random(-25, 25), 700 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(4 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 925 + random(-25, 25), 925 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(3 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 725 + random(-25, 25), 875 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(3 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 675 + random(-25, 25), 675 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(3 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 975 + random(-25, 25), 925 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(5 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 750 + random(-25, 25), 925 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(5 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 725 + random(-25, 25), 800 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(5 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 650 + random(-25, 25), 600 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(5 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure NCR_Red_Encounters
begin
    variable LVar0 := 0;
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 1) then begin
        wm_area_set_pos(44, 700 + random(-25, 25), 1000 + random(-25, 25));
        set_exit_grids(0, -2, 0, 20100, 0);
        game_time_advance(16 * (24 * (60 * (60 * 10))));
        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
            call Redding_EPA_Encounter();
        end
        else begin
            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                call Redding_Reno_Encounter();
            end
            else begin
                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                    call Redding_SRNRRN_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                        call Broken_Hills_Brok_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                            call Broken_Hills_NCR_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                call Redding_Band_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                    call Redding_Red_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                        call Broken_Hills_VPat_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                            call Redding_NRNR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                call Redding_DNRV_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                    call Redding_DVMV_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                        call Broken_Hills_VNNB_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                            call Broken_Hills_RDRC_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                call Redding_DMRV_Encounter();
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    else begin
        if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 2) then begin
            if (LVar0 == 0) then begin
                wm_area_set_pos(44, 800 + random(-25, 25), 1200 + random(-25, 25));
                set_exit_grids(0, -2, 0, 20100, 0);
                game_time_advance(10 * (24 * (60 * (60 * 10))));
                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                    call Redding_EPA_Encounter();
                end
                else begin
                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                        call Redding_Reno_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                            call Redding_SRNRRN_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                call Broken_Hills_Brok_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                    call Broken_Hills_NCR_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                        call Redding_Band_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                            call Redding_Red_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                call Broken_Hills_VPat_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                    call Redding_NRNR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                        call Redding_DNRV_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                            call Redding_DVMV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                call Broken_Hills_VNNB_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                    call Broken_Hills_RDRC_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                        call Redding_DMRV_Encounter();
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (LVar0 == 1) then begin
                    wm_area_set_pos(44, 675 + random(-25, 25), 925 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(10 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        else begin
            if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 3) then begin
                if (LVar0 == 0) then begin
                    wm_area_set_pos(44, 900 + random(-25, 25), 1350 + random(-25, 25));
                    set_exit_grids(0, -2, 0, 20100, 0);
                    game_time_advance(8 * (24 * (60 * (60 * 10))));
                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                        call Redding_EPA_Encounter();
                    end
                    else begin
                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                            call Redding_Reno_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                call Redding_SRNRRN_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                    call Broken_Hills_Brok_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                        call Broken_Hills_NCR_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                            call Redding_Band_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                call Redding_Red_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                    call Broken_Hills_VPat_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                        call Redding_NRNR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                            call Redding_DNRV_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                call Redding_DVMV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                    call Broken_Hills_VNNB_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                        call Broken_Hills_RDRC_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                            call Redding_DMRV_Encounter();
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                else begin
                    if (LVar0 == 1) then begin
                        wm_area_set_pos(44, 725 + random(-25, 25), 1100 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(8 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 2) then begin
                            wm_area_set_pos(44, 675 + random(-25, 25), 825 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(8 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
            else begin
                if (global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) == 4) then begin
                    if (LVar0 == 0) then begin
                        wm_area_set_pos(44, 1050 + random(-25, 25), 1400 + random(-25, 25));
                        set_exit_grids(0, -2, 0, 20100, 0);
                        game_time_advance(5 * (24 * (60 * (60 * 10))));
                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                            call Redding_EPA_Encounter();
                        end
                        else begin
                            if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                call Redding_Reno_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                    call Redding_SRNRRN_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                        call Broken_Hills_Brok_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                            call Broken_Hills_NCR_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                call Redding_Band_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                    call Redding_Red_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                        call Broken_Hills_VPat_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                            call Redding_NRNR_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                call Redding_DNRV_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                    call Redding_DVMV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                        call Broken_Hills_VNNB_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                            call Broken_Hills_RDRC_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                call Redding_DMRV_Encounter();
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                    else begin
                        if (LVar0 == 1) then begin
                            wm_area_set_pos(44, 725 + random(-25, 25), 1175 + random(-25, 25));
                            set_exit_grids(0, -2, 0, 20100, 0);
                            game_time_advance(6 * (24 * (60 * (60 * 10))));
                            if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                call Redding_EPA_Encounter();
                            end
                            else begin
                                if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                    call Redding_Reno_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                        call Redding_SRNRRN_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                            call Broken_Hills_Brok_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                call Broken_Hills_NCR_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                    call Redding_Band_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                        call Redding_Red_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                            call Broken_Hills_VPat_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                call Redding_NRNR_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                    call Redding_DNRV_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                        call Redding_DVMV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                            call Broken_Hills_VNNB_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                call Broken_Hills_RDRC_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                    call Redding_DMRV_Encounter();
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                        else begin
                            if (LVar0 == 2) then begin
                                wm_area_set_pos(44, 675 + random(-25, 25), 825 + random(-25, 25));
                                set_exit_grids(0, -2, 0, 20100, 0);
                                game_time_advance(6 * (24 * (60 * (60 * 10))));
                                if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                    call Redding_EPA_Encounter();
                                end
                                else begin
                                    if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                        call Redding_Reno_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                            call Redding_SRNRRN_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                call Broken_Hills_Brok_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                    call Broken_Hills_NCR_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                        call Redding_Band_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                            call Redding_Red_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                call Broken_Hills_VPat_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                    call Redding_NRNR_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                        call Redding_DNRV_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                            call Redding_DVMV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                call Broken_Hills_VNNB_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                    call Broken_Hills_RDRC_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                        call Redding_DMRV_Encounter();
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                            else begin
                                if (LVar0 == 3) then begin
                                    wm_area_set_pos(44, 675 + random(-25, 25), 675 + random(-25, 25));
                                    set_exit_grids(0, -2, 0, 20100, 0);
                                    game_time_advance(5 * (24 * (60 * (60 * 10))));
                                    if ((worldmap_xpos >= 400) and (worldmap_xpos <= 750) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1150)) then begin
                                        call Redding_EPA_Encounter();
                                    end
                                    else begin
                                        if ((worldmap_xpos >= 750) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 800) and (worldmap_ypos <= 1100) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800))) then begin
                                            call Redding_Reno_Encounter();
                                        end
                                        else begin
                                            if ((worldmap_xpos >= 550) and (worldmap_xpos <= 800) and (worldmap_ypos >= 700) and (worldmap_ypos <= 800)) then begin
                                                call Redding_SRNRRN_Encounter();
                                            end
                                            else begin
                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 750) and (worldmap_ypos <= 800) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 750) and (worldmap_ypos <= 1050))) then begin
                                                    call Broken_Hills_Brok_Encounter();
                                                end
                                                else begin
                                                    if ((worldmap_xpos >= 1000) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1500)) then begin
                                                        call Broken_Hills_NCR_Encounter();
                                                    end
                                                    else begin
                                                        if ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 0) and (worldmap_ypos <= 100) or ((worldmap_xpos >= 650) and (worldmap_xpos <= 800) and (worldmap_ypos >= 150) and (worldmap_ypos <= 400))) then begin
                                                            call Redding_Band_Encounter();
                                                        end
                                                        else begin
                                                            if ((worldmap_xpos >= 500) and (worldmap_xpos <= 850) and (worldmap_ypos >= 400) and (worldmap_ypos <= 700) and not((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600)) and not((worldmap_xpos >= 800) and (worldmap_xpos <= 850) and (worldmap_ypos >= 650) and (worldmap_ypos <= 700))) then begin
                                                                call Redding_Red_Encounter();
                                                            end
                                                            else begin
                                                                if ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 450) and not((worldmap_xpos >= 1150) and (worldmap_xpos <= 1400) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300)) and not((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 400) and (worldmap_ypos <= 450))) then begin
                                                                    call Broken_Hills_VPat_Encounter();
                                                                end
                                                                else begin
                                                                    if ((worldmap_xpos >= 700) and (worldmap_xpos <= 800) and (worldmap_ypos >= 1150) and (worldmap_ypos <= 1300) or ((worldmap_xpos >= 750) and (worldmap_xpos <= 950) and (worldmap_ypos >= 1300) and (worldmap_ypos <= 1350)) or ((worldmap_xpos >= 850) and (worldmap_xpos <= 1000) and (worldmap_ypos >= 1350) and (worldmap_ypos <= 1400))) then begin
                                                                        call Redding_NRNR_Encounter();
                                                                    end
                                                                    else begin
                                                                        if ((worldmap_xpos >= 400) and (worldmap_xpos <= 450) and (worldmap_ypos >= 400) and (worldmap_ypos <= 500) or ((worldmap_xpos >= 450) and (worldmap_xpos <= 500) and (worldmap_ypos >= 300) and (worldmap_ypos <= 550)) or ((worldmap_xpos >= 500) and (worldmap_xpos <= 550) and (worldmap_ypos >= 500) and (worldmap_ypos <= 600))) then begin
                                                                            call Redding_DNRV_Encounter();
                                                                        end
                                                                        else begin
                                                                            if ((worldmap_xpos >= 950) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 250) and (worldmap_ypos <= 300))) then begin
                                                                                call Redding_DVMV_Encounter();
                                                                            end
                                                                            else begin
                                                                                if ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1200) and (worldmap_ypos >= 1000) and (worldmap_ypos <= 1400) or ((worldmap_xpos >= 1050) and (worldmap_xpos <= 1100) and (worldmap_ypos >= 1200) and (worldmap_ypos <= 1250)) or ((worldmap_xpos >= 1100) and (worldmap_xpos <= 1150) and (worldmap_ypos >= 1400) and (worldmap_ypos <= 1450))) then begin
                                                                                    call Broken_Hills_VNNB_Encounter();
                                                                                end
                                                                                else begin
                                                                                    if ((worldmap_xpos >= 1200) and (worldmap_xpos <= 1450) and (worldmap_ypos >= 450) and (worldmap_ypos <= 650) or ((worldmap_xpos >= 1150) and (worldmap_xpos <= 1300) and (worldmap_ypos >= 650) and (worldmap_ypos <= 750))) then begin
                                                                                        call Broken_Hills_RDRC_Encounter();
                                                                                    end
                                                                                    else begin
                                                                                        if ((worldmap_xpos >= 500) and (worldmap_xpos <= 600) and (worldmap_ypos >= 150) and (worldmap_ypos <= 250) or ((worldmap_xpos >= 550) and (worldmap_xpos <= 950) and (worldmap_ypos >= 100) and (worldmap_ypos <= 150)) or ((worldmap_xpos >= 900) and (worldmap_xpos <= 1050) and (worldmap_ypos >= 200) and (worldmap_ypos <= 250))) then begin
                                                                                            call Redding_DMRV_Encounter();
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_DNRV_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 10) then begin
        debug_msg("DNRV_Encounter Table, Encounter 00");
        display_mstr(350);
        Encounter_Counter := random(7, 12);
        Encounter_Rotation := random(0, 4);
        call DNRV_Den_Caravan();
    end
    else begin
        if (LVar0 < 20) then begin
            debug_msg("DNRV_Encounter Table, Encounter 01");
            display_mstr(351);
            Encounter_Counter := random(6, 8);
            Encounter_Rotation := random(0, 3);
            call DVMV_Highwaymen();
            Encounter_Counter := random(5, 8);
            Encounter_Rotation := random(1, 4);
            call DVMV_Robbers();
        end
        else begin
            if (LVar0 < 30) then begin
                debug_msg("DNRV_Encounter Table, Encounter 02");
                display_mstr(352);
                Encounter_Counter := random(8, 12);
                Encounter_Rotation := random(0, 5);
                call DVMV_Highwaymen();
            end
            else begin
                if (LVar0 < 40) then begin
                    debug_msg("DNRV_Encounter Table, Encounter 03");
                    display_mstr(353);
                    Encounter_Counter := random(6, 12);
                    Encounter_Rotation := random(0, 5);
                    call DVMV_Robbers();
                end
                else begin
                    if (LVar0 < 43) then begin
                        debug_msg("DNRV_Encounter Table, Encounter 04");
                        display_mstr(354);
                        Encounter_Counter := random(6, 10);
                        Encounter_Rotation := 3;
                        call DNRV_Redding_Caravan();
                        Combat1 := Critter;
                        Encounter_Counter := random(8, 12);
                        Encounter_Rotation := 4;
                        call DVMV_Highwaymen();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 48) then begin
                            debug_msg("DNRV_Encounter Table, Encounter 05");
                            display_mstr(355);
                            Encounter_Counter := random(4, 8);
                            Encounter_Rotation := random(0, 4);
                            call DNRV_Reno_Caravan();
                            Combat1 := Critter;
                            Encounter_Counter := random(6, 10);
                            Encounter_Rotation := (Encounter_Rotation + 1) % 6;
                            call DVMV_Robbers();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 58) then begin
                                debug_msg("DNRV_Encounter Table, Encounter 06");
                                display_mstr(356);
                                Encounter_Counter := random(4, 8);
                                Encounter_Rotation := random(3, 5);
                                call DNRV_Den_Caravan();
                                Combat1 := Critter;
                                Encounter_Counter := random(6, 10);
                                Encounter_Rotation := Encounter_Rotation;
                                call DVMV_Highwaymen();
                                Combat2 := Critter;
                            end
                            else begin
                                if (LVar0 < 68) then begin
                                    debug_msg("DNRV_Encounter Table, Encounter 07");
                                    display_mstr(357);
                                    Encounter_Counter := random(8, 12);
                                    Encounter_Rotation := random(0, 5);
                                    call DVMV_Robbers();
                                    Combat1 := Critter;
                                    Encounter_Counter := random(4, 7);
                                    Encounter_Rotation := random(3, 5);
                                    call DNRV_Vault_Caravan();
                                    Combat2 := Critter;
                                end
                                else begin
                                    if (LVar0 < 78) then begin
                                        debug_msg("DNRV_Encounter Table, Encounter 08");
                                        display_mstr(358);
                                        Encounter_Counter := random(4, 8);
                                        Encounter_Rotation := 3;
                                        call DNRV_Den_Caravan();
                                        Combat1 := Critter;
                                        Encounter_Counter := random(4, 8);
                                        Encounter_Rotation := 4;
                                        call DNRV_Vault_Caravan();
                                        Combat2 := Critter;
                                    end
                                    else begin
                                        if (LVar0 < 88) then begin
                                            debug_msg("DNRV_Encounter Table, Encounter 09");
                                            display_mstr(359);
                                            Encounter_Counter := random(6, 8);
                                            Encounter_Rotation := random(3, 5);
                                            call DVMV_Highwaymen();
                                            Combat1 := Critter;
                                            Encounter_Counter := random(6, 10);
                                            Encounter_Rotation := (Encounter_Rotation + 1) % 6;
                                            call DVMV_Robbers();
                                            Combat2 := Critter;
                                        end
                                        else begin
                                            if (LVar0 < 93) then begin
                                                debug_msg("DNRV_Encounter Table, Encounter 10");
                                                display_mstr(360);
                                                Encounter_Counter := random(6, 8);
                                                Encounter_Rotation := 4;
                                                call DNRV_Vault_Caravan();
                                            end
                                            else begin
                                                if (LVar0 < 100) then begin
                                                    debug_msg("DNRV_Encounter Table, Encounter 11");
                                                    display_mstr(361);
                                                    Encounter_Counter := random(4, 8);
                                                    Encounter_Rotation := 3;
                                                    call DNRV_Den_Caravan();
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_DMRV_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 7) then begin
        debug_msg("DMRV_Encounter Table, Encounter 00");
        display_mstr(400);
        Encounter_Counter := random(6, 9);
        Encounter_Rotation := random(0, 5);
        call DMRV_Highwaymen();
    end
    else begin
        if (LVar0 < 14) then begin
            debug_msg("DMRV_Encounter Table, Encounter 01");
            display_mstr(401);
            Encounter_Counter := random(6, 9);
            Encounter_Rotation := random(0, 5);
            call DMRV_Robbers();
        end
        else begin
            if (LVar0 < 21) then begin
                debug_msg("DMRV_Encounter Table, Encounter 02");
                display_mstr(402);
                Encounter_Counter := random(3, 6);
                Encounter_Rotation := random(0, 2);
                call DMRV_Robbers();
                Encounter_Counter := random(3, 6);
                Encounter_Rotation := random(3, 5);
                call DMRV_Highwaymen();
            end
            else begin
                if (LVar0 < 28) then begin
                    debug_msg("DMRV_Encounter Table, Encounter 03");
                    display_mstr(403);
                    Encounter_Counter := random(3, 6);
                    Encounter_Rotation := random(2, 5);
                    call DMRV_Golden_Geckos();
                    Encounter_Counter := random(3, 6);
                    Encounter_Counter := random(0, 3);
                    call DMRV_Scorpions();
                end
                else begin
                    if (LVar0 < 35) then begin
                        debug_msg("DMRV_Encounter Table, Encounter 04");
                        display_mstr(404);
                        Encounter_Counter := random(5, 8);
                        Encounter_Rotation := obj_get_rot(dude_obj);
                        call DMRV_Golden_Geckos();
                    end
                    else begin
                        if (LVar0 < 42) then begin
                            debug_msg("DMRV_Encounter Table, Encounter 05");
                            display_mstr(405);
                            Encounter_Counter := random(6, 9);
                            Encounter_Rotation := random(0, 4);
                            call Klad_Mole_Pig_Rat();
                        end
                        else begin
                            if (LVar0 < 49) then begin
                                debug_msg("DMRV_Encounter Table, Encounter 06");
                                display_mstr(406);
                                Encounter_Counter := random(5, 10);
                                Encounter_Rotation := random(2, 4);
                                call DMRV_Scorpions();
                            end
                            else begin
                                if (LVar0 < 56) then begin
                                    debug_msg("DMRV_Encounter Table, Encounter 07");
                                    display_mstr(407);
                                    Encounter_Counter := random(10, 15);
                                    Encounter_Rotation := random(0, 5);
                                    call ARRO_Spore_Plants();
                                end
                                else begin
                                    if (LVar0 < 63) then begin
                                        debug_msg("DMRV_Encounter Table, Encounter 08");
                                        display_mstr(408);
                                        Encounter_Counter := random(5, 8);
                                        Encounter_Rotation := random(2, 5);
                                        call DMRV_Robbers();
                                        Combat1 := Critter;
                                        Encounter_Counter := random(5, 8);
                                        Encounter_Rotation := random(0, 2);
                                        call DMRV_Highwaymen();
                                        Combat2 := Critter;
                                    end
                                    else begin
                                        if (LVar0 < 68) then begin
                                            debug_msg("DMRV_Encounter Table, Encounter 09");
                                            display_mstr(409);
                                            Encounter_Counter := random(6, 8);
                                            Encounter_Rotation := obj_get_rot(dude_obj);
                                            call DMRV_Caravan();
                                            Combat1 := Critter;
                                            Encounter_Counter := random(6, 10);
                                            Encounter_Rotation := (obj_get_rot(dude_obj) + 1) % 6;
                                            call DMRV_Highwaymen();
                                            Combat2 := Critter;
                                        end
                                        else begin
                                            if (LVar0 < 73) then begin
                                                debug_msg("DMRV_Encounter Table, Encounter 10");
                                                display_mstr(410);
                                                Encounter_Counter := random(6, 8);
                                                Encounter_Rotation := obj_get_rot(dude_obj);
                                                call DMRV_Caravan();
                                                Combat1 := Critter;
                                                Encounter_Counter := random(6, 10);
                                                Encounter_Counter := (obj_get_rot(dude_obj) + 1) % 6;
                                                call DMRV_Robbers();
                                                Combat2 := Critter;
                                            end
                                            else begin
                                                if (LVar0 < 78) then begin
                                                    debug_msg("DMRV_Encounter Table, Encounter 11");
                                                    display_mstr(411);
                                                    Encounter_Counter := random(6, 8);
                                                    Encounter_Rotation := obj_get_rot(dude_obj);
                                                    call DMRV_Caravan();
                                                    Combat1 := Critter;
                                                    Encounter_Counter := random(6, 10);
                                                    Encounter_Rotation := random(1, 5);
                                                    call DMRV_Scorpions();
                                                    Combat2 := Critter;
                                                end
                                                else begin
                                                    if (LVar0 < 85) then begin
                                                        debug_msg("DMRV_Encounter Table, Encounter 12");
                                                        display_mstr(412);
                                                        Encounter_Counter := random(5, 8);
                                                        Encounter_Rotation := random(0, 4);
                                                        call DMRV_Golden_Geckos();
                                                        Combat1 := Critter;
                                                        Encounter_Counter := random(5, 8);
                                                        Encounter_Rotation := random(1, 5);
                                                        call DMRV_Scorpions();
                                                        Combat2 := Critter;
                                                    end
                                                    else begin
                                                        if (LVar0 < 100) then begin
                                                            debug_msg("DMRV_Encounter Table, Encounter 13");
                                                            display_mstr(413);
                                                            Encounter_Counter := random(6, 8);
                                                            Encounter_Rotation := obj_get_rot(dude_obj);
                                                            call DMRV_Caravan();
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_Band_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 10) then begin
        debug_msg("Band_Encounter Table, Encounter 00");
        display_mstr(450);
        Encounter_Counter := random(3, 6);
        Encounter_Rotation := random(2, 5);
        call DMRV_Highwaymen();
        Encounter_Counter := random(4, 7);
        Encounter_Rotation := random(0, 3);
        call DMRV_Robbers();
    end
    else begin
        if (LVar0 < 20) then begin
            debug_msg("Band_Encounter Table, Encounter 01");
            display_mstr(451);
            Encounter_Counter := random(3, 6);
            Encounter_Rotation := random(3, 5);
            call DMRV_Highwaymen();
            Encounter_Counter := random(6, 10);
            Encounter_Rotation := random(0, 2);
            call DMRV_Golden_Geckos();
        end
        else begin
            if (LVar0 < 30) then begin
                debug_msg("Band_Encounter Table, Encounter 02");
                display_mstr(452);
                Encounter_Counter := random(6, 10);
                Encounter_Rotation := obj_get_rot(dude_obj);
                call DMRV_Golden_Geckos();
            end
            else begin
                if (LVar0 < 40) then begin
                    debug_msg("Band_Encounter Table, Encounter 03");
                    display_mstr(453);
                    Encounter_Counter := random(6, 8);
                    Encounter_Rotation := random(2, 4);
                    call DMRV_Scorpions();
                    Encounter_Counter := random(6, 12);
                    Encounter_Rotation := random(1, 5);
                    call ARRO_Spore_Plants();
                end
                else begin
                    if (LVar0 < 50) then begin
                        debug_msg("Band_Encounter Table, Encounter 04");
                        display_mstr(454);
                        Encounter_Counter := random(4, 6);
                        Encounter_Rotation := random(3, 5);
                        call DMRV_Robbers();
                        Combat1 := Critter;
                        Encounter_Counter := random(8, 12);
                        Encounter_Rotation := (Encounter_Rotation + 2) % 6;
                        call DMRV_Scorpions();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 60) then begin
                            debug_msg("Band_Encounter Table, Encounter 05");
                            display_mstr(455);
                            Encounter_Counter := random(6, 8);
                            Encounter_Rotation := (obj_get_rot(dude_obj) + 3) % 6;
                            call DMRV_Scorpions();
                            Combat1 := Critter;
                            Encounter_Counter := random(4, 6);
                            Encounter_Rotation := obj_get_rot(dude_obj);
                            call DMRV_Robbers();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 70) then begin
                                debug_msg("Band_Encounter Table, Encounter 06");
                                display_mstr(456);
                                Encounter_Counter := random(4, 5);
                                Encounter_Rotation := obj_get_rot(dude_obj);
                                call DMRV_Caravan();
                                Combat1 := Critter;
                                Encounter_Counter := random(6, 8);
                                Encounter_Rotation := random(3, 5);
                                call DMRV_Highwaymen();
                                Combat2 := Critter;
                            end
                            else begin
                                if (LVar0 < 80) then begin
                                    debug_msg("Band_Encounter Table, Encounter 07");
                                    display_mstr(457);
                                    Encounter_Counter := random(4, 5);
                                    Encounter_Rotation := obj_get_rot(dude_obj);
                                    call DMRV_Caravan();
                                    Combat1 := Critter;
                                    Encounter_Counter := random(5, 9);
                                    Encounter_Rotation := random(0, 3);
                                    call DMRV_Robbers();
                                    Combat2 := Critter;
                                end
                                else begin
                                    if (LVar0 < 90) then begin
                                        debug_msg("Band_Encounter Table, Encounter 08");
                                        display_mstr(458);
                                        Encounter_Counter := random(3, 6);
                                        Encounter_Rotation := random(0, 4);
                                        call DMRV_Highwaymen();
                                        Combat1 := Critter;
                                        Encounter_Counter := random(6, 12);
                                        Encounter_Rotation := random(0, 5);
                                        call ARRO_Spore_Plants();
                                        Combat2 := Critter;
                                    end
                                    else begin
                                        if (LVar0 < 100) then begin
                                            debug_msg("Band_Encounter Table, Encounter 09");
                                            display_mstr(459);
                                            Encounter_Counter := random(4, 5);
                                            Encounter_Rotation := obj_get_rot(dude_obj);
                                            call DMRV_Caravan();
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_DVMV_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 8) then begin
        debug_msg("DVMV_Encounter Table, Encounter 00");
        display_mstr(500);
        Encounter_Counter := random(6, 9);
        Encounter_Rotation := random(0, 3);
        call DVMV_Highwaymen();
        Encounter_Counter := random(6, 10);
        Encounter_Rotation := random(2, 5);
        call DVMV_Wild_Dogs();
    end
    else begin
        if (LVar0 < 16) then begin
            debug_msg("DVMV_Encounter Table, Encounter 01");
            display_mstr(501);
            Encounter_Counter := random(5, 10);
            Encounter_Rotation := random(2, 4);
            call DVMV_Robbers();
            Encounter_Counter := random(3, 6);
            Encounter_Rotation := Encounter_Rotation;
            call DVMV_Wild_Dogs();
        end
        else begin
            if (LVar0 < 24) then begin
                debug_msg("DVMV_Encounter Table, Encounter 02");
                display_mstr(502);
                Encounter_Counter := random(7, 11);
                Encounter_Rotation := random(0, 5);
                call DVMV_Robbers();
            end
            else begin
                if (LVar0 < 32) then begin
                    debug_msg("DVMV_Encounter Table, Encounter 03");
                    display_mstr(503);
                    Encounter_Counter := random(7, 11);
                    Encounter_Rotation := random(2, 5);
                    call DVMV_Highwaymen();
                end
                else begin
                    if (LVar0 < 40) then begin
                        debug_msg("DVMV_Encounter Table, Encounter 04");
                        display_mstr(504);
                        Encounter_Counter := random(8, 13);
                        Encounter_Rotation := random(0, 5);
                        call DVMV_Mantis_Swarm();
                        Encounter_Counter := random(6, 8);
                        Encounter_Rotation := random(0, 5);
                        call ARRO_Spore_Plants();
                    end
                    else begin
                        if (LVar0 < 48) then begin
                            debug_msg("DVMV_Encounter Table, Encounter 05");
                            display_mstr(505);
                            Encounter_Counter := random(6, 8);
                            Encounter_Rotation := random(1, 4);
                            call DVMV_Wild_Dogs();
                            Encounter_Counter := random(6, 8);
                            Encounter_Rotation := obj_get_rot(dude_obj);
                            call ARRO_Spore_Plants();
                        end
                        else begin
                            if (LVar0 < 56) then begin
                                debug_msg("DVMV_Encounter Table, Encounter 06");
                                display_mstr(506);
                                Encounter_Counter := random(10, 15);
                                Encounter_Rotation := random(0, 5);
                                call DVMV_Mantis_Swarm();
                            end
                            else begin
                                if (LVar0 < 64) then begin
                                    debug_msg("DVMV_Encounter Table, Encounter 07");
                                    display_mstr(507);
                                    Encounter_Counter := random(6, 12);
                                    Encounter_Rotation := random(0, 5);
                                    call DVMV_Wild_Dogs();
                                end
                                else begin
                                    if (LVar0 < 72) then begin
                                        debug_msg("DVMV_Encounter Table, Encounter 08");
                                        display_mstr(508);
                                        Encounter_Counter := random(6, 9);
                                        Encounter_Rotation := random(3, 5);
                                        call DVMV_Robbers();
                                        Combat1 := Critter;
                                        Encounter_Counter := random(6, 12);
                                        Encounter_Rotation := (Encounter_Rotation + 3) % 6;
                                        call DVMV_Wild_Dogs();
                                        Combat2 := Critter;
                                    end
                                    else begin
                                        if (LVar0 < 79) then begin
                                            debug_msg("DVMV_Encounter Table, Encounter 09");
                                            display_mstr(508);
                                            Encounter_Counter := random(6, 8);
                                            Encounter_Rotation := obj_get_rot(dude_obj);
                                            call DVMV_Caravan();
                                            Combat1 := Critter;
                                            Encounter_Counter := random(10, 14);
                                            Encounter_Rotation := (Encounter_Rotation + 3) % 6;
                                            call DVMV_Wild_Dogs();
                                            Combat2 := Critter;
                                        end
                                        else begin
                                            if (LVar0 < 86) then begin
                                                debug_msg("DVMV_Encounter Table, Encounter 10");
                                                display_mstr(510);
                                                Encounter_Counter := random(6, 8);
                                                Encounter_Rotation := obj_get_rot(dude_obj);
                                                call DVMV_Caravan();
                                                Combat1 := Critter;
                                                Encounter_Counter := random(6, 10);
                                                Encounter_Rotation := (Encounter_Rotation + 1) % 6;
                                                call DVMV_Robbers();
                                                Combat2 := Critter;
                                            end
                                            else begin
                                                if (LVar0 < 93) then begin
                                                    debug_msg("DVMV_Encounter Table, Encounter 11");
                                                    display_mstr(511);
                                                    Encounter_Counter := random(6, 8);
                                                    Encounter_Rotation := (obj_get_rot(dude_obj) + 1) % 6;
                                                    call DVMV_Caravan();
                                                    Combat1 := Critter;
                                                    Encounter_Counter := random(6, 8);
                                                    Encounter_Rotation := (Encounter_Rotation + 1) % 6;
                                                    call DVMV_Highwaymen();
                                                    Combat2 := Critter;
                                                end
                                                else begin
                                                    if (LVar0 < 100) then begin
                                                        debug_msg("DVMV_Encounter Table, Encounter 12");
                                                        display_mstr(512);
                                                        Encounter_Counter := random(6, 8);
                                                        Encounter_Rotation := obj_get_rot(dude_obj);
                                                        call DVMV_Caravan();
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_Red_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 10) then begin
        debug_msg("Red_Encounter Table, Encounter 00");
        display_mstr(550);
        Encounter_Counter := random(7, 12);
        Encounter_Rotation := random(0, 5);
        call DMRV_Golden_Geckos();
        Encounter_Counter := random(5, 8);
        Encounter_Rotation := (Encounter_Rotation + 3) % 6;
        call Red_Wolves();
    end
    else begin
        if (LVar0 < 20) then begin
            debug_msg("Red_Encounter Table, Encounter 01");
            display_mstr(551);
            Encounter_Counter := random(7, 10);
            Encounter_Rotation := random(1, 3);
            call Red_Claim_Jumper();
        end
        else begin
            if (LVar0 < 30) then begin
                debug_msg("Red_Encounter Table, Encounter 02");
                display_mstr(552);
                Encounter_Counter := random(7, 12);
                Encounter_Rotation := random(0, 5);
                call Red_Wolves();
            end
            else begin
                if (LVar0 < 35) then begin
                    debug_msg("Red_Encounter Table, Encounter 03");
                    display_mstr(553);
                    Encounter_Counter := random(7, 12);
                    Encounter_Rotation := random(0, 4);
                    call DMRV_Golden_Geckos();
                end
                else begin
                    if (LVar0 < 45) then begin
                        debug_msg("Red_Encounter Table, Encounter 04");
                        display_mstr(554);
                        Encounter_Counter := random(3, 5);
                        Encounter_Rotation := random(1, 3);
                        call Red_Prospector();
                        Combat1 := Critter;
                        Encounter_Counter := random(4, 7);
                        Encounter_Rotation := random(2, 5);
                        call Red_Claim_Jumper();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 55) then begin
                            debug_msg("Red_Encounter Table, Encounter 05");
                            display_mstr(555);
                            Encounter_Counter := random(3, 5);
                            Encounter_Rotation := (obj_get_rot(dude_obj) + 3) % 6;
                            call Red_Trappers();
                            Combat1 := Critter;
                            Encounter_Counter := random(6, 12);
                            Encounter_Rotation := obj_get_rot(dude_obj);
                            call DMRV_Golden_Geckos();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 65) then begin
                                debug_msg("Red_Encounter Table, Encounter 06");
                                display_mstr(556);
                                Encounter_Counter := random(2, 4);
                                Encounter_Rotation := random(0, 3);
                                call Red_Bootlegger();
                                Combat1 := Critter;
                                Encounter_Counter := random(5, 8);
                                Encounter_Rotation := (Encounter_Rotation + 2) % 6;
                                call Red_Wolves();
                                Combat2 := Critter;
                            end
                            else begin
                                if (LVar0 < 70) then begin
                                    debug_msg("Red_Encounter Table, Encounter 07");
                                    display_mstr(557);
                                    Encounter_Counter := random(2, 4);
                                    Encounter_Rotation := random(2, 4);
                                    call Red_Homesteaders();
                                    Combat1 := Critter;
                                    Encounter_Counter := random(6, 8);
                                    Encounter_Rotation := (Encounter_Rotation + 2) % 6;
                                    call Red_Claim_Jumper();
                                    Combat2 := Critter;
                                end
                                else begin
                                    if (LVar0 < 75) then begin
                                        debug_msg("Red_Encounter Table, Encounter 08");
                                        display_mstr(558);
                                        Encounter_Counter := random(4, 6);
                                        Encounter_Rotation := random(1, 3);
                                        call Red_Homesteaders();
                                        Combat1 := Critter;
                                        Encounter_Counter := random(6, 10);
                                        Encounter_Rotation := Encounter_Rotation;
                                        call Red_Wolves();
                                        Combat2 := Critter;
                                    end
                                    else begin
                                        if (LVar0 < 83) then begin
                                            debug_msg("Red_Encounter Table, Encounter 09");
                                            display_mstr(559);
                                            Encounter_Counter := random(4, 8);
                                            Encounter_Rotation := obj_get_rot(dude_obj);
                                            call Red_Bootlegger();
                                        end
                                        else begin
                                            if (LVar0 < 91) then begin
                                                debug_msg("Red_Encounter Table, Encounter 10");
                                                display_mstr(560);
                                                Encounter_Counter := random(6, 8);
                                                Encounter_Rotation := random(0, 4);
                                                call Red_Trappers();
                                            end
                                            else begin
                                                if (LVar0 < 100) then begin
                                                    debug_msg("Red_Encounter Table, Encounter 11");
                                                    display_mstr(561);
                                                    Encounter_Counter := random(3, 6);
                                                    Encounter_Rotation := random(0, 5);
                                                    call Red_Prospector();
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_SRNRRN_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 18) then begin
        debug_msg("SRNRRN_Encounter Table, Encounter 00");
        display_mstr(600);
        Encounter_Counter := random(3, 6);
        Encounter_Rotation := random(0, 5);
        call EPA_Deathclaws();
    end
    else begin
        if (LVar0 < 36) then begin
            debug_msg("SRNRRN_Encounter Table, Encounter 01");
            display_mstr(601);
            Encounter_Counter := random(5, 10);
            Encounter_Rotation := random(0, 4);
            call EPA_Fire_Geckos();
        end
        else begin
            if (LVar0 < 44) then begin
                debug_msg("SRNRRN_Encounter Table, Encounter 02");
                display_mstr(602);
                Encounter_Counter := random(6, 9);
                Encounter_Rotation := obj_get_rot(dude_obj);
                call DNRV_Reno_Caravan();
                Combat1 := Critter;
                Encounter_Counter := random(3, 5);
                Encounter_Rotation := (Encounter_Rotation + 1) % 6;
                call EPA_Deathclaws();
                Combat2 := Critter;
            end
            else begin
                if (LVar0 < 52) then begin
                    debug_msg("SRNRRN_Encounter Table, Encounter 03");
                    display_mstr(603);
                    Encounter_Counter := random(6, 10);
                    Encounter_Rotation := obj_get_rot(dude_obj);
                    call Fran2_San_Fran_Caravan();
                    Combat1 := Critter;
                    Encounter_Counter := random(4, 7);
                    Encounter_Rotation := (Encounter_Rotation + 1) % 6;
                    call EPA_Deathclaws();
                    Combat2 := Critter;
                end
                else begin
                    if (LVar0 < 60) then begin
                        debug_msg("SRNRRN_Encounter Table, Encounter 04");
                        display_mstr(604);
                        Encounter_Counter := random(5, 8);
                        Encounter_Rotation := obj_get_rot(dude_obj);
                        call DNRV_Redding_Caravan();
                        Combat1 := Critter;
                        Encounter_Counter := random(4, 6);
                        Encounter_Rotation := (Encounter_Rotation + 1) % 6;
                        call EPA_Fire_Geckos();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 68) then begin
                            debug_msg("SRNRRN_Encounter Table, Encounter 05");
                            display_mstr(605);
                            Encounter_Counter := random(7, 11);
                            Encounter_Rotation := obj_get_rot(dude_obj);
                            call NCR_Caravan();
                            Combat1 := Critter;
                            Encounter_Counter := random(3, 7);
                            Encounter_Rotation := random(0, 3);
                            call EPA_Fire_Geckos();
                            Combat2 := Critter;
                        end
                        else begin
                            if (LVar0 < 76) then begin
                                debug_msg("SRNRRN_Encounter Table, Encounter 06");
                                display_mstr(606);
                                Encounter_Counter := random(6, 10);
                                Encounter_Rotation := obj_get_rot(dude_obj);
                                call Fran2_San_Fran_Caravan();
                            end
                            else begin
                                if (LVar0 < 84) then begin
                                    debug_msg("SRNRRN_Encounter Table, Encounter 07");
                                    display_mstr(607);
                                    Encounter_Counter := random(5, 8);
                                    Encounter_Rotation := obj_get_rot(dude_obj);
                                    call DNRV_Redding_Caravan();
                                end
                                else begin
                                    if (LVar0 < 92) then begin
                                        debug_msg("SRNRRN_Encounter Table, Encounter 08");
                                        display_mstr(608);
                                        Encounter_Counter := random(6, 9);
                                        Encounter_Rotation := obj_get_rot(dude_obj);
                                        call DNRV_Reno_Caravan();
                                    end
                                    else begin
                                        if (LVar0 < 100) then begin
                                            debug_msg("SRNRRN_Encounter Table, Encounter 09");
                                            display_mstr(609);
                                            Encounter_Counter := random(7, 11);
                                            Encounter_Rotation := obj_get_rot(dude_obj);
                                            call NCR_Caravan();
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_EPA_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 4) then begin
        debug_msg("EPA_Encounter Table, Encounter 00");
        display_mstr(650);
        Encounter_Counter := random(5, 8);
        Encounter_Rotation := random(0, 3);
        call EPA_Special_Alien();
        Encounter_Counter := random(3, 6);
        Encounter_Rotation := random(3, 5);
        call EPA_Deathclaws();
    end
    else begin
        if (LVar0 < 16) then begin
            debug_msg("EPA_Encounter Table, Encounter 01");
            display_mstr(651);
            Encounter_Counter := random(6, 10);
            Encounter_Rotation := random(0, 5);
            call EPA_Floater_Centaurs();
        end
        else begin
            if (LVar0 < 28) then begin
                debug_msg("EPA_Encounter Table, Encounter 02");
                display_mstr(652);
                Encounter_Counter := random(8, 10);
                Encounter_Rotation := random(0, 3);
                call EPA_Special_Fire_Geckos();
            end
            else begin
                if (LVar0 < 40) then begin
                    debug_msg("EPA_Encounter Table, Encounter 03");
                    display_mstr(653);
                    Encounter_Counter := random(6, 10);
                    Encounter_Rotation := random(0, 5);
                    call EPA_Special_Alien();
                end
                else begin
                    if (LVar0 < 52) then begin
                        debug_msg("EPA_Encounter Table, Encounter 04");
                        display_mstr(654);
                        Encounter_Counter := random(3, 6);
                        Encounter_Rotation := random(0, 5);
                        call EPA_Deathclaws();
                    end
                    else begin
                        if (LVar0 < 64) then begin
                            debug_msg("EPA_Encounter Table, Encounter 05");
                            display_mstr(655);
                            Encounter_Counter := random(6, 10);
                            Encounter_Rotation := random(0, 5);
                            call EPA_Fire_Geckos();
                        end
                        else begin
                            if (LVar0 < 76) then begin
                                debug_msg("EPA_Encounter Table, Encounter 06");
                                display_mstr(656);
                                Encounter_Counter := random(6, 10);
                                Encounter_Rotation := random(0, 5);
                                call EPA_Alien();
                            end
                            else begin
                                if (LVar0 < 88) then begin
                                    debug_msg("EPA_Encounter Table, Encounter 07");
                                    display_mstr(657);
                                    Encounter_Counter := random(4, 8);
                                    Encounter_Rotation := random(0, 5);
                                    call EPA_Centaurs();
                                end
                                else begin
                                    if (LVar0 < 100) then begin
                                        debug_msg("EPA_Encounter Table, Encounter 08");
                                        display_mstr(658);
                                        Encounter_Counter := random(6, 10);
                                        Encounter_Rotation := random(0, 5);
                                        call EPA_Floaters();
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_Reno_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 15) then begin
        debug_msg("Reno_Encounter Table, Encounter 00");
        display_mstr(700);
        Encounter_Counter := random(6, 10);
        Encounter_Rotation := random(0, 5);
        call New_Yakuza();
    end
    else begin
        if (LVar0 < 30) then begin
            debug_msg("Reno_Encounter Table, Encounter 01");
            display_mstr(701);
            Encounter_Counter := random(7, 12);
            Encounter_Rotation := random(0, 3);
            call New_Gang();
        end
        else begin
            if (LVar0 < 40) then begin
                debug_msg("Reno_Encounter Table, Encounter 02");
                display_mstr(702);
                Encounter_Counter := random(7, 10);
                Encounter_Rotation := obj_get_rot(dude_obj);
                call Red_Wolves();
            end
            else begin
                if (LVar0 < 55) then begin
                    debug_msg("Reno_Encounter Table, Encounter 03");
                    display_mstr(703);
                    Encounter_Counter := random(4, 8);
                    Encounter_Rotation := random(0, 3);
                    call New_Mobsters();
                    Combat1 := Critter;
                    Encounter_Counter := random(5, 9);
                    Encounter_Rotation := (Encounter_Rotation + 3) % 6;
                    call New_Yakuza();
                    Combat2 := Critter;
                end
                else begin
                    if (LVar0 < 70) then begin
                        debug_msg("Reno_Encounter Table, Encounter 04");
                        display_mstr(704);
                        Encounter_Counter := random(4, 8);
                        Encounter_Rotation := random(3, 5);
                        call New_Mobsters();
                        Combat1 := Critter;
                        Encounter_Counter := random(6, 10);
                        Encounter_Rotation := Encounter_Rotation;
                        call New_Gang();
                        Combat2 := Critter;
                    end
                    else begin
                        if (LVar0 < 90) then begin
                            debug_msg("Reno_Encounter Table, Encounter 05");
                            display_mstr(705);
                            Encounter_Counter := random(4, 8);
                            Encounter_Rotation := obj_get_rot(dude_obj);
                            call New_Mobsters();
                        end
                        else begin
                            if (LVar0 < 100) then begin
                                debug_msg("Reno_Encounter Table, Encounter 06");
                                display_mstr(706);
                                Encounter_Counter := random(1, 2);
                                Encounter_Rotation := (obj_get_rot(dude_obj) + 3) % 6;
                                call New_Traveler();
                            end
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_NRNR_Encounter
begin
    variable LVar0 := 0;
    LVar0 := random(0, 99);
    if (LVar0 < 21) then begin
        debug_msg("NRNR_Encounter Table, Encounter 00");
        display_mstr(750);
        Encounter_Counter := random(6, 10);
        Encounter_Rotation := obj_get_rot(dude_obj);
        call NCR_Caravan();
        Combat1 := Critter;
        Encounter_Counter := random(7, 12);
        Encounter_Rotation := (Encounter_Rotation + 2) % 6;
        call NCR_Masters_Army();
        Combat2 := Critter;
    end
    else begin
        if (LVar0 < 41) then begin
            debug_msg("NRNR_Encounter Table, Encounter 01");
            display_mstr(751);
            Encounter_Counter := random(6, 10);
            Encounter_Counter := obj_get_rot(dude_obj);
            call DNRV_Reno_Caravan();
            Combat1 := Critter;
            Encounter_Counter := random(7, 11);
            Encounter_Rotation := (Encounter_Rotation + 1) % 6;
            call NCR_Masters_Army();
            Combat2 := Critter;
        end
        else begin
            if (LVar0 < 61) then begin
                debug_msg("NRNR_Encounter Table, Encounter 02");
                display_mstr(752);
                Encounter_Counter := random(6, 10);
                Encounter_Rotation := obj_get_rot(dude_obj);
                call DNRV_Redding_Caravan();
                Combat1 := Critter;
                Encounter_Counter := random(5, 9);
                Encounter_Rotation := (Encounter_Rotation + 1) % 6;
                call EPA_Deathclaws();
                Combat2 := Critter;
            end
            else begin
                if (LVar0 < 74) then begin
                    debug_msg("NRNR_Encounter Table, Encounter 03");
                    display_mstr(753);
                    Encounter_Counter := random(6, 10);
                    Encounter_Rotation := obj_get_rot(dude_obj);
                    call DNRV_Redding_Caravan();
                end
                else begin
                    if (LVar0 < 87) then begin
                        debug_msg("NRNR_Encounter Table, Encounter 04");
                        display_mstr(754);
                        Encounter_Counter := random(6, 10);
                        Encounter_Counter := obj_get_rot(dude_obj);
                        call DNRV_Reno_Caravan();
                    end
                    else begin
                        if (LVar0 < 100) then begin
                            debug_msg("NRNR_Encounter Table, Encounter 05");
                            display_mstr(755);
                            Encounter_Counter := random(6, 10);
                            Encounter_Rotation := obj_get_rot(dude_obj);
                            call NCR_Caravan();
                        end
                    end
                end
            end
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Redding_NCR_Encounter
begin
    call Broken_Hills_NCR_Encounter();
end

procedure NCR_Cattle_Drive
begin
    variable LVar0 := 0;
    call Build_Caravan_Team();
    LVar0 := global_var(GVAR_CARAVAN_ENCOUNTERS_TOTAL) - global_var(GVAR_CARAVAN_ENCOUNTERS);
    if ((global_var(GVAR_NCR_CATTLE_DRIVE) bwand 16) != 0) then begin
        call NCR_Red_Encounters();
        if (map_var(1) > 0) then begin
            set_global_var(GVAR_NCR_CATTLE_DRIVE, global_var(GVAR_NCR_CATTLE_DRIVE) bwor 64);
        end
    end
    return 0;
    LVar0 := 0;
end

procedure Default_Caravan
begin
    variable LVar0 := 0;
    call Build_Caravan_Team();
    return 0;
    LVar0 := 0;
end

procedure Build_Caravan_Team
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    variable LVar4 := 0;
    variable LVar5 := 0;
    variable LVar6 := 0;
    variable LVar7 := 0;
    variable LVar8 := 0;
    variable LVar9 := 0;
    variable LVar10 := 0;
    variable LVar11 := 0;
    variable LVar12 := 0;
    variable LVar13 := 0;
    variable LVar14 := 0;
    variable LVar15 := 0;
    variable LVar16 := 0;
    LVar1 := random(0, 5);
    LVar0 := tile_num_in_direction(22097, LVar1, random(3, 8));
    override_map_start(LVar0 % 200, LVar0 / 200, 0, random(0, 5));
    anim(dude_obj, 1000, LVar1);
    for (call Add_Mysterious_Stranger(); LVar2 < global_var(GVAR_CARAVAN_MASTERS); anim(LVar7, 1000, rotation_to_tile(tile_num(LVar7), dude_tile))) begin
        LVar2 := LVar2 + 1;
        if (global_var(GVAR_MEDICINE_CARAVAN) == 4) then begin
            LVar7 := create_object_sid(16777308, 0, 0, SCRIPT_RCWADE);
            add_obj_to_inven(LVar7, create_object(388, 0, 0));
        end
        else begin
            if (global_var(GVAR_CATTLE_DRIVE_CARAVAN) == 4) then begin
                LVar7 := create_object_sid(16777260, 0, 0, SCRIPT_RCSTANWL);
                add_obj_to_inven(LVar7, create_object(388, 0, 0));
            end
            else begin
                if (global_var(GVAR_JET_CARAVAN) == 4) then begin
                    LVar7 := create_object_sid(16777252, 0, 0, SCRIPT_RCSAVINE);
                    add_obj_to_inven(LVar7, create_object(242, 0, 0));
                end
                else begin
                    if (global_var(GVAR_BH_CARAVAN) == 2) then begin
                        LVar7 := create_object_sid(16777248, 0, 0, SCRIPT_HCCHAD);
                    end
                    else begin
                        if ((global_var(GVAR_NCR_CATTLE_DRIVE) bwand 16) != 0) then begin
                            LVar7 := create_object_sid(16777477, 0, 0, SCRIPT_SCHAL);
                            add_obj_to_inven(LVar7, create_object(354, 0, 0));
                            add_obj_to_inven(LVar7, create_object(95, 0, 0));
                        end
                        else begin
                            LVar7 := create_object(16777359, 0, 0);
                        end
                    end
                end
            end
        end
        LVar16 := critter_add_trait(LVar7, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
        LVar11 := (LVar1 + 3) % 6;
        LVar8 := tile_num_in_direction(LVar0, LVar11, random(5, 7));
        critter_attempt_placement(LVar7, LVar8, 0);
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(LVar7, 2 * random(10, 30));
            continue;
        end
        item_caps_adjust(LVar7, random(10, 30));
    end
    while ((global_var(GVAR_CARAVAN_CARTS) > ((global_var(GVAR_CARAVAN_BRAHMIN) / 2) + (global_var(GVAR_CARAVAN_BRAHMIN) % 2))) and (global_var(GVAR_CARAVAN_BRAHMIN) != 0)) do begin
        set_global_var(GVAR_CARAVAN_CARTS, global_var(GVAR_CARAVAN_CARTS) - 1);
        for (/* O_NOOP */; LVar3 < global_var(GVAR_CARAVAN_CARTS); anim(LVar7, 1000, 1)) begin
            LVar3 := LVar3 + 1;
            LVar8 := tile_num_in_direction(LVar8, LVar11, 8);
            if (random(0, 99) < 50) then begin
                Scenery_Creation := create_object(33554959, LVar8, 0);
                Scenery_Creation_Hex := LVar8;
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 1) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 1, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 2) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 3, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 2) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 4, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 1) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 5, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 1) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 0, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 1) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 5, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 2) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 1, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
            end
            else begin
                Scenery_Creation := create_object(33554960, LVar8, 0);
                Scenery_Creation_Hex := LVar8;
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 1) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 1, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 2) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 3, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 2) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 4, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 1) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 5, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 1) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 0, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 1) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 5, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
                Scenery_Creation_Count := 0;
                while (Scenery_Creation_Count < 2) do begin
                    Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 1, 1);
                    Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, 0);
                    Scenery_Creation_Count := Scenery_Creation_Count + 1;
                end
            end
            LVar9 := tile_num_in_direction(LVar8, 0, 1);
            LVar7 := create_object_sid(16777226, 0, 0, SCRIPT_ECCRTBRA);
            critter_attempt_placement(LVar7, LVar9, 0);
            LVar16 := critter_add_trait(LVar7, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
            anim(LVar7, 1000, 1);
            LVar4 := LVar4 + 1;
            if (LVar4 < global_var(GVAR_CARAVAN_BRAHMIN)) then begin
                LVar9 := tile_num_in_direction(LVar8, 2, 2);
                LVar7 := create_object_sid(16777226, 0, 0, SCRIPT_ECCRTBRA);
                critter_attempt_placement(LVar7, LVar9, 0);
                LVar16 := critter_add_trait(LVar7, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
                anim(LVar7, 1000, 1);
                LVar4 := LVar4 + 1;
            end
            if (LVar5 < global_var(GVAR_CARAVAN_DRIVERS)) then begin
                LVar5 := LVar5 + 1;
                if (global_var(GVAR_MEDICINE_CARAVAN) == 4) then begin
                    if (random(0, 99) < 50) then begin
                        LVar7 := create_object_sid(16777308, 0, 0, SCRIPT_RCCVNDRV);
                    end
                    else begin
                        LVar7 := create_object_sid(16777307, 0, 0, SCRIPT_RCCVNDRV);
                    end
                end
                else begin
                    if (global_var(GVAR_CATTLE_DRIVE_CARAVAN) == 4) then begin
                        if (random(0, 99) < 50) then begin
                            LVar7 := create_object_sid(16777353, 0, 0, SCRIPT_RCCVNDRV);
                        end
                        else begin
                            LVar7 := create_object_sid(16777354, 0, 0, SCRIPT_RCCVNDRV);
                        end
                    end
                    else begin
                        if (global_var(GVAR_JET_CARAVAN) == 4) then begin
                            if (random(0, 99) < 50) then begin
                                LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNDRV);
                            end
                            else begin
                                LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNDRV);
                            end
                        end
                        else begin
                            if (global_var(GVAR_BH_CARAVAN) == 2) then begin
                                if (random(0, 99) < 50) then begin
                                    LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNDRV);
                                end
                                else begin
                                    LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNDRV);
                                end
                            end
                            else begin
                                if ((global_var(GVAR_NCR_CATTLE_DRIVE) bwand 16) != 0) then begin
                                    if (random(0, 99) < 50) then begin
                                        LVar7 := create_object_sid(16777477, 0, 0, SCRIPT_RCCVNDRV);
                                    end
                                    else begin
                                        LVar7 := create_object_sid(16777478, 0, 0, SCRIPT_RCCVNDRV);
                                    end
                                    LVar15 := random(0, 99);
                                    if (LVar15 < 33) then begin
                                        LVar14 := create_object(332, 0, 0);
                                    end
                                    else begin
                                        if (LVar15 < 66) then begin
                                            LVar14 := create_object(268, 0, 0);
                                        end
                                        else begin
                                            if (LVar15 < 99) then begin
                                                LVar14 := create_object(118, 0, 0);
                                            end
                                        end
                                    end
                                end
                                else begin
                                    if (random(0, 99) < 50) then begin
                                        LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNDRV);
                                    end
                                    else begin
                                        LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNDRV);
                                    end
                                end
                            end
                        end
                    end
                end
                LVar10 := tile_num_in_direction(LVar8, 1, 3);
                critter_attempt_placement(LVar7, LVar10, 0);
                LVar16 := critter_add_trait(LVar7, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
                if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                    item_caps_adjust(LVar7, 2 * random(5, 20));
                    continue;
                end
                item_caps_adjust(LVar7, random(5, 20));
            end
        end
        LVar12 := (LVar11 + 1) % 6;
        LVar9 := tile_num_in_direction(LVar0, LVar12, random(7, 10));
        while (LVar4 < global_var(GVAR_CARAVAN_BRAHMIN)) do begin
            LVar4 := LVar4 + 1;
            LVar9 := tile_num_in_direction(LVar9, random(0, 5), random(2, 5));
            LVar7 := create_object_sid(16777226, 0, 0, SCRIPT_ECCRTBRA);
            critter_attempt_placement(LVar7, LVar9, 0);
            LVar16 := critter_add_trait(LVar7, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
            anim(LVar7, 1000, random(0, 5));
        end
        LVar13 := (LVar11 + 1) % 6;
        for (LVar10 := tile_num_in_direction(LVar0, LVar13, random(7, 10)); LVar5 < global_var(GVAR_CARAVAN_DRIVERS); anim(LVar7, 1000, random(0, 5))) begin
            LVar5 := LVar5 + 1;
            if (global_var(GVAR_MEDICINE_CARAVAN) == 4) then begin
                if (random(0, 99) < 50) then begin
                    LVar7 := create_object_sid(16777308, 0, 0, SCRIPT_RCCVNDRV);
                end
                else begin
                    LVar7 := create_object_sid(16777307, 0, 0, SCRIPT_RCCVNDRV);
                end
            end
            else begin
                if (global_var(GVAR_CATTLE_DRIVE_CARAVAN) == 4) then begin
                    if (random(0, 99) < 50) then begin
                        LVar7 := create_object_sid(16777353, 0, 0, SCRIPT_RCCVNDRV);
                    end
                    else begin
                        LVar7 := create_object_sid(16777354, 0, 0, SCRIPT_RCCVNDRV);
                    end
                end
                else begin
                    if (global_var(GVAR_JET_CARAVAN) == 4) then begin
                        if (random(0, 99) < 50) then begin
                            LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNDRV);
                        end
                        else begin
                            LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNDRV);
                        end
                    end
                    else begin
                        if (global_var(GVAR_BH_CARAVAN) == 2) then begin
                            if (random(0, 99) < 50) then begin
                                LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNDRV);
                            end
                            else begin
                                LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNDRV);
                            end
                        end
                        else begin
                            if ((global_var(GVAR_NCR_CATTLE_DRIVE) bwand 16) != 0) then begin
                                if (random(0, 99) < 50) then begin
                                    LVar7 := create_object_sid(16777477, 0, 0, SCRIPT_RCCVNDRV);
                                end
                                else begin
                                    LVar7 := create_object_sid(16777478, 0, 0, SCRIPT_RCCVNDRV);
                                end
                                LVar15 := random(0, 99);
                                if (LVar15 < 33) then begin
                                    LVar14 := create_object(332, 0, 0);
                                end
                                else begin
                                    if (LVar15 < 66) then begin
                                        LVar14 := create_object(268, 0, 0);
                                    end
                                    else begin
                                        if (LVar15 < 99) then begin
                                            LVar14 := create_object(118, 0, 0);
                                        end
                                    end
                                end
                            end
                            else begin
                                if (random(0, 99) < 50) then begin
                                    LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNDRV);
                                end
                                else begin
                                    LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNDRV);
                                end
                            end
                        end
                    end
                end
            end
            LVar10 := tile_num_in_direction(LVar10, 1, 3);
            critter_attempt_placement(LVar7, LVar10, 0);
            LVar16 := critter_add_trait(LVar7, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(LVar7, 2 * random(5, 20));
                continue;
            end
            item_caps_adjust(LVar7, random(5, 20));
        end
        LVar11 := LVar11 - 1;
        while (LVar11 < 0) do begin
            LVar11 := LVar11 + 6;
        end
        if (LVar11 > 5) then begin
            LVar11 := LVar11 % 6;
        end
        LVar8 := tile_num_in_direction(LVar0, LVar11, random(7, 10));
        while (LVar6 < global_var(GVAR_CARAVAN_GUARDS)) do begin
            LVar6 := LVar6 + 1;
            if (global_var(GVAR_MEDICINE_CARAVAN) == 4) then begin
                if (random(0, 99) < 50) then begin
                    LVar7 := create_object_sid(16777262, 0, 0, SCRIPT_RCCVNGRD);
                end
                else begin
                    LVar7 := create_object_sid(16777263, 0, 0, SCRIPT_RCCVNGRD);
                end
                LVar15 := random(0, 99);
                if (LVar15 < 50) then begin
                    LVar14 := create_object(242, 0, 0);
                end
                else begin
                    if (LVar15 < 99) then begin
                        LVar14 := create_object(23, 0, 0);
                    end
                end
            end
            else begin
                if (global_var(GVAR_CATTLE_DRIVE_CARAVAN) == 4) then begin
                    if (random(0, 99) < 50) then begin
                        LVar7 := create_object_sid(16777353, 0, 0, SCRIPT_RCCVNGRD);
                    end
                    else begin
                        LVar7 := create_object_sid(16777354, 0, 0, SCRIPT_RCCVNGRD);
                    end
                    LVar15 := random(0, 99);
                    if (LVar15 < 50) then begin
                        LVar14 := create_object(352, 0, 0);
                    end
                    else begin
                        if (LVar15 < 99) then begin
                            LVar14 := create_object(351, 0, 0);
                        end
                    end
                end
                else begin
                    if (global_var(GVAR_JET_CARAVAN) == 4) then begin
                        if (random(0, 99) < 50) then begin
                            LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNGRD);
                        end
                        else begin
                            LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNGRD);
                        end
                        LVar15 := random(0, 99);
                        if (LVar15 < 50) then begin
                            LVar14 := create_object(268, 0, 0);
                        end
                        else begin
                            if (LVar15 < 99) then begin
                                LVar14 := create_object(283, 0, 0);
                            end
                        end
                    end
                    else begin
                        if (global_var(GVAR_BH_CARAVAN) == 2) then begin
                            if (random(0, 99) < 50) then begin
                                LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNGRD);
                            end
                            else begin
                                LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNGRD);
                            end
                            LVar15 := random(0, 99);
                            if (LVar15 < 50) then begin
                                LVar14 := create_object(332, 0, 0);
                            end
                            else begin
                                if (LVar15 < 99) then begin
                                    LVar14 := create_object(268, 0, 0);
                                end
                            end
                        end
                        else begin
                            if ((global_var(GVAR_NCR_CATTLE_DRIVE) bwand 16) != 0) then begin
                                if (random(0, 99) < 50) then begin
                                    LVar7 := create_object_sid(16777477, 0, 0, SCRIPT_RCCVNGRD);
                                end
                                else begin
                                    LVar7 := create_object_sid(16777478, 0, 0, SCRIPT_RCCVNGRD);
                                end
                                LVar15 := random(0, 99);
                                if (LVar15 < 33) then begin
                                    LVar14 := create_object(332, 0, 0);
                                end
                                else begin
                                    if (LVar15 < 66) then begin
                                        LVar14 := create_object(268, 0, 0);
                                    end
                                    else begin
                                        if (LVar15 < 99) then begin
                                            LVar14 := create_object(118, 0, 0);
                                        end
                                    end
                                end
                            end
                            else begin
                                if (random(0, 99) < 50) then begin
                                    LVar7 := create_object_sid(16777400, 0, 0, SCRIPT_RCCVNGRD);
                                end
                                else begin
                                    LVar7 := create_object_sid(16777401, 0, 0, SCRIPT_RCCVNGRD);
                                end
                                LVar15 := random(0, 99);
                                if (LVar15 < 50) then begin
                                    LVar14 := create_object(388, 0, 0);
                                end
                                else begin
                                    if (LVar15 < 99) then begin
                                        LVar14 := create_object(354, 0, 0);
                                    end
                                end
                            end
                        end
                    end
                end
            end
            LVar8 := tile_num_in_direction(LVar8, random(0, 5), random(2, 4));
            critter_attempt_placement(LVar7, LVar8, 0);
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(LVar7, 2 * random(10, 20));
            end
            else begin
                item_caps_adjust(LVar7, random(10, 20));
            end
            LVar16 := critter_add_trait(LVar7, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
            anim(LVar7, 1000, obj_get_rot(dude_obj));
            add_obj_to_inven(LVar7, LVar14);
            wield_obj_critter(LVar7, LVar14);
            if (random(0, 99) < 50) then begin
                LVar14 := create_object(40, 0, 0);
                add_obj_to_inven(LVar7, LVar14);
            end
        end
        return 0;
        LVar0 := 0;
        LVar1 := 0;
        LVar2 := 0;
        LVar3 := 0;
        LVar4 := 0;
        LVar5 := 0;
        LVar6 := 0;
        LVar7 := 0;
        LVar8 := 0;
        LVar9 := 0;
        LVar10 := 0;
        LVar11 := 0;
        LVar12 := 0;
        LVar13 := 0;
        LVar14 := 0;
        LVar15 := 0;
        LVar16 := 0;
    end

procedure Build_Grey_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    LVar1 := tile_num_in_direction(dude_tile, Encounter_Rotation, 20);
    Scenery_Creation := create_object(33554960, LVar1, dude_elevation);
    Scenery_Creation_Hex := LVar1;
    Scenery_Creation_Count := 0;
    while (Scenery_Creation_Count < 1) do begin
        Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 1, 1);
        Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, dude_elevation);
        Scenery_Creation_Count := Scenery_Creation_Count + 1;
    end
    Scenery_Creation_Count := 0;
    while (Scenery_Creation_Count < 2) do begin
        Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 3, 1);
        Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, dude_elevation);
        Scenery_Creation_Count := Scenery_Creation_Count + 1;
    end
    Scenery_Creation_Count := 0;
    while (Scenery_Creation_Count < 2) do begin
        Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 4, 1);
        Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, dude_elevation);
        Scenery_Creation_Count := Scenery_Creation_Count + 1;
    end
    Scenery_Creation_Count := 0;
    while (Scenery_Creation_Count < 1) do begin
        Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 5, 1);
        Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, dude_elevation);
        Scenery_Creation_Count := Scenery_Creation_Count + 1;
    end
    Scenery_Creation_Count := 0;
    while (Scenery_Creation_Count < 1) do begin
        Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 0, 1);
        Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, dude_elevation);
        Scenery_Creation_Count := Scenery_Creation_Count + 1;
    end
    Scenery_Creation_Count := 0;
    while (Scenery_Creation_Count < 1) do begin
        Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 5, 1);
        Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, dude_elevation);
        Scenery_Creation_Count := Scenery_Creation_Count + 1;
    end
    Scenery_Creation_Count := 0;
    while (Scenery_Creation_Count < 2) do begin
        Scenery_Creation_Hex := tile_num_in_direction(Scenery_Creation_Hex, 1, 1);
        Scenery_Creation := create_object(33554499, Scenery_Creation_Hex, dude_elevation);
        Scenery_Creation_Count := Scenery_Creation_Count + 1;
    end
    LVar0 := tile_num_in_direction(LVar1, 0, 1);
    Critter := create_object_sid(16777226, 0, 0, SCRIPT_ECCRTBRA);
    critter_attempt_placement(Critter, LVar0, 0);
    anim(Critter, 1000, 1);
    LVar0 := tile_num_in_direction(LVar1, 2, 2);
    Critter := create_object_sid(16777226, 0, 0, SCRIPT_ECCRTBRA);
    critter_attempt_placement(Critter, LVar0, 0);
    anim(Critter, 1000, 1);
    return 0;
    LVar0 := 0;
    LVar1 := 0;
end

procedure Add_Mysterious_Stranger
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    variable LVar4 := 0;
    LVar2 := random(0, 99);
    LVar3 := 30 + (2 * dude_luck);
    if (map_first_run and not(global_var(GVAR_MYSTERIOUS_STRANGER) bwand 1) and (LVar2 < LVar3) and has_trait(TRAIT_PERK, dude_obj, PERK_mysterious_stranger)) then begin
        if (not(global_var(GVAR_MYSTERIOUS_STRANGER) bwand 2)) then begin
            set_global_var(GVAR_MYSTERIOUS_STRANGER, global_var(GVAR_MYSTERIOUS_STRANGER) bwor 2);
            if (random(0, 99) < 50) then begin
                set_global_var(GVAR_MYSTERIOUS_STRANGER, global_var(GVAR_MYSTERIOUS_STRANGER) bwor 4);
            end
        end
        if (global_var(GVAR_MYSTERIOUS_STRANGER) bwand 4) then begin
            LVar0 := create_object_sid(16777487, 0, 0, SCRIPT_ECMSTSTR);
        end
        else begin
            LVar0 := create_object_sid(16777486, 0, 0, SCRIPT_ECMSTSTR);
        end
        LVar1 := tile_num_in_direction(dude_tile, random(0, 5), random(5, 10));
        critter_attempt_placement(LVar0, LVar1, dude_elevation);
        LVar4 := critter_add_trait(LVar0, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(LVar0, 2 * random(30, 60));
        end
        else begin
            item_caps_adjust(LVar0, random(30, 60));
        end
        anim(LVar0, 1000, obj_get_rot(dude_obj));
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
    LVar4 := 0;
end

procedure Brok_Rogues
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777252, 0, 0, SCRIPT_ECROGUE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (388 > 0) then begin
            LVar3 := create_object(388, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 20));
        end
        else begin
            item_caps_adjust(Critter, random(5, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777253, 0, 0, SCRIPT_ECROGUE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (354 > 0) then begin
            LVar3 := create_object(354, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 20));
        end
        else begin
            item_caps_adjust(Critter, random(5, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777255, 0, 0, SCRIPT_ECROGUE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (11 > 0) then begin
            LVar3 := create_object(11, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 20));
        end
        else begin
            item_caps_adjust(Critter, random(5, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777254, 0, 0, SCRIPT_ECROGUE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (268 > 0) then begin
            LVar3 := create_object(268, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 20));
        end
        else begin
            item_caps_adjust(Critter, random(5, 20));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure Red_Wolves
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 1;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777298, 0, 0, SCRIPT_ECWLDDOG);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DMRV_Scorpions
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 1;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777222, 0, 0, SCRIPT_ECSCORP);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure ARRO_Spore_Plants
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 1;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777232, 0, 0, SCRIPT_ECPLANT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure Brok_Unity_Patrol
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    variable LVar4 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777472, 0, 0, SCRIPT_ECUNIPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (12 > 0) then begin
            LVar3 := create_object(12, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(4, 14));
        end
        else begin
            item_caps_adjust(Critter, random(4, 14));
        end
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777474, 0, 0, SCRIPT_ECUNIPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (242 > 0) then begin
            LVar3 := create_object(242, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(3, 10));
        end
        else begin
            item_caps_adjust(Critter, random(3, 10));
        end
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777474, 0, 0, SCRIPT_ECUNIPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (23 > 0) then begin
            LVar3 := create_object(23, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(4, 10));
        end
        else begin
            item_caps_adjust(Critter, random(4, 10));
        end
    end
    LVar1 := Encounter_Counter * 3 / 20;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777264, 0, 0, SCRIPT_ECUNIPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (23 > 0) then begin
            LVar3 := create_object(23, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 25));
        end
        else begin
            item_caps_adjust(Critter, random(10, 25));
        end
    end
    LVar1 := Encounter_Counter / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777265, 0, 0, SCRIPT_ECUNIPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (23 > 0) then begin
            LVar3 := create_object(23, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 25));
        end
        else begin
            item_caps_adjust(Critter, random(10, 25));
        end
        LVar4 := create_object(14, 0, 0);
        add_mult_objs_to_inven(Critter, LVar4, random(2, 5));
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
    LVar4 := 0;
end

procedure VPat_Strong_Slavers
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777440, 0, 0, SCRIPT_ECSLAVER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (9 > 0) then begin
            LVar3 := create_object(9, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 30));
        end
        else begin
            item_caps_adjust(Critter, random(10, 30));
        end
        set_map_var(1, map_var(1) + 1);
        LVar3 := create_object(159, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, 2);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
        for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777441, 0, 0, SCRIPT_ECSLAVER);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (280 > 0) then begin
                LVar3 := create_object(280, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(20, 30));
                continue;
            end
            item_caps_adjust(Critter, random(20, 30));
        end
        LVar1 := Encounter_Counter / 4;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
        end
        while (LVar0 < LVar1) do begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777254, 0, 0, SCRIPT_ECSLAVER);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (268 > 0) then begin
                LVar3 := create_object(268, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(10, 20));
            end
            else begin
                item_caps_adjust(Critter, random(10, 20));
            end
            LVar3 := create_object(259, 0, 0);
            add_mult_objs_to_inven(Critter, LVar3, 1);
            set_map_var(1, map_var(1) + 1);
        end
        LVar1 := Encounter_Counter / 4;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
        end
        while (LVar0 < LVar1) do begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777441, 0, 0, SCRIPT_ECSLAVER);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (236 > 0) then begin
                LVar3 := create_object(236, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(15, 30));
            end
            else begin
                item_caps_adjust(Critter, random(15, 30));
            end
            LVar3 := create_object(259, 0, 0);
            add_mult_objs_to_inven(Critter, LVar3, 1);
            set_map_var(1, map_var(1) + 1);
        end
        return 0;
        LVar0 := 0;
        LVar1 := 0;
        LVar2 := 0;
        LVar3 := 0;
    end

procedure DVMV_Wild_Dogs
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 1;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777298, 0, 0, SCRIPT_ECWLDDOG);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DMRV_Golden_Geckos
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 7 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777302, 0, 0, SCRIPT_ECGECKO);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar1 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777299, 0, 0, SCRIPT_ECGECKO);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure VPat_Patrol
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777438, 0, 0, SCRIPT_ECVLTPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (23 > 0) then begin
            LVar3 := create_object(23, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(30, 40));
        end
        else begin
            item_caps_adjust(Critter, random(30, 40));
        end
        LVar3 := create_object(40, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, 1);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777439, 0, 0, SCRIPT_ECVLTPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (23 > 0) then begin
            LVar3 := create_object(23, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
        LVar3 := create_object(40, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, 1);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777438, 0, 0, SCRIPT_ECVLTPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (18 > 0) then begin
            LVar3 := create_object(18, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
        LVar3 := create_object(40, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, 1);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777439, 0, 0, SCRIPT_ECVLTPAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (18 > 0) then begin
            LVar3 := create_object(18, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(15, 30));
        end
        else begin
            item_caps_adjust(Critter, random(15, 30));
        end
        LVar3 := create_object(40, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure RDRC_Raiders
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
        for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777454, 0, 0, SCRIPT_ECRAIDER);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (23 > 0) then begin
                LVar3 := create_object(23, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(14, 23));
                continue;
            end
            item_caps_adjust(Critter, random(14, 23));
        end
        LVar1 := Encounter_Counter / 4;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
            for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777454, 0, 0, SCRIPT_ECRAIDER);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (242 > 0) then begin
                    LVar3 := create_object(242, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                    item_caps_adjust(Critter, 2 * random(20, 26));
                    continue;
                end
                item_caps_adjust(Critter, random(20, 26));
            end
            LVar1 := Encounter_Counter / 4;
            LVar0 := 0;
            if (LVar1 < 1) then begin
                LVar1 := 1;
                for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                    LVar0 := LVar0 + 1;
                    Critter := create_object_sid(16777455, 0, 0, SCRIPT_ECRAIDER);
                    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                    Finding_New_Tile := 0;
                    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                        Finding_New_Tile := Finding_New_Tile + 1;
                        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                    end
                    critter_attempt_placement(Critter, LVar2, dude_elevation);
                    if (268 > 0) then begin
                        LVar3 := create_object(268, 0, 0);
                        add_obj_to_inven(Critter, LVar3);
                        wield_obj_critter(Critter, LVar3);
                    end
                    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                        item_caps_adjust(Critter, 2 * random(13, 21));
                        continue;
                    end
                    item_caps_adjust(Critter, random(13, 21));
                end
                LVar1 := Encounter_Counter / 4;
                LVar0 := 0;
                if (LVar1 < 1) then begin
                    LVar1 := 1;
                    for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                        LVar0 := LVar0 + 1;
                        Critter := create_object_sid(16777455, 0, 0, SCRIPT_ECRAIDER);
                        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                        Finding_New_Tile := 0;
                        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                            Finding_New_Tile := Finding_New_Tile + 1;
                            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                        end
                        critter_attempt_placement(Critter, LVar2, dude_elevation);
                        if (332 > 0) then begin
                            LVar3 := create_object(332, 0, 0);
                            add_obj_to_inven(Critter, LVar3);
                            wield_obj_critter(Critter, LVar3);
                        end
                        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                            item_caps_adjust(Critter, 2 * random(15, 28));
                            continue;
                        end
                        item_caps_adjust(Critter, random(15, 28));
                    end
                    return 0;
                    LVar0 := 0;
                    LVar1 := 0;
                    LVar2 := 0;
                    LVar3 := 0;
                end

procedure DNRV_Vault_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, 18);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777274, 0, 0, SCRIPT_ECMSTVC);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (-1 > 0) then begin
        LVar3 := create_object(-1, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(50, 90));
    end
    else begin
        item_caps_adjust(Critter, random(50, 90));
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777256, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (10 > 0) then begin
            LVar3 := create_object(10, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 30));
        end
        else begin
            item_caps_adjust(Critter, random(10, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777257, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (8 > 0) then begin
            LVar3 := create_object(8, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(15, 30));
        end
        else begin
            item_caps_adjust(Critter, random(15, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777256, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (9 > 0) then begin
            LVar3 := create_object(9, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 20));
        end
        else begin
            item_caps_adjust(Critter, random(10, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777257, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (18 > 0) then begin
            LVar3 := create_object(18, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(12, 22));
        end
        else begin
            item_caps_adjust(Critter, random(12, 22));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure RDRC_Broken_Hills_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, 14);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777277, 0, 0, SCRIPT_ECMSTBRO);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (268 > 0) then begin
        LVar3 := create_object(268, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(100, 130));
    end
    else begin
        item_caps_adjust(Critter, random(100, 130));
    end
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777264, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (12 > 0) then begin
            LVar3 := create_object(12, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(30, 50));
        end
        else begin
            item_caps_adjust(Critter, random(30, 50));
        end
    end
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777265, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (12 > 0) then begin
            LVar3 := create_object(12, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(25, 45));
        end
        else begin
            item_caps_adjust(Critter, random(25, 45));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure RDRC_Gecko_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, 13);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777395, 0, 0, SCRIPT_ECMSTGEC);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (94 > 0) then begin
        LVar3 := create_object(94, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(30, 50));
    end
    else begin
        item_caps_adjust(Critter, random(30, 50));
    end
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777318, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (10 > 0) then begin
            LVar3 := create_object(10, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 20));
        end
        else begin
            item_caps_adjust(Critter, random(10, 20));
        end
    end
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777318, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (23 > 0) then begin
            LVar3 := create_object(23, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(15, 25));
        end
        else begin
            item_caps_adjust(Critter, random(15, 25));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure NCR_Marauders
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
        for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777254, 0, 0, SCRIPT_ECMARADR);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (268 > 0) then begin
                LVar3 := create_object(268, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(10, 40));
                continue;
            end
            item_caps_adjust(Critter, random(10, 40));
        end
        LVar1 := Encounter_Counter / 4;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
            for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777479, 0, 0, SCRIPT_ECMARADR);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (296 > 0) then begin
                    LVar3 := create_object(296, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                    item_caps_adjust(Critter, 2 * random(10, 30));
                    continue;
                end
                item_caps_adjust(Critter, random(10, 30));
            end
            LVar1 := Encounter_Counter / 4;
            LVar0 := 0;
            if (LVar1 < 1) then begin
                LVar1 := 1;
                for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                    LVar0 := LVar0 + 1;
                    Critter := create_object_sid(16777480, 0, 0, SCRIPT_ECMARADR);
                    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                    Finding_New_Tile := 0;
                    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                        Finding_New_Tile := Finding_New_Tile + 1;
                        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                    end
                    critter_attempt_placement(Critter, LVar2, dude_elevation);
                    if (280 > 0) then begin
                        LVar3 := create_object(280, 0, 0);
                        add_obj_to_inven(Critter, LVar3);
                        wield_obj_critter(Critter, LVar3);
                    end
                    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                        item_caps_adjust(Critter, 2 * random(10, 40));
                        continue;
                    end
                    item_caps_adjust(Critter, random(10, 40));
                end
                LVar1 := Encounter_Counter / 4;
                LVar0 := 0;
                if (LVar1 < 1) then begin
                    LVar1 := 1;
                    for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                        LVar0 := LVar0 + 1;
                        Critter := create_object_sid(16777480, 0, 0, SCRIPT_ECMARADR);
                        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                        Finding_New_Tile := 0;
                        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                            Finding_New_Tile := Finding_New_Tile + 1;
                            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                        end
                        critter_attempt_placement(Critter, LVar2, dude_elevation);
                        if (236 > 0) then begin
                            LVar3 := create_object(236, 0, 0);
                            add_obj_to_inven(Critter, LVar3);
                            wield_obj_critter(Critter, LVar3);
                        end
                        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                            item_caps_adjust(Critter, 2 * random(10, 30));
                            continue;
                        end
                        item_caps_adjust(Critter, random(10, 30));
                    end
                    return 0;
                    LVar0 := 0;
                    LVar1 := 0;
                    LVar2 := 0;
                    LVar3 := 0;
                end

procedure DNRV_Reno_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, random(13, 16));
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777275, 0, 0, SCRIPT_ECMSTNEW);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (-1 > 0) then begin
        LVar3 := create_object(-1, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(20, 40));
    end
    else begin
        item_caps_adjust(Critter, random(20, 40));
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777262, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (22 > 0) then begin
            LVar3 := create_object(22, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 20));
        end
        else begin
            item_caps_adjust(Critter, random(10, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777263, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (23 > 0) then begin
            LVar3 := create_object(23, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(8, 18));
        end
        else begin
            item_caps_adjust(Critter, random(8, 18));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777258, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (115 > 0) then begin
            LVar3 := create_object(115, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 15));
        end
        else begin
            item_caps_adjust(Critter, random(5, 15));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar1 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777261, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (385 > 0) then begin
            LVar3 := create_object(385, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(13, 23));
        end
        else begin
            item_caps_adjust(Critter, random(13, 23));
        end
        LVar3 := create_object(95, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, 2);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DNRV_Redding_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, 13);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777277, 0, 0, SCRIPT_ECMSTRED);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (-1 > 0) then begin
        LVar3 := create_object(-1, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(40, 100));
    end
    else begin
        item_caps_adjust(Critter, random(40, 100));
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777262, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (23 > 0) then begin
            LVar3 := create_object(23, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 30));
        end
        else begin
            item_caps_adjust(Critter, random(10, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777264, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (12 > 0) then begin
            LVar3 := create_object(12, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777263, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (22 > 0) then begin
            LVar3 := create_object(22, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 30));
        end
        else begin
            item_caps_adjust(Critter, random(10, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777263, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (332 > 0) then begin
            LVar3 := create_object(332, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 30));
        end
        else begin
            item_caps_adjust(Critter, random(20, 30));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure NCR_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777277, 0, 0, SCRIPT_ECMSTNCR);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (268 > 0) then begin
        LVar3 := create_object(268, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(50, 100));
    end
    else begin
        item_caps_adjust(Critter, random(50, 100));
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777477, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (242 > 0) then begin
            LVar3 := create_object(242, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777477, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (11 > 0) then begin
            LVar3 := create_object(11, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(25, 45));
        end
        else begin
            item_caps_adjust(Critter, random(25, 45));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777478, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (268 > 0) then begin
            LVar3 := create_object(268, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 30));
        end
        else begin
            item_caps_adjust(Critter, random(20, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777478, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (332 > 0) then begin
            LVar3 := create_object(332, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure V15_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777277, 0, 0, SCRIPT_ECMSTV15);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (332 > 0) then begin
        LVar3 := create_object(332, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(50, 100));
    end
    else begin
        item_caps_adjust(Critter, random(50, 100));
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777477, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (242 > 0) then begin
            LVar3 := create_object(242, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777477, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (11 > 0) then begin
            LVar3 := create_object(11, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(25, 45));
        end
        else begin
            item_caps_adjust(Critter, random(25, 45));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777478, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (268 > 0) then begin
            LVar3 := create_object(268, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 30));
        end
        else begin
            item_caps_adjust(Critter, random(20, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777478, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (332 > 0) then begin
            LVar3 := create_object(332, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure New_Traveler
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    if (random(0, 99) < 50) then begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777437, 0, 0, SCRIPT_ECTRVLR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (236 > 0) then begin
            LVar3 := create_object(236, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 15));
        end
        else begin
            item_caps_adjust(Critter, random(5, 15));
        end
    end
    else begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777436, 0, 0, SCRIPT_ECTRVLR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (235 > 0) then begin
            LVar3 := create_object(235, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 15));
        end
        else begin
            item_caps_adjust(Critter, random(5, 15));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure NCR_Masters_Army
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777473, 0, 0, SCRIPT_ECMSTAMY);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (118 > 0) then begin
            LVar3 := create_object(118, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777472, 0, 0, SCRIPT_ECMSTAMY);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (12 > 0) then begin
            LVar3 := create_object(12, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        LVar3 := create_object(35, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, random(1, 3));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777464, 0, 0, SCRIPT_ECCENTUR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777462, 0, 0, SCRIPT_ECFLOATR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure NCR_Rangers
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777477, 0, 0, SCRIPT_ECRANGER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (242 > 0) then begin
            LVar3 := create_object(242, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 30));
        end
        else begin
            item_caps_adjust(Critter, random(10, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777477, 0, 0, SCRIPT_ECRANGER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (11 > 0) then begin
            LVar3 := create_object(11, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(15, 30));
        end
        else begin
            item_caps_adjust(Critter, random(15, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777478, 0, 0, SCRIPT_ECRANGER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (268 > 0) then begin
            LVar3 := create_object(268, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 30));
        end
        else begin
            item_caps_adjust(Critter, random(20, 30));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777478, 0, 0, SCRIPT_ECRANGER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (332 > 0) then begin
            LVar3 := create_object(332, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure KLA_Farmers
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 2 / 3;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777281, 0, 0, SCRIPT_ECFARMER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (9 > 0) then begin
            LVar3 := create_object(9, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(2, 10));
        end
        else begin
            item_caps_adjust(Critter, random(2, 10));
        end
        LVar3 := create_object(71, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, random(2, 5));
    end
    LVar1 := Encounter_Counter / 3;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777282, 0, 0, SCRIPT_ECFARMER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (10 > 0) then begin
            LVar3 := create_object(10, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 10));
        end
        else begin
            item_caps_adjust(Critter, random(5, 10));
        end
        LVar3 := create_object(71, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, random(2, 5));
    end
    if (random(0, 99) < 30) then begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777268, 0, 0, SCRIPT_ECCHILD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    end
    if (random(0, 99) < 30) then begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777269, 0, 0, SCRIPT_ECCHILD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DNRV_Den_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777272, 0, 0, SCRIPT_ECMSTDEN);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (-1 > 0) then begin
        LVar3 := create_object(-1, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(3, 20));
    end
    else begin
        item_caps_adjust(Critter, random(3, 20));
    end
    set_map_var(1, map_var(1) + 1);
    LVar1 := Encounter_Counter / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
        for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777440, 0, 0, SCRIPT_ECGUARD);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (236 > 0) then begin
                LVar3 := create_object(236, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(3, 10));
                continue;
            end
            item_caps_adjust(Critter, random(3, 10));
        end
        LVar1 := Encounter_Counter / 2;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
            for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777356, 0, 0, SCRIPT_ECGUARD);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (9 > 0) then begin
                    LVar3 := create_object(9, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                    item_caps_adjust(Critter, 2 * random(2, 10));
                    continue;
                end
                item_caps_adjust(Critter, random(2, 10));
            end
            LVar1 := Encounter_Counter * 3 / 20;
            LVar0 := 0;
            if (LVar1 < 1) then begin
                LVar1 := 1;
            end
            while (LVar0 < LVar1) do begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777235, 0, 0, SCRIPT_ECSLAVE);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (-1 > 0) then begin
                    LVar3 := create_object(-1, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            end
            LVar1 := Encounter_Counter * 3 / 20;
            LVar0 := 0;
            if (LVar1 < 1) then begin
                LVar1 := 1;
            end
            while (LVar0 < LVar1) do begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777236, 0, 0, SCRIPT_ECSLAVE);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (-1 > 0) then begin
                    LVar3 := create_object(-1, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            end
            return 0;
            LVar0 := 0;
            LVar1 := 0;
            LVar2 := 0;
            LVar3 := 0;
        end

procedure DVMV_Highwaymen
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777246, 0, 0, SCRIPT_ECHIWYMN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (313 > 0) then begin
            LVar3 := create_object(313, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 10));
        end
        else begin
            item_caps_adjust(Critter, random(5, 10));
        end
        LVar3 := create_object(40, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777247, 0, 0, SCRIPT_ECHIWYMN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (351 > 0) then begin
            LVar3 := create_object(351, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(6, 10));
        end
        else begin
            item_caps_adjust(Critter, random(6, 10));
        end
        LVar3 := create_object(363, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        LVar3 := create_object(40, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777246, 0, 0, SCRIPT_ECHIWYMN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (18 > 0) then begin
            LVar3 := create_object(18, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(4, 12));
        end
        else begin
            item_caps_adjust(Critter, random(4, 12));
        end
        LVar3 := create_object(273, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777247, 0, 0, SCRIPT_ECHIWYMN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (94 > 0) then begin
            LVar3 := create_object(94, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 10));
        end
        else begin
            item_caps_adjust(Critter, random(5, 10));
        end
        LVar3 := create_object(273, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        LVar3 := create_object(95, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DVMV_Robbers
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 2 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777246, 0, 0, SCRIPT_ECROBBER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (94 > 0) then begin
            LVar3 := create_object(94, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 11));
        end
        else begin
            item_caps_adjust(Critter, random(5, 11));
        end
        LVar3 := create_object(95, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 2 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777247, 0, 0, SCRIPT_ECROBBER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (9 > 0) then begin
            LVar3 := create_object(9, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(6, 12));
        end
        else begin
            item_caps_adjust(Critter, random(6, 12));
        end
        LVar3 := create_object(29, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777250, 0, 0, SCRIPT_ECROBBER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (236 > 0) then begin
            LVar3 := create_object(236, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(6, 10));
        end
        else begin
            item_caps_adjust(Critter, random(6, 10));
        end
        LVar3 := create_object(40, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        LVar3 := create_object(259, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, random(1, 3));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777251, 0, 0, SCRIPT_ECROBBER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (9 > 0) then begin
            LVar3 := create_object(9, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 14));
        end
        else begin
            item_caps_adjust(Critter, random(10, 14));
        end
        LVar3 := create_object(259, 0, 0);
        add_mult_objs_to_inven(Critter, LVar3, random(1, 4));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DMRV_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777433, 0, 0, SCRIPT_ECMSTDEN);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (10 > 0) then begin
        LVar3 := create_object(10, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(20, 40));
    end
    else begin
        item_caps_adjust(Critter, random(20, 40));
    end
    LVar3 := create_object(40, 0, 0);
    add_obj_to_inven(Critter, LVar3);
    LVar3 := create_object(259, 0, 0);
    add_obj_to_inven(Critter, LVar3);
    LVar1 := Encounter_Counter * 2 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777262, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (10 > 0) then begin
            LVar3 := create_object(10, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 20));
        end
        else begin
            item_caps_adjust(Critter, random(10, 20));
        end
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777233, 0, 0, SCRIPT_ECSLAVE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777240, 0, 0, SCRIPT_ECSLAVE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DMRV_Highwaymen
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777246, 0, 0, SCRIPT_ECHIWYMN);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (10 > 0) then begin
        LVar3 := create_object(10, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(40, 70));
    end
    else begin
        item_caps_adjust(Critter, random(40, 70));
    end
    LVar3 := create_object(40, 0, 0);
    add_obj_to_inven(Critter, LVar3);
    LVar3 := create_object(259, 0, 0);
    add_obj_to_inven(Critter, LVar3);
    set_map_var(1, map_var(1) + 1);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777250, 0, 0, SCRIPT_ECHIWYMN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (236 > 0) then begin
            LVar3 := create_object(236, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 20));
        end
        else begin
            item_caps_adjust(Critter, random(10, 20));
        end
        LVar3 := create_object(40, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777251, 0, 0, SCRIPT_ECHIWYMN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (236 > 0) then begin
            LVar3 := create_object(236, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 16));
        end
        else begin
            item_caps_adjust(Critter, random(10, 16));
        end
        LVar3 := create_object(40, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777252, 0, 0, SCRIPT_ECHIWYMN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (10 > 0) then begin
            LVar3 := create_object(10, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 25));
        end
        else begin
            item_caps_adjust(Critter, random(10, 25));
        end
        LVar3 := create_object(259, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777253, 0, 0, SCRIPT_ECHIWYMN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (10 > 0) then begin
            LVar3 := create_object(10, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(12, 20));
        end
        else begin
            item_caps_adjust(Critter, random(12, 20));
        end
        LVar3 := create_object(259, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DMRV_Robbers
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777247, 0, 0, SCRIPT_ECROBBER);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (10 > 0) then begin
        LVar3 := create_object(10, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(20, 40));
    end
    else begin
        item_caps_adjust(Critter, random(20, 40));
    end
    LVar3 := create_object(40, 0, 0);
    add_obj_to_inven(Critter, LVar3);
    LVar3 := create_object(259, 0, 0);
    add_obj_to_inven(Critter, LVar3);
    set_map_var(1, map_var(1) + 1);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777248, 0, 0, SCRIPT_ECROBBER);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (236 > 0) then begin
            LVar3 := create_object(236, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 20));
        end
        else begin
            item_caps_adjust(Critter, random(10, 20));
        end
        LVar3 := create_object(40, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
        for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777249, 0, 0, SCRIPT_ECROBBER);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (234 > 0) then begin
                LVar3 := create_object(234, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(8, 22));
                continue;
            end
            item_caps_adjust(Critter, random(8, 22));
        end
        LVar1 := Encounter_Counter * 3 / 10;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
            for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777252, 0, 0, SCRIPT_ECROBBER);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (8 > 0) then begin
                    LVar3 := create_object(8, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                    item_caps_adjust(Critter, 2 * random(5, 15));
                    continue;
                end
                item_caps_adjust(Critter, random(5, 15));
            end
            LVar1 := Encounter_Counter / 5;
            LVar0 := 0;
            if (LVar1 < 1) then begin
                LVar1 := 1;
                for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                    LVar0 := LVar0 + 1;
                    Critter := create_object_sid(16777253, 0, 0, SCRIPT_ECROBBER);
                    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                    Finding_New_Tile := 0;
                    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                        Finding_New_Tile := Finding_New_Tile + 1;
                        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                    end
                    critter_attempt_placement(Critter, LVar2, dude_elevation);
                    if (8 > 0) then begin
                        LVar3 := create_object(8, 0, 0);
                        add_obj_to_inven(Critter, LVar3);
                        wield_obj_critter(Critter, LVar3);
                    end
                    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                        item_caps_adjust(Critter, 2 * random(10, 20));
                        continue;
                    end
                    item_caps_adjust(Critter, random(10, 20));
                end
                return 0;
                LVar0 := 0;
                LVar1 := 0;
                LVar2 := 0;
                LVar3 := 0;
            end

procedure DVMV_Mantis_Swarm
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777432, 0, 0, SCRIPT_ECMANTIS);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure DVMV_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777276, 0, 0, SCRIPT_ECMRCHNT);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (236 > 0) then begin
        LVar3 := create_object(236, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(50, 100));
    end
    else begin
        item_caps_adjust(Critter, random(50, 100));
    end
    LVar3 := create_object(259, 0, 0);
    add_obj_to_inven(Critter, LVar3);
    LVar3 := create_object(40, 0, 0);
    add_obj_to_inven(Critter, LVar3);
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777262, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (9 > 0) then begin
            LVar3 := create_object(9, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 30));
        end
        else begin
            item_caps_adjust(Critter, random(10, 30));
        end
        LVar3 := create_object(29, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        LVar3 := create_object(40, 0, 0);
        add_obj_to_inven(Critter, LVar3);
    end
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777263, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (351 > 0) then begin
            LVar3 := create_object(351, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 20));
        end
        else begin
            item_caps_adjust(Critter, random(10, 20));
        end
        LVar3 := create_object(40, 0, 0);
        add_obj_to_inven(Critter, LVar3);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure Red_Claim_Jumper
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
        for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777252, 0, 0, SCRIPT_ECCLMJMP);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (355 > 0) then begin
                LVar3 := create_object(355, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(10, 30));
                continue;
            end
            item_caps_adjust(Critter, random(10, 30));
        end
        LVar1 := Encounter_Counter / 4;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
            for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777252, 0, 0, SCRIPT_ECCLMJMP);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (118 > 0) then begin
                    LVar3 := create_object(118, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                    item_caps_adjust(Critter, 2 * random(10, 30));
                    continue;
                end
                item_caps_adjust(Critter, random(10, 30));
            end
            LVar1 := Encounter_Counter / 4;
            LVar0 := 0;
            if (LVar1 < 1) then begin
                LVar1 := 1;
                for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                    LVar0 := LVar0 + 1;
                    Critter := create_object_sid(16777253, 0, 0, SCRIPT_ECCLMJMP);
                    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                    Finding_New_Tile := 0;
                    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                        Finding_New_Tile := Finding_New_Tile + 1;
                        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                    end
                    critter_attempt_placement(Critter, LVar2, dude_elevation);
                    if (355 > 0) then begin
                        LVar3 := create_object(355, 0, 0);
                        add_obj_to_inven(Critter, LVar3);
                        wield_obj_critter(Critter, LVar3);
                    end
                    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                        item_caps_adjust(Critter, 2 * random(10, 30));
                        continue;
                    end
                    item_caps_adjust(Critter, random(10, 30));
                end
                LVar1 := Encounter_Counter / 4;
                LVar0 := 0;
                if (LVar1 < 1) then begin
                    LVar1 := 1;
                    for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                        LVar0 := LVar0 + 1;
                        Critter := create_object_sid(16777252, 0, 0, SCRIPT_ECCLMJMP);
                        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                        Finding_New_Tile := 0;
                        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                            Finding_New_Tile := Finding_New_Tile + 1;
                            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                        end
                        critter_attempt_placement(Critter, LVar2, dude_elevation);
                        if (118 > 0) then begin
                            LVar3 := create_object(118, 0, 0);
                            add_obj_to_inven(Critter, LVar3);
                            wield_obj_critter(Critter, LVar3);
                        end
                        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                            item_caps_adjust(Critter, 2 * random(10, 30));
                            continue;
                        end
                        item_caps_adjust(Critter, random(10, 30));
                    end
                    return 0;
                    LVar0 := 0;
                    LVar1 := 0;
                    LVar2 := 0;
                    LVar3 := 0;
                end

procedure Red_Prospector
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777452, 0, 0, SCRIPT_ECPROSPE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (115 > 0) then begin
            LVar3 := create_object(115, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(0, 20));
        end
        else begin
            item_caps_adjust(Critter, random(0, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777452, 0, 0, SCRIPT_ECPROSPE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (354 > 0) then begin
            LVar3 := create_object(354, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(0, 20));
        end
        else begin
            item_caps_adjust(Critter, random(0, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777453, 0, 0, SCRIPT_ECPROSPE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (352 > 0) then begin
            LVar3 := create_object(352, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(0, 20));
        end
        else begin
            item_caps_adjust(Critter, random(0, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777453, 0, 0, SCRIPT_ECPROSPE);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (268 > 0) then begin
            LVar3 := create_object(268, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(0, 20));
        end
        else begin
            item_caps_adjust(Critter, random(0, 20));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure Red_Bootlegger
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777450, 0, 0, SCRIPT_ECMONSHN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (115 > 0) then begin
            LVar3 := create_object(115, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(2, 10));
        end
        else begin
            item_caps_adjust(Critter, random(2, 10));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777450, 0, 0, SCRIPT_ECMONSHN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (354 > 0) then begin
            LVar3 := create_object(354, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(6, 16));
        end
        else begin
            item_caps_adjust(Critter, random(6, 16));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777451, 0, 0, SCRIPT_ECMONSHN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (388 > 0) then begin
            LVar3 := create_object(388, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(4, 12));
        end
        else begin
            item_caps_adjust(Critter, random(4, 12));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777451, 0, 0, SCRIPT_ECMONSHN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (235 > 0) then begin
            LVar3 := create_object(235, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(4, 16));
        end
        else begin
            item_caps_adjust(Critter, random(4, 16));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure Red_Trappers
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777248, 0, 0, SCRIPT_ECTRAPPR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (236 > 0) then begin
            LVar3 := create_object(236, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(0, 20));
        end
        else begin
            item_caps_adjust(Critter, random(0, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777248, 0, 0, SCRIPT_ECTRAPPR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (235 > 0) then begin
            LVar3 := create_object(235, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(0, 20));
        end
        else begin
            item_caps_adjust(Critter, random(0, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777249, 0, 0, SCRIPT_ECTRAPPR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (236 > 0) then begin
            LVar3 := create_object(236, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(0, 20));
        end
        else begin
            item_caps_adjust(Critter, random(0, 20));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777248, 0, 0, SCRIPT_ECTRAPPR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (235 > 0) then begin
            LVar3 := create_object(235, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(0, 20));
        end
        else begin
            item_caps_adjust(Critter, random(0, 20));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure Red_Homesteaders
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777436, 0, 0, SCRIPT_ECHOMEST);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (388 > 0) then begin
            LVar3 := create_object(388, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(4, 16));
        end
        else begin
            item_caps_adjust(Critter, random(4, 16));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777436, 0, 0, SCRIPT_ECHOMEST);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (16 > 0) then begin
            LVar3 := create_object(16, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(5, 15));
        end
        else begin
            item_caps_adjust(Critter, random(5, 15));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777437, 0, 0, SCRIPT_ECHOMEST);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (268 > 0) then begin
            LVar3 := create_object(268, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(3, 17));
        end
        else begin
            item_caps_adjust(Critter, random(3, 17));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777437, 0, 0, SCRIPT_ECHOMEST);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (352 > 0) then begin
            LVar3 := create_object(352, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(4, 16));
        end
        else begin
            item_caps_adjust(Critter, random(4, 16));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure EPA_Deathclaws
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 6 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777460, 0, 0, SCRIPT_ECDTHCLW);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (371 > 0) then begin
            LVar3 := create_object(371, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 2 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777461, 0, 0, SCRIPT_ECDTHCLW);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (371 > 0) then begin
            LVar3 := create_object(371, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 2 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777224, 0, 0, SCRIPT_ECDTHCLW);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure EPA_Fire_Geckos
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777456, 0, 0, SCRIPT_ECGECKO);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (427 > 0) then begin
            LVar3 := create_object(427, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure EPA_Centaurs
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 2 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777464, 0, 0, SCRIPT_ECCENTUR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 3 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777465, 0, 0, SCRIPT_ECCENTUR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure EPA_Floaters
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 2 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777462, 0, 0, SCRIPT_ECFLOATR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 3 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777463, 0, 0, SCRIPT_ECFLOATR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure Fran2_San_Fran_Caravan
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    call Build_Grey_Caravan();
    LVar0 := LVar0 + 1;
    Critter := create_object_sid(16777358, 0, 0, SCRIPT_ECMSTSAN);
    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
    Finding_New_Tile := 0;
    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
        Finding_New_Tile := Finding_New_Tile + 1;
        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    end
    critter_attempt_placement(Critter, LVar2, dude_elevation);
    if (388 > 0) then begin
        LVar3 := create_object(388, 0, 0);
        add_obj_to_inven(Critter, LVar3);
        wield_obj_critter(Critter, LVar3);
    end
    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
        item_caps_adjust(Critter, 2 * random(100, 160));
    end
    else begin
        item_caps_adjust(Critter, random(100, 160));
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777438, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (118 > 0) then begin
            LVar3 := create_object(118, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777438, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (389 > 0) then begin
            LVar3 := create_object(389, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777439, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (355 > 0) then begin
            LVar3 := create_object(355, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777439, 0, 0, SCRIPT_ECGUARD);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (296 > 0) then begin
            LVar3 := create_object(296, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(20, 40));
        end
        else begin
            item_caps_adjust(Critter, random(20, 40));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure EPA_Special_Alien
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777458, 0, 0, SCRIPT_ECALIEN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 3 / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777459, 0, 0, SCRIPT_ECALIEN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure EPA_Floater_Centaurs
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777464, 0, 0, SCRIPT_ECCENTUR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777462, 0, 0, SCRIPT_ECFLOATR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777465, 0, 0, SCRIPT_ECCENTUR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 3 / 10;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777463, 0, 0, SCRIPT_ECFLOATR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure EPA_Special_Fire_Geckos
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 9 / 20;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777456, 0, 0, SCRIPT_ECGECKO);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (427 > 0) then begin
            LVar3 := create_object(427, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 11 / 20;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777457, 0, 0, SCRIPT_ECGECKO);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (427 > 0) then begin
            LVar3 := create_object(427, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure New_Yakuza
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
        for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777476, 0, 0, SCRIPT_ECYAKUZA);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (283 > 0) then begin
                LVar3 := create_object(283, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(3, 30));
                continue;
            end
            item_caps_adjust(Critter, random(3, 30));
        end
        LVar1 := Encounter_Counter / 2;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
            for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777476, 0, 0, SCRIPT_ECYAKUZA);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (143 > 0) then begin
                    LVar3 := create_object(143, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                    item_caps_adjust(Critter, 2 * random(3, 30));
                    continue;
                end
                item_caps_adjust(Critter, random(3, 30));
            end
            return 0;
            LVar0 := 0;
            LVar1 := 0;
            LVar2 := 0;
            LVar3 := 0;
        end

procedure New_Gang
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 4;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
        for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
            LVar0 := LVar0 + 1;
            Critter := create_object_sid(16777252, 0, 0, SCRIPT_ECGANGS);
            LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
            Finding_New_Tile := 0;
            while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                Finding_New_Tile := Finding_New_Tile + 1;
                LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
            end
            critter_attempt_placement(Critter, LVar2, dude_elevation);
            if (242 > 0) then begin
                LVar3 := create_object(242, 0, 0);
                add_obj_to_inven(Critter, LVar3);
                wield_obj_critter(Critter, LVar3);
            end
            anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
            if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                item_caps_adjust(Critter, 2 * random(3, 8));
                continue;
            end
            item_caps_adjust(Critter, random(3, 8));
        end
        LVar1 := Encounter_Counter / 4;
        LVar0 := 0;
        if (LVar1 < 1) then begin
            LVar1 := 1;
            for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                LVar0 := LVar0 + 1;
                Critter := create_object_sid(16777252, 0, 0, SCRIPT_ECGANGS);
                LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                Finding_New_Tile := 0;
                while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                    Finding_New_Tile := Finding_New_Tile + 1;
                    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                end
                critter_attempt_placement(Critter, LVar2, dude_elevation);
                if (241 > 0) then begin
                    LVar3 := create_object(241, 0, 0);
                    add_obj_to_inven(Critter, LVar3);
                    wield_obj_critter(Critter, LVar3);
                end
                anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                    item_caps_adjust(Critter, 2 * random(5, 18));
                    continue;
                end
                item_caps_adjust(Critter, random(5, 18));
            end
            LVar1 := Encounter_Counter / 4;
            LVar0 := 0;
            if (LVar1 < 1) then begin
                LVar1 := 1;
                for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                    LVar0 := LVar0 + 1;
                    Critter := create_object_sid(16777255, 0, 0, SCRIPT_ECGANGS);
                    LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                    Finding_New_Tile := 0;
                    while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                        Finding_New_Tile := Finding_New_Tile + 1;
                        LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                    end
                    critter_attempt_placement(Critter, LVar2, dude_elevation);
                    if (11 > 0) then begin
                        LVar3 := create_object(11, 0, 0);
                        add_obj_to_inven(Critter, LVar3);
                        wield_obj_critter(Critter, LVar3);
                    end
                    anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                    if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                        item_caps_adjust(Critter, 2 * random(3, 8));
                        continue;
                    end
                    item_caps_adjust(Critter, random(3, 8));
                end
                LVar1 := Encounter_Counter / 4;
                LVar0 := 0;
                if (LVar1 < 1) then begin
                    LVar1 := 1;
                    for (/* O_NOOP */; LVar0 < LVar1; set_map_var(1, map_var(1) + 1)) begin
                        LVar0 := LVar0 + 1;
                        Critter := create_object_sid(16777253, 0, 0, SCRIPT_ECGANGS);
                        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
                        Finding_New_Tile := 0;
                        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
                            Finding_New_Tile := Finding_New_Tile + 1;
                            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
                        end
                        critter_attempt_placement(Critter, LVar2, dude_elevation);
                        if (22 > 0) then begin
                            LVar3 := create_object(22, 0, 0);
                            add_obj_to_inven(Critter, LVar3);
                            wield_obj_critter(Critter, LVar3);
                        end
                        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
                        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
                            item_caps_adjust(Critter, 2 * random(3, 8));
                            continue;
                        end
                        item_caps_adjust(Critter, random(3, 8));
                    end
                    return 0;
                    LVar0 := 0;
                    LVar1 := 0;
                    LVar2 := 0;
                    LVar3 := 0;
                end

procedure New_Mobsters
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777475, 0, 0, SCRIPT_ECMOBSTR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (283 > 0) then begin
            LVar3 := create_object(283, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(10, 30));
        end
        else begin
            item_caps_adjust(Critter, random(10, 30));
        end
    end
    LVar1 := Encounter_Counter / 2;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777475, 0, 0, SCRIPT_ECMOBSTR);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (242 > 0) then begin
            LVar3 := create_object(242, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        if (has_trait(TRAIT_PERK, dude_obj, PERK_fortune_finder)) then begin
            item_caps_adjust(Critter, 2 * random(12, 23));
        end
        else begin
            item_caps_adjust(Critter, random(12, 23));
        end
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure EPA_Alien
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777458, 0, 0, SCRIPT_ECALIEN);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end

procedure Klad_Mole_Pig_Rat
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    variable LVar2 := 0;
    variable LVar3 := 0;
    LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
    LVar1 := Encounter_Counter * 2 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777326, 0, 0, SCRIPT_ECRAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 1 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777327, 0, 0, SCRIPT_ECRAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    LVar1 := Encounter_Counter * 2 / 5;
    LVar0 := 0;
    if (LVar1 < 1) then begin
        LVar1 := 1;
    end
    while (LVar0 < LVar1) do begin
        LVar0 := LVar0 + 1;
        Critter := create_object_sid(16777328, 0, 0, SCRIPT_ECRAT);
        LVar2 := tile_num_in_direction(LVar2, random(0, 5), random(2, 5));
        Finding_New_Tile := 0;
        while (not(tile_in_tile_rect(8709, 15638, 24963, 31892, LVar2)) and (Finding_New_Tile < 5)) do begin
            Finding_New_Tile := Finding_New_Tile + 1;
            LVar2 := tile_num_in_direction(dude_tile, Encounter_Rotation, dude_perception * 2);
        end
        critter_attempt_placement(Critter, LVar2, dude_elevation);
        if (-1 > 0) then begin
            LVar3 := create_object(-1, 0, 0);
            add_obj_to_inven(Critter, LVar3);
            wield_obj_critter(Critter, LVar3);
        end
        anim(Critter, 1000, rotation_to_tile(tile_num(Critter), dude_tile));
        set_map_var(1, map_var(1) + 1);
    end
    return 0;
    LVar0 := 0;
    LVar1 := 0;
    LVar2 := 0;
    LVar3 := 0;
end
