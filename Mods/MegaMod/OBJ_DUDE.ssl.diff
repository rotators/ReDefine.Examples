diff --git a/Mods/MegaMod/Original/OBJ_DUDE.ssl b/Mods/MegaMod/ReDefine/OBJ_DUDE.ssl
index e7fd6a6..bde5bfd 100644
--- a/Mods/MegaMod/Original/OBJ_DUDE.ssl
+++ b/Mods/MegaMod/ReDefine/OBJ_DUDE.ssl
@@ -873,9 +873,9 @@ begin
     LVar0 := cur_section_start;
     cur_section_start := 500;
     items_avail := 0;
-    while ((message_str(2, cur_section_start) != "Error") and (message_str(2, cur_section_start) == "[ITEM]")) do begin
-        cur_gvar := atoim(message_str(2, cur_section_start + 4), "");
-        if ((message_str(2, cur_section_start + 4) == "") or global_var(cur_gvar)) then begin
+    while ((message_str(SCRIPT_TEST0, cur_section_start) != "Error") and (message_str(SCRIPT_TEST0, cur_section_start) == "[ITEM]")) do begin
+        cur_gvar := atoim(message_str(SCRIPT_TEST0, cur_section_start + 4), "");
+        if ((message_str(SCRIPT_TEST0, cur_section_start + 4) == "") or global_var(cur_gvar)) then begin
             items_avail := items_avail + 1;
         end
         cur_section_start := cur_section_start + 25;
@@ -909,19 +909,19 @@ begin
     setTextColor(0.00000, 1.00000, 0.00000);
     format(proto_data(cur_pid, 1), 25, LVar2, 250, 10, 2);
     LVar2 := LVar2 + 30;
-    while ((message_str(2, cur_section_start + LVar0) != "[TOOLS]") and (LVar0 < 25)) do begin
+    while ((message_str(SCRIPT_TEST0, cur_section_start + LVar0) != "[TOOLS]") and (LVar0 < 25)) do begin
         LVar0 := LVar0 + 1;
     end
     LVar0 := LVar0 + 1;
-    format(message_str(2, 300), 25, LVar2, 250, 10, 2);
+    format(message_str(SCRIPT_TEST0, 300), 25, LVar2, 250, 10, 2);
     LVar2 := LVar2 + 10;
     LVar1 := LVar0;
-    while ((message_str(2, cur_section_start + LVar0) != "[SKILLS]") and (LVar0 < 25) and (message_str(2, cur_section_start + LVar0) != "Error") and (message_str(2, cur_section_start) == "[ITEM]")) do begin
+    while ((message_str(SCRIPT_TEST0, cur_section_start + LVar0) != "[SKILLS]") and (LVar0 < 25) and (message_str(SCRIPT_TEST0, cur_section_start + LVar0) != "Error") and (message_str(SCRIPT_TEST0, cur_section_start) == "[ITEM]")) do begin
         LVar16 := 0;
         LVar17 := 0;
         LVar15 := 0;
         while (not(LVar15)) do begin
-            LVar14 := wordar(message_str(2, cur_section_start + LVar0), LVar16);
+            LVar14 := wordar(message_str(SCRIPT_TEST0, cur_section_start + LVar0), LVar16);
             if (LVar14 == "") then begin
                 LVar15 := 1;
                 if (LVar17 == 0) then begin
@@ -938,7 +938,7 @@ begin
                     setTextColor(1.00000, 0.00000, 0.00000);
                 end
                 if (LVar16) then begin
-                    format(message_str(2, 150) + proto_data(LVar6, 1), 25, LVar2, 250, 10, 0);
+                    format(message_str(SCRIPT_TEST0, 150) + proto_data(LVar6, 1), 25, LVar2, 250, 10, 0);
                 end
                 else begin
                     format(proto_data(LVar6, 1), 25, LVar2, 250, 10, 0);
@@ -951,42 +951,42 @@ begin
     end
     if (LVar1 == LVar0) then begin
         setTextColor(0.00000, 1.00000, 0.00000);
-        format(message_str(2, 303), 25, LVar2, 250, 10, 0);
+        format(message_str(SCRIPT_TEST0, 303), 25, LVar2, 250, 10, 0);
         LVar2 := LVar2 + 10;
     end
     LVar0 := LVar0 + 1;
     setTextColor(0.00000, 1.00000, 0.00000);
-    format(message_str(2, 301), 25, LVar2, 250, 10, 2);
+    format(message_str(SCRIPT_TEST0, 301), 25, LVar2, 250, 10, 2);
     LVar2 := LVar2 + 10;
     LVar1 := LVar0;
-    while ((message_str(2, cur_section_start + LVar0) != "[COMPONENTS]") and (LVar0 < 25) and (message_str(2, cur_section_start + LVar0) != "Error") and (message_str(2, cur_section_start) == "[ITEM]")) do begin
-        LVar7 := parse_skill_name(message_str(2, cur_section_start + LVar0));
-        LVar8 := atoim(message_str(2, cur_section_start + LVar0), message_str(2, 19 + LVar7) + ":");
-        if (has_skill(dude_obj, LVar7) >= LVar8) then begin
+    while ((message_str(SCRIPT_TEST0, cur_section_start + LVar0) != "[COMPONENTS]") and (LVar0 < 25) and (message_str(SCRIPT_TEST0, cur_section_start + LVar0) != "Error") and (message_str(SCRIPT_TEST0, cur_section_start) == "[ITEM]")) do begin
+        LVar7 := parse_skill_name(message_str(SCRIPT_TEST0, cur_section_start + LVar0));
+        LVar8 := atoim(message_str(SCRIPT_TEST0, cur_section_start + LVar0), message_str(SCRIPT_TEST0, 19 + LVar7) + ":");
+        if (dude_skill(LVar7) >= LVar8) then begin
             setTextColor(0.00000, 1.00000, 0.00000);
         end
         else begin
             setTextColor(1.00000, 0.00000, 0.00000);
             LVar4 := 0;
         end
-        format(message_str(2, 1 + LVar7) + ": " + LVar8, 25, LVar2, 250, 10, 0);
+        format(message_str(SCRIPT_TEST0, 1 + LVar7) + ": " + LVar8, 25, LVar2, 250, 10, 0);
         LVar2 := LVar2 + 10;
         LVar0 := LVar0 + 1;
     end
     if (LVar1 == LVar0) then begin
         setTextColor(0.00000, 1.00000, 0.00000);
-        format(message_str(2, 303), 25, LVar2, 250, 10, 0);
+        format(message_str(SCRIPT_TEST0, 303), 25, LVar2, 250, 10, 0);
         LVar2 := LVar2 + 10;
     end
     LVar0 := LVar0 + 1;
     setTextColor(0.00000, 1.00000, 0.00000);
-    format(message_str(2, 302), 25, LVar2, 250, 10, 2);
+    format(message_str(SCRIPT_TEST0, 302), 25, LVar2, 250, 10, 2);
     LVar2 := LVar2 + 10;
     LVar1 := LVar0;
     max := 32767;
-    while ((LVar0 < 25) and (message_str(2, cur_section_start + LVar0) != "Error") and (message_str(2, cur_section_start) == "[ITEM]")) do begin
-        LVar9 := atoim(message_str(2, cur_section_start + LVar0), "");
-        LVar10 := atoim(message_str(2, cur_section_start + LVar0), "" + LVar9 + ":");
+    while ((LVar0 < 25) and (message_str(SCRIPT_TEST0, cur_section_start + LVar0) != "Error") and (message_str(SCRIPT_TEST0, cur_section_start) == "[ITEM]")) do begin
+        LVar9 := atoim(message_str(SCRIPT_TEST0, cur_section_start + LVar0), "");
+        LVar10 := atoim(message_str(SCRIPT_TEST0, cur_section_start + LVar0), "" + LVar9 + ":");
         if (obj_is_carrying_obj_pid(dude_obj, LVar9) >= LVar10) then begin
             setTextColor(0.00000, 1.00000, 0.00000);
         end
@@ -1004,7 +1004,7 @@ begin
     end
     if (LVar1 == LVar0) then begin
         setTextColor(0.00000, 1.00000, 0.00000);
-        format(message_str(2, 303), 25, LVar2, 250, 10, 0);
+        format(message_str(SCRIPT_TEST0, 303), 25, LVar2, 250, 10, 0);
         LVar2 := LVar2 + 10;
     end
     if (LVar3 and LVar4 and LVar5) then begin
@@ -1013,7 +1013,7 @@ begin
     else begin
         can_batch := 0;
     end
-    cur_undo := message_str(2, cur_section_start + 6);
+    cur_undo := message_str(SCRIPT_TEST0, cur_section_start + 6);
     if ((cur_undo == "YES") and LVar3 and LVar4 and obj_is_carrying_obj_pid(dude_obj, cur_pid)) then begin
         can_undo := 1;
     end
@@ -1021,14 +1021,14 @@ begin
         can_undo := 0;
     end
     setTextColor(0.00000, 1.00000, 0.00000);
-    format(message_str(2, 304), 25, LVar2, 250, 10, 2);
+    format(message_str(SCRIPT_TEST0, 304), 25, LVar2, 250, 10, 2);
     LVar2 := LVar2 + 10;
-    cur_time := atoim(message_str(2, cur_section_start + 5), "");
+    cur_time := atoim(message_str(SCRIPT_TEST0, cur_section_start + 5), "");
     LVar12 := cur_time / (60 * 10) / 60;
     LVar13 := cur_time / (60 * 10) % 60;
-    format(message_str(2, 305) + LVar12, 25, LVar2, 250, 10, 0);
+    format(message_str(SCRIPT_TEST0, 305) + LVar12, 25, LVar2, 250, 10, 0);
     LVar2 := LVar2 + 10;
-    format(message_str(2, 306) + LVar13, 25, LVar2, 250, 10, 0);
+    format(message_str(SCRIPT_TEST0, 306) + LVar13, 25, LVar2, 250, 10, 0);
     showWin;
     return 0;
     LVar0 := 0;
@@ -1055,8 +1055,8 @@ procedure draw_item_pcx
 begin
     variable LVar0 := 0;
     variable LVar1 := 0;
-    cur_pcx := message_str(2, cur_section_start + 2);
-    cur_size := atoim(message_str(2, cur_section_start + 3), "");
+    cur_pcx := message_str(SCRIPT_TEST0, cur_section_start + 2);
+    cur_size := atoim(message_str(SCRIPT_TEST0, cur_section_start + 3), "");
     LVar0 := cur_size / 1000;
     LVar1 := cur_size % 1000;
     call redraw_win_dscr();
@@ -1073,7 +1073,7 @@ begin
     variable LVar1 := 0;
     variable LVar2 := -1;
     while ((LVar1 < 18) and (LVar2 < 0)) do begin
-        if ((arg0 > message_str(2, 19 + LVar1)) and (arg0 < (message_str(2, 19 + LVar1) + ";"))) then begin
+        if ((arg0 > message_str(SCRIPT_TEST0, 19 + LVar1)) and (arg0 < (message_str(SCRIPT_TEST0, 19 + LVar1) + ";"))) then begin
             LVar2 := LVar1;
         end
         LVar1 := LVar1 + 1;
@@ -1089,9 +1089,9 @@ procedure display_items_list
 begin
     sayStart;
     mouseShape("pcx/st1.pcx", 0, 0);
-    sayReply("r_display_list", message_str(2, 200));
+    sayReply("r_display_list", message_str(SCRIPT_TEST0, 200));
     call display_items_avail();
-    sayOption(message_str(2, 101), exit_mode);
+    sayOption(message_str(SCRIPT_TEST0, 101), exit_mode);
     sayEnd;
 end
 
@@ -1102,29 +1102,29 @@ begin
     call redraw_win_idle();
     cur_section_start := 500;
     if (cur_pos != 0) then begin
-        sayOption(message_str(2, 106), list_back);
+        sayOption(message_str(SCRIPT_TEST0, 106), list_back);
     end
     while (LVar1 < cur_pos) do begin
-        cur_gvar := atoim(message_str(2, cur_section_start + 4), "");
-        if ((message_str(2, cur_section_start + 4) == "") or global_var(cur_gvar)) then begin
+        cur_gvar := atoim(message_str(SCRIPT_TEST0, cur_section_start + 4), "");
+        if ((message_str(SCRIPT_TEST0, cur_section_start + 4) == "") or global_var(cur_gvar)) then begin
             LVar1 := LVar1 + 1;
         end
         cur_section_start := cur_section_start + 25;
     end
-    while ((LVar0 < 7) and (message_str(2, cur_section_start) != "Error") and (message_str(2, cur_section_start) == "[ITEM]")) do begin
-        cur_pid := atoim(message_str(2, cur_section_start + 1), "");
-        cur_gvar := atoim(message_str(2, cur_section_start + 4), "");
-        if ((message_str(2, cur_section_start + 4) == "") or global_var(cur_gvar)) then begin
+    while ((LVar0 < 7) and (message_str(SCRIPT_TEST0, cur_section_start) != "Error") and (message_str(SCRIPT_TEST0, cur_section_start) == "[ITEM]")) do begin
+        cur_pid := atoim(message_str(SCRIPT_TEST0, cur_section_start + 1), "");
+        cur_gvar := atoim(message_str(SCRIPT_TEST0, cur_section_start + 4), "");
+        if ((message_str(SCRIPT_TEST0, cur_section_start + 4) == "") or global_var(cur_gvar)) then begin
             call display_next_option(LVar0);
             LVar0 := LVar0 + 1;
         end
         cur_section_start := cur_section_start + 25;
     end
     if ((cur_pos + 6) < (items_avail - 1)) then begin
-        sayOption(message_str(2, 105), list_next_one);
+        sayOption(message_str(SCRIPT_TEST0, 105), list_next_one);
     end
     if (items_avail == 0) then begin
-        sayOption(message_str(2, 107), exit_mode);
+        sayOption(message_str(SCRIPT_TEST0, 107), exit_mode);
     end
     return 0;
     LVar0 := 0;
@@ -1143,8 +1143,8 @@ end
 
 procedure display_item_options
 begin
-    cur_pid := atoim(message_str(2, cur_section_start + 1), "");
-    cur_gvar := atoim(message_str(2, cur_section_start + 4), "");
+    cur_pid := atoim(message_str(SCRIPT_TEST0, cur_section_start + 1), "");
+    cur_gvar := atoim(message_str(SCRIPT_TEST0, cur_section_start + 4), "");
     max_undo := obj_is_carrying_obj_pid(dude_obj, cur_pid);
     sayStart;
     mouseShape("pcx/st1.pcx", 0, 0);
@@ -1152,19 +1152,19 @@ begin
     call draw_item_pcx();
     call draw_item_properties();
     if (can_batch and (max > 1)) then begin
-        sayOption(message_str(2, 108) + message_str(2, 110) + max + message_str(2, 111), batch_all_items);
+        sayOption(message_str(SCRIPT_TEST0, 108) + message_str(SCRIPT_TEST0, 110) + max + message_str(SCRIPT_TEST0, 111), batch_all_items);
     end
     if (can_batch) then begin
-        sayOption(message_str(2, 103), batch_one_item);
+        sayOption(message_str(SCRIPT_TEST0, 103), batch_one_item);
     end
     if (can_undo and (max_undo > 1)) then begin
-        sayOption(message_str(2, 109) + message_str(2, 110) + max_undo + message_str(2, 111), undo_all_items);
+        sayOption(message_str(SCRIPT_TEST0, 109) + message_str(SCRIPT_TEST0, 110) + max_undo + message_str(SCRIPT_TEST0, 111), undo_all_items);
     end
     if (can_undo) then begin
-        sayOption(message_str(2, 104), undo_one_item);
+        sayOption(message_str(SCRIPT_TEST0, 104), undo_one_item);
     end
-    sayOption(message_str(2, 102), items_list_mode);
-    sayOption(message_str(2, 101), exit_mode);
+    sayOption(message_str(SCRIPT_TEST0, 102), items_list_mode);
+    sayOption(message_str(SCRIPT_TEST0, 101), exit_mode);
     sayEnd;
 end
 
@@ -1172,9 +1172,9 @@ procedure display_batch_ok
 begin
     sayStart;
     mouseShape("pcx/st1.pcx", 0, 0);
-    sayReply("r_batch_item", message_str(2, 201));
-    sayOption(message_str(2, 100), item_options_mode);
-    sayOption(message_str(2, 101), exit_mode);
+    sayReply("r_batch_item", message_str(SCRIPT_TEST0, 201));
+    sayOption(message_str(SCRIPT_TEST0, 100), item_options_mode);
+    sayOption(message_str(SCRIPT_TEST0, 101), exit_mode);
     sayEnd;
 end
 
@@ -1182,9 +1182,9 @@ procedure display_undo_ok
 begin
     sayStart;
     mouseShape("pcx/st1.pcx", 0, 0);
-    sayReply("r_undo_batch", message_str(2, 202));
-    sayOption(message_str(2, 100), item_options_mode);
-    sayOption(message_str(2, 101), exit_mode);
+    sayReply("r_undo_batch", message_str(SCRIPT_TEST0, 202));
+    sayOption(message_str(SCRIPT_TEST0, 100), item_options_mode);
+    sayOption(message_str(SCRIPT_TEST0, 101), exit_mode);
     sayEnd;
 end
 
@@ -1221,13 +1221,13 @@ begin
     variable LVar4 := 0;
     variable LVar5 := 0;
     game_time_advance(cur_time * arg0);
-    while ((message_str(2, cur_section_start + LVar1) != "[COMPONENTS]") and (LVar1 < 25)) do begin
+    while ((message_str(SCRIPT_TEST0, cur_section_start + LVar1) != "[COMPONENTS]") and (LVar1 < 25)) do begin
         LVar1 := LVar1 + 1;
     end
     LVar1 := LVar1 + 1;
-    while ((LVar1 < 25) and (message_str(2, cur_section_start + LVar1) != "Error") and (message_str(2, cur_section_start) == "[ITEM]")) do begin
-        LVar2 := atoim(message_str(2, cur_section_start + LVar1), "");
-        LVar3 := atoim(message_str(2, cur_section_start + LVar1), LVar2 + ":");
+    while ((LVar1 < 25) and (message_str(SCRIPT_TEST0, cur_section_start + LVar1) != "Error") and (message_str(SCRIPT_TEST0, cur_section_start) == "[ITEM]")) do begin
+        LVar2 := atoim(message_str(SCRIPT_TEST0, cur_section_start + LVar1), "");
+        LVar3 := atoim(message_str(SCRIPT_TEST0, cur_section_start + LVar1), LVar2 + ":");
         removed_qty := obj_is_carrying_obj_pid(dude_obj, LVar2);
         if ((LVar3 * arg0) < removed_qty) then begin
             removed_qty := LVar3 * arg0;
@@ -1235,17 +1235,17 @@ begin
         while (removed_qty) do begin
             restock_obj := obj_carrying_pid_obj(dude_obj, LVar2);
             if (obj_type(dude_obj) == 1) then begin
-                if (critter_inven_obj(dude_obj, 0) == restock_obj) then begin
-                    if (obj_item_subtype(critter_inven_obj(dude_obj, 0)) == 0) then begin
-                        restock_obj := critter_inven_obj(dude_obj, 0);
+                if (critter_inven_obj(dude_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                    if (obj_item_subtype(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 0) then begin
+                        restock_obj := critter_inven_obj(dude_obj, INVEN_TYPE_WORN);
                         debug_msg("armour pid == " + obj_pid(restock_obj));
                         rm_obj_from_inven(dude_obj, restock_obj);
                         add_obj_to_inven(dude_obj, restock_obj);
                     end
                 end
                 else begin
-                    if ((critter_inven_obj(dude_obj, 2) == restock_obj) or (critter_inven_obj(dude_obj, 1) == restock_obj)) then begin
-                        metarule(43, dude_obj);
+                    if ((critter_inven_obj(dude_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(dude_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                        inven_unwield(dude_obj);
                     end
                 end
             end
@@ -1257,7 +1257,7 @@ begin
         end
         LVar1 := LVar1 + 1;
     end
-    restock_obj := create_object_sid(cur_pid, 0, 0, -1);
+    restock_obj := create_object(cur_pid, 0, 0);
     if (obj_item_subtype(restock_obj) == 3) then begin
         if (get_weapon_ammo_pid(restock_obj) > 0) then begin
             set_weapon_ammo_count(restock_obj, 0);
@@ -1266,7 +1266,7 @@ begin
     add_mult_objs_to_inven(dude_obj, restock_obj, arg0);
     LVar4 := cur_time * arg0 / (60 * 10) / 60;
     LVar5 := cur_time * arg0 / (60 * 10) % 60;
-    display_msg(message_str(2, 400) + proto_data(cur_pid, 1) + message_str(2, 402) + arg0 + message_str(2, 403) + LVar4 + message_str(2, 404) + LVar5 + message_str(2, 405));
+    display_msg(message_str(SCRIPT_TEST0, 400) + proto_data(cur_pid, 1) + message_str(SCRIPT_TEST0, 402) + arg0 + message_str(SCRIPT_TEST0, 403) + LVar4 + message_str(SCRIPT_TEST0, 404) + LVar5 + message_str(SCRIPT_TEST0, 405));
     call batch_ok_mode();
     return 0;
     arg0 := 0;
@@ -1285,14 +1285,14 @@ begin
     variable LVar4 := 0;
     variable LVar5 := 0;
     game_time_advance(cur_time * arg0);
-    while ((message_str(2, cur_section_start + LVar1) != "[COMPONENTS]") and (LVar1 < 25)) do begin
+    while ((message_str(SCRIPT_TEST0, cur_section_start + LVar1) != "[COMPONENTS]") and (LVar1 < 25)) do begin
         LVar1 := LVar1 + 1;
     end
     LVar1 := LVar1 + 1;
-    while ((LVar1 < 25) and (message_str(2, cur_section_start + LVar1) != "Error") and (message_str(2, cur_section_start) == "[ITEM]")) do begin
-        LVar2 := atoim(message_str(2, cur_section_start + LVar1), "");
-        LVar3 := atoim(message_str(2, cur_section_start + LVar1), LVar2 + ":");
-        restock_obj := create_object_sid(LVar2, 0, 0, -1);
+    while ((LVar1 < 25) and (message_str(SCRIPT_TEST0, cur_section_start + LVar1) != "Error") and (message_str(SCRIPT_TEST0, cur_section_start) == "[ITEM]")) do begin
+        LVar2 := atoim(message_str(SCRIPT_TEST0, cur_section_start + LVar1), "");
+        LVar3 := atoim(message_str(SCRIPT_TEST0, cur_section_start + LVar1), LVar2 + ":");
+        restock_obj := create_object(LVar2, 0, 0);
         if (obj_item_subtype(restock_obj) == 3) then begin
             if (get_weapon_ammo_pid(restock_obj) > 0) then begin
                 set_weapon_ammo_count(restock_obj, 0);
@@ -1308,17 +1308,17 @@ begin
     while (removed_qty) do begin
         restock_obj := obj_carrying_pid_obj(dude_obj, cur_pid);
         if (obj_type(dude_obj) == 1) then begin
-            if (critter_inven_obj(dude_obj, 0) == restock_obj) then begin
-                if (obj_item_subtype(critter_inven_obj(dude_obj, 0)) == 0) then begin
-                    restock_obj := critter_inven_obj(dude_obj, 0);
+            if (critter_inven_obj(dude_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                if (obj_item_subtype(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 0) then begin
+                    restock_obj := critter_inven_obj(dude_obj, INVEN_TYPE_WORN);
                     debug_msg("armour pid == " + obj_pid(restock_obj));
                     rm_obj_from_inven(dude_obj, restock_obj);
                     add_obj_to_inven(dude_obj, restock_obj);
                 end
             end
             else begin
-                if ((critter_inven_obj(dude_obj, 2) == restock_obj) or (critter_inven_obj(dude_obj, 1) == restock_obj)) then begin
-                    metarule(43, dude_obj);
+                if ((critter_inven_obj(dude_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(dude_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                    inven_unwield(dude_obj);
                 end
             end
         end
@@ -1330,7 +1330,7 @@ begin
     end
     LVar4 := cur_time * arg0 / (60 * 10) / 60;
     LVar5 := cur_time * arg0 / (60 * 10) % 60;
-    display_msg(message_str(2, 401) + proto_data(cur_pid, 1) + message_str(2, 402) + arg0 + message_str(2, 403) + LVar4 + message_str(2, 404) + LVar5 + message_str(2, 405));
+    display_msg(message_str(SCRIPT_TEST0, 401) + proto_data(cur_pid, 1) + message_str(SCRIPT_TEST0, 402) + arg0 + message_str(SCRIPT_TEST0, 403) + LVar4 + message_str(SCRIPT_TEST0, 404) + LVar5 + message_str(SCRIPT_TEST0, 405));
     call undo_ok_mode();
     return 0;
     arg0 := 0;
@@ -1427,53 +1427,53 @@ end
 procedure ChooseFromList
 begin
     variable LVar0 := 0;
-    gsay_reply(1, stored_msg);
-    if (message_str(353, top_msg - 1) != "") then begin
-        giq_option(1, 1, message_str(353, 150), CLICK_PREV, 50);
+    Reply(stored_msg);
+    if (message_str(SCRIPT_NEWR1, top_msg - 1) != "") then begin
+        giq_option(1, NAME, message_str(SCRIPT_NEWR1, 150), CLICK_PREV, NEUTRAL_REACTION);
     end
     if (LVar0 == 0) then begin
-        if (message_str(353, top_msg + 0) != "") then begin
-            giq_option(1, 1, message_str(353, top_msg + 0), CLICK_0, 50);
+        if (message_str(SCRIPT_NEWR1, top_msg + 0) != "") then begin
+            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 0), CLICK_0, NEUTRAL_REACTION);
         end
         else begin
             LVar0 := 1;
         end
     end
     if (LVar0 == 0) then begin
-        if (message_str(353, top_msg + 1) != "") then begin
-            giq_option(1, 1, message_str(353, top_msg + 1), CLICK_1, 50);
+        if (message_str(SCRIPT_NEWR1, top_msg + 1) != "") then begin
+            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 1), CLICK_1, NEUTRAL_REACTION);
         end
         else begin
             LVar0 := 1;
         end
     end
     if (LVar0 == 0) then begin
-        if (message_str(353, top_msg + 2) != "") then begin
-            giq_option(1, 1, message_str(353, top_msg + 2), CLICK_2, 50);
+        if (message_str(SCRIPT_NEWR1, top_msg + 2) != "") then begin
+            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 2), CLICK_2, NEUTRAL_REACTION);
         end
         else begin
             LVar0 := 1;
         end
     end
     if (LVar0 == 0) then begin
-        if (message_str(353, top_msg + 3) != "") then begin
-            giq_option(1, 1, message_str(353, top_msg + 3), CLICK_3, 50);
+        if (message_str(SCRIPT_NEWR1, top_msg + 3) != "") then begin
+            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 3), CLICK_3, NEUTRAL_REACTION);
         end
         else begin
             LVar0 := 1;
         end
     end
     if (LVar0 == 0) then begin
-        if (message_str(353, top_msg + 4) != "") then begin
-            giq_option(1, 1, message_str(353, top_msg + 4), CLICK_4, 50);
+        if (message_str(SCRIPT_NEWR1, top_msg + 4) != "") then begin
+            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 4), CLICK_4, NEUTRAL_REACTION);
         end
         else begin
             LVar0 := 1;
         end
     end
     if (LVar0 == 0) then begin
-        if (message_str(353, top_msg + 5) != "") then begin
-            giq_option(1, 1, message_str(353, 151), CLICK_MORE, 50);
+        if (message_str(SCRIPT_NEWR1, top_msg + 5) != "") then begin
+            giq_option(1, NAME, message_str(SCRIPT_NEWR1, 151), CLICK_MORE, NEUTRAL_REACTION);
         end
     end
     return 0;
@@ -1606,24 +1606,24 @@ procedure start
 begin
     if (local_var(0) == 0) then begin
         set_local_var(0, game_time);
-        set_global_var(104, global_var(104) + 75);
-        if (global_var(104) < 0) then begin
-            set_global_var(104, 0);
+        set_global_var(GVAR_BUST_SKEEVE, global_var(GVAR_BUST_SKEEVE) + 75);
+        if (global_var(GVAR_BUST_SKEEVE) < 0) then begin
+            set_global_var(GVAR_BUST_SKEEVE, 0);
         end
         else begin
-            if (global_var(104) > (100 + (2 * (get_critter_stat(dude_obj, 2) - 10)))) then begin
-                set_global_var(104, 100 + (2 * (get_critter_stat(dude_obj, 2) - 10)));
+            if (global_var(GVAR_BUST_SKEEVE) > (100 + (2 * (dude_endurance - 10)))) then begin
+                set_global_var(GVAR_BUST_SKEEVE, 100 + (2 * (dude_endurance - 10)));
             end
         end
     end
-    if (script_action == 22) then begin
+    if (script_action == timed_event_proc) then begin
         if (fixed_param == 1) then begin
-            float_msg(self_obj, message_str(1487, 400), -2);
+            float_msg(self_obj, message_str(SCRIPT_SCOUTF, 400), FLOAT_MSG_WARNING);
             add_timer_event(dude_obj, game_ticks(4), 3);
         end
         else begin
             if (fixed_param == 2) then begin
-                float_msg(self_obj, message_str(1487, 402), -2);
+                float_msg(self_obj, message_str(SCRIPT_SCOUTF, 402), FLOAT_MSG_WARNING);
                 add_timer_event(dude_obj, game_ticks(4), 3);
             end
         end
@@ -1633,14 +1633,14 @@ end
 procedure timed_event_p_proc
 begin
     if (fixed_param == 1) then begin
-        critter_dmg(self_obj, 400, 0);
-        display_msg(message_str(14, 400));
+        critter_damage(self_obj, 400);
+        display_msg(g_mstr(400));
     end
     else begin
         if (fixed_param == 2) then begin
-            if ((global_var(173) == 3) and global_var(172)) then begin
-                move_to(dude_obj, tile_num(dude_obj), 1);
-                gfade_in(1);
+            if ((global_var(GVAR_NCR_V15_DARION_DEAL) == 3) and global_var(GVAR_NCR_V15_DARION_DEAD)) then begin
+                move_to(dude_obj, dude_tile, 1);
+                fade_in;
             end
         end
         else begin
@@ -1651,12 +1651,12 @@ begin
             end
             else begin
                 if (fixed_param == 4) then begin
-                    set_global_var(630, game_time + (7 * (24 * (60 * (60 * 10))) * 2));
+                    set_global_var(GVAR_DUDE_START_SEQ_1, game_time + (7 * (24 * (60 * (60 * 10))) * 2));
                 end
                 else begin
                     if (fixed_param == 5) then begin
-                        if (global_var(295) == 1) then begin
-                            set_global_var(295, 0);
+                        if (global_var(GVAR_ADDICT_TRAGIC) == 1) then begin
+                            set_global_var(GVAR_ADDICT_TRAGIC, 0);
                         end
                     end
                     else begin
@@ -1684,11 +1684,11 @@ begin
                             else begin
                                 if (fixed_param == 8) then begin
                                     if (count == 3) then begin
-                                        float_msg(dude_obj, message_str(1309, 412), 3);
+                                        float_msg(dude_obj, message_str(SCRIPT_AITEM6, 412), FLOAT_MSG_GREEN);
                                     end
                                     else begin
                                         if (count == 4) then begin
-                                            float_msg(dude_obj, message_str(1309, 413), 3);
+                                            float_msg(dude_obj, message_str(SCRIPT_AITEM6, 413), FLOAT_MSG_GREEN);
                                             script_overrides;
                                             reg_anim_func(2, dude_obj);
                                             reg_anim_func(1, 1);
@@ -1698,12 +1698,12 @@ begin
                                         end
                                         else begin
                                             if (count == 5) then begin
-                                                display_msg(message_str(1309, 414));
-                                                float_msg(dude_obj, message_str(1309, 415), 3);
+                                                display_msg(message_str(SCRIPT_AITEM6, 414));
+                                                float_msg(dude_obj, message_str(SCRIPT_AITEM6, 415), FLOAT_MSG_GREEN);
                                             end
                                             else begin
                                                 if (count == 6) then begin
-                                                    float_msg(dude_obj, message_str(1309, 416), 3);
+                                                    float_msg(dude_obj, message_str(SCRIPT_AITEM6, 416), FLOAT_MSG_GREEN);
                                                 end
                                                 else begin
                                                     if (count == 7) then begin
@@ -1715,12 +1715,12 @@ begin
                                                     end
                                                     else begin
                                                         if (count == 8) then begin
-                                                            float_msg(dude_obj, message_str(1309, 417), 3);
+                                                            float_msg(dude_obj, message_str(SCRIPT_AITEM6, 417), FLOAT_MSG_GREEN);
                                                         end
                                                         else begin
                                                             if (count == 9) then begin
-                                                                float_msg(dude_obj, message_str(1309, 418), 2);
-                                                                display_msg(message_str(1309, 419));
+                                                                float_msg(dude_obj, message_str(SCRIPT_AITEM6, 418), FLOAT_MSG_RED);
+                                                                display_msg(message_str(SCRIPT_AITEM6, 419));
                                                                 script_overrides;
                                                                 reg_anim_func(2, dude_obj);
                                                                 reg_anim_func(1, 1);
@@ -1735,8 +1735,8 @@ begin
                                                                     reg_anim_animate(dude_obj, 37, -1);
                                                                     reg_anim_func(3, 0);
                                                                     gfade_out(600);
-                                                                    display_msg(message_str(1309, 420));
-                                                                    game_time_advance((13 - get_critter_stat(dude_obj, 2)) * (60 * (60 * 10)));
+                                                                    display_msg(message_str(SCRIPT_AITEM6, 420));
+                                                                    game_time_advance((13 - dude_endurance) * (60 * (60 * 10)));
                                                                     gfade_in(600);
                                                                 end
                                                             end
@@ -1757,7 +1757,7 @@ begin
                                 end
                                 else begin
                                     if (fixed_param == 91) then begin
-                                        critter_dmg(self_obj, 1000, 3);
+                                        critter_dmg(self_obj, 1000, DMG_plasma);
                                     end
                                     else begin
                                         if (fixed_param == 92) then begin
@@ -1765,22 +1765,22 @@ begin
                                         end
                                         else begin
                                             if (fixed_param == 93) then begin
-                                                float_msg(self_obj, message_str(1540, 140), 8);
-                                                set_global_var(962, 2);
-                                                set_global_var(1006, 0);
-                                                critter_dmg(self_obj, 40, 3);
+                                                float_msg(self_obj, message_str(SCRIPT_MCGARETH, 140), FLOAT_MSG_YELLOW);
+                                                set_global_var(GVAR_RESERVED, 2);
+                                                set_global_var(GVAR_LAST_BATTLE_BEGIN, 0);
+                                                critter_dmg(self_obj, 40, DMG_plasma);
                                             end
                                             else begin
                                                 if (fixed_param == 132) then begin
                                                     restock_obj := obj_carrying_pid_obj(dude_obj, 124);
                                                     use_obj_on_obj(restock_obj, dude_obj);
-                                                    metarule3(100, self_obj, 132, 0);
+                                                    rm_fixed_timer_event(self_obj, 132);
                                                 end
                                                 else begin
                                                     if (fixed_param == 133) then begin
                                                         restock_obj := obj_carrying_pid_obj(dude_obj, 125);
                                                         use_obj_on_obj(restock_obj, dude_obj);
-                                                        metarule3(100, self_obj, 133, 0);
+                                                        rm_fixed_timer_event(self_obj, 133);
                                                     end
                                                 end
                                             end
@@ -1806,28 +1806,28 @@ begin
     variable LVar5 := 0;
     variable LVar6 := 0;
     if (obj_is_carrying_obj_pid(dude_obj, 542) > 0) then begin
-        if (global_var(644) == 20) then begin
+        if (global_var(GVAR_AHELDER_Q1_AGRO) == 20) then begin
             LVar6 := obj_carrying_pid_obj(dude_obj, 542);
             rm_obj_from_inven(dude_obj, LVar6);
             call Delete_Removed_Items(542);
         end
     end
-    if (global_var(630) != 0) then begin
-        if ((game_time > global_var(630)) and not((global_var(429) bwand 2) != 0) and (cur_map_index != 40)) then begin
-            set_global_var(582, global_var(582) bwor 1);
-            set_global_var(630, 0);
+    if (global_var(GVAR_DUDE_START_SEQ_1) != 0) then begin
+        if ((game_time > global_var(GVAR_DUDE_START_SEQ_1)) and not((global_var(GVAR_V13_STATUS_FLAGS) bwand 2) != 0) and (cur_map_index != MAP_VAULT13)) then begin
+            set_global_var(GVAR_VIGNETTE_SEQUENCE, global_var(GVAR_VIGNETTE_SEQUENCE) bwor 1);
+            set_global_var(GVAR_DUDE_START_SEQ_1, 0);
         end
     end
-    if (global_var(295) == 1) then begin
+    if (global_var(GVAR_ADDICT_TRAGIC) == 1) then begin
         if (local_var(6) == 0) then begin
             set_local_var(6, 1);
             add_timer_event(dude_obj, (7 * (24 * (60 * (60 * 10)))) - 10, 5);
         end
     end
     if (obj_is_carrying_obj_pid(dude_obj, 562) == 1) then begin
-        if (global_var(993) == 1) then begin
-            float_msg(self_obj, message_str(1540, 135), 12);
-            set_global_var(993, 2);
+        if (global_var(GVAR_LIBERATE_SALVATOREGUNS) == 1) then begin
+            float_msg(self_obj, message_str(SCRIPT_MCGARETH, 135), FLOAT_MSG_LIGHT_GREY);
+            set_global_var(GVAR_LIBERATE_SALVATOREGUNS, 2);
         end
     end
     if ((obj_is_carrying_obj_pid(dude_obj, 941) >= 1) and (obj_is_carrying_obj_pid(dude_obj, 948) >= 1)) then begin
@@ -1836,46 +1836,46 @@ begin
         call Delete_Removed_Items(941);
     end
     if (obj_is_carrying_obj_pid(dude_obj, 569) == 1) then begin
-        if (has_trait(0, dude_obj, 30)) then begin
-            if (global_var(962) == 0) then begin
-                float_msg(self_obj, message_str(1540, 139), 2);
+        if (has_trait(TRAIT_PERK, dude_obj, PERK_snakeater)) then begin
+            if (global_var(GVAR_RESERVED) == 0) then begin
+                float_msg(self_obj, message_str(SCRIPT_MCGARETH, 139), FLOAT_MSG_RED);
                 add_timer_event(self_obj, 20, 93);
-                set_global_var(962, 1);
+                set_global_var(GVAR_RESERVED, 1);
             end
         end
         else begin
-            if (global_var(962) == 0) then begin
-                float_msg(self_obj, message_str(1540, 136), 2);
+            if (global_var(GVAR_RESERVED) == 0) then begin
+                float_msg(self_obj, message_str(SCRIPT_MCGARETH, 136), FLOAT_MSG_RED);
                 add_timer_event(self_obj, 30, 91);
-                set_global_var(962, 1);
+                set_global_var(GVAR_RESERVED, 1);
             end
         end
     end
-    if (global_var(848) > 0) then begin
+    if (global_var(GVAR_MIRIA_ASK2TIME) > 0) then begin
         if (((game_time - soda_timer) >= (60 * (60 * 10))) and (soda_timer != 0) or (((game_time - rocks_timer) >= (60 * (60 * 10))) and (rocks_timer != 0))) then begin
-            set_global_var(848, 0);
+            set_global_var(GVAR_MIRIA_ASK2TIME, 0);
             soda_timer := 0;
             rocks_timer := 0;
         end
     end
-    if (global_var(848) == 1) then begin
+    if (global_var(GVAR_MIRIA_ASK2TIME) == 1) then begin
         if (took_soda == 1) then begin
-            set_global_var(848, 3);
+            set_global_var(GVAR_MIRIA_ASK2TIME, 3);
         end
         took_rocks := 1;
         rocks_timer := game_time;
     end
-    if (global_var(848) == 2) then begin
+    if (global_var(GVAR_MIRIA_ASK2TIME) == 2) then begin
         if (took_rocks == 1) then begin
-            set_global_var(848, 3);
+            set_global_var(GVAR_MIRIA_ASK2TIME, 3);
         end
         took_soda := 1;
         soda_timer := game_time;
     end
-    if ((global_var(848) == 2) or (global_var(848) == 1) or (global_var(848) == 0)) then begin
+    if ((global_var(GVAR_MIRIA_ASK2TIME) == 2) or (global_var(GVAR_MIRIA_ASK2TIME) == 1) or (global_var(GVAR_MIRIA_ASK2TIME) == 0)) then begin
     end
     else begin
-        if ((global_var(848) == 3) and (gave_warning != 1)) then begin
+        if ((global_var(GVAR_MIRIA_ASK2TIME) == 3) and (gave_warning != 1)) then begin
             gave_warning := 1;
             display_msg("Something doesn't feel quite right in your stomach.");
             warning_timer := game_time + game_ticks(10);
@@ -1888,43 +1888,43 @@ begin
             end
             else begin
                 if ((game_time >= warning_timer) and (gave_warning2 == 1)) then begin
-                    explosion(tile_num(dude_obj), elevation(dude_obj), 999999);
+                    explosion(dude_tile, dude_elevation, 999999);
                 end
             end
         end
     end
-    if (global_var(960) == 0) then begin
-        if (has_skill(dude_obj, 12) > 74) then begin
-            set_global_var(960, 1);
+    if (global_var(GVAR_BEEN_POISONED) == 0) then begin
+        if (dude_skill(SKILL_SCIENCE) > 74) then begin
+            set_global_var(GVAR_BEEN_POISONED, 1);
         end
         else begin
-            if (get_pc_stat(1) >= 10) then begin
-                set_global_var(960, 1);
+            if (get_pc_stat(PCSTAT_level) >= 10) then begin
+                set_global_var(GVAR_BEEN_POISONED, 1);
             end
         end
     end
-    if (global_var(960) == 1) then begin
-        if ((obj_pid(critter_inven_obj(dude_obj, 0)) == 3) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 232) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 348) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 349) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 554)) then begin
-            if (global_var(800) == 1) then begin
-                set_global_var(960, 2);
-                display_msg(message_str(14, 468));
+    if (global_var(GVAR_BEEN_POISONED) == 1) then begin
+        if ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 3) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 232) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 348) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 349) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 554)) then begin
+            if (global_var(GVAR_FLASHLIGHT_IS_ON) == 1) then begin
+                set_global_var(GVAR_BEEN_POISONED, 2);
+                display_msg(g_mstr(468));
             end
-            if (global_var(800) == 2) then begin
-                set_global_var(960, 2);
-                display_msg(message_str(14, 469));
+            if (global_var(GVAR_FLASHLIGHT_IS_ON) == 2) then begin
+                set_global_var(GVAR_BEEN_POISONED, 2);
+                display_msg(g_mstr(469));
             end
-            if (global_var(800) == 3) then begin
-                set_global_var(960, 2);
-                display_msg(message_str(14, 470));
+            if (global_var(GVAR_FLASHLIGHT_IS_ON) == 3) then begin
+                set_global_var(GVAR_BEEN_POISONED, 2);
+                display_msg(g_mstr(470));
             end
-            if (has_skill(dude_obj, 12) > 74) then begin
-                set_global_var(960, 2);
-                display_msg(message_str(14, 464));
+            if (dude_skill(SKILL_SCIENCE) > 74) then begin
+                set_global_var(GVAR_BEEN_POISONED, 2);
+                display_msg(g_mstr(464));
             end
             else begin
-                if (get_pc_stat(1) >= 10) then begin
-                    set_global_var(960, 2);
-                    display_msg(message_str(14, 465));
+                if (get_pc_stat(PCSTAT_level) >= 10) then begin
+                    set_global_var(GVAR_BEEN_POISONED, 2);
+                    display_msg(g_mstr(465));
                 end
             end
         end
@@ -1941,38 +1941,38 @@ end
 
 procedure map_enter_p_proc
 begin
-    if ((global_var(561) > 1) or (global_var(557) > 1) or (global_var(560) > 1) or (global_var(558) > 1) or (global_var(565) > 3) or (global_var(1081) > 0) and has_trait(0, dude_obj, 40) and (global_var(1054) == 1)) then begin
-        float_msg(self_obj, message_str(1614, 2700), 2);
+    if ((global_var(GVAR_SAN_FRAN_VERTI_ELE_QST) > 1) or (global_var(GVAR_SAN_FRAN_VERTI_STEAL_SHI_QST) > 1) or (global_var(GVAR_SAN_FRAN_VERTI_SHI_QST) > 1) or (global_var(GVAR_SAN_FRAN_VERTI_STEAL_ELE_QST) > 1) or (global_var(GVAR_SAN_FRAN_BOS_QUEST) > 3) or (global_var(GVAR_BOS_TO_BH_QUEST) > 0) and has_trait(TRAIT_PERK, dude_obj, PERK_scrounger) and (global_var(GVAR_GECKOS_SKINS) == 1)) then begin
+        float_msg(self_obj, message_str(SCRIPT_ACMONKM, 2700), FLOAT_MSG_RED);
         add_timer_event(self_obj, 30, 91);
     end
-    metarule3(108, tile_num(dude_obj), 0, 0);
+    tile_set_center(dude_tile);
 end
 
 procedure combat_p_proc
 begin
-    if (metarule(49, target_obj) == 5) then begin
-        if ((obj_pid(critter_inven_obj(dude_obj, 0)) == 3) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 232) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 348) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 349) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 554)) then begin
-            set_global_var(959, 1);
-            display_msg(message_str(14, 461));
+    if (weapon_dmg_type(target_obj) == 5) then begin
+        if ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 3) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 232) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 348) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 349) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 554)) then begin
+            set_global_var(GVAR_HAS_PERMISSION_TO_OPEN_SLAVE_PEN, 1);
+            display_msg(g_mstr(461));
         end
     end
-    if (cur_map_index == 55) then begin
+    if (CUR_MAP_NEWR2) then begin
         if (prize_fighter_obj == 0) then begin
         end
         else begin
             if (fixed_param == 4) then begin
-                if (global_var(507) != 0) then begin
-                    if ((((global_var(507) - game_time) / 10) <= 0) and (global_var(507) != 0)) then begin
+                if (global_var(GVAR_NEW_RENO_ROUND_TIME) != 0) then begin
+                    if ((((global_var(GVAR_NEW_RENO_ROUND_TIME) - game_time) / 10) <= 0) and (global_var(GVAR_NEW_RENO_ROUND_TIME) != 0)) then begin
                         last_timed_obj := prize_fighter_obj;
                         last_timed_param := last_timed_param;
-                        metarule3(100, prize_fighter_obj, 42, 0);
+                        rm_fixed_timer_event(prize_fighter_obj, 42);
                         add_timer_event(prize_fighter_obj, 0, 42);
                     end
                     else begin
                         if ((critter_state(dude_obj) bwand 2) or (critter_state(prize_fighter_obj) bwand 2)) then begin
                             last_timed_obj := prize_fighter_obj;
                             last_timed_param := last_timed_param;
-                            metarule3(100, prize_fighter_obj, 41, 0);
+                            rm_fixed_timer_event(prize_fighter_obj, 41);
                             add_timer_event(prize_fighter_obj, 0, 41);
                         end
                     end
@@ -1986,47 +1986,47 @@ procedure map_update_p_proc
 begin
     variable LVar0 := 0;
     variable LVar1 := 0;
-    LVar0 := (1 + has_trait(1, dude_obj, 0)) * (game_time - local_var(0)) / (60 * 10 * 3);
+    LVar0 := (1 + has_trait(TRAIT_OBJECT, dude_obj, 0)) * (game_time - local_var(0)) / (60 * 10 * 3);
     if (LVar0 > 0) then begin
-        set_global_var(104, global_var(104) + -LVar0);
-        if (global_var(104) < 0) then begin
-            set_global_var(104, 0);
+        set_global_var(GVAR_BUST_SKEEVE, global_var(GVAR_BUST_SKEEVE) + -LVar0);
+        if (global_var(GVAR_BUST_SKEEVE) < 0) then begin
+            set_global_var(GVAR_BUST_SKEEVE, 0);
         end
         else begin
-            if (global_var(104) > (100 + (2 * (get_critter_stat(dude_obj, 2) - 10)))) then begin
-                set_global_var(104, 100 + (2 * (get_critter_stat(dude_obj, 2) - 10)));
+            if (global_var(GVAR_BUST_SKEEVE) > (100 + (2 * (dude_endurance - 10)))) then begin
+                set_global_var(GVAR_BUST_SKEEVE, 100 + (2 * (dude_endurance - 10)));
             end
         end
     end
-    if (global_var(192) == 0) then begin
-        if (global_var(193) > 0) then begin
-            LVar1 := (game_time / (10 * 60 * 60 * 24)) - global_var(133);
+    if (global_var(GVAR_HAVE_MUTATED) == 0) then begin
+        if (global_var(GVAR_MUTATE_STAGE) > 0) then begin
+            LVar1 := (game_time / (10 * 60 * 60 * 24)) - global_var(GVAR_MUTATE_WHEN);
             if (LVar1 > 30) then begin
-                if (global_var(193) < 5) then begin
-                    display_msg(message_str(1, 140));
-                    set_global_var(193, 5);
-                    set_global_var(192, 1);
+                if (global_var(GVAR_MUTATE_STAGE) < 5) then begin
+                    display_mstr(140);
+                    set_global_var(GVAR_MUTATE_STAGE, 5);
+                    set_global_var(GVAR_HAVE_MUTATED, 1);
                 end
             end
             else begin
                 if (LVar1 > 25) then begin
-                    if (global_var(193) < 4) then begin
-                        display_msg(message_str(1, 130));
-                        set_global_var(193, 4);
+                    if (global_var(GVAR_MUTATE_STAGE) < 4) then begin
+                        display_mstr(130);
+                        set_global_var(GVAR_MUTATE_STAGE, 4);
                     end
                 end
                 else begin
                     if (LVar1 > 20) then begin
-                        if (global_var(193) < 3) then begin
-                            display_msg(message_str(1, 120));
-                            set_global_var(193, 3);
+                        if (global_var(GVAR_MUTATE_STAGE) < 3) then begin
+                            display_mstr(120);
+                            set_global_var(GVAR_MUTATE_STAGE, 3);
                         end
                     end
                     else begin
                         if (LVar1 > 15) then begin
-                            if (global_var(193) < 2) then begin
-                                display_msg(message_str(1, 110));
-                                set_global_var(193, 2);
+                            if (global_var(GVAR_MUTATE_STAGE) < 2) then begin
+                                display_mstr(110);
+                                set_global_var(GVAR_MUTATE_STAGE, 2);
                             end
                         end
                     end
@@ -2035,9 +2035,9 @@ begin
         end
     end
     if (self_obj) then begin
-        if (obj_carrying_pid_obj(self_obj, 366) and not(global_var(629))) then begin
-            set_global_var(629, 1);
-            display_msg(message_str(1, 150) + 4000 + message_str(1, 151));
+        if (obj_carrying_pid_obj(self_obj, 366) and not(global_var(GVAR_GAVE_GECK_EXP))) then begin
+            set_global_var(GVAR_GAVE_GECK_EXP, 1);
+            display_msg(mstr(150) + 4000 + mstr(151));
             give_exp_points(4000);
         end
     end
@@ -2053,68 +2053,68 @@ begin
     variable LVar2 := 0;
     if (obj_pid(source_obj) == 366) then begin
         script_overrides;
-        display_msg(message_str(14, 1099));
+        display_msg(g_mstr(1099));
     end
     if (obj_pid(source_obj) == 556) then begin
         script_overrides;
-        display_msg(message_str(14, 20000));
-        set_global_var(757, global_var(757) + -1);
-        critter_rm_trait(dude_obj, 0, 100, 1);
-        critter_rm_trait(dude_obj, 0, 13, 1);
+        display_msg(g_mstr(20000));
+        set_global_var(GVAR_ELDRIDGE_TASK, global_var(GVAR_ELDRIDGE_TASK) + -1);
+        critter_rm_trait(dude_obj, TRAIT_PERK, PERK_pack_rat_perk, 1);
+        critter_rm_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
         LVar2 := obj_carrying_pid_obj(dude_obj, 556);
         rm_obj_from_inven(dude_obj, LVar2);
         call Delete_Removed_Items(556);
-        if ((global_var(757) == 2) or (global_var(757) == 3)) then begin
-            critter_add_trait(dude_obj, 0, 100, 1);
+        if ((global_var(GVAR_ELDRIDGE_TASK) == 2) or (global_var(GVAR_ELDRIDGE_TASK) == 3)) then begin
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_pack_rat_perk, 1);
         end
-        if ((global_var(757) == 4) or (global_var(757) == 5)) then begin
-            critter_add_trait(dude_obj, 0, 100, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
+        if ((global_var(GVAR_ELDRIDGE_TASK) == 4) or (global_var(GVAR_ELDRIDGE_TASK) == 5)) then begin
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_pack_rat_perk, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
         end
-        if ((global_var(757) == 6) or (global_var(757) == 7)) then begin
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
+        if ((global_var(GVAR_ELDRIDGE_TASK) == 6) or (global_var(GVAR_ELDRIDGE_TASK) == 7)) then begin
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
         end
-        if (global_var(757) > 7) then begin
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 100, 1);
+        if (global_var(GVAR_ELDRIDGE_TASK) > 7) then begin
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_pack_rat_perk, 1);
         end
     end
     if (obj_pid(source_obj) == 557) then begin
         script_overrides;
-        display_msg(message_str(14, 20000));
-        set_global_var(757, global_var(757) + -1);
-        critter_rm_trait(dude_obj, 0, 100, 1);
-        critter_rm_trait(dude_obj, 0, 13, 1);
+        display_msg(g_mstr(20000));
+        set_global_var(GVAR_ELDRIDGE_TASK, global_var(GVAR_ELDRIDGE_TASK) + -1);
+        critter_rm_trait(dude_obj, TRAIT_PERK, PERK_pack_rat_perk, 1);
+        critter_rm_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
         LVar2 := obj_carrying_pid_obj(dude_obj, 557);
         rm_obj_from_inven(dude_obj, LVar2);
         call Delete_Removed_Items(557);
-        if ((global_var(757) == 2) or (global_var(757) == 3)) then begin
-            critter_add_trait(dude_obj, 0, 100, 1);
+        if ((global_var(GVAR_ELDRIDGE_TASK) == 2) or (global_var(GVAR_ELDRIDGE_TASK) == 3)) then begin
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_pack_rat_perk, 1);
         end
-        if ((global_var(757) == 4) or (global_var(757) == 5)) then begin
-            critter_add_trait(dude_obj, 0, 100, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
+        if ((global_var(GVAR_ELDRIDGE_TASK) == 4) or (global_var(GVAR_ELDRIDGE_TASK) == 5)) then begin
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_pack_rat_perk, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
         end
-        if ((global_var(757) == 6) or (global_var(757) == 7)) then begin
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
+        if ((global_var(GVAR_ELDRIDGE_TASK) == 6) or (global_var(GVAR_ELDRIDGE_TASK) == 7)) then begin
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
         end
-        if (global_var(757) > 7) then begin
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 13, 1);
-            critter_add_trait(dude_obj, 0, 100, 1);
+        if (global_var(GVAR_ELDRIDGE_TASK) > 7) then begin
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_strong_back, 1);
+            critter_add_trait(dude_obj, TRAIT_PERK, PERK_pack_rat_perk, 1);
         end
     end
     if (obj_pid(source_obj) == 571) then begin
         script_overrides;
-        set_global_var(999, 4);
-        display_msg(message_str(1556, 126));
+        set_global_var(GVAR_ALLOWED_TO_SPEAK_TO_JACK, 4);
+        display_msg(message_str(SCRIPT_MCTARWIN, 126));
         LVar2 := obj_carrying_pid_obj(dude_obj, 571);
         rm_obj_from_inven(dude_obj, LVar2);
         call Delete_Removed_Items(571);
@@ -2127,10 +2127,10 @@ end
 
 procedure Check_Bess_Float
 begin
-    if (tile_distance(19894, tile_num(dude_obj)) < 10) then begin
+    if (tile_distance(19894, dude_tile) < 10) then begin
         if (not(Did_Bess_Float)) then begin
             Did_Bess_Float := 1;
-            float_msg(dude_obj, message_str(1, 141), 0);
+            float_msg(dude_obj, mstr(141), FLOAT_MSG_NORMAL);
         end
         return 1;
     end
@@ -2139,7 +2139,7 @@ end
 
 procedure char_mods
 begin
-    if (global_var(847) == 1) then begin
+    if (global_var(GVAR_MIRIA_ASK1TIME) == 1) then begin
         call char_mod_gender();
     end
 end
@@ -2163,73 +2163,73 @@ begin
     variable LVar0 := 0;
     if (source_obj == dude_obj) then begin
         if ((obj_being_used_with == 106) or (obj_being_used_with == 124) or (obj_being_used_with == 125) or (obj_being_used_with == 126)) then begin
-            set_global_var(104, global_var(104) + 5);
-            if (global_var(104) < 0) then begin
-                set_global_var(104, 0);
+            set_global_var(GVAR_BUST_SKEEVE, global_var(GVAR_BUST_SKEEVE) + 5);
+            if (global_var(GVAR_BUST_SKEEVE) < 0) then begin
+                set_global_var(GVAR_BUST_SKEEVE, 0);
             end
             else begin
-                if (global_var(104) > (100 + (2 * (get_critter_stat(dude_obj, 2) - 10)))) then begin
-                    set_global_var(104, 100 + (2 * (get_critter_stat(dude_obj, 2) - 10)));
+                if (global_var(GVAR_BUST_SKEEVE) > (100 + (2 * (dude_endurance - 10)))) then begin
+                    set_global_var(GVAR_BUST_SKEEVE, 100 + (2 * (dude_endurance - 10)));
                 end
             end
         end
         else begin
             if ((obj_being_used_with == 81) or (obj_being_used_with == 103)) then begin
-                set_global_var(104, global_var(104) + 10);
-                if (global_var(104) < 0) then begin
-                    set_global_var(104, 0);
+                set_global_var(GVAR_BUST_SKEEVE, global_var(GVAR_BUST_SKEEVE) + 10);
+                if (global_var(GVAR_BUST_SKEEVE) < 0) then begin
+                    set_global_var(GVAR_BUST_SKEEVE, 0);
                 end
                 else begin
-                    if (global_var(104) > (100 + (2 * (get_critter_stat(dude_obj, 2) - 10)))) then begin
-                        set_global_var(104, 100 + (2 * (get_critter_stat(dude_obj, 2) - 10)));
+                    if (global_var(GVAR_BUST_SKEEVE) > (100 + (2 * (dude_endurance - 10)))) then begin
+                        set_global_var(GVAR_BUST_SKEEVE, 100 + (2 * (dude_endurance - 10)));
                     end
                 end
             end
             else begin
                 if ((obj_being_used_with == 226) or (obj_being_used_with == 227)) then begin
-                    set_global_var(104, global_var(104) + 25);
-                    if (global_var(104) < 0) then begin
-                        set_global_var(104, 0);
+                    set_global_var(GVAR_BUST_SKEEVE, global_var(GVAR_BUST_SKEEVE) + 25);
+                    if (global_var(GVAR_BUST_SKEEVE) < 0) then begin
+                        set_global_var(GVAR_BUST_SKEEVE, 0);
                     end
                     else begin
-                        if (global_var(104) > (100 + (2 * (get_critter_stat(dude_obj, 2) - 10)))) then begin
-                            set_global_var(104, 100 + (2 * (get_critter_stat(dude_obj, 2) - 10)));
+                        if (global_var(GVAR_BUST_SKEEVE) > (100 + (2 * (dude_endurance - 10)))) then begin
+                            set_global_var(GVAR_BUST_SKEEVE, 100 + (2 * (dude_endurance - 10)));
                         end
                     end
                 end
                 else begin
                     if (0) then begin
-                        set_global_var(104, global_var(104) + 50);
-                        if (global_var(104) < 0) then begin
-                            set_global_var(104, 0);
+                        set_global_var(GVAR_BUST_SKEEVE, global_var(GVAR_BUST_SKEEVE) + 50);
+                        if (global_var(GVAR_BUST_SKEEVE) < 0) then begin
+                            set_global_var(GVAR_BUST_SKEEVE, 0);
                         end
                         else begin
-                            if (global_var(104) > (100 + (2 * (get_critter_stat(dude_obj, 2) - 10)))) then begin
-                                set_global_var(104, 100 + (2 * (get_critter_stat(dude_obj, 2) - 10)));
+                            if (global_var(GVAR_BUST_SKEEVE) > (100 + (2 * (dude_endurance - 10)))) then begin
+                                set_global_var(GVAR_BUST_SKEEVE, 100 + (2 * (dude_endurance - 10)));
                             end
                         end
                     end
                     else begin
                         if (0) then begin
-                            set_global_var(104, global_var(104) + 75);
-                            if (global_var(104) < 0) then begin
-                                set_global_var(104, 0);
+                            set_global_var(GVAR_BUST_SKEEVE, global_var(GVAR_BUST_SKEEVE) + 75);
+                            if (global_var(GVAR_BUST_SKEEVE) < 0) then begin
+                                set_global_var(GVAR_BUST_SKEEVE, 0);
                             end
                             else begin
-                                if (global_var(104) > (100 + (2 * (get_critter_stat(dude_obj, 2) - 10)))) then begin
-                                    set_global_var(104, 100 + (2 * (get_critter_stat(dude_obj, 2) - 10)));
+                                if (global_var(GVAR_BUST_SKEEVE) > (100 + (2 * (dude_endurance - 10)))) then begin
+                                    set_global_var(GVAR_BUST_SKEEVE, 100 + (2 * (dude_endurance - 10)));
                                 end
                             end
                         end
                         else begin
                             if (0) then begin
-                                set_global_var(104, global_var(104) + 90);
-                                if (global_var(104) < 0) then begin
-                                    set_global_var(104, 0);
+                                set_global_var(GVAR_BUST_SKEEVE, global_var(GVAR_BUST_SKEEVE) + 90);
+                                if (global_var(GVAR_BUST_SKEEVE) < 0) then begin
+                                    set_global_var(GVAR_BUST_SKEEVE, 0);
                                 end
                                 else begin
-                                    if (global_var(104) > (100 + (2 * (get_critter_stat(dude_obj, 2) - 10)))) then begin
-                                        set_global_var(104, 100 + (2 * (get_critter_stat(dude_obj, 2) - 10)));
+                                    if (global_var(GVAR_BUST_SKEEVE) > (100 + (2 * (dude_endurance - 10)))) then begin
+                                        set_global_var(GVAR_BUST_SKEEVE, 100 + (2 * (dude_endurance - 10)));
                                     end
                                 end
                             end
@@ -2240,126 +2240,126 @@ begin
         end
         if ((obj_pid(obj_being_used_with) == 124) or (obj_pid(obj_being_used_with) == 125) or (obj_pid(obj_being_used_with) == 310) or (obj_pid(obj_being_used_with) == 662) or (obj_pid(obj_being_used_with) == 311)) then begin
             if (random(1, 100) <= 15) then begin
-                display_msg(message_str(1, 500));
-                set_critter_stat(dude_obj, 1, -2);
+                display_mstr(500);
+                set_critter_stat(dude_obj, STAT_pe, -2);
                 if (not(is_iface_tag_active(4))) then begin
                     show_iface_tag(4);
                 end
-                set_global_var(26, 1);
+                set_global_var(GVAR_ALCOHOL_ADDICT, 1);
             end
         end
         if (obj_pid(obj_being_used_with) == 670) then begin
             script_overrides;
             rm_obj_from_inven(dude_obj, obj_being_used_with);
             call Delete_Removed_Items(670);
-            set_global_var(848, 1);
+            set_global_var(GVAR_MIRIA_ASK2TIME, 1);
         end
         if (obj_pid(obj_being_used_with) == 106) then begin
-            if (global_var(848) > 0) then begin
+            if (global_var(GVAR_MIRIA_ASK2TIME) > 0) then begin
                 script_overrides;
                 rm_obj_from_inven(dude_obj, obj_being_used_with);
                 call Delete_Removed_Items(106);
             end
-            set_global_var(848, 2);
+            set_global_var(GVAR_MIRIA_ASK2TIME, 2);
         end
         if (obj_pid(obj_being_used_with) == 757) then begin
             if (not(combat_is_initialized)) then begin
-                if ((obj_pid(critter_inven_obj(dude_obj, 0)) == 3) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 232) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
+                if ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 3) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 232) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
                     script_overrides;
                     if (local_var(2) == 0) then begin
-                        display_msg(message_str(1309, 400));
+                        display_msg(message_str(SCRIPT_AITEM6, 400));
                     end
                     else begin
-                        display_msg(message_str(1309, 401));
+                        display_msg(message_str(SCRIPT_AITEM6, 401));
                     end
                     add_timer_event(dude_obj, 1, 7);
                     set_local_var(2, local_var(2) + 1);
                     if ((local_var(2) % 10) == 0) then begin
                         script_overrides;
-                        display_msg(message_str(1309, 403));
-                        set_global_var(859, 1);
+                        display_msg(message_str(SCRIPT_AITEM6, 403));
+                        set_global_var(GVAR_TEST_SOLAR_SCORCHER, 1);
                         rm_obj_from_inven(dude_obj, obj_being_used_with);
                         call Delete_Removed_Items(757);
                     end
                 end
                 else begin
-                    if ((obj_pid(critter_inven_obj(dude_obj, 0)) == 348) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 349) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 599) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 600)) then begin
+                    if ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 348) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 349) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 599) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 600)) then begin
                         script_overrides;
-                        display_msg(message_str(1309, 402));
+                        display_msg(message_str(SCRIPT_AITEM6, 402));
                     end
                     else begin
-                        if ((get_critter_stat(dude_obj, 34) == 0) and (source_obj == dude_obj) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 348) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 349) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 599) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 600)) then begin
+                        if ((dude_gender == 0) and (source_obj == dude_obj) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 348) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 349) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 599) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 600)) then begin
                             script_overrides;
                             if (local_var(2) == 0) then begin
-                                display_msg(message_str(1309, 400));
+                                display_msg(message_str(SCRIPT_AITEM6, 400));
                             end
                             else begin
-                                display_msg(message_str(1309, 401));
+                                display_msg(message_str(SCRIPT_AITEM6, 401));
                             end
                             add_timer_event(dude_obj, 1, 6);
                             set_local_var(2, local_var(2) + 1);
                             if ((local_var(2) % 10) == 0) then begin
                                 script_overrides;
-                                display_msg(message_str(1309, 403));
-                                set_global_var(859, 1);
+                                display_msg(message_str(SCRIPT_AITEM6, 403));
+                                set_global_var(GVAR_TEST_SOLAR_SCORCHER, 1);
                                 rm_obj_from_inven(dude_obj, obj_being_used_with);
                                 call Delete_Removed_Items(757);
                             end
                         end
                         else begin
-                            if ((get_critter_stat(dude_obj, 34) == 1) and (source_obj == dude_obj) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
+                            if ((dude_gender == 1) and (source_obj == dude_obj) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
                                 script_overrides;
-                                display_msg(message_str(1309, 425));
+                                display_msg(message_str(SCRIPT_AITEM6, 425));
                             end
                         end
                     end
                 end
                 if (obj_is_carrying_obj_pid(dude_obj, 101) == 0) then begin
                     script_overrides;
-                    display_msg(message_str(1309, 404));
+                    display_msg(message_str(SCRIPT_AITEM6, 404));
                 end
             end
         end
         if (obj_pid(obj_being_used_with) == 589) then begin
             if (not(combat_is_initialized)) then begin
-                if ((obj_pid(critter_inven_obj(dude_obj, 0)) == 3) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 232) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
+                if ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 3) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 232) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
                     script_overrides;
                     if (local_var(2) == 0) then begin
-                        display_msg(message_str(1309, 400));
+                        display_msg(message_str(SCRIPT_AITEM6, 400));
                     end
                     else begin
-                        display_msg(message_str(1309, 401));
+                        display_msg(message_str(SCRIPT_AITEM6, 401));
                     end
                     add_timer_event(dude_obj, 1, 7);
                     set_local_var(2, local_var(2) + 1);
                     if ((local_var(2) % 10) == 0) then begin
                         script_overrides;
-                        display_msg(message_str(1309, 403));
-                        set_global_var(859, 1);
+                        display_msg(message_str(SCRIPT_AITEM6, 403));
+                        set_global_var(GVAR_TEST_SOLAR_SCORCHER, 1);
                         rm_obj_from_inven(dude_obj, obj_being_used_with);
                         call Delete_Removed_Items(589);
                     end
                 end
                 else begin
-                    if ((obj_pid(critter_inven_obj(dude_obj, 0)) == 348) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 349) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 599) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 600) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
+                    if ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 348) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 349) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 599) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 600) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
                         script_overrides;
-                        display_msg(message_str(1309, 402));
+                        display_msg(message_str(SCRIPT_AITEM6, 402));
                     end
                     else begin
-                        if ((get_critter_stat(dude_obj, 34) == 0) and (source_obj == dude_obj) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 348) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 349) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 599) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 600)) then begin
+                        if ((dude_gender == 0) and (source_obj == dude_obj) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 348) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 349) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 599) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 600)) then begin
                             script_overrides;
                             if (local_var(2) == 0) then begin
-                                display_msg(message_str(1309, 400));
+                                display_msg(message_str(SCRIPT_AITEM6, 400));
                             end
                             else begin
-                                display_msg(message_str(1309, 401));
+                                display_msg(message_str(SCRIPT_AITEM6, 401));
                             end
                             add_timer_event(dude_obj, 1, 6);
                             set_local_var(2, local_var(2) + 1);
                             if ((local_var(2) % 10) == 0) then begin
                                 script_overrides;
-                                display_msg(message_str(1309, 403));
-                                set_global_var(859, 1);
+                                display_msg(message_str(SCRIPT_AITEM6, 403));
+                                set_global_var(GVAR_TEST_SOLAR_SCORCHER, 1);
                                 rm_obj_from_inven(dude_obj, obj_being_used_with);
                                 call Delete_Removed_Items(589);
                             end
@@ -2368,34 +2368,34 @@ begin
                 end
                 if (obj_is_carrying_obj_pid(dude_obj, 101) == 0) then begin
                     script_overrides;
-                    display_msg(message_str(1309, 404));
+                    display_msg(message_str(SCRIPT_AITEM6, 404));
                 end
             end
         end
         if (obj_pid(obj_being_used_with) == 625) then begin
             if (not(combat_is_initialized)) then begin
                 game_ui_disable;
-                if ((obj_pid(critter_inven_obj(dude_obj, 0)) == 3) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 232) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
+                if ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 3) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 232) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0)) then begin
                     script_overrides;
-                    display_msg(message_str(1309, 410));
+                    display_msg(message_str(SCRIPT_AITEM6, 410));
                     add_timer_event(dude_obj, 1, 7);
                 end
                 else begin
-                    if ((obj_is_carrying_obj_pid(dude_obj, 101) > 0) and ((obj_pid(critter_inven_obj(dude_obj, 0)) == 348) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 349) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 599) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 600))) then begin
+                    if ((obj_is_carrying_obj_pid(dude_obj, 101) > 0) and ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 348) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 349) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 599) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 600))) then begin
                         script_overrides;
-                        display_msg(message_str(1309, 402));
+                        display_msg(message_str(SCRIPT_AITEM6, 402));
                     end
                     else begin
-                        if ((get_critter_stat(dude_obj, 34) == 0) and (source_obj == dude_obj) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0) and (obj_pid(critter_inven_obj(dude_obj, 0)) != 348) or (obj_pid(critter_inven_obj(dude_obj, 0)) != 349)) then begin
+                        if ((dude_gender == 0) and (source_obj == dude_obj) and (obj_is_carrying_obj_pid(dude_obj, 101) > 0) and (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 348) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) != 349)) then begin
                             script_overrides;
-                            display_msg(message_str(1309, 410));
+                            display_msg(message_str(SCRIPT_AITEM6, 410));
                             add_timer_event(dude_obj, 1, 6);
                         end
                     end
                 end
                 if (obj_is_carrying_obj_pid(dude_obj, 101) == 0) then begin
                     script_overrides;
-                    display_msg(message_str(1309, 404));
+                    display_msg(message_str(SCRIPT_AITEM6, 404));
                     game_ui_enable;
                 end
                 count := count + 1;
@@ -2413,9 +2413,9 @@ begin
             if (obj_pid(obj_being_used_with) == 616) then begin
                 script_overrides;
                 gfade_out(10 * 2);
-                set_critter_stat(dude_obj, 5, 1);
-                display_msg(message_str(1309, 441));
-                float_msg(dude_obj, message_str(1309, 440), 4);
+                set_critter_stat(dude_obj, STAT_ag, 1);
+                display_msg(message_str(SCRIPT_AITEM6, 441));
+                float_msg(dude_obj, message_str(SCRIPT_AITEM6, 440), FLOAT_MSG_BLUE);
                 gfade_in(10 * 2);
                 scr_return(1);
             end
@@ -2425,9 +2425,9 @@ begin
                         set_local_var(15, 1);
                         script_overrides;
                         gfade_out(10);
-                        display_msg(message_str(1, 400));
-                        critter_mod_skill(dude_obj, 8, 5);
-                        critter_mod_skill(dude_obj, 3, 5);
+                        display_mstr(400);
+                        critter_mod_skill(dude_obj, SKILL_SNEAK, 5);
+                        critter_mod_skill(dude_obj, SKILL_UNARMED_COMBAT, 5);
                         gfade_in(10);
                         scr_return(1);
                     end
@@ -2438,8 +2438,8 @@ begin
                         if (local_var(16) == 0) then begin
                             set_local_var(16, 1);
                             gfade_out(10);
-                            critter_mod_skill(dude_obj, 2, 10);
-                            display_msg(message_str(1096, 100));
+                            critter_mod_skill(dude_obj, SKILL_ENERGY_WEAPONS, 10);
+                            display_msg(message_str(SCRIPT_NICATPW5, 100));
                             gfade_in(10);
                             scr_return(1);
                         end
@@ -2451,9 +2451,9 @@ begin
                                 script_overrides;
                                 gfade_out(10);
                                 debug_msg("  mark_on_map(" + 25 + ")");
-                                mark_area_known(0, 25, 1);
-                                set_global_var(495, global_var(495) bwor 262144);
-                                display_msg(message_str(219, 2360));
+                                mark_area_known(MARK_TYPE_TOWN, 25, MARK_STATE_KNOWN);
+                                set_global_var(GVAR_NEW_RENO_FLAG_3, global_var(GVAR_NEW_RENO_FLAG_3) bwor 262144);
+                                display_msg(message_str(SCRIPT_KLADWTWN, 2360));
                                 gfade_in(10);
                                 scr_return(1);
                             end
@@ -2461,27 +2461,27 @@ begin
                         else begin
                             if (obj_pid(obj_being_used_with) == 343) then begin
                                 script_overrides;
-                                if (metarule(17, 63) == 0) then begin
+                                if (town_known(63) == MARK_STATE_UNKNOWN) then begin
                                     gfade_out(10);
-                                    mark_area_known(0, 63, 1);
-                                    mark_area_known(0, 64, 1);
-                                    mark_area_known(0, 65, 1);
-                                    display_msg(message_str(219, 2361));
+                                    mark_area_known(MARK_TYPE_TOWN, 63, MARK_STATE_KNOWN);
+                                    mark_area_known(MARK_TYPE_TOWN, 64, MARK_STATE_KNOWN);
+                                    mark_area_known(MARK_TYPE_TOWN, 65, MARK_STATE_KNOWN);
+                                    display_msg(message_str(SCRIPT_KLADWTWN, 2361));
                                     gfade_in(10);
                                     scr_return(0);
                                 end
                                 else begin
-                                    display_msg(message_str(219, 2362));
+                                    display_msg(message_str(SCRIPT_KLADWTWN, 2362));
                                 end
                             end
                             else begin
                                 if (obj_pid(obj_being_used_with) == 523) then begin
                                     script_overrides;
-                                    if (metarule(17, 14) == 0) then begin
+                                    if (town_known(14) == MARK_STATE_UNKNOWN) then begin
                                         gfade_out(10);
-                                        display_msg(message_str(1268, 100));
+                                        display_msg(message_str(SCRIPT_EISANMAP, 100));
                                         debug_msg("  mark_on_map(" + 14 + ")");
-                                        mark_area_known(0, 14, 1);
+                                        mark_area_known(MARK_TYPE_TOWN, 14, MARK_STATE_KNOWN);
                                         gfade_in(10);
                                         scr_return(1);
                                     end
@@ -2489,200 +2489,200 @@ begin
                                 else begin
                                     if (obj_pid(obj_being_used_with) == 328) then begin
                                         script_overrides;
-                                        if (get_critter_stat(dude_obj, 6) <= 3) then begin
+                                        if (dude_luck <= 3) then begin
                                             LVar0 := random(199, 228);
                                         end
                                         else begin
-                                            if (get_critter_stat(dude_obj, 6) < 9) then begin
+                                            if (dude_luck < 9) then begin
                                                 LVar0 := random(200, 228);
                                             end
                                             else begin
-                                                if (get_critter_stat(dude_obj, 6) >= 9) then begin
+                                                if (dude_luck >= 9) then begin
                                                     LVar0 := random(200, 243);
                                                 end
                                             end
                                         end
                                         if (LVar0 == 232) then begin
-                                            set_global_var(243, 1);
+                                            set_global_var(GVAR_8_BALL_TOILET_SECRET, 1);
                                         end
                                         else begin
                                             if (LVar0 == 233) then begin
-                                                set_global_var(244, 1);
+                                                set_global_var(GVAR_8_BALL_TRASH_SECRET, 1);
                                             end
                                             else begin
                                                 if (LVar0 == 243) then begin
-                                                    set_global_var(599, 1);
+                                                    set_global_var(GVAR_8_BALL_VAULT_TERMINAL, 1);
                                                 end
                                             end
                                         end
-                                        display_msg(message_str(412, LVar0));
+                                        display_msg(message_str(SCRIPT_ZI8BALL, LVar0));
                                         scr_return(0);
                                     end
                                     else begin
                                         if (obj_pid(obj_being_used_with) == 458) then begin
                                             script_overrides;
-                                            if (global_var(220) != 1) then begin
+                                            if (global_var(GVAR_HOLODISK_MB_OUTSIDE) != 1) then begin
                                                 gfade_out(10);
-                                                set_global_var(220, 1);
-                                                display_msg(message_str(151, 102));
+                                                set_global_var(GVAR_HOLODISK_MB_OUTSIDE, 1);
+                                                display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                 gfade_in(10);
                                             end
                                             else begin
-                                                display_msg(message_str(151, 101));
+                                                display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                             end
                                             scr_return(0);
                                         end
                                         else begin
                                             if (obj_pid(obj_being_used_with) == 459) then begin
                                                 script_overrides;
-                                                if (global_var(221) != 1) then begin
+                                                if (global_var(GVAR_HOLODISK_MB_LEVEL_1) != 1) then begin
                                                     gfade_out(10);
-                                                    set_global_var(221, 1);
-                                                    display_msg(message_str(151, 102));
+                                                    set_global_var(GVAR_HOLODISK_MB_LEVEL_1, 1);
+                                                    display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                     gfade_in(10);
                                                 end
                                                 else begin
-                                                    display_msg(message_str(151, 101));
+                                                    display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                 end
                                                 scr_return(0);
                                             end
                                             else begin
                                                 if (obj_pid(obj_being_used_with) == 460) then begin
                                                     script_overrides;
-                                                    if (global_var(222) != 1) then begin
+                                                    if (global_var(GVAR_HOLODISK_MB_LEVEL_2) != 1) then begin
                                                         gfade_out(10);
-                                                        set_global_var(222, 1);
-                                                        display_msg(message_str(151, 102));
+                                                        set_global_var(GVAR_HOLODISK_MB_LEVEL_2, 1);
+                                                        display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                         gfade_in(10);
                                                     end
                                                     else begin
-                                                        display_msg(message_str(151, 101));
+                                                        display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                     end
                                                     scr_return(0);
                                                 end
                                                 else begin
                                                     if (obj_pid(obj_being_used_with) == 461) then begin
                                                         script_overrides;
-                                                        if (global_var(223) != 1) then begin
+                                                        if (global_var(GVAR_HOLODISK_MB_LEVEL_3) != 1) then begin
                                                             gfade_out(10);
-                                                            set_global_var(223, 1);
-                                                            display_msg(message_str(151, 102));
+                                                            set_global_var(GVAR_HOLODISK_MB_LEVEL_3, 1);
+                                                            display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                             gfade_in(10);
                                                         end
                                                         else begin
-                                                            display_msg(message_str(151, 101));
+                                                            display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                         end
                                                         scr_return(0);
                                                     end
                                                     else begin
                                                         if (obj_pid(obj_being_used_with) == 462) then begin
                                                             script_overrides;
-                                                            if (global_var(224) != 1) then begin
+                                                            if (global_var(GVAR_HOLODISK_MB_LEVEL_4) != 1) then begin
                                                                 gfade_out(10);
-                                                                set_global_var(224, 1);
-                                                                display_msg(message_str(151, 102));
+                                                                set_global_var(GVAR_HOLODISK_MB_LEVEL_4, 1);
+                                                                display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                 gfade_in(10);
                                                             end
                                                             else begin
-                                                                display_msg(message_str(151, 101));
+                                                                display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                             end
                                                             scr_return(0);
                                                         end
                                                         else begin
                                                             if (obj_pid(obj_being_used_with) == 463) then begin
                                                                 script_overrides;
-                                                                if (global_var(164) != 1) then begin
+                                                                if (global_var(GVAR_HOLODISK_SIERRA_EVACUATION) != 1) then begin
                                                                     gfade_out(10);
-                                                                    set_global_var(164, 1);
-                                                                    display_msg(message_str(151, 102));
+                                                                    set_global_var(GVAR_HOLODISK_SIERRA_EVACUATION, 1);
+                                                                    display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                     gfade_in(10);
                                                                 end
                                                                 else begin
-                                                                    display_msg(message_str(151, 101));
+                                                                    display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                                 end
                                                                 scr_return(0);
                                                             end
                                                             else begin
                                                                 if (obj_pid(obj_being_used_with) == 464) then begin
                                                                     script_overrides;
-                                                                    if (global_var(166) != 1) then begin
+                                                                    if (global_var(GVAR_HOLODISK_SIERRA_EXP_LOG) != 1) then begin
                                                                         gfade_out(10);
-                                                                        set_global_var(166, 1);
-                                                                        display_msg(message_str(151, 102));
+                                                                        set_global_var(GVAR_HOLODISK_SIERRA_EXP_LOG, 1);
+                                                                        display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                         gfade_in(10);
                                                                     end
                                                                     else begin
-                                                                        display_msg(message_str(151, 101));
+                                                                        display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                                     end
                                                                     scr_return(0);
                                                                 end
                                                                 else begin
                                                                     if (obj_pid(obj_being_used_with) == 465) then begin
                                                                         script_overrides;
-                                                                        if (global_var(165) != 1) then begin
+                                                                        if (global_var(GVAR_HOLODISK_SIERRA_MED_LOG) != 1) then begin
                                                                             gfade_out(10);
-                                                                            set_global_var(165, 1);
-                                                                            display_msg(message_str(151, 102));
+                                                                            set_global_var(GVAR_HOLODISK_SIERRA_MED_LOG, 1);
+                                                                            display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                             gfade_in(10);
                                                                         end
                                                                         else begin
-                                                                            display_msg(message_str(151, 101));
+                                                                            display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                                         end
                                                                         scr_return(0);
                                                                     end
                                                                     else begin
                                                                         if (obj_pid(obj_being_used_with) == 478) then begin
                                                                             script_overrides;
-                                                                            if (global_var(521) != 1) then begin
+                                                                            if (global_var(GVAR_SIERRA_MISSION_HOLODISK) != 1) then begin
                                                                                 gfade_out(10);
-                                                                                set_global_var(521, 1);
-                                                                                display_msg(message_str(151, 102));
+                                                                                set_global_var(GVAR_SIERRA_MISSION_HOLODISK, 1);
+                                                                                display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                                 gfade_in(10);
                                                                             end
                                                                             else begin
-                                                                                display_msg(message_str(151, 101));
+                                                                                display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                                             end
                                                                             scr_return(0);
                                                                         end
                                                                         else begin
                                                                             if (obj_pid(obj_being_used_with) == 477) then begin
                                                                                 script_overrides;
-                                                                                if (global_var(520) != 1) then begin
+                                                                                if (global_var(GVAR_SIERRA_GNN_HOLODISK) != 1) then begin
                                                                                     gfade_out(10);
-                                                                                    set_global_var(520, 1);
-                                                                                    display_msg(message_str(151, 102));
+                                                                                    set_global_var(GVAR_SIERRA_GNN_HOLODISK, 1);
+                                                                                    display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                                     gfade_in(10);
                                                                                 end
                                                                                 else begin
-                                                                                    display_msg(message_str(151, 101));
+                                                                                    display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                                                 end
                                                                                 scr_return(0);
                                                                             end
                                                                             else begin
                                                                                 if ((obj_pid(obj_being_used_with) == 493) or (obj_pid(obj_being_used_with) == 472)) then begin
                                                                                     script_overrides;
-                                                                                    if (global_var(522) != 1) then begin
+                                                                                    if (global_var(GVAR_ELRON_HOLODISK) != 1) then begin
                                                                                         gfade_out(10);
-                                                                                        set_global_var(522, 1);
-                                                                                        display_msg(message_str(151, 102));
+                                                                                        set_global_var(GVAR_ELRON_HOLODISK, 1);
+                                                                                        display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                                         gfade_in(10);
                                                                                     end
                                                                                     else begin
-                                                                                        display_msg(message_str(151, 101));
+                                                                                        display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                                                     end
                                                                                     scr_return(0);
                                                                                 end
                                                                                 else begin
                                                                                     if (obj_pid(obj_being_used_with) == 490) then begin
                                                                                         script_overrides;
-                                                                                        if (global_var(596) != 1) then begin
+                                                                                        if (global_var(GVAR_NCR_HISTORY_HOLO_DOWNLOAD) != 1) then begin
                                                                                             gfade_out(10);
-                                                                                            set_global_var(596, 1);
-                                                                                            display_msg(message_str(151, 102));
+                                                                                            set_global_var(GVAR_NCR_HISTORY_HOLO_DOWNLOAD, 1);
+                                                                                            display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                                             gfade_in(10);
                                                                                         end
                                                                                         else begin
-                                                                                            display_msg(message_str(151, 101));
+                                                                                            display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                                                         end
                                                                                         scr_return(0);
                                                                                     end
@@ -2691,36 +2691,36 @@ begin
                                                                                             script_overrides;
                                                                                             if (local_var(8) == 0) then begin
                                                                                                 set_local_var(8, 1);
-                                                                                                display_msg(message_str(151, 104));
-                                                                                                critter_mod_skill(dude_obj, 16, 10);
+                                                                                                display_msg(message_str(SCRIPT_MISCTEXT, 104));
+                                                                                                critter_mod_skill(dude_obj, SKILL_GAMBLING, 10);
                                                                                             end
                                                                                             else begin
-                                                                                                display_msg(message_str(151, 105));
+                                                                                                display_msg(message_str(SCRIPT_MISCTEXT, 105));
                                                                                             end
                                                                                         end
                                                                                         else begin
                                                                                             if (obj_pid(obj_being_used_with) == 673) then begin
                                                                                                 script_overrides;
-                                                                                                if (global_var(768) != 1) then begin
+                                                                                                if (global_var(GVAR_FAMILIAR_WITH_MODOC_WELL) != 1) then begin
                                                                                                     gfade_out(10);
-                                                                                                    set_global_var(768, 1);
-                                                                                                    display_msg(message_str(151, 102));
+                                                                                                    set_global_var(GVAR_FAMILIAR_WITH_MODOC_WELL, 1);
+                                                                                                    display_msg(message_str(SCRIPT_MISCTEXT, 102));
                                                                                                     gfade_in(10);
                                                                                                 end
                                                                                                 else begin
-                                                                                                    display_msg(message_str(151, 101));
+                                                                                                    display_msg(message_str(SCRIPT_MISCTEXT, 101));
                                                                                                 end
                                                                                                 scr_return(0);
                                                                                             end
                                                                                             else begin
                                                                                                 if (obj_pid(obj_being_used_with) == 583) then begin
                                                                                                     script_overrides;
-                                                                                                    if (global_var(709) == 0) then begin
-                                                                                                        set_global_var(709, 1);
-                                                                                                        display_msg(message_str(219, 2350));
+                                                                                                    if (global_var(GVAR_IN_TROUBLE_WITH_MARIA) == 0) then begin
+                                                                                                        set_global_var(GVAR_IN_TROUBLE_WITH_MARIA, 1);
+                                                                                                        display_msg(message_str(SCRIPT_KLADWTWN, 2350));
                                                                                                     end
                                                                                                     else begin
-                                                                                                        display_msg(message_str(219, 2351));
+                                                                                                        display_msg(message_str(SCRIPT_KLADWTWN, 2351));
                                                                                                     end
                                                                                                 end
                                                                                                 else begin
@@ -2740,33 +2740,33 @@ begin
                                                                                                         else begin
                                                                                                             if (obj_pid(obj_being_used_with) == 758) then begin
                                                                                                                 script_overrides;
-                                                                                                                if (global_var(638) != 1) then begin
+                                                                                                                if (global_var(GVAR_HOLODISK_ENCLAVE_VERTIBIRD) != 1) then begin
                                                                                                                     roll_result := roll_vs_skill(dude_obj, 13, -20);
                                                                                                                     if (is_success(roll_result)) then begin
-                                                                                                                        set_global_var(638, 1);
-                                                                                                                        display_msg(message_str(219, 2358));
+                                                                                                                        set_global_var(GVAR_HOLODISK_ENCLAVE_VERTIBIRD, 1);
+                                                                                                                        display_msg(message_str(SCRIPT_KLADWTWN, 2358));
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        display_msg(message_str(219, 2357));
+                                                                                                                        display_msg(message_str(SCRIPT_KLADWTWN, 2357));
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
-                                                                                                                    display_msg(message_str(219, 2359));
+                                                                                                                    display_msg(message_str(SCRIPT_KLADWTWN, 2359));
                                                                                                                 end
                                                                                                             end
                                                                                                             else begin
                                                                                                                 if (obj_pid(obj_being_used_with) == 553) then begin
                                                                                                                     script_overrides;
-                                                                                                                    if (metarule(17, 8) == 0) then begin
+                                                                                                                    if (town_known(8) == MARK_STATE_UNKNOWN) then begin
                                                                                                                         gfade_out(10);
-                                                                                                                        display_msg(message_str(219, 2363));
+                                                                                                                        display_msg(message_str(SCRIPT_KLADWTWN, 2363));
                                                                                                                         debug_msg("  mark_on_map(" + 8 + ")");
-                                                                                                                        mark_area_known(0, 8, 1);
+                                                                                                                        mark_area_known(MARK_TYPE_TOWN, 8, MARK_STATE_KNOWN);
                                                                                                                         gfade_in(10);
                                                                                                                         scr_return(1);
                                                                                                                     end
                                                                                                                     else begin
-                                                                                                                        display_msg(message_str(219, 2364));
+                                                                                                                        display_msg(message_str(SCRIPT_KLADWTWN, 2364));
                                                                                                                     end
                                                                                                                 end
                                                                                                                 else begin
@@ -2800,13 +2800,13 @@ begin
                                                                                                                                         script_overrides;
                                                                                                                                         if (local_var(18) == 0) then begin
                                                                                                                                             set_local_var(18, 1);
-                                                                                                                                            set_global_var(960, 1);
-                                                                                                                                            set_global_var(800, 3);
+                                                                                                                                            set_global_var(GVAR_BEEN_POISONED, 1);
+                                                                                                                                            set_global_var(GVAR_FLASHLIGHT_IS_ON, 3);
                                                                                                                                             game_time_advance(60 * 10 * 10);
-                                                                                                                                            display_msg(message_str(14, 463));
+                                                                                                                                            display_msg(g_mstr(463));
                                                                                                                                         end
                                                                                                                                         else begin
-                                                                                                                                            display_msg(message_str(14, 467));
+                                                                                                                                            display_msg(g_mstr(467));
                                                                                                                                         end
                                                                                                                                     end
                                                                                                                                 end
@@ -2855,10 +2855,10 @@ end
 
 procedure damage_p_proc
 begin
-    if (metarule(49, target_obj) == 5) then begin
-        if ((obj_pid(critter_inven_obj(dude_obj, 0)) == 3) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 232) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 348) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 349) or (obj_pid(critter_inven_obj(dude_obj, 0)) == 554)) then begin
-            set_global_var(959, 1);
-            display_msg(message_str(14, 461));
+    if (weapon_dmg_type(target_obj) == 5) then begin
+        if ((obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 3) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 232) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 348) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 349) or (obj_pid(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 554)) then begin
+            set_global_var(GVAR_HAS_PERMISSION_TO_OPEN_SLAVE_PEN, 1);
+            display_msg(g_mstr(461));
         end
     end
 end
@@ -2913,33 +2913,33 @@ end
 procedure Pamphlet
 begin
     set_local_var(10, 0);
-    gsay_reply(219, 2353);
-    giq_option(4, 219, 2354, Node999, 50);
+    gsay_reply(SCRIPT_KLADWTWN, 2353);
+    giq_option(4, SCRIPT_KLADWTWN, 2354, Node999, NEUTRAL_REACTION);
 end
 
 procedure Oldletter
 begin
     set_local_var(11, 0);
-    if (get_critter_stat(dude_obj, 4) > 2) then begin
-        gsay_reply(219, 5850);
+    if (dude_iq > 2) then begin
+        gsay_reply(SCRIPT_KLADWTWN, 5850);
     end
     else begin
-        gsay_reply(219, 5856);
+        gsay_reply(SCRIPT_KLADWTWN, 5856);
     end
-    giq_option(3, 219, 5853, Oldletter2, 50);
-    giq_option(-2, 219, 5855, Node999, 50);
+    giq_option(3, SCRIPT_KLADWTWN, 5853, Oldletter2, NEUTRAL_REACTION);
+    giq_option(-2, SCRIPT_KLADWTWN, 5855, Node999, NEUTRAL_REACTION);
 end
 
 procedure Oldletter2
 begin
-    gsay_reply(219, 5851);
-    giq_option(3, 219, 5853, Oldletter3, 50);
+    gsay_reply(SCRIPT_KLADWTWN, 5851);
+    giq_option(3, SCRIPT_KLADWTWN, 5853, Oldletter3, NEUTRAL_REACTION);
 end
 
 procedure Oldletter3
 begin
-    gsay_reply(219, 5852);
-    giq_option(3, 219, 5854, Node999, 50);
+    gsay_reply(SCRIPT_KLADWTWN, 5852);
+    giq_option(3, SCRIPT_KLADWTWN, 5854, Node999, NEUTRAL_REACTION);
 end
 
 procedure Node999
@@ -2952,12 +2952,12 @@ begin
     variable LVar1 := 0;
     variable LVar2 := 0;
     variable LVar3 := 0;
-    LVar0 := create_object_sid(911, 0, 0, -1);
-    LVar1 := create_object_sid(912, 0, 0, -1);
+    LVar0 := create_object(911, 0, 0);
+    LVar1 := create_object(912, 0, 0);
     LVar2 := random(1, 10);
-    LVar3 := get_critter_stat(dude_obj, 6) + LVar2;
+    LVar3 := dude_luck + LVar2;
     if ((obj_is_carrying_obj_pid(dude_obj, 910) >= 1) and (LVar3 >= 13)) then begin
-        display_msg(message_str(1306, 4121));
+        display_msg(message_str(SCRIPT_AICRSHDR, 4121));
         removed_qty := obj_is_carrying_obj_pid(dude_obj, 910);
         if (1 < removed_qty) then begin
             removed_qty := 1;
@@ -2966,17 +2966,17 @@ begin
             restock_obj := obj_carrying_pid_obj(dude_obj, 910);
             if (obj_type(self_obj) == 1) then begin
                 restock_obj := obj_carrying_pid_obj(dude_obj, 910);
-                if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                    if (obj_item_subtype(critter_inven_obj(dude_obj, 0)) == 0) then begin
-                        restock_obj := critter_inven_obj(dude_obj, 0);
+                if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                    if (obj_item_subtype(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 0) then begin
+                        restock_obj := critter_inven_obj(dude_obj, INVEN_TYPE_WORN);
                         debug_msg("armour pid == " + obj_pid(restock_obj));
                         rm_obj_from_inven(dude_obj, restock_obj);
                         add_obj_to_inven(dude_obj, restock_obj);
                     end
                 end
                 else begin
-                    if ((critter_inven_obj(dude_obj, 2) == restock_obj) or (critter_inven_obj(dude_obj, 1) == restock_obj)) then begin
-                        metarule(43, dude_obj);
+                    if ((critter_inven_obj(dude_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(dude_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                        inven_unwield(dude_obj);
                     end
                 end
             end
@@ -2989,7 +2989,7 @@ begin
     end
     else begin
         if (obj_is_carrying_obj_pid(dude_obj, 910) >= 1) then begin
-            display_msg(message_str(1306, 4120));
+            display_msg(message_str(SCRIPT_AICRSHDR, 4120));
             removed_qty := obj_is_carrying_obj_pid(dude_obj, 910);
             if (1 < removed_qty) then begin
                 removed_qty := 1;
@@ -2998,17 +2998,17 @@ begin
                 restock_obj := obj_carrying_pid_obj(dude_obj, 910);
                 if (obj_type(self_obj) == 1) then begin
                     restock_obj := obj_carrying_pid_obj(dude_obj, 910);
-                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                        if (obj_item_subtype(critter_inven_obj(dude_obj, 0)) == 0) then begin
-                            restock_obj := critter_inven_obj(dude_obj, 0);
+                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                        if (obj_item_subtype(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 0) then begin
+                            restock_obj := critter_inven_obj(dude_obj, INVEN_TYPE_WORN);
                             debug_msg("armour pid == " + obj_pid(restock_obj));
                             rm_obj_from_inven(dude_obj, restock_obj);
                             add_obj_to_inven(dude_obj, restock_obj);
                         end
                     end
                     else begin
-                        if ((critter_inven_obj(dude_obj, 2) == restock_obj) or (critter_inven_obj(dude_obj, 1) == restock_obj)) then begin
-                            metarule(43, dude_obj);
+                        if ((critter_inven_obj(dude_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(dude_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                            inven_unwield(dude_obj);
                         end
                     end
                 end
@@ -3020,7 +3020,7 @@ begin
             add_obj_to_inven(dude_obj, LVar0);
         end
         else begin
-            display_msg(message_str(1306, 4122));
+            display_msg(message_str(SCRIPT_AICRSHDR, 4122));
         end
     end
     return 0;
@@ -3033,21 +3033,21 @@ end
 procedure Audio
 begin
     set_local_var(12, 0);
-    gsay_reply(219, 2370);
+    gsay_reply(SCRIPT_KLADWTWN, 2370);
     if ((obj_is_carrying_obj_pid(dude_obj, 38) >= 1) and (obj_is_carrying_obj_pid(dude_obj, 98) >= 1)) then begin
-        giq_option(2, 219, 2372, Audio2, 50);
+        giq_option(2, SCRIPT_KLADWTWN, 2372, Audio2, NEUTRAL_REACTION);
     end
     if ((obj_is_carrying_obj_pid(dude_obj, 39) >= 1) and (obj_is_carrying_obj_pid(dude_obj, 98) >= 1)) then begin
-        giq_option(2, 219, 2373, Audio3, 50);
+        giq_option(2, SCRIPT_KLADWTWN, 2373, Audio3, NEUTRAL_REACTION);
     end
-    giq_option(2, 219, 2374, Node999, 50);
+    giq_option(2, SCRIPT_KLADWTWN, 2374, Node999, NEUTRAL_REACTION);
 end
 
 procedure Audio2
 begin
     variable LVar0 := 0;
-    LVar0 := create_object_sid(948, 0, 0, -1);
-    gsay_reply(219, 2375);
+    LVar0 := create_object(948, 0, 0);
+    gsay_reply(SCRIPT_KLADWTWN, 2375);
     add_mult_objs_to_inven(dude_obj, LVar0, 1);
     removed_qty := obj_is_carrying_obj_pid(dude_obj, 38);
     if (1 < removed_qty) then begin
@@ -3057,17 +3057,17 @@ begin
         restock_obj := obj_carrying_pid_obj(dude_obj, 38);
         if (obj_type(self_obj) == 1) then begin
             restock_obj := obj_carrying_pid_obj(dude_obj, 38);
-            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                if (obj_item_subtype(critter_inven_obj(dude_obj, 0)) == 0) then begin
-                    restock_obj := critter_inven_obj(dude_obj, 0);
+            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                if (obj_item_subtype(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 0) then begin
+                    restock_obj := critter_inven_obj(dude_obj, INVEN_TYPE_WORN);
                     debug_msg("armour pid == " + obj_pid(restock_obj));
                     rm_obj_from_inven(dude_obj, restock_obj);
                     add_obj_to_inven(dude_obj, restock_obj);
                 end
             end
             else begin
-                if ((critter_inven_obj(dude_obj, 2) == restock_obj) or (critter_inven_obj(dude_obj, 1) == restock_obj)) then begin
-                    metarule(43, dude_obj);
+                if ((critter_inven_obj(dude_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(dude_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                    inven_unwield(dude_obj);
                 end
             end
         end
@@ -3084,17 +3084,17 @@ begin
         restock_obj2 := obj_carrying_pid_obj(dude_obj, 98);
         if (obj_type(self_obj) == 1) then begin
             restock_obj2 := obj_carrying_pid_obj(dude_obj, 98);
-            if (critter_inven_obj(self_obj, 0) == restock_obj2) then begin
-                if (obj_item_subtype(critter_inven_obj(dude_obj, 0)) == 0) then begin
-                    restock_obj2 := critter_inven_obj(dude_obj, 0);
+            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj2) then begin
+                if (obj_item_subtype(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 0) then begin
+                    restock_obj2 := critter_inven_obj(dude_obj, INVEN_TYPE_WORN);
                     debug_msg("armour pid == " + obj_pid(restock_obj2));
                     rm_obj_from_inven(dude_obj, restock_obj2);
                     add_obj_to_inven(dude_obj, restock_obj2);
                 end
             end
             else begin
-                if ((critter_inven_obj(dude_obj, 2) == restock_obj2) or (critter_inven_obj(dude_obj, 1) == restock_obj2)) then begin
-                    metarule(43, dude_obj);
+                if ((critter_inven_obj(dude_obj, INVEN_TYPE_LEFT_HAND) == restock_obj2) or (critter_inven_obj(dude_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj2)) then begin
+                    inven_unwield(dude_obj);
                 end
             end
         end
@@ -3103,7 +3103,7 @@ begin
     end
     restock_obj2 := 0;
     restock_amt2 := 0;
-    giq_option(2, 219, 2371, Node999, 50);
+    giq_option(2, SCRIPT_KLADWTWN, 2371, Node999, NEUTRAL_REACTION);
     return 0;
     LVar0 := 0;
 end
@@ -3111,8 +3111,8 @@ end
 procedure Audio3
 begin
     variable LVar0 := 0;
-    LVar0 := create_object_sid(948, 0, 0, -1);
-    gsay_reply(219, 2375);
+    LVar0 := create_object(948, 0, 0);
+    gsay_reply(SCRIPT_KLADWTWN, 2375);
     add_mult_objs_to_inven(dude_obj, LVar0, 1);
     removed_qty := obj_is_carrying_obj_pid(dude_obj, 39);
     if (1 < removed_qty) then begin
@@ -3122,17 +3122,17 @@ begin
         restock_obj := obj_carrying_pid_obj(dude_obj, 39);
         if (obj_type(self_obj) == 1) then begin
             restock_obj := obj_carrying_pid_obj(dude_obj, 39);
-            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                if (obj_item_subtype(critter_inven_obj(dude_obj, 0)) == 0) then begin
-                    restock_obj := critter_inven_obj(dude_obj, 0);
+            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                if (obj_item_subtype(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 0) then begin
+                    restock_obj := critter_inven_obj(dude_obj, INVEN_TYPE_WORN);
                     debug_msg("armour pid == " + obj_pid(restock_obj));
                     rm_obj_from_inven(dude_obj, restock_obj);
                     add_obj_to_inven(dude_obj, restock_obj);
                 end
             end
             else begin
-                if ((critter_inven_obj(dude_obj, 2) == restock_obj) or (critter_inven_obj(dude_obj, 1) == restock_obj)) then begin
-                    metarule(43, dude_obj);
+                if ((critter_inven_obj(dude_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(dude_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                    inven_unwield(dude_obj);
                 end
             end
         end
@@ -3149,17 +3149,17 @@ begin
         restock_obj2 := obj_carrying_pid_obj(dude_obj, 98);
         if (obj_type(self_obj) == 1) then begin
             restock_obj2 := obj_carrying_pid_obj(dude_obj, 98);
-            if (critter_inven_obj(self_obj, 0) == restock_obj2) then begin
-                if (obj_item_subtype(critter_inven_obj(dude_obj, 0)) == 0) then begin
-                    restock_obj2 := critter_inven_obj(dude_obj, 0);
+            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj2) then begin
+                if (obj_item_subtype(critter_inven_obj(dude_obj, INVEN_TYPE_WORN)) == 0) then begin
+                    restock_obj2 := critter_inven_obj(dude_obj, INVEN_TYPE_WORN);
                     debug_msg("armour pid == " + obj_pid(restock_obj2));
                     rm_obj_from_inven(dude_obj, restock_obj2);
                     add_obj_to_inven(dude_obj, restock_obj2);
                 end
             end
             else begin
-                if ((critter_inven_obj(dude_obj, 2) == restock_obj2) or (critter_inven_obj(dude_obj, 1) == restock_obj2)) then begin
-                    metarule(43, dude_obj);
+                if ((critter_inven_obj(dude_obj, INVEN_TYPE_LEFT_HAND) == restock_obj2) or (critter_inven_obj(dude_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj2)) then begin
+                    inven_unwield(dude_obj);
                 end
             end
         end
@@ -3168,7 +3168,7 @@ begin
     end
     restock_obj2 := 0;
     restock_amt2 := 0;
-    giq_option(2, 219, 2371, Node999, 50);
+    giq_option(2, SCRIPT_KLADWTWN, 2371, Node999, NEUTRAL_REACTION);
     return 0;
     LVar0 := 0;
 end
@@ -3177,137 +3177,137 @@ procedure Tape
 begin
     set_local_var(13, 0);
     if (obj_is_carrying_obj_pid(dude_obj, 948) >= 1) then begin
-        gsay_reply(1306, 4132);
-        giq_option(2, 1306, 4133, Tape2, 50);
-        giq_option(2, 1306, 4134, Tape8, 50);
-        giq_option(2, 1306, 4131, Node999, 50);
+        gsay_reply(SCRIPT_AICRSHDR, 4132);
+        giq_option(2, SCRIPT_AICRSHDR, 4133, Tape2, NEUTRAL_REACTION);
+        giq_option(2, SCRIPT_AICRSHDR, 4134, Tape8, NEUTRAL_REACTION);
+        giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
     end
     else begin
-        gsay_reply(1306, 4130);
-        giq_option(2, 1306, 4131, Node999, 50);
+        gsay_reply(SCRIPT_AICRSHDR, 4130);
+        giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
     end
 end
 
 procedure Tape2
 begin
-    gsay_reply(1306, 4138);
-    giq_option(2, 1306, 4137, Tape3, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4138);
+    giq_option(2, SCRIPT_AICRSHDR, 4137, Tape3, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape3
 begin
-    gsay_reply(1306, 4139);
-    giq_option(2, 1306, 4135, Tape4, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4139);
+    giq_option(2, SCRIPT_AICRSHDR, 4135, Tape4, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape4
 begin
-    gsay_reply(1306, 4140);
-    giq_option(2, 1306, 4137, Tape5, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4140);
+    giq_option(2, SCRIPT_AICRSHDR, 4137, Tape5, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape5
 begin
-    gsay_reply(1306, 4141);
-    giq_option(2, 1306, 4136, Tape, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4141);
+    giq_option(2, SCRIPT_AICRSHDR, 4136, Tape, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape6
 begin
-    gsay_reply(1306, 4142);
-    giq_option(2, 1306, 4137, Tape7, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4142);
+    giq_option(2, SCRIPT_AICRSHDR, 4137, Tape7, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape7
 begin
-    gsay_reply(1306, 4143);
-    giq_option(2, 1306, 4136, Tape, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4143);
+    giq_option(2, SCRIPT_AICRSHDR, 4136, Tape, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape8
 begin
-    gsay_reply(1306, 4142);
-    giq_option(2, 1306, 4137, Tape9, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4142);
+    giq_option(2, SCRIPT_AICRSHDR, 4137, Tape9, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape9
 begin
-    gsay_reply(1306, 4143);
-    giq_option(2, 1306, 4135, Tape10, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4143);
+    giq_option(2, SCRIPT_AICRSHDR, 4135, Tape10, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape10
 begin
-    gsay_reply(1306, 4144);
-    giq_option(2, 1306, 4137, Tape11, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4144);
+    giq_option(2, SCRIPT_AICRSHDR, 4137, Tape11, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape11
 begin
-    gsay_reply(1306, 4145);
-    giq_option(2, 1306, 4136, Tape, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4145);
+    giq_option(2, SCRIPT_AICRSHDR, 4136, Tape, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape12
 begin
-    gsay_reply(1306, 4146);
-    giq_option(2, 1306, 4137, Tape13, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4146);
+    giq_option(2, SCRIPT_AICRSHDR, 4137, Tape13, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure Tape13
 begin
-    gsay_reply(1306, 4147);
-    giq_option(2, 1306, 4136, Tape, 50);
-    giq_option(2, 1306, 4131, Node999, 50);
+    gsay_reply(SCRIPT_AICRSHDR, 4147);
+    giq_option(2, SCRIPT_AICRSHDR, 4136, Tape, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_AICRSHDR, 4131, Node999, NEUTRAL_REACTION);
 end
 
 procedure catpaw
 begin
     set_local_var(14, 0);
-    gsay_reply(219, 2380);
-    giq_option(2, 219, 2385, catpaw2, 50);
+    gsay_reply(SCRIPT_KLADWTWN, 2380);
+    giq_option(2, SCRIPT_KLADWTWN, 2385, catpaw2, NEUTRAL_REACTION);
 end
 
 procedure catpaw2
 begin
-    gsay_reply(219, 2381);
-    giq_option(2, 219, 2385, catpaw3, 50);
+    gsay_reply(SCRIPT_KLADWTWN, 2381);
+    giq_option(2, SCRIPT_KLADWTWN, 2385, catpaw3, NEUTRAL_REACTION);
 end
 
 procedure catpaw3
 begin
-    gsay_reply(219, 2382);
-    giq_option(2, 219, 2385, catpaw4, 50);
+    gsay_reply(SCRIPT_KLADWTWN, 2382);
+    giq_option(2, SCRIPT_KLADWTWN, 2385, catpaw4, NEUTRAL_REACTION);
 end
 
 procedure catpaw4
 begin
-    if (get_critter_stat(dude_obj, 1) >= 6) then begin
-        gsay_reply(219, 2383);
-        giq_option(2, 219, 2385, catpaw5, 50);
+    if (dude_perception >= 6) then begin
+        gsay_reply(SCRIPT_KLADWTWN, 2383);
+        giq_option(2, SCRIPT_KLADWTWN, 2385, catpaw5, NEUTRAL_REACTION);
     end
     else begin
-        gsay_reply(219, 2383);
-        giq_option(2, 219, 2386, Node999, 50);
+        gsay_reply(SCRIPT_KLADWTWN, 2383);
+        giq_option(2, SCRIPT_KLADWTWN, 2386, Node999, NEUTRAL_REACTION);
     end
 end
 
 procedure catpaw5
 begin
-    gsay_reply(219, 2384);
-    giq_option(2, 219, 2386, Node999, 50);
-    giq_option(2, 219, 2387, catpaw6, 50);
+    gsay_reply(SCRIPT_KLADWTWN, 2384);
+    giq_option(2, SCRIPT_KLADWTWN, 2386, Node999, NEUTRAL_REACTION);
+    giq_option(2, SCRIPT_KLADWTWN, 2387, catpaw6, NEUTRAL_REACTION);
 end
 
 procedure catpaw6
@@ -3316,4 +3316,3 @@ begin
     end_dialogue;
     load_map(179, 0);
 end
-
