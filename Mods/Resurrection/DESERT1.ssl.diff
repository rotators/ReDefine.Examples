diff --git a/Mods/Resurrection/Original/DESERT1.ssl b/Mods/Resurrection/ReDefine/DESERT1.ssl
index 44e93e8..dd646ea 100644
--- a/Mods/Resurrection/Original/DESERT1.ssl
+++ b/Mods/Resurrection/ReDefine/DESERT1.ssl
@@ -76,12 +76,12 @@ begin
             return 1;
         end
     end
-    if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+    if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
         if (tile_distance_objs(self_obj, party_member_obj(16777779)) <= 5) then begin
             return 1;
         end
     end
-    if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+    if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
         if (tile_distance_objs(self_obj, party_member_obj(16777811)) <= 5) then begin
             return 1;
         end
@@ -96,7 +96,7 @@ begin
             return 1;
         end
     end
-    if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+    if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
         if (tile_distance_objs(self_obj, party_member_obj(16777814)) <= 5) then begin
             return 1;
         end
@@ -230,62 +230,62 @@ begin
             end
         end
     end
-    if (((global_var(911) bwand 1) != 0) and not(metarule(22, 0))) then begin
+    if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 1) != 0) and not(is_loading_game)) then begin
         game_ui_disable;
-        if (cur_map_index == 102) then begin
+        if (CUR_MAP_KARAVAN1) then begin
             wm_area_set_pos(31, random(520, 580), random(350, 450));
-            if ((global_var(911) bwand 1048576) != 0) then begin
-                set_global_var(911, global_var(911) bwand (-1 - 1048576));
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 1048576) != 0) then begin
+                set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand (-1 - 1048576));
                 add_timer_event(self_obj, game_ticks(1), 3);
             end
         end
-        if ((cur_map_index == 103) or (cur_map_index == 104) or (cur_map_index == 105) or (cur_map_index == 106)) then begin
-            if (((global_var(911) bwand 4096) != 0) or ((global_var(911) bwand 256) != 0)) then begin
+        if ((CUR_MAP_KARAVAN2) or (CUR_MAP_KARAVAN3) or (CUR_MAP_KARAVAN4) or (CUR_MAP_KARAVAN5)) then begin
+            if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4096) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 256) != 0)) then begin
                 wm_area_set_pos(31, random(200, 350), random(110, 170));
             end
-            if (((global_var(911) bwand 1024) != 0) or ((global_var(911) bwand 64) != 0)) then begin
+            if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 1024) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 64) != 0)) then begin
                 wm_area_set_pos(31, random(680, 740), random(220, 280));
             end
-            if (((global_var(911) bwand 2048) != 0) or ((global_var(911) bwand 128) != 0)) then begin
+            if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 128) != 0)) then begin
                 wm_area_set_pos(31, random(520, 580), random(350, 450));
             end
             game_time_advance(random(1, 2) * (24 * (60 * (60 * 10))));
-            if ((global_var(911) bwand 1048576) != 0) then begin
-                set_global_var(911, global_var(911) bwand (-1 - 1048576));
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 1048576) != 0) then begin
+                set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand (-1 - 1048576));
                 add_timer_event(self_obj, game_ticks(1), 3);
             end
             else begin
                 add_timer_event(self_obj, 8, 3);
             end
         end
-        set_global_var(916, 0);
+        set_global_var(GVAR_KARAVAN_ATACKERS_COUNTER, 0);
         game_time_advance(random(1, 12) * (60 * (60 * 10)));
         game_time_advance(random(1, 30) * (60 * 10));
-        if (((global_var(911) bwand 2048) != 0) or ((global_var(911) bwand 128) != 0)) then begin
-            if ((global_var(911) bwand 4) != 0) then begin
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 128) != 0)) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
                 enemy_count := random(4, 5);
             end
-            if ((global_var(911) bwand 8) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
                 enemy_count := random(4, 6);
             end
-            if ((global_var(911) bwand 16) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
                 enemy_count := random(5, 7);
             end
         end
         else begin
-            if ((global_var(911) bwand 4) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
                 enemy_count := random(4, 5);
             end
-            if ((global_var(911) bwand 8) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
                 enemy_count := random(4, 6);
             end
-            if ((global_var(911) bwand 16) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
                 enemy_count := random(5, 7);
             end
         end
-        if (((global_var(911) bwand 2048) != 0) or ((global_var(911) bwand 128) != 0)) then begin
-            if ((global_var(867) bwand 268435456) != 0) then begin
-                if ((global_var(911) bwand 4) != 0) then begin
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 128) != 0)) then begin
+            if ((global_var(GVAR_AQ_ALBUQ_DEATHS) bwand 268435456) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
                     choose_sub_random_class := random(1, 5);
                     if ((choose_sub_random_class == 1) or (choose_sub_random_class == 2)) then begin
                         enemy_type := 1;
@@ -294,7 +294,7 @@ begin
                         enemy_type := random(13, 18);
                     end
                 end
-                if ((global_var(911) bwand 8) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
                     choose_sub_random_class := random(1, 6);
                     if ((choose_sub_random_class == 1) or (choose_sub_random_class == 2)) then begin
                         enemy_type := 1;
@@ -303,7 +303,7 @@ begin
                         enemy_type := random(14, 19);
                     end
                 end
-                if ((global_var(911) bwand 16) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
                     choose_sub_random_class := random(1, 5);
                     if (choose_sub_random_class == 1) then begin
                         enemy_type := 1;
@@ -314,7 +314,7 @@ begin
                 end
             end
             else begin
-                if (get_critter_stat(dude_obj, 6) > 6) then begin
+                if (dude_luck > 6) then begin
                     choose_sub_random_class := random(1, 4);
                 end
                 else begin
@@ -329,40 +329,40 @@ begin
             end
         end
         else begin
-            if ((global_var(911) bwand 4) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
                 enemy_type := random(2, 11);
             end
-            if ((global_var(911) bwand 8) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
                 enemy_type := random(1, 13);
             end
-            if ((global_var(911) bwand 16) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
                 enemy_type := random(1, 15);
             end
         end
         if (enemy_type == 4) then begin
             enemy_type := random(5, 8);
         end
-        if ((enemy_type == 1) and (((global_var(911) bwand 2048) != 0) or ((global_var(911) bwand 128) != 0))) then begin
-            if ((global_var(911) bwand 4) != 0) then begin
+        if ((enemy_type == 1) and (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 128) != 0))) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
                 enemy_count := random(2, 3);
             end
-            if ((global_var(911) bwand 8) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
                 enemy_count := random(3, 4);
             end
-            if ((global_var(911) bwand 16) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
                 enemy_count := random(4, 5);
             end
         end
-        if (cur_map_index == 102) then begin
+        if (CUR_MAP_KARAVAN1) then begin
             enemy_type := 7;
-            if (global_var(747) == 1) then begin
+            if (global_var(GVAR_DEAL_WITH_RAIDERS) == 1) then begin
                 enemy_count := 10;
             end
             else begin
                 enemy_count := 5;
             end
         end
-        if (((global_var(911) bwand 2048) != 0) or ((global_var(911) bwand 128) != 0)) then begin
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 128) != 0)) then begin
             if ((enemy_type == 1) and (enemy_count > 6)) then begin
                 enemy_count := 6;
             end
@@ -378,258 +378,258 @@ begin
                 enemy_count := 6;
             end
         end
-        if ((global_var(911) bwand 8) != 0) then begin
-            if (cur_map_index == 103) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777989, 17502, 0, 23);
+        if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
+            if (CUR_MAP_KARAVAN2) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777989, 17502, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777799, 19497, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777799, 19497, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777799, 22098, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777799, 22098, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777800, 20708, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777800, 20708, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 104) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777989, 19486, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777989, 19486, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777799, 18496, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777799, 18496, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777799, 21105, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777799, 21105, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777800, 19113, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777800, 19113, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 105) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777989, 21490, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777989, 21490, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777799, 22306, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777799, 22306, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777799, 20108, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777799, 20108, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777800, 22716, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777800, 22716, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 106) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777989, 19079, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777989, 19079, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777799, 17485, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777799, 17485, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777799, 17893, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777799, 17893, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777800, 19705, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777800, 19705, 0, SCRIPT_KARBLOCK);
                 end
             end
         end
-        if ((global_var(911) bwand 16) != 0) then begin
-            if (cur_map_index == 103) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777990, 17502, 0, 23);
+        if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
+            if (CUR_MAP_KARAVAN2) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777990, 17502, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777797, 19497, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777797, 19497, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777797, 22098, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777797, 22098, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777798, 20708, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777798, 20708, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 104) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777990, 19486, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777990, 19486, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777797, 18496, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777797, 18496, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777797, 21105, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777797, 21105, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777798, 19113, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777798, 19113, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 105) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777990, 21490, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777990, 21490, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777797, 22306, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777797, 22306, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777797, 20108, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777797, 20108, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777798, 22716, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777798, 22716, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 106) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777990, 19079, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777990, 19079, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777797, 17485, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777797, 17485, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777797, 17893, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777797, 17893, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777798, 19705, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777798, 19705, 0, SCRIPT_KARBLOCK);
                 end
             end
         end
-        if ((global_var(911) bwand 4) != 0) then begin
-            if (cur_map_index == 102) then begin
-                Karavan_Leader := create_object_sid(16777765, 17898, 0, 23);
-                Karavan_Guard1 := create_object_sid(16777797, 19501, 0, 23);
-                Karavan_Guard2 := create_object_sid(16777797, 20908, 0, 23);
-                Karavan_Guard3 := create_object_sid(16777798, 21295, 0, 23);
-                Karavan_Guard4 := create_object_sid(16777798, 22902, 0, 23);
+        if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
+            if (CUR_MAP_KARAVAN1) then begin
+                Karavan_Leader := create_object_sid(16777765, 17898, 0, SCRIPT_KARBLOCK);
+                Karavan_Guard1 := create_object_sid(16777797, 19501, 0, SCRIPT_KARBLOCK);
+                Karavan_Guard2 := create_object_sid(16777797, 20908, 0, SCRIPT_KARBLOCK);
+                Karavan_Guard3 := create_object_sid(16777798, 21295, 0, SCRIPT_KARBLOCK);
+                Karavan_Guard4 := create_object_sid(16777798, 22902, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 103) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777991, 17502, 0, 23);
+            if (CUR_MAP_KARAVAN2) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777991, 17502, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777797, 19497, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777797, 19497, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777797, 22098, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777797, 22098, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777798, 20708, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777798, 20708, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 104) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777991, 19486, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777991, 19486, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777797, 18496, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777797, 18496, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777797, 21105, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777797, 21105, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777798, 19113, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777798, 19113, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 105) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777991, 21490, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777991, 21490, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777797, 22306, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777797, 22306, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777797, 20108, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777797, 20108, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777798, 22716, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777798, 22716, 0, SCRIPT_KARBLOCK);
                 end
             end
-            if (cur_map_index == 106) then begin
-                if (not((global_var(911) bwand 8192) != 0)) then begin
-                    Karavan_Leader := create_object_sid(16777991, 19079, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+                    Karavan_Leader := create_object_sid(16777991, 19079, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 16384) != 0)) then begin
-                    Karavan_Guard1 := create_object_sid(16777797, 17485, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+                    Karavan_Guard1 := create_object_sid(16777797, 17485, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 32768) != 0)) then begin
-                    Karavan_Guard2 := create_object_sid(16777797, 17893, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+                    Karavan_Guard2 := create_object_sid(16777797, 17893, 0, SCRIPT_KARBLOCK);
                 end
-                if (not((global_var(911) bwand 65536) != 0)) then begin
-                    Karavan_Guard3 := create_object_sid(16777798, 19705, 0, 23);
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+                    Karavan_Guard3 := create_object_sid(16777798, 19705, 0, SCRIPT_KARBLOCK);
                 end
             end
         end
-        if (cur_map_index == 102) then begin
+        if (CUR_MAP_KARAVAN1) then begin
             anim(Karavan_Leader, 1000, 5);
             anim(Karavan_Guard1, 1000, 5);
             anim(Karavan_Guard2, 1000, 5);
             anim(Karavan_Guard3, 1000, 5);
             anim(Karavan_Guard4, 1000, 5);
         end
-        if (cur_map_index == 103) then begin
-            if (not((global_var(911) bwand 8192) != 0)) then begin
+        if (CUR_MAP_KARAVAN2) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
                 anim(Karavan_Leader, 1000, 5);
             end
-            if (not((global_var(911) bwand 16384) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
                 anim(Karavan_Guard1, 1000, 5);
             end
-            if (not((global_var(911) bwand 32768) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
                 anim(Karavan_Guard2, 1000, 5);
             end
-            if (not((global_var(911) bwand 65536) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
                 anim(Karavan_Guard3, 1000, 5);
             end
         end
-        if (cur_map_index == 104) then begin
-            if (not((global_var(911) bwand 8192) != 0)) then begin
+        if (CUR_MAP_KARAVAN3) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
                 anim(Karavan_Leader, 1000, 0);
             end
-            if (not((global_var(911) bwand 16384) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
                 anim(Karavan_Guard1, 1000, 0);
             end
-            if (not((global_var(911) bwand 32768) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
                 anim(Karavan_Guard2, 1000, 0);
             end
-            if (not((global_var(911) bwand 65536) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
                 anim(Karavan_Guard3, 1000, 0);
             end
         end
-        if (cur_map_index == 105) then begin
-            if (not((global_var(911) bwand 8192) != 0)) then begin
+        if (CUR_MAP_KARAVAN4) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
                 anim(Karavan_Leader, 1000, 1);
             end
-            if (not((global_var(911) bwand 16384) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
                 anim(Karavan_Guard1, 1000, 1);
             end
-            if (not((global_var(911) bwand 32768) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
                 anim(Karavan_Guard2, 1000, 1);
             end
-            if (not((global_var(911) bwand 65536) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
                 anim(Karavan_Guard3, 1000, 1);
             end
         end
-        if (cur_map_index == 106) then begin
-            if (not((global_var(911) bwand 8192) != 0)) then begin
+        if (CUR_MAP_KARAVAN5) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
                 anim(Karavan_Leader, 1000, 1);
             end
-            if (not((global_var(911) bwand 16384) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
                 anim(Karavan_Guard1, 1000, 1);
             end
-            if (not((global_var(911) bwand 32768) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
                 anim(Karavan_Guard2, 1000, 1);
             end
-            if (not((global_var(911) bwand 65536) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
                 anim(Karavan_Guard3, 1000, 1);
             end
         end
         call equip_caravan_team();
-        if ((global_var(911) bwand 8192) != 0) then begin
-            if ((global_var(911) bwand 4) != 0) then begin
-                if (not((global_var(911) bwand 65536) != 0)) then begin
+        if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
                     replacing_guard_ID := 3;
                 end
                 else begin
-                    if (not((global_var(911) bwand 32768) != 0)) then begin
+                    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
                         replacing_guard_ID := 2;
                     end
                     else begin
@@ -638,11 +638,11 @@ begin
                 end
             end
             else begin
-                if (not((global_var(911) bwand 16384) != 0)) then begin
+                if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
                     replacing_guard_ID := 1;
                 end
                 else begin
-                    if (not((global_var(911) bwand 32768) != 0)) then begin
+                    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
                         replacing_guard_ID := 2;
                     end
                     else begin
@@ -651,190 +651,190 @@ begin
                 end
             end
             if (replacing_guard_ID == 1) then begin
-                if (cur_map_index == 103) then begin
+                if (CUR_MAP_KARAVAN2) then begin
                     move_to(Karavan_Guard1, 17502, 0);
                 end
-                if (cur_map_index == 104) then begin
+                if (CUR_MAP_KARAVAN3) then begin
                     move_to(Karavan_Guard1, 19486, 0);
                 end
-                if (cur_map_index == 105) then begin
+                if (CUR_MAP_KARAVAN4) then begin
                     move_to(Karavan_Guard1, 21490, 0);
                 end
-                if (cur_map_index == 106) then begin
+                if (CUR_MAP_KARAVAN5) then begin
                     move_to(Karavan_Guard1, 19079, 0);
                 end
             end
             if (replacing_guard_ID == 2) then begin
-                if (cur_map_index == 103) then begin
+                if (CUR_MAP_KARAVAN2) then begin
                     move_to(Karavan_Guard2, 17502, 0);
                 end
-                if (cur_map_index == 104) then begin
+                if (CUR_MAP_KARAVAN3) then begin
                     move_to(Karavan_Guard2, 19486, 0);
                 end
-                if (cur_map_index == 105) then begin
+                if (CUR_MAP_KARAVAN4) then begin
                     move_to(Karavan_Guard2, 21490, 0);
                 end
-                if (cur_map_index == 106) then begin
+                if (CUR_MAP_KARAVAN5) then begin
                     move_to(Karavan_Guard2, 19079, 0);
                 end
             end
             if (replacing_guard_ID == 3) then begin
-                if (cur_map_index == 103) then begin
+                if (CUR_MAP_KARAVAN2) then begin
                     move_to(Karavan_Guard3, 17502, 0);
                 end
-                if (cur_map_index == 104) then begin
+                if (CUR_MAP_KARAVAN3) then begin
                     move_to(Karavan_Guard3, 19486, 0);
                 end
-                if (cur_map_index == 105) then begin
+                if (CUR_MAP_KARAVAN4) then begin
                     move_to(Karavan_Guard3, 21490, 0);
                 end
-                if (cur_map_index == 106) then begin
+                if (CUR_MAP_KARAVAN5) then begin
                     move_to(Karavan_Guard3, 19079, 0);
                 end
             end
         end
-        if (cur_map_index == 102) then begin
+        if (CUR_MAP_KARAVAN1) then begin
             add_timer_event(Karavan_Leader, game_ticks(0), 6);
         end
         else begin
-            if (not((global_var(911) bwand 8192) != 0)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
                 add_timer_event(Karavan_Leader, game_ticks(0), 1);
             end
         end
-        if (not((global_var(911) bwand 16384) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
             add_timer_event(Karavan_Guard1, game_ticks(0), 2);
         end
-        if (not((global_var(911) bwand 32768) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
             add_timer_event(Karavan_Guard2, game_ticks(0), 3);
         end
-        if (not((global_var(911) bwand 65536) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
             add_timer_event(Karavan_Guard3, game_ticks(0), 4);
         end
-        if (cur_map_index == 102) then begin
+        if (CUR_MAP_KARAVAN1) then begin
             add_timer_event(Karavan_Guard4, game_ticks(0), 5);
         end
-        if (not((global_var(911) bwand 524288) != 0) and not((global_var(911) bwand 262144) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 524288) != 0) and not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 262144) != 0)) then begin
             call generate_fourth_guard();
             add_timer_event(Karavan_Guard4, game_ticks(0), 5);
-            set_global_var(911, global_var(911) bwor 2097152);
+            set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwor 2097152);
         end
-        if (not((global_var(911) bwand 8192) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
             add_timer_event(Karavan_Leader, 5, 10);
         end
-        if (not((global_var(911) bwand 16384) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
             add_timer_event(Karavan_Guard1, 5, 10);
         end
-        if (not((global_var(911) bwand 32768) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
             add_timer_event(Karavan_Guard2, 5, 10);
         end
-        if (not((global_var(911) bwand 65536) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
             add_timer_event(Karavan_Guard3, 5, 10);
         end
-        if (cur_map_index == 102) then begin
+        if (CUR_MAP_KARAVAN1) then begin
             add_timer_event(Karavan_Guard4, 5, 10);
         end
-        if ((global_var(1024) == 1) and (cur_map_index == 102)) then begin
+        if ((global_var(GVAR_CARAVAN_JEREMY_ESCAPED) == 1) and (CUR_MAP_KARAVAN1)) then begin
         end
         else begin
             add_timer_event(self_obj, 6, 1);
         end
-        if (cur_map_index == 102) then begin
+        if (CUR_MAP_KARAVAN1) then begin
             move_to(dude_obj, 18303, 0);
             anim(dude_obj, 1000, 5);
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777293) != 0) then begin
                 if (party_member_obj(16777293) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777293), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777293))) then begin
+                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -856,103 +856,103 @@ begin
                 anim(party_member_obj(16777812), 1000, 5);
             end
         end
-        if (cur_map_index == 103) then begin
+        if (CUR_MAP_KARAVAN2) then begin
             move_to(dude_obj, 18307, 0);
             anim(dude_obj, 1000, 5);
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777293) != 0) then begin
                 if (party_member_obj(16777293) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777293), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777293))) then begin
+                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -974,103 +974,103 @@ begin
                 anim(party_member_obj(16777812), 1000, 5);
             end
         end
-        if (cur_map_index == 104) then begin
+        if (CUR_MAP_KARAVAN3) then begin
             move_to(dude_obj, 20693, 0);
             anim(dude_obj, 1000, 0);
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777293) != 0) then begin
                 if (party_member_obj(16777293) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777293), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777293))) then begin
+                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 0);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 0);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 0);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 0);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1092,103 +1092,103 @@ begin
                 anim(party_member_obj(16777812), 1000, 0);
             end
         end
-        if (cur_map_index == 105) then begin
+        if (CUR_MAP_KARAVAN4) then begin
             move_to(dude_obj, 19891, 0);
             anim(dude_obj, 1000, 1);
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777293) != 0) then begin
                 if (party_member_obj(16777293) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777293), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777293))) then begin
+                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 1);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 1);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 1);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 1);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1210,103 +1210,103 @@ begin
                 anim(party_member_obj(16777812), 1000, 1);
             end
         end
-        if (cur_map_index == 106) then begin
+        if (CUR_MAP_KARAVAN5) then begin
             move_to(dude_obj, 19887, 0);
             anim(dude_obj, 1000, 1);
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777293) != 0) then begin
                 if (party_member_obj(16777293) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777293), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777293))) then begin
+                        critter_attempt_placement(party_member_obj(16777293), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 1);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 1);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 1);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 1);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1330,288 +1330,288 @@ begin
             add_timer_event(self_obj, 1, 2);
         end
         call generate_enemy_type();
-        if (cur_map_index == 102) then begin
+        if (CUR_MAP_KARAVAN1) then begin
             enemy_TILE := 16298;
             enemy_ROTATION := 2;
         end
-        if (cur_map_index == 103) then begin
+        if (CUR_MAP_KARAVAN2) then begin
             enemy_TILE := 16303;
             enemy_ROTATION := 2;
         end
-        if (cur_map_index == 104) then begin
+        if (CUR_MAP_KARAVAN3) then begin
             enemy_TILE := 18677;
             enemy_ROTATION := 3;
         end
-        if (cur_map_index == 105) then begin
+        if (CUR_MAP_KARAVAN4) then begin
             enemy_TILE := 22487;
             enemy_ROTATION := 4;
         end
-        if (cur_map_index == 106) then begin
+        if (CUR_MAP_KARAVAN5) then begin
             enemy_TILE := 20280;
             enemy_ROTATION := 5;
         end
         Enemy_Attacker := create_object_sid(enemy_PID, enemy_TILE, 0, enemy_SCRIPT);
-        critter_add_trait(Enemy_Attacker, 1, 6, enemy_TEAM);
-        critter_add_trait(Enemy_Attacker, 1, 5, enemy_AI);
+        critter_add_trait(Enemy_Attacker, TRAIT_OBJECT, OBJECT_TEAM_NUM, enemy_TEAM);
+        critter_add_trait(Enemy_Attacker, TRAIT_OBJECT, OBJECT_AI_PACKET, enemy_AI);
         anim(Enemy_Attacker, 1000, enemy_ROTATION);
-        set_global_var(916, global_var(916) + 1);
+        set_global_var(GVAR_KARAVAN_ATACKERS_COUNTER, global_var(GVAR_KARAVAN_ATACKERS_COUNTER) + 1);
         if (enemy_type == 1) then begin
-            display_msg(message_str(35, 100));
+            display_mstr(100);
         end
         if (enemy_type == 2) then begin
-            display_msg(message_str(35, 101));
+            display_mstr(101);
         end
         if (enemy_type == 3) then begin
-            display_msg(message_str(35, 102));
+            display_mstr(102);
         end
         if (enemy_type == 4) then begin
-            display_msg(message_str(35, 103));
+            display_mstr(103);
         end
         if (enemy_type == 5) then begin
-            display_msg(message_str(35, 104));
+            display_mstr(104);
         end
         if (enemy_type == 6) then begin
-            display_msg(message_str(35, 105));
+            display_mstr(105);
         end
         if ((enemy_type == 7) or (enemy_type == 8) or (enemy_type == 9) or (enemy_type == 10) or (enemy_type == 11) or (enemy_type == 12) or (enemy_type == 13) or (enemy_type == 14) or (enemy_type == 15)) then begin
-            display_msg(message_str(35, 106));
+            display_mstr(106);
         end
         if ((enemy_type == 16) or (enemy_type == 17) or (enemy_type == 18) or (enemy_type == 19) or (enemy_type == 20)) then begin
-            display_msg(message_str(35, 107));
+            display_mstr(107);
         end
         if ((enemy_type == 7) or (enemy_type == 8) or (enemy_type == 9) or (enemy_type == 10) or (enemy_type == 11) or (enemy_type == 12) or (enemy_type == 13) or (enemy_type == 14) or (enemy_type == 15) or ((enemy_type == 16) or (enemy_type == 17) or (enemy_type == 18) or (enemy_type == 19) or (enemy_type == 20))) then begin
             call choose_random_weapon_for_enemy();
-            restock_obj := create_object_sid(item, 0, 0, -1);
+            restock_obj := create_object(item, 0, 0);
             add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
             if (obj_is_carrying_obj_pid(Enemy_Attacker, 94)) then begin
-                restock_obj := create_object_sid(95, 0, 0, -1);
+                restock_obj := create_object(95, 0, 0);
                 add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
             end
             if (obj_is_carrying_obj_pid(Enemy_Attacker, 13)) then begin
-                restock_obj := create_object_sid(14, 0, 0, -1);
+                restock_obj := create_object(14, 0, 0);
                 add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 2);
             end
             if (obj_is_carrying_obj_pid(Enemy_Attacker, 143)) then begin
-                restock_obj := create_object_sid(34, 0, 0, -1);
+                restock_obj := create_object(34, 0, 0);
                 add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
             end
             if (obj_is_carrying_obj_pid(Enemy_Attacker, 12)) then begin
-                restock_obj := create_object_sid(35, 0, 0, -1);
+                restock_obj := create_object(35, 0, 0);
                 add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
             end
             if ((enemy_type == 7) or (enemy_type == 8) or (enemy_type == 9) or (enemy_type == 10) or (enemy_type == 11) or (enemy_type == 12) or (enemy_type == 13) or (enemy_type == 14) or (enemy_type == 15)) then begin
                 probability_drugs := random(1, 10);
-                restock_obj := create_object_sid(41, 0, 0, -1);
+                restock_obj := create_object(41, 0, 0);
                 add_mult_objs_to_inven(Enemy_Attacker, restock_obj, random(10, 30));
                 if (probability_drugs == 1) then begin
-                    restock_obj := create_object_sid(87, 0, 0, -1);
+                    restock_obj := create_object(87, 0, 0);
                     add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
                 end
                 if (probability_drugs == 2) then begin
-                    restock_obj := create_object_sid(53, 0, 0, -1);
+                    restock_obj := create_object(53, 0, 0);
                     add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
                 end
                 if (probability_drugs == 3) then begin
-                    restock_obj := create_object_sid(110, 0, 0, -1);
+                    restock_obj := create_object(110, 0, 0);
                     add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
                 end
                 if (probability_drugs == 4) then begin
-                    restock_obj := create_object_sid(40, 0, 0, -1);
+                    restock_obj := create_object(40, 0, 0);
                     add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
                 end
                 if (probability_drugs == 5) then begin
-                    restock_obj := create_object_sid(87, 0, 0, -1);
+                    restock_obj := create_object(87, 0, 0);
                     add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
                 end
                 if (probability_drugs == 6) then begin
-                    restock_obj := create_object_sid(53, 0, 0, -1);
+                    restock_obj := create_object(53, 0, 0);
                     add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
                 end
                 add_timer_event(Enemy_Attacker, 1, 20);
             end
             if ((enemy_type == 16) or (enemy_type == 17) or (enemy_type == 18) or (enemy_type == 19) or (enemy_type == 20)) then begin
                 if (not(obj_carrying_pid_obj(Enemy_Attacker, 309))) then begin
-                    restock_obj := create_object_sid(309, 0, 0, -1);
+                    restock_obj := create_object(309, 0, 0);
                     add_mult_objs_to_inven(Enemy_Attacker, restock_obj, 1);
                 end
-                restock_obj := create_object_sid(40, 0, 0, -1);
+                restock_obj := create_object(40, 0, 0);
                 add_mult_objs_to_inven(Enemy_Attacker, restock_obj, random(1, 2));
                 add_timer_event(Enemy_Attacker, 1, 20);
             end
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 16293;
             end
-            if (cur_map_index == 103) then begin
+            if (CUR_MAP_KARAVAN2) then begin
                 enemy_TILE := 16298;
             end
-            if (cur_map_index == 104) then begin
+            if (CUR_MAP_KARAVAN3) then begin
                 enemy_TILE := 18081;
             end
-            if (cur_map_index == 105) then begin
+            if (CUR_MAP_KARAVAN4) then begin
                 enemy_TILE := 23293;
             end
-            if (cur_map_index == 106) then begin
+            if (CUR_MAP_KARAVAN5) then begin
                 enemy_TILE := 19675;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 16507;
             end
-            if (cur_map_index == 103) then begin
+            if (CUR_MAP_KARAVAN2) then begin
                 enemy_TILE := 15502;
             end
-            if (cur_map_index == 104) then begin
+            if (CUR_MAP_KARAVAN3) then begin
                 enemy_TILE := 20482;
             end
-            if (cur_map_index == 105) then begin
+            if (CUR_MAP_KARAVAN4) then begin
                 enemy_TILE := 23488;
             end
-            if (cur_map_index == 106) then begin
+            if (CUR_MAP_KARAVAN5) then begin
                 enemy_TILE := 20877;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 15300;
             end
-            if (cur_map_index == 103) then begin
+            if (CUR_MAP_KARAVAN2) then begin
                 enemy_TILE := 15907;
             end
-            if (cur_map_index == 104) then begin
+            if (CUR_MAP_KARAVAN3) then begin
                 enemy_TILE := 19676;
             end
-            if (cur_map_index == 105) then begin
+            if (CUR_MAP_KARAVAN4) then begin
                 enemy_TILE := 22081;
             end
-            if (cur_map_index == 106) then begin
+            if (CUR_MAP_KARAVAN5) then begin
                 enemy_TILE := 20284;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 14894;
             end
-            if (cur_map_index == 103) then begin
+            if (CUR_MAP_KARAVAN2) then begin
                 enemy_TILE := 17108;
             end
-            if (cur_map_index == 104) then begin
+            if (CUR_MAP_KARAVAN3) then begin
                 enemy_TILE := 17274;
             end
-            if (cur_map_index == 105) then begin
+            if (CUR_MAP_KARAVAN4) then begin
                 enemy_TILE := 24492;
             end
-            if (cur_map_index == 106) then begin
+            if (CUR_MAP_KARAVAN5) then begin
                 enemy_TILE := 21683;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 16890;
             end
-            if (cur_map_index == 103) then begin
+            if (CUR_MAP_KARAVAN2) then begin
                 enemy_TILE := 16895;
             end
-            if (cur_map_index == 104) then begin
+            if (CUR_MAP_KARAVAN3) then begin
                 enemy_TILE := 18272;
             end
-            if (cur_map_index == 105) then begin
+            if (CUR_MAP_KARAVAN4) then begin
                 enemy_TILE := 23283;
             end
-            if (cur_map_index == 106) then begin
+            if (CUR_MAP_KARAVAN5) then begin
                 enemy_TILE := 21286;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 15487;
             end
-            if (cur_map_index == 103) then begin
+            if (CUR_MAP_KARAVAN2) then begin
                 enemy_TILE := 17913;
             end
-            if (cur_map_index == 104) then begin
+            if (CUR_MAP_KARAVAN3) then begin
                 enemy_TILE := 16677;
             end
-            if (cur_map_index == 105) then begin
+            if (CUR_MAP_KARAVAN4) then begin
                 enemy_TILE := 24296;
             end
-            if (cur_map_index == 106) then begin
+            if (CUR_MAP_KARAVAN5) then begin
                 enemy_TILE := 21880;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 17888;
             end
-            if (cur_map_index == 103) then begin
+            if (CUR_MAP_KARAVAN2) then begin
                 enemy_TILE := 15296;
             end
-            if (cur_map_index == 104) then begin
+            if (CUR_MAP_KARAVAN3) then begin
                 enemy_TILE := 16682;
             end
-            if (cur_map_index == 105) then begin
+            if (CUR_MAP_KARAVAN4) then begin
                 enemy_TILE := 24486;
             end
-            if (cur_map_index == 106) then begin
+            if (CUR_MAP_KARAVAN5) then begin
                 enemy_TILE := 20072;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 17710;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 14088;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (enemy_count > global_var(916)) then begin
-            if (cur_map_index == 102) then begin
+        if (enemy_count > global_var(GVAR_KARAVAN_ATACKERS_COUNTER)) then begin
+            if (CUR_MAP_KARAVAN1) then begin
                 enemy_TILE := 14096;
             end
             call generate_enemy_type();
             call generate_enemy_team();
         end
-        if (cur_map_index == 102) then begin
-            if (global_var(1024) == 1) then begin
-                Jeremy := create_object_sid(16777764, 17103, 0, 12);
+        if (CUR_MAP_KARAVAN1) then begin
+            if (global_var(GVAR_CARAVAN_JEREMY_ESCAPED) == 1) then begin
+                Jeremy := create_object_sid(16777764, 17103, 0, SCRIPT_JEREMKAR);
                 anim(Jeremy, 1000, 2);
-                restock_obj := create_object_sid(18, 0, 0, -1);
+                restock_obj := create_object(18, 0, 0);
                 add_mult_objs_to_inven(Jeremy, restock_obj, 1);
-                restock_obj := create_object_sid(31, 0, 0, -1);
+                restock_obj := create_object(31, 0, 0);
                 add_mult_objs_to_inven(Jeremy, restock_obj, 1);
-                restock_obj := create_object_sid(40, 0, 0, -1);
+                restock_obj := create_object(40, 0, 0);
                 add_mult_objs_to_inven(Jeremy, restock_obj, 1);
-                restock_obj := create_object_sid(110, 0, 0, -1);
+                restock_obj := create_object(110, 0, 0);
                 add_mult_objs_to_inven(Jeremy, restock_obj, 1);
-                set_global_var(916, global_var(916) + 1);
-                if (cur_map_index == 102) then begin
+                set_global_var(GVAR_KARAVAN_ATACKERS_COUNTER, global_var(GVAR_KARAVAN_ATACKERS_COUNTER) + 1);
+                if (CUR_MAP_KARAVAN1) then begin
                     add_timer_event(Jeremy, 2, 20);
                 end
             end
         end
-        set_global_var(911, global_var(911) bwor 33554432);
+        set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwor 33554432);
         game_ui_enable;
     end
 end
@@ -1694,40 +1694,40 @@ begin
             end
         end
     end
-    if (((global_var(911) bwand 33554432) == 0) or (((global_var(911) bwand 8192) != 0) and ((global_var(911) bwand 16384) != 0) and ((global_var(911) bwand 32768) != 0) and ((global_var(911) bwand 65536) != 0) and not((global_var(911) bwand 2097152) != 0)) or (((global_var(911) bwand 16384) != 0) and ((global_var(911) bwand 32768) != 0) and ((global_var(911) bwand 65536) != 0) and ((global_var(911) bwand 524288) != 0)) or (global_var(916) > 0) or ((global_var(911) bwand 131072) != 0)) then begin
+    if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 33554432) == 0) or (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0) and not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2097152) != 0)) or (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 524288) != 0)) or (global_var(GVAR_KARAVAN_ATACKERS_COUNTER) > 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 131072) != 0)) then begin
     end
     else begin
         probability_2nd_ambush := 0;
-        if (not((global_var(911) bwand 262144) != 0)) then begin
-            if (((global_var(911) bwand 1024) != 0) or ((global_var(911) bwand 64) != 0)) then begin
-                if ((global_var(911) bwand 8) != 0) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 262144) != 0)) then begin
+            if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 1024) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 64) != 0)) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
                     probability_2nd_ambush := random(1, 20);
                 end
-                if ((global_var(911) bwand 16) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
                     probability_2nd_ambush := random(1, 5);
                 end
-                if ((global_var(911) bwand 4) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
                     probability_2nd_ambush := random(1, 30);
                 end
             end
             else begin
-                if ((global_var(911) bwand 8) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
                     probability_2nd_ambush := random(1, 10);
                 end
-                if ((global_var(911) bwand 16) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
                     probability_2nd_ambush := random(1, 3);
                 end
-                if ((global_var(911) bwand 4) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
                     probability_2nd_ambush := random(1, 20);
                 end
             end
-            set_global_var(911, global_var(911) bwor 262144);
+            set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwor 262144);
         end
         if (probability_2nd_ambush == 1) then begin
             map_number := random(1, 3);
-            if (cur_map_index == 102) then begin
-                if ((global_var(911) bwand 2048) != 0) then begin
-                    if ((global_var(867) bwand 268435456) != 0) then begin
+            if (CUR_MAP_KARAVAN1) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) then begin
+                    if ((global_var(GVAR_AQ_ALBUQ_DEATHS) bwand 268435456) != 0) then begin
                         set_exit_grids(0, 21, 0, 25707, 0);
                     end
                     else begin
@@ -1735,7 +1735,7 @@ begin
                     end
                 end
             end
-            if (cur_map_index == 103) then begin
+            if (CUR_MAP_KARAVAN2) then begin
                 if (map_number == 1) then begin
                     set_exit_grids(0, 104, 0, 20693, 0);
                 end
@@ -1746,7 +1746,7 @@ begin
                     set_exit_grids(0, 106, 0, 19887, 1);
                 end
             end
-            if (cur_map_index == 104) then begin
+            if (CUR_MAP_KARAVAN3) then begin
                 if (map_number == 1) then begin
                     set_exit_grids(0, 103, 0, 18307, 5);
                 end
@@ -1757,7 +1757,7 @@ begin
                     set_exit_grids(0, 106, 0, 19887, 1);
                 end
             end
-            if (cur_map_index == 105) then begin
+            if (CUR_MAP_KARAVAN4) then begin
                 if (map_number == 1) then begin
                     set_exit_grids(0, 103, 0, 18307, 5);
                 end
@@ -1768,7 +1768,7 @@ begin
                     set_exit_grids(0, 106, 0, 19887, 1);
                 end
             end
-            if (cur_map_index == 106) then begin
+            if (CUR_MAP_KARAVAN5) then begin
                 if (map_number == 1) then begin
                     set_exit_grids(0, 103, 0, 18307, 5);
                 end
@@ -1781,34 +1781,34 @@ begin
             end
         end
         else begin
-            if ((global_var(911) bwand 512) != 0) then begin
-                if ((global_var(911) bwand 8) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 512) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
                     set_exit_grids(0, 12, 0, 22104, 3);
                 end
-                if ((global_var(911) bwand 16) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
                     set_exit_grids(0, 11, 0, 14475, 5);
                 end
-                if ((global_var(911) bwand 4) != 0) then begin
+                if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
                     set_exit_grids(0, 9, 0, 18888, 5);
                 end
             end
-            if ((global_var(911) bwand 1024) != 0) then begin
-                if ((global_var(842) bwand 1073741824) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 1024) != 0) then begin
+                if ((global_var(GVAR_C_CORATH_STATUS) bwand 1073741824) != 0) then begin
                     set_exit_grids(0, 15, 0, 21751, 3);
                 end
                 else begin
                     set_exit_grids(0, 15, 0, 18944, 0);
                 end
             end
-            if ((global_var(911) bwand 2048) != 0) then begin
-                if ((global_var(867) bwand 268435456) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) then begin
+                if ((global_var(GVAR_AQ_ALBUQ_DEATHS) bwand 268435456) != 0) then begin
                     set_exit_grids(0, 21, 0, 25707, 0);
                 end
                 else begin
                     set_exit_grids(0, 21, 0, 28911, 5);
                 end
             end
-            if ((global_var(911) bwand 4096) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4096) != 0) then begin
                 set_exit_grids(0, 6, 1, 25523, 0);
             end
         end
@@ -1817,40 +1817,40 @@ end
 
 procedure map_exit_p_proc
 begin
-    set_global_var(911, global_var(911) bwand (-1 - 33554432));
-    if (((global_var(911) bwand 8192) != 0) and ((global_var(911) bwand 16384) != 0) and ((global_var(911) bwand 32768) != 0) and ((global_var(911) bwand 65536) != 0) and not((global_var(911) bwand 2097152) != 0) or (((global_var(911) bwand 16384) != 0) and ((global_var(911) bwand 32768) != 0) and ((global_var(911) bwand 65536) != 0) and ((global_var(911) bwand 524288) != 0)) or (global_var(916) > 0) or ((global_var(911) bwand 131072) != 0)) then begin
-        if ((global_var(911) bwand 1) != 0) then begin
-            if ((global_var(911) bwand 8) != 0) then begin
-                set_global_var(735, 1);
+    set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand (-1 - 33554432));
+    if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0) and not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2097152) != 0) or (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0) and ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 524288) != 0)) or (global_var(GVAR_KARAVAN_ATACKERS_COUNTER) > 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 131072) != 0)) then begin
+        if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 1) != 0) then begin
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8) != 0) then begin
+                set_global_var(GVAR_SEDIT_CARAVANS_LEAVE, 1);
             end
-            if ((global_var(911) bwand 16) != 0) then begin
-                set_global_var(783, 1);
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0) then begin
+                set_global_var(GVAR_CRIMSON_CARAVAN_LEAVE, 1);
             end
-            if ((global_var(911) bwand 4) != 0) then begin
-                set_global_var(742, 1);
+            if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
+                set_global_var(GVAR_FREDERYKS_DREAM_LEAVE, 1);
             end
         end
-        set_global_var(911, 0);
-        set_global_var(915, 0);
-        set_global_var(916, 0);
-        if ((global_var(748) == 2) and (global_var(747) == 1) and (global_var(751) == 0)) then begin
-            set_global_var(751, 1);
+        set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, 0);
+        set_global_var(GVAR_KARAVAN_GUARDS_COUNTER, 0);
+        set_global_var(GVAR_KARAVAN_ATACKERS_COUNTER, 0);
+        if ((global_var(GVAR_QUEST_S_FREDERYK_CARAVANA) == 2) and (global_var(GVAR_DEAL_WITH_RAIDERS) == 1) and (global_var(GVAR_FROST_DESTROY) == 0)) then begin
+            set_global_var(GVAR_FROST_DESTROY, 1);
         end
-        if ((global_var(748) == 2) and (global_var(751) == 1)) then begin
-            set_global_var(1058, 1);
+        if ((global_var(GVAR_QUEST_S_FREDERYK_CARAVANA) == 2) and (global_var(GVAR_FROST_DESTROY) == 1)) then begin
+            set_global_var(GVAR_FRED_SPEC_KARAVAN_LOST, 1);
         end
     end
     else begin
-        gfade_out(1);
-        set_global_var(911, global_var(911) bwor 1048576);
+        fade_out;
+        set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwor 1048576);
     end
 end
 
 procedure timed_event_p_proc
 begin
     if (fixed_param == 1) then begin
-        set_global_var(911, global_var(911) bwor 8388608);
-        if (not((global_var(911) bwand 8192) != 0)) then begin
+        set_global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS, global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwor 8388608);
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
             attack_setup(Enemy_Attacker, Karavan_Leader);
         end
         else begin
@@ -1866,13 +1866,13 @@ begin
         end
     end
     if (fixed_param == 2) then begin
-        metarule3(108, 18284, 0, 0);
+        tile_set_center(18284);
     end
     if (fixed_param == 3) then begin
-        gfade_in(1);
+        fade_in;
     end
     if (fixed_param == 4) then begin
-        if (not((global_var(911) bwand 8192) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
             if (obj_is_carrying_obj_pid(Karavan_Leader, 18) >= 1) then begin
                 wield_obj_critter(Karavan_Leader, obj_carrying_pid_obj(Karavan_Leader, 18));
             end
@@ -1889,7 +1889,7 @@ begin
                 wield_obj_critter(Karavan_Leader, obj_carrying_pid_obj(Karavan_Leader, 16));
             end
         end
-        if (not((global_var(911) bwand 16384) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
             if (obj_is_carrying_obj_pid(Karavan_Guard1, 18) >= 1) then begin
                 wield_obj_critter(Karavan_Guard1, obj_carrying_pid_obj(Karavan_Guard1, 18));
             end
@@ -1903,7 +1903,7 @@ begin
                 wield_obj_critter(Karavan_Guard1, obj_carrying_pid_obj(Karavan_Guard1, 8));
             end
         end
-        if (not((global_var(911) bwand 32768) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
             if (obj_is_carrying_obj_pid(Karavan_Guard2, 18) >= 1) then begin
                 wield_obj_critter(Karavan_Guard2, obj_carrying_pid_obj(Karavan_Guard2, 18));
             end
@@ -1917,7 +1917,7 @@ begin
                 wield_obj_critter(Karavan_Guard2, obj_carrying_pid_obj(Karavan_Guard2, 8));
             end
         end
-        if (not((global_var(911) bwand 65536) != 0)) then begin
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
             if (obj_is_carrying_obj_pid(Karavan_Guard3, 18) >= 1) then begin
                 wield_obj_critter(Karavan_Guard3, obj_carrying_pid_obj(Karavan_Guard3, 18));
             end
@@ -1931,7 +1931,7 @@ begin
                 wield_obj_critter(Karavan_Guard3, obj_carrying_pid_obj(Karavan_Guard3, 8));
             end
         end
-        if (((global_var(911) bwand 2097152) != 0) or (cur_map_index == 102) and not((global_var(911) bwand 524288) != 0)) then begin
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2097152) != 0) or (CUR_MAP_KARAVAN1) and not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 524288) != 0)) then begin
             if (obj_is_carrying_obj_pid(Karavan_Guard4, 18) >= 1) then begin
                 wield_obj_critter(Karavan_Guard4, obj_carrying_pid_obj(Karavan_Guard4, 18));
             end
@@ -1952,135 +1952,135 @@ end
 procedure equip_caravan_team
 begin
     call choose_random_weapon_for_caravan();
-    if (cur_map_index == 102) then begin
-        restock_obj := create_object_sid(16, 0, 0, -1);
+    if (CUR_MAP_KARAVAN1) then begin
+        restock_obj := create_object(16, 0, 0);
         add_mult_objs_to_inven(Karavan_Leader, restock_obj, 1);
-        restock_obj := create_object_sid(38, 0, 0, -1);
+        restock_obj := create_object(38, 0, 0);
         add_mult_objs_to_inven(Karavan_Leader, restock_obj, 1);
     end
     else begin
-        if (not((global_var(911) bwand 8192) != 0)) then begin
-            restock_obj := create_object_sid(item, 0, 0, -1);
+        if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+            restock_obj := create_object(item, 0, 0);
             add_mult_objs_to_inven(Karavan_Leader, restock_obj, 1);
         end
     end
     call choose_random_weapon_for_caravan();
-    if (not((global_var(911) bwand 16384) != 0)) then begin
-        restock_obj := create_object_sid(item, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+        restock_obj := create_object(item, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard1, restock_obj, 1);
     end
     call choose_random_weapon_for_caravan();
-    if (not((global_var(911) bwand 32768) != 0)) then begin
-        restock_obj := create_object_sid(item, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+        restock_obj := create_object(item, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard2, restock_obj, 1);
     end
     call choose_random_weapon_for_caravan();
-    if (not((global_var(911) bwand 65536) != 0)) then begin
-        restock_obj := create_object_sid(item, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+        restock_obj := create_object(item, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard3, restock_obj, 1);
     end
-    if (not((global_var(911) bwand 8192) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
         add_mult_objs_to_inven(Karavan_Leader, restock_obj, 1);
     end
-    if (not((global_var(911) bwand 16384) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard1, restock_obj, 1);
     end
-    if (not((global_var(911) bwand 32768) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard2, restock_obj, 1);
     end
-    if (not((global_var(911) bwand 65536) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard3, restock_obj, 1);
     end
-    if (not((global_var(911) bwand 8192) != 0) and not(cur_map_index == 102)) then begin
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0) and not(CUR_MAP_KARAVAN1)) then begin
         if (obj_is_carrying_obj_pid(Karavan_Leader, 94)) then begin
-            restock_obj := create_object_sid(95, 0, 0, -1);
+            restock_obj := create_object(95, 0, 0);
             add_mult_objs_to_inven(Karavan_Leader, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Leader, 18)) then begin
-            restock_obj := create_object_sid(31, 0, 0, -1);
+            restock_obj := create_object(31, 0, 0);
             add_mult_objs_to_inven(Karavan_Leader, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Leader, 9)) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(Karavan_Leader, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Leader, 8)) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(Karavan_Leader, restock_obj, 1);
         end
     end
-    if (not((global_var(911) bwand 16384) != 0)) then begin
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
         if (obj_is_carrying_obj_pid(Karavan_Guard1, 94)) then begin
-            restock_obj := create_object_sid(95, 0, 0, -1);
+            restock_obj := create_object(95, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard1, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard1, 18)) then begin
-            restock_obj := create_object_sid(31, 0, 0, -1);
+            restock_obj := create_object(31, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard1, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard1, 9)) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard1, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard1, 8)) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard1, restock_obj, 1);
         end
     end
-    if (not((global_var(911) bwand 32768) != 0)) then begin
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
         if (obj_is_carrying_obj_pid(Karavan_Guard2, 94)) then begin
-            restock_obj := create_object_sid(95, 0, 0, -1);
+            restock_obj := create_object(95, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard2, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard2, 18)) then begin
-            restock_obj := create_object_sid(31, 0, 0, -1);
+            restock_obj := create_object(31, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard2, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard2, 9)) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard2, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard2, 8)) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard2, restock_obj, 1);
         end
     end
-    if (not((global_var(911) bwand 65536) != 0)) then begin
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
         if (obj_is_carrying_obj_pid(Karavan_Guard3, 94)) then begin
-            restock_obj := create_object_sid(95, 0, 0, -1);
+            restock_obj := create_object(95, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard3, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard3, 18)) then begin
-            restock_obj := create_object_sid(31, 0, 0, -1);
+            restock_obj := create_object(31, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard3, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard3, 9)) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard3, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Karavan_Guard3, 8)) then begin
-            restock_obj := create_object_sid(29, 0, 0, -1);
+            restock_obj := create_object(29, 0, 0);
             add_mult_objs_to_inven(Karavan_Guard3, restock_obj, 1);
         end
     end
-    if (not((global_var(911) bwand 8192) != 0)) then begin
-        restock_obj := create_object_sid(41, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 8192) != 0)) then begin
+        restock_obj := create_object(41, 0, 0);
         add_mult_objs_to_inven(Karavan_Leader, restock_obj, random(20, 100));
     end
-    if (not((global_var(911) bwand 16384) != 0)) then begin
-        restock_obj := create_object_sid(41, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16384) != 0)) then begin
+        restock_obj := create_object(41, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard1, restock_obj, random(10, 50));
     end
-    if (not((global_var(911) bwand 32768) != 0)) then begin
-        restock_obj := create_object_sid(41, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 32768) != 0)) then begin
+        restock_obj := create_object(41, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard2, restock_obj, random(10, 50));
     end
-    if (not((global_var(911) bwand 65536) != 0)) then begin
-        restock_obj := create_object_sid(41, 0, 0, -1);
+    if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 65536) != 0)) then begin
+        restock_obj := create_object(41, 0, 0);
         add_mult_objs_to_inven(Karavan_Guard3, restock_obj, random(10, 50));
     end
     add_timer_event(self_obj, 2, 4);
@@ -2088,7 +2088,7 @@ end
 
 procedure choose_random_weapon_for_caravan
 begin
-    if ((global_var(911) bwand 4) != 0) then begin
+    if ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) then begin
         probability := random(1, 4);
     end
     else begin
@@ -2111,18 +2111,18 @@ end
 procedure generate_enemy_type
 begin
     if (enemy_type == 1) then begin
-        if (((global_var(911) bwand 2048) != 0) or ((global_var(911) bwand 128) != 0) and (big_dethclaw_counter < 1)) then begin
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 128) != 0) and (big_dethclaw_counter < 1)) then begin
             probability := random(1, 4);
         end
         else begin
-            if (not((global_var(911) bwand 2048) != 0) and not((global_var(911) bwand 128) != 0) and (big_dethclaw_counter < 3)) then begin
+            if (not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) and not((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 128) != 0) and (big_dethclaw_counter < 3)) then begin
                 probability := random(1, 4);
             end
             else begin
                 probability := random(1, 3);
             end
         end
-        if (((global_var(911) bwand 2048) != 0) or ((global_var(911) bwand 128) != 0)) then begin
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 2048) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 128) != 0)) then begin
             if ((probability == 1) or (probability == 2) or (probability == 3)) then begin
                 enemy_PID := 16777460;
             end
@@ -2257,66 +2257,66 @@ end
 procedure generate_enemy_team
 begin
     Enemy := create_object_sid(enemy_PID, enemy_TILE, 0, enemy_SCRIPT);
-    critter_add_trait(Enemy, 1, 6, enemy_TEAM);
-    critter_add_trait(Enemy, 1, 5, enemy_AI);
+    critter_add_trait(Enemy, TRAIT_OBJECT, OBJECT_TEAM_NUM, enemy_TEAM);
+    critter_add_trait(Enemy, TRAIT_OBJECT, OBJECT_AI_PACKET, enemy_AI);
     anim(Enemy, 1000, enemy_ROTATION);
-    set_global_var(916, global_var(916) + 1);
+    set_global_var(GVAR_KARAVAN_ATACKERS_COUNTER, global_var(GVAR_KARAVAN_ATACKERS_COUNTER) + 1);
     if ((enemy_type == 7) or (enemy_type == 8) or (enemy_type == 9) or (enemy_type == 10) or (enemy_type == 11) or (enemy_type == 12) or (enemy_type == 13) or (enemy_type == 14) or (enemy_type == 15) or ((enemy_type == 16) or (enemy_type == 17) or (enemy_type == 18) or (enemy_type == 19) or (enemy_type == 20))) then begin
         call choose_random_weapon_for_enemy();
-        restock_obj := create_object_sid(item, 0, 0, -1);
+        restock_obj := create_object(item, 0, 0);
         add_mult_objs_to_inven(Enemy, restock_obj, 1);
         if (obj_is_carrying_obj_pid(Enemy, 94)) then begin
-            restock_obj := create_object_sid(95, 0, 0, -1);
+            restock_obj := create_object(95, 0, 0);
             add_mult_objs_to_inven(Enemy, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Enemy, 13)) then begin
-            restock_obj := create_object_sid(14, 0, 0, -1);
+            restock_obj := create_object(14, 0, 0);
             add_mult_objs_to_inven(Enemy, restock_obj, 2);
         end
         if (obj_is_carrying_obj_pid(Enemy, 143)) then begin
-            restock_obj := create_object_sid(34, 0, 0, -1);
+            restock_obj := create_object(34, 0, 0);
             add_mult_objs_to_inven(Enemy, restock_obj, 1);
         end
         if (obj_is_carrying_obj_pid(Enemy, 12)) then begin
-            restock_obj := create_object_sid(35, 0, 0, -1);
+            restock_obj := create_object(35, 0, 0);
             add_mult_objs_to_inven(Enemy, restock_obj, 1);
         end
         if ((enemy_type == 7) or (enemy_type == 8) or (enemy_type == 9) or (enemy_type == 10) or (enemy_type == 11) or (enemy_type == 12) or (enemy_type == 13) or (enemy_type == 14) or (enemy_type == 15)) then begin
             probability_drugs := random(1, 10);
-            restock_obj := create_object_sid(41, 0, 0, -1);
+            restock_obj := create_object(41, 0, 0);
             add_mult_objs_to_inven(Enemy, restock_obj, random(5, 20));
             if (probability_drugs == 1) then begin
-                restock_obj := create_object_sid(87, 0, 0, -1);
+                restock_obj := create_object(87, 0, 0);
                 add_mult_objs_to_inven(Enemy, restock_obj, 1);
             end
             if (probability_drugs == 2) then begin
-                restock_obj := create_object_sid(53, 0, 0, -1);
+                restock_obj := create_object(53, 0, 0);
                 add_mult_objs_to_inven(Enemy, restock_obj, 1);
             end
             if (probability_drugs == 3) then begin
-                restock_obj := create_object_sid(110, 0, 0, -1);
+                restock_obj := create_object(110, 0, 0);
                 add_mult_objs_to_inven(Enemy, restock_obj, 1);
             end
             if (probability_drugs == 4) then begin
-                restock_obj := create_object_sid(40, 0, 0, -1);
+                restock_obj := create_object(40, 0, 0);
                 add_mult_objs_to_inven(Enemy, restock_obj, 1);
             end
             if (probability_drugs == 5) then begin
-                restock_obj := create_object_sid(87, 0, 0, -1);
+                restock_obj := create_object(87, 0, 0);
                 add_mult_objs_to_inven(Enemy, restock_obj, 1);
             end
             if (probability_drugs == 6) then begin
-                restock_obj := create_object_sid(53, 0, 0, -1);
+                restock_obj := create_object(53, 0, 0);
                 add_mult_objs_to_inven(Enemy, restock_obj, 1);
             end
             add_timer_event(Enemy, 1, 20);
         end
         if ((enemy_type == 16) or (enemy_type == 17) or (enemy_type == 18) or (enemy_type == 19) or (enemy_type == 20)) then begin
             if (not(obj_carrying_pid_obj(Enemy, 309))) then begin
-                restock_obj := create_object_sid(309, 0, 0, -1);
+                restock_obj := create_object(309, 0, 0);
                 add_mult_objs_to_inven(Enemy, restock_obj, 1);
             end
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(Enemy, restock_obj, random(1, 2));
             add_timer_event(Enemy, 1, 20);
         end
@@ -2423,113 +2423,112 @@ end
 procedure generate_fourth_guard
 begin
     if (replacing_guard_ID == 1) then begin
-        if (((global_var(911) bwand 4) != 0) or ((global_var(911) bwand 16) != 0)) then begin
-            if (cur_map_index == 103) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 19497, 0, 23);
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0)) then begin
+            if (CUR_MAP_KARAVAN2) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 19497, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 104) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 18496, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 18496, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 105) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 22306, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 22306, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 106) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 17485, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 17485, 0, SCRIPT_KARBLOCK);
             end
         end
         else begin
-            if (cur_map_index == 103) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 19497, 0, 23);
+            if (CUR_MAP_KARAVAN2) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 19497, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 104) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 18496, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 18496, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 105) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 22306, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 22306, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 106) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 17485, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 17485, 0, SCRIPT_KARBLOCK);
             end
         end
     end
     if (replacing_guard_ID == 2) then begin
-        if (((global_var(911) bwand 4) != 0) or ((global_var(911) bwand 16) != 0)) then begin
-            if (cur_map_index == 103) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 22098, 0, 23);
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0)) then begin
+            if (CUR_MAP_KARAVAN2) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 22098, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 104) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 21105, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 21105, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 105) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 20108, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 20108, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 106) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 17893, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 17893, 0, SCRIPT_KARBLOCK);
             end
         end
         else begin
-            if (cur_map_index == 103) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 22098, 0, 23);
+            if (CUR_MAP_KARAVAN2) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 22098, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 104) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 21105, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 21105, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 105) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 20108, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 20108, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 106) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 17893, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 17893, 0, SCRIPT_KARBLOCK);
             end
         end
     end
     if (replacing_guard_ID == 3) then begin
-        if (((global_var(911) bwand 4) != 0) or ((global_var(911) bwand 16) != 0)) then begin
-            if (cur_map_index == 103) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 20708, 0, 23);
+        if (((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 4) != 0) or ((global_var(GVAR_KARAVAN_ROUTES_COMMAND_BITS) bwand 16) != 0)) then begin
+            if (CUR_MAP_KARAVAN2) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 20708, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 104) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 19113, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 19113, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 105) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 22716, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 22716, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 106) then begin
-                Karavan_Guard4 := create_object_sid(16777797, 19705, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                Karavan_Guard4 := create_object_sid(16777797, 19705, 0, SCRIPT_KARBLOCK);
             end
         end
         else begin
-            if (cur_map_index == 103) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 20708, 0, 23);
+            if (CUR_MAP_KARAVAN2) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 20708, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 104) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 19113, 0, 23);
+            if (CUR_MAP_KARAVAN3) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 19113, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 105) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 22716, 0, 23);
+            if (CUR_MAP_KARAVAN4) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 22716, 0, SCRIPT_KARBLOCK);
             end
-            if (cur_map_index == 106) then begin
-                Karavan_Guard4 := create_object_sid(16777799, 19705, 0, 23);
+            if (CUR_MAP_KARAVAN5) then begin
+                Karavan_Guard4 := create_object_sid(16777799, 19705, 0, SCRIPT_KARBLOCK);
             end
         end
     end
-    if (cur_map_index == 103) then begin
+    if (CUR_MAP_KARAVAN2) then begin
         anim(Karavan_Guard4, 1000, 5);
     end
-    if (cur_map_index == 104) then begin
+    if (CUR_MAP_KARAVAN3) then begin
         anim(Karavan_Guard4, 1000, 0);
     end
-    if (cur_map_index == 105) then begin
+    if (CUR_MAP_KARAVAN4) then begin
         anim(Karavan_Guard4, 1000, 1);
     end
-    if (cur_map_index == 106) then begin
+    if (CUR_MAP_KARAVAN5) then begin
         anim(Karavan_Guard4, 1000, 1);
     end
     call choose_random_weapon_for_caravan();
-    restock_obj := create_object_sid(item, 0, 0, -1);
+    restock_obj := create_object(item, 0, 0);
     add_mult_objs_to_inven(Karavan_Guard4, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(Karavan_Guard4, restock_obj, 1);
-    restock_obj := create_object_sid(41, 0, 0, -1);
+    restock_obj := create_object(41, 0, 0);
     add_mult_objs_to_inven(Karavan_Guard4, restock_obj, random(10, 50));
 end
-
