diff --git a/Mods/Resurrection/Original/ALB_CISA.ssl b/Mods/Resurrection/ReDefine/ALB_CISA.ssl
index 1c9a1e3..c520390 100644
--- a/Mods/Resurrection/Original/ALB_CISA.ssl
+++ b/Mods/Resurrection/ReDefine/ALB_CISA.ssl
@@ -105,12 +105,12 @@ begin
             return 1;
         end
     end
-    if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+    if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
         if (tile_distance_objs(self_obj, party_member_obj(16777779)) <= 5) then begin
             return 1;
         end
     end
-    if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+    if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
         if (tile_distance_objs(self_obj, party_member_obj(16777811)) <= 5) then begin
             return 1;
         end
@@ -125,7 +125,7 @@ begin
             return 1;
         end
     end
-    if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+    if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
         if (tile_distance_objs(self_obj, party_member_obj(16777814)) <= 5) then begin
             return 1;
         end
@@ -259,41 +259,41 @@ begin
             end
         end
     end
-    if (not((global_var(865) bwand 1) != 0)) then begin
-        set_global_var(865, global_var(865) bwor 1);
+    if (not((global_var(GVAR_AQ_ALBUQ_EVENTS) bwand 1) != 0)) then begin
+        set_global_var(GVAR_AQ_ALBUQ_EVENTS, global_var(GVAR_AQ_ALBUQ_EVENTS) bwor 1);
     end
-    if (not(metarule(22, 0))) then begin
-        if ((global_var(1029) == 3) or (global_var(1029) == 4) and (global_var(998) == 0) and not((map_var(0) bwand 268435456) != 0)) then begin
+    if (not(is_loading_game)) then begin
+        if ((global_var(GVAR_AQE_KICK_BENICIO_FROM_ALBUQUERQUE) == 3) or (global_var(GVAR_AQE_KICK_BENICIO_FROM_ALBUQUERQUE) == 4) and (global_var(GVAR_AQE_ENEMY_EMPEROR) == 0) and not((map_var(0) bwand 268435456) != 0)) then begin
             set_map_var(0, map_var(0) bwor 268435456);
             add_timer_event(Myzrael_door, game_ticks(0), 3);
-            set_global_var(967, 2);
-            if (not((global_var(904) bwand 32) != 0)) then begin
-                set_global_var(904, global_var(904) bwor 32);
+            set_global_var(GVAR_AQ_EMPEROR_STATUS, 2);
+            if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 32) != 0)) then begin
+                set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 32);
             end
-            if (not((global_var(904) bwand 2) != 0)) then begin
-                set_global_var(904, global_var(904) bwor 2);
+            if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 2) != 0)) then begin
+                set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 2);
             end
-            is1 := create_object_sid(16778031, 15279, 0, 130);
-            is2 := create_object_sid(16778032, 15285, 0, 130);
-            restock_obj := create_object_sid(406, 0, 0, -1);
+            is1 := create_object_sid(16778031, 15279, 0, SCRIPT_ACISVOJ6);
+            is2 := create_object_sid(16778032, 15285, 0, SCRIPT_ACISVOJ6);
+            restock_obj := create_object(406, 0, 0);
             add_mult_objs_to_inven(is1, restock_obj, 1);
-            restock_obj := create_object_sid(406, 0, 0, -1);
+            restock_obj := create_object(406, 0, 0);
             add_mult_objs_to_inven(is2, restock_obj, 1);
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(is1, restock_obj, 2);
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(is2, restock_obj, 2);
             anim(is1, 1000, 2);
             anim(is2, 1000, 2);
-            is3 := create_object_sid(16778031, 15671, 0, 130);
-            is4 := create_object_sid(16778031, 19491, 0, 130);
-            restock_obj := create_object_sid(599, 0, 0, -1);
+            is3 := create_object_sid(16778031, 15671, 0, SCRIPT_ACISVOJ6);
+            is4 := create_object_sid(16778031, 19491, 0, SCRIPT_ACISVOJ6);
+            restock_obj := create_object(599, 0, 0);
             add_mult_objs_to_inven(is3, restock_obj, 1);
-            restock_obj := create_object_sid(599, 0, 0, -1);
+            restock_obj := create_object(599, 0, 0);
             add_mult_objs_to_inven(is4, restock_obj, 1);
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(is3, restock_obj, 2);
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(is4, restock_obj, 2);
             anim(is3, 1000, 3);
             anim(is4, 1000, 0);
@@ -301,111 +301,111 @@ begin
             anim(self_obj, 1000, 2);
             add_timer_event(self_obj, 5, 101);
         end
-        if ((global_var(1017) bwand 16) != 0) then begin
-            if ((global_var(998) != 1) and (global_var(1008) != 3) and ((global_var(904) bwand 8388608) != 0) and ((game_time - global_var(1001)) >= (60 * (60 * 10) * 8))) then begin
+        if ((global_var(GVAR_AQE_DIRECTIONS_SETUP) bwand 16) != 0) then begin
+            if ((global_var(GVAR_AQE_ENEMY_EMPEROR) != 1) and (global_var(GVAR_AQE_HELP_TO_ARAN) != 3) and ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 8388608) != 0) and ((game_time - global_var(GVAR_AQE_BRAD_WAITING_TIME)) >= (60 * (60 * 10) * 8))) then begin
                 if (not((map_var(0) bwand 16777216) != 0)) then begin
                     set_map_var(0, map_var(0) bwor 16777216);
                 end
             end
-            set_global_var(1017, global_var(1017) bwand (-1 - 16));
+            set_global_var(GVAR_AQE_DIRECTIONS_SETUP, global_var(GVAR_AQE_DIRECTIONS_SETUP) bwand (-1 - 16));
         end
-        if ((global_var(1000) bwand 268435456) != 0) then begin
+        if ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 268435456) != 0) then begin
             move_to(dude_obj, 21464, 0);
             anim(dude_obj, 1000, 2);
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777294) != 0) then begin
                 if (party_member_obj(16777294) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777294), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 1), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777294))) then begin
+                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 1), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 reg_anim_func(2, party_member_obj(16777729));
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777779));
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777811));
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777814));
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -429,13 +429,13 @@ begin
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 2);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 2);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 2);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 2);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -458,42 +458,42 @@ begin
             end
             add_timer_event(Vault_elevator_door, game_ticks(0), 3);
         end
-        if ((global_var(998) != 1) and not((global_var(1000) bwand 32) != 0)) then begin
-            if ((global_var(574) == 1) and (global_var(992) == 0) and (global_var(1008) == 0) and not((global_var(1000) bwand 8) != 0)) then begin
-                set_global_var(1000, global_var(1000) bwor 32);
-                create_object_sid(16777804, 0, 0, 107);
+        if ((global_var(GVAR_AQE_ENEMY_EMPEROR) != 1) and not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 32) != 0)) then begin
+            if ((global_var(GVAR_HOLODISK_ENCLAVE_STATE) == 1) and (global_var(GVAR_AQE_QUEST_ELISA_3) == 0) and (global_var(GVAR_AQE_HELP_TO_ARAN) == 0) and not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 8) != 0)) then begin
+                set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwor 32);
+                create_object_sid(16777804, 0, 0, SCRIPT_APIPMSG);
             end
-            if ((global_var(898) < 4) and ((global_var(882) != 4) and (global_var(881) != 2) and (global_var(883) != 2)) and (global_var(859) == 0) and ((global_var(1000) bwand 16) == 0) and not((global_var(867) bwand 33554432) != 0) and ((global_var(1017) bwand 131072) == 0)) then begin
-                if ((global_var(574) == 1) and ((global_var(1006) == 0) and ((global_var(904) bwand 2) != 0) and not((global_var(904) bwand 8192) != 0) or ((global_var(1007) == 0) and ((global_var(904) bwand 1) != 0)))) then begin
-                    set_global_var(1000, global_var(1000) bwor 32);
-                    create_object_sid(16777804, 0, 0, 107);
+            if ((global_var(GVAR_AQ_MUTANT_HUNTERS_CANDIDATE) < 4) and ((global_var(GVAR_AQ_QUEST_MTHUNT_HERMAN_QUEST) != 4) and (global_var(GVAR_AQ_QUEST_MTHUNT_TULSA_QUEST) != 2) and (global_var(GVAR_AQ_QUEST_MTHUNT_DUTCH_QUEST) != 2)) and (global_var(GVAR_AQ_MUTANT_HUNTER) == 0) and ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 16) == 0) and not((global_var(GVAR_AQ_ALBUQ_DEATHS) bwand 33554432) != 0) and ((global_var(GVAR_AQE_DIRECTIONS_SETUP) bwand 131072) == 0)) then begin
+                if ((global_var(GVAR_HOLODISK_ENCLAVE_STATE) == 1) and ((global_var(GVAR_AQE_MESAGE_FROM_ELISA) == 0) and ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 2) != 0) and not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 8192) != 0) or ((global_var(GVAR_AQE_MESAGE_FROM_ARAN) == 0) and ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 1) != 0)))) then begin
+                    set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwor 32);
+                    create_object_sid(16777804, 0, 0, SCRIPT_APIPMSG);
                 end
             end
-            if ((global_var(574) == 1) and ((global_var(1017) bwand 131072) == 0) and ((global_var(1017) bwand 65536) != 0) and (global_var(864) == 0) and ((global_var(1000) bwand 16) == 0) and ((global_var(882) == 4) or (global_var(881) == 2) or (global_var(883) == 2))) then begin
-                set_global_var(1000, global_var(1000) bwor 32);
-                create_object_sid(16777804, 0, 0, 107);
+            if ((global_var(GVAR_HOLODISK_ENCLAVE_STATE) == 1) and ((global_var(GVAR_AQE_DIRECTIONS_SETUP) bwand 131072) == 0) and ((global_var(GVAR_AQE_DIRECTIONS_SETUP) bwand 65536) != 0) and (global_var(GVAR_AQ_ENEMY_HUNTERS) == 0) and ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 16) == 0) and ((global_var(GVAR_AQ_QUEST_MTHUNT_HERMAN_QUEST) == 4) or (global_var(GVAR_AQ_QUEST_MTHUNT_TULSA_QUEST) == 2) or (global_var(GVAR_AQ_QUEST_MTHUNT_DUTCH_QUEST) == 2))) then begin
+                set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwor 32);
+                create_object_sid(16777804, 0, 0, SCRIPT_APIPMSG);
             end
         end
-        if ((global_var(1008) == 3) and not(metarule(22, 0))) then begin
+        if ((global_var(GVAR_AQE_HELP_TO_ARAN) == 3) and not(is_loading_game)) then begin
             call Generate_Gate_Guards();
             call Generate_Arans_Soldiers();
             set_map_var(0, map_var(0) bwand (-1 - 16384));
-            set_global_var(1011, 0);
+            set_global_var(GVAR_AQE_EMPEROR_SOLDIERS_COUNT, 0);
             game_ui_disable;
             add_timer_event(self_obj, game_ticks(0), 5);
         end
-        if ((global_var(998) != 1) and (global_var(1008) != 3) and ((global_var(904) bwand 8388608) != 0) and ((game_time - global_var(1001)) >= (60 * (60 * 10) * 8))) then begin
+        if ((global_var(GVAR_AQE_ENEMY_EMPEROR) != 1) and (global_var(GVAR_AQE_HELP_TO_ARAN) != 3) and ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 8388608) != 0) and ((game_time - global_var(GVAR_AQE_BRAD_WAITING_TIME)) >= (60 * (60 * 10) * 8))) then begin
             if ((map_var(0) bwand 16777216) != 0) then begin
                 game_ui_disable;
-                brad_partym := create_object_sid(16778026, 29505, 0, 118);
-                restock_obj := create_object_sid(16, 0, 0, -1);
+                brad_partym := create_object_sid(16778026, 29505, 0, SCRIPT_ABRADSPT);
+                restock_obj := create_object(16, 0, 0);
                 add_mult_objs_to_inven(brad_partym, restock_obj, 1);
                 wield_obj_critter(brad_partym, obj_carrying_pid_obj(brad_partym, 16));
-                gateguard1 := create_object_sid(16778031, 29103, 0, 130);
-                gateguard2 := create_object_sid(16778045, 29107, 0, 130);
-                restock_obj := create_object_sid(24, 0, 0, -1);
+                gateguard1 := create_object_sid(16778031, 29103, 0, SCRIPT_ACISVOJ6);
+                gateguard2 := create_object_sid(16778045, 29107, 0, SCRIPT_ACISVOJ6);
+                restock_obj := create_object(24, 0, 0);
                 add_mult_objs_to_inven(gateguard1, restock_obj, 1);
-                restock_obj := create_object_sid(24, 0, 0, -1);
+                restock_obj := create_object(24, 0, 0);
                 add_mult_objs_to_inven(gateguard2, restock_obj, 1);
                 wield_obj_critter(gateguard1, obj_carrying_pid_obj(gateguard1, 24));
                 wield_obj_critter(gateguard2, obj_carrying_pid_obj(gateguard2, 24));
@@ -503,14 +503,14 @@ begin
                 add_timer_event(brad_partym, game_ticks(2), 20);
             end
         end
-        if ((global_var(998) != 1) and (global_var(1008) != 3) and (global_var(997) == 2) and not((global_var(904) bwand 2097152) != 0)) then begin
-            set_global_var(904, global_var(904) bwor 2097152);
-            brad_partym := create_object_sid(16778026, tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj), 118);
-            anim(brad_partym, 1000, has_trait(1, dude_obj, 10));
-            restock_obj := create_object_sid(16, 0, 0, -1);
+        if ((global_var(GVAR_AQE_ENEMY_EMPEROR) != 1) and (global_var(GVAR_AQE_HELP_TO_ARAN) != 3) and (global_var(GVAR_AQE_QUEST_B_SNEED) == 2) and not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 2097152) != 0)) then begin
+            set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 2097152);
+            brad_partym := create_object_sid(16778026, tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation, SCRIPT_ABRADSPT);
+            anim(brad_partym, 1000, obj_get_rot(dude_obj));
+            restock_obj := create_object(16, 0, 0);
             add_mult_objs_to_inven(brad_partym, restock_obj, 1);
             wield_obj_critter(brad_partym, obj_carrying_pid_obj(brad_partym, 16));
-            critter_add_trait(brad_partym, 1, 6, 0);
+            critter_add_trait(brad_partym, TRAIT_OBJECT, OBJECT_TEAM_NUM, 0);
             add_timer_event(brad_partym, game_ticks(random(10, 20)), 1);
             add_timer_event(brad_partym, game_ticks(1), 70);
         end
@@ -605,46 +605,46 @@ end
 
 procedure map_exit_p_proc
 begin
-    if ((global_var(1008) >= 2) and (global_var(1008) != 10) and (tile_in_tile_rect(32310, 32300, 33710, 33700, tile_num(dude_obj)) or tile_in_tile_rect(20370, 20361, 24970, 24961, tile_num(dude_obj)))) then begin
-        if (get_critter_stat(dude_obj, 34) == 0) then begin
-            display_msg(message_str(1633, 4500));
+    if ((global_var(GVAR_AQE_HELP_TO_ARAN) >= 2) and (global_var(GVAR_AQE_HELP_TO_ARAN) != 10) and (tile_in_tile_rect(32310, 32300, 33710, 33700, dude_tile) or tile_in_tile_rect(20370, 20361, 24970, 24961, dude_tile))) then begin
+        if (dude_gender == 0) then begin
+            display_mstr(4500);
         end
         else begin
-            display_msg(message_str(1633, 4501));
+            display_mstr(4501);
         end
-        set_global_var(998, 1);
-        set_global_var(904, global_var(904) bwor 64);
-        if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
-            set_global_var(1020, global_var(1020) bwor 64);
+        set_global_var(GVAR_AQE_ENEMY_EMPEROR, 1);
+        set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 64);
+        if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
+            set_global_var(GVAR_PTR_LYSTRA_REACTIONS_2, global_var(GVAR_PTR_LYSTRA_REACTIONS_2) bwor 64);
         end
-        set_global_var(1008, 1);
+        set_global_var(GVAR_AQE_HELP_TO_ARAN, 1);
     end
 end
 
 procedure timed_event_p_proc
 begin
-    if ((fixed_param == 1) and (global_var(990) == 2) and (global_var(998) == 0)) then begin
+    if ((fixed_param == 1) and (global_var(GVAR_AQE_QUEST_ELISA_1) == 2) and (global_var(GVAR_AQE_ENEMY_EMPEROR) == 0)) then begin
         if (fixed_param == 1) then begin
             sequence := sequence + 1;
         end
         if (sequence == 1) then begin
-            float_msg(Aran_obj, message_str(1633, 2000), 2);
+            float_msg(Aran_obj, mstr(2000), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(6), 1);
         end
         if (sequence == 2) then begin
-            if (get_critter_stat(dude_obj, 34) == 0) then begin
-                float_msg(Elisa_obj, message_str(1633, 2050), 8);
+            if (dude_gender == 0) then begin
+                float_msg(Elisa_obj, mstr(2050), FLOAT_MSG_YELLOW);
             end
             else begin
-                float_msg(Elisa_obj, message_str(1633, 2051), 8);
+                float_msg(Elisa_obj, mstr(2051), FLOAT_MSG_YELLOW);
             end
             add_timer_event(self_obj, game_ticks(6), 1);
         end
         if (sequence == 3) then begin
-            float_msg(Aran_obj, message_str(1633, 2100), 2);
+            float_msg(Aran_obj, mstr(2100), FLOAT_MSG_RED);
         end
     end
-    if ((fixed_param == 2) and (global_var(993) == 3)) then begin
+    if ((fixed_param == 2) and (global_var(GVAR_AQE_QUEST_ANONYM_1) == 3)) then begin
         if (fixed_param == 2) then begin
             sequence := sequence + 1;
         end
@@ -657,101 +657,101 @@ begin
         if (sequence == 2) then begin
             move_to(dude_obj, 17283, 0);
             anim(dude_obj, 1000, 5);
-            metarule3(108, 16483, 0, 0);
+            tile_set_center(16483);
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777294) != 0) then begin
                 if (party_member_obj(16777294) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777294), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777294))) then begin
+                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 reg_anim_func(2, party_member_obj(16777729));
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777779));
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777811));
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777814));
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -775,13 +775,13 @@ begin
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -817,98 +817,98 @@ begin
             add_timer_event(self_obj, game_ticks(5), 2);
         end
         if (sequence == 4) then begin
-            float_msg(Elisa_obj, message_str(1633, 100), 8);
+            float_msg(Elisa_obj, mstr(100), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 5) then begin
-            float_msg(Myzrael_obj, message_str(1633, 200), 9);
+            float_msg(Myzrael_obj, mstr(200), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(5), 2);
         end
         if (sequence == 6) then begin
-            float_msg(Myzrael_obj, message_str(1633, 201), 9);
+            float_msg(Myzrael_obj, mstr(201), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 7) then begin
-            if (get_critter_stat(dude_obj, 34) == 0) then begin
-                float_msg(Elisa_obj, message_str(1633, 300), 8);
+            if (dude_gender == 0) then begin
+                float_msg(Elisa_obj, mstr(300), FLOAT_MSG_YELLOW);
             end
             else begin
-                float_msg(Elisa_obj, message_str(1633, 301), 8);
+                float_msg(Elisa_obj, mstr(301), FLOAT_MSG_YELLOW);
             end
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 8) then begin
-            float_msg(Aran_obj, message_str(1633, 400), 2);
+            float_msg(Aran_obj, mstr(400), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 9) then begin
-            float_msg(Myzrael_obj, message_str(1633, 500), 9);
+            float_msg(Myzrael_obj, mstr(500), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(5), 2);
         end
         if (sequence == 10) then begin
-            float_msg(Myzrael_obj, message_str(1633, 501), 9);
+            float_msg(Myzrael_obj, mstr(501), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(5), 2);
         end
         if (sequence == 11) then begin
-            float_msg(dude_obj, message_str(1633, 600), 4);
+            float_msg(dude_obj, mstr(600), FLOAT_MSG_BLUE);
             add_timer_event(self_obj, game_ticks(9), 2);
         end
         if (sequence == 12) then begin
-            float_msg(dude_obj, message_str(1633, 601), 4);
+            float_msg(dude_obj, mstr(601), FLOAT_MSG_BLUE);
             add_timer_event(self_obj, game_ticks(8), 2);
         end
         if (sequence == 13) then begin
-            if (get_critter_stat(dude_obj, 34) == 0) then begin
-                float_msg(Aran_obj, message_str(1633, 700), 2);
+            if (dude_gender == 0) then begin
+                float_msg(Aran_obj, mstr(700), FLOAT_MSG_RED);
             end
             else begin
-                float_msg(Aran_obj, message_str(1633, 701), 2);
+                float_msg(Aran_obj, mstr(701), FLOAT_MSG_RED);
             end
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 14) then begin
-            if (get_critter_stat(dude_obj, 34) == 0) then begin
-                float_msg(dude_obj, message_str(1633, 800), 4);
+            if (dude_gender == 0) then begin
+                float_msg(dude_obj, mstr(800), FLOAT_MSG_BLUE);
             end
             else begin
-                float_msg(dude_obj, message_str(1633, 801), 4);
+                float_msg(dude_obj, mstr(801), FLOAT_MSG_BLUE);
             end
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 15) then begin
-            float_msg(Aran_obj, message_str(1633, 900), 2);
+            float_msg(Aran_obj, mstr(900), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 16) then begin
-            float_msg(Elisa_obj, message_str(1633, 1000), 8);
+            float_msg(Elisa_obj, mstr(1000), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 17) then begin
-            float_msg(Aran_obj, message_str(1633, 1100), 2);
+            float_msg(Aran_obj, mstr(1100), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 2);
         end
         if (sequence == 18) then begin
-            float_msg(Aran_obj, message_str(1633, 1101), 2);
+            float_msg(Aran_obj, mstr(1101), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 2);
         end
         if (sequence == 19) then begin
-            float_msg(Myzrael_obj, message_str(1633, 1200), 9);
+            float_msg(Myzrael_obj, mstr(1200), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 20) then begin
-            float_msg(Myzrael_obj, message_str(1633, 1201), 9);
+            float_msg(Myzrael_obj, mstr(1201), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 21) then begin
-            float_msg(Elisa_obj, message_str(1633, 1300), 8);
+            float_msg(Elisa_obj, mstr(1300), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(5), 2);
         end
         if (sequence == 22) then begin
-            float_msg(Aran_obj, message_str(1633, 1400), 2);
+            float_msg(Aran_obj, mstr(1400), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 2);
         end
         if (sequence == 23) then begin
-            float_msg(Myzrael_obj, message_str(1633, 1500), 9);
+            float_msg(Myzrael_obj, mstr(1500), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(7), 2);
         end
         if (sequence == 24) then begin
@@ -921,21 +921,21 @@ begin
             add_timer_event(self_obj, game_ticks(3), 2);
         end
         if (sequence == 26) then begin
-            float_msg(dude_obj, message_str(1633, 1600), 4);
+            float_msg(dude_obj, mstr(1600), FLOAT_MSG_BLUE);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 27) then begin
-            float_msg(Elisa_obj, message_str(1633, 1700 + (get_critter_stat(dude_obj, 34) == 1)), 8);
+            float_msg(Elisa_obj, mstr(1700 + (dude_gender == 1)), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(6), 2);
         end
         if (sequence == 28) then begin
             game_ui_enable;
-            set_global_var(910, global_var(910) bwand (-1 - 4194304));
+            set_global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS, global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand (-1 - 4194304));
             set_map_var(0, map_var(0) bwand (-1 - 262144));
             set_map_var(0, map_var(0) bwand (-1 - 4096));
         end
     end
-    if ((fixed_param == 3) and (global_var(990) == 3)) then begin
+    if ((fixed_param == 3) and (global_var(GVAR_AQE_QUEST_ELISA_1) == 3)) then begin
         if (fixed_param == 3) then begin
             sequence := sequence + 1;
         end
@@ -948,101 +948,101 @@ begin
         if (sequence == 2) then begin
             move_to(dude_obj, 17283, 0);
             anim(dude_obj, 1000, 5);
-            metarule3(108, 16483, 0, 0);
+            tile_set_center(16483);
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777294) != 0) then begin
                 if (party_member_obj(16777294) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777294), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777294))) then begin
+                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 reg_anim_func(2, party_member_obj(16777729));
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777779));
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777811));
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777814));
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1066,13 +1066,13 @@ begin
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1108,66 +1108,66 @@ begin
             add_timer_event(self_obj, game_ticks(5), 3);
         end
         if (sequence == 4) then begin
-            float_msg(Elisa_obj, message_str(1633, 2500), 8);
+            float_msg(Elisa_obj, mstr(2500), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(6), 3);
         end
         if (sequence == 5) then begin
-            float_msg(Myzrael_obj, message_str(1633, 2550), 9);
+            float_msg(Myzrael_obj, mstr(2550), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(6), 3);
         end
         if (sequence == 6) then begin
-            if (get_critter_stat(dude_obj, 34) == 0) then begin
-                float_msg(Elisa_obj, message_str(1633, 2600), 8);
+            if (dude_gender == 0) then begin
+                float_msg(Elisa_obj, mstr(2600), FLOAT_MSG_YELLOW);
             end
             else begin
-                float_msg(Elisa_obj, message_str(1633, 2601), 8);
+                float_msg(Elisa_obj, mstr(2601), FLOAT_MSG_YELLOW);
             end
             add_timer_event(self_obj, game_ticks(8), 3);
         end
         if (sequence == 7) then begin
-            if (get_critter_stat(dude_obj, 34) == 0) then begin
-                float_msg(Elisa_obj, message_str(1633, 2602), 8);
+            if (dude_gender == 0) then begin
+                float_msg(Elisa_obj, mstr(2602), FLOAT_MSG_YELLOW);
             end
             else begin
-                float_msg(Elisa_obj, message_str(1633, 2603), 8);
+                float_msg(Elisa_obj, mstr(2603), FLOAT_MSG_YELLOW);
             end
             add_timer_event(self_obj, game_ticks(5), 3);
         end
         if (sequence == 8) then begin
-            if (get_critter_stat(dude_obj, 34) == 0) then begin
-                float_msg(dude_obj, message_str(1633, 2650), 4);
+            if (dude_gender == 0) then begin
+                float_msg(dude_obj, mstr(2650), FLOAT_MSG_BLUE);
             end
             else begin
-                float_msg(dude_obj, message_str(1633, 2651), 4);
+                float_msg(dude_obj, mstr(2651), FLOAT_MSG_BLUE);
             end
             add_timer_event(self_obj, game_ticks(6), 3);
         end
         if (sequence == 9) then begin
-            float_msg(Aran_obj, message_str(1633, 2700), 2);
+            float_msg(Aran_obj, mstr(2700), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 3);
         end
         if (sequence == 10) then begin
-            float_msg(dude_obj, message_str(1633, 2750), 4);
+            float_msg(dude_obj, mstr(2750), FLOAT_MSG_BLUE);
             add_timer_event(self_obj, game_ticks(8), 3);
         end
         if (sequence == 11) then begin
-            float_msg(Aran_obj, message_str(1633, 2800), 2);
+            float_msg(Aran_obj, mstr(2800), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(6), 3);
         end
         if (sequence == 12) then begin
-            float_msg(Aran_obj, message_str(1633, 2801), 2);
+            float_msg(Aran_obj, mstr(2801), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(4), 3);
         end
         if (sequence == 13) then begin
-            float_msg(Elisa_obj, message_str(1633, 2850), 8);
+            float_msg(Elisa_obj, mstr(2850), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(5), 3);
         end
         if (sequence == 14) then begin
-            float_msg(Aran_obj, message_str(1633, 2900), 2);
+            float_msg(Aran_obj, mstr(2900), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(7), 3);
         end
         if (sequence == 15) then begin
-            float_msg(Aran_obj, message_str(1633, 2901), 2);
+            float_msg(Aran_obj, mstr(2901), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 3);
         end
         if (sequence == 16) then begin
@@ -1175,19 +1175,19 @@ begin
             add_timer_event(self_obj, game_ticks(2), 3);
         end
         if (sequence == 17) then begin
-            float_msg(Aran_obj, message_str(1633, 2902), 2);
+            float_msg(Aran_obj, mstr(2902), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 3);
         end
         if (sequence == 18) then begin
-            float_msg(Myzrael_obj, message_str(1633, 2950), 9);
+            float_msg(Myzrael_obj, mstr(2950), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(5), 3);
         end
         if (sequence == 19) then begin
-            float_msg(Myzrael_obj, message_str(1633, 2951), 9);
+            float_msg(Myzrael_obj, mstr(2951), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(6), 3);
         end
         if (sequence == 20) then begin
-            float_msg(Myzrael_obj, message_str(1633, 2952), 9);
+            float_msg(Myzrael_obj, mstr(2952), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(4), 3);
         end
         if (sequence == 21) then begin
@@ -1200,29 +1200,29 @@ begin
             add_timer_event(self_obj, game_ticks(3), 3);
         end
         if (sequence == 23) then begin
-            anim(Elisa_obj, 1000, rotation_to_tile(tile_num(Elisa_obj), tile_num(dude_obj)));
+            anim(Elisa_obj, 1000, rotation_to_tile(tile_num(Elisa_obj), dude_tile));
             add_timer_event(self_obj, game_ticks(1), 3);
         end
         if (sequence == 24) then begin
             game_ui_enable;
-            set_global_var(910, global_var(910) bwand (-1 - 4194304));
-            set_global_var(990, 4);
+            set_global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS, global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand (-1 - 4194304));
+            set_global_var(GVAR_AQE_QUEST_ELISA_1, 4);
             set_map_var(0, map_var(0) bwand (-1 - 262144));
             add_timer_event(Elisa_obj, game_ticks(0), 1);
         end
     end
     if (fixed_param == 5) then begin
         move_to(Aran_obj, 29706, 0);
-        restock_obj := create_object_sid(40, 0, 0, -1);
+        restock_obj := create_object(40, 0, 0);
         add_mult_objs_to_inven(Aran_obj, restock_obj, 2);
         anim(Aran_obj, 1000, 5);
         wield_obj_critter(Aran_obj, obj_carrying_pid_obj(Aran_obj, 406));
         add_timer_event(self_obj, game_ticks(1), 6);
     end
     if (fixed_param == 6) then begin
-        set_global_var(1008, 4);
+        set_global_var(GVAR_AQE_HELP_TO_ARAN, 4);
         game_ui_enable;
-        if (not((global_var(1000) bwand 128) != 0)) then begin
+        if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 128) != 0)) then begin
             attack_setup(is1, gateguard1);
         end
         else begin
@@ -1234,7 +1234,7 @@ begin
             sequence2 := sequence2 + 1;
         end
         if (sequence2 == 1) then begin
-            metarule3(108, 27905, 0, 0);
+            tile_set_center(27905);
             call Generate_New_Soldiers();
             add_timer_event(self_obj, game_ticks(1), 10);
         end
@@ -1270,19 +1270,19 @@ begin
             add_timer_event(self_obj, game_ticks(1), 10);
         end
         if (sequence2 == 8) then begin
-            float_msg(is6, message_str(1633, 3000), 8);
+            float_msg(is6, mstr(3000), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(8), 10);
         end
         if (sequence2 == 9) then begin
-            float_msg(Aran_obj, message_str(1633, 3050), 2);
+            float_msg(Aran_obj, mstr(3050), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(8), 10);
         end
         if (sequence2 == 10) then begin
-            float_msg(is6, message_str(1633, 3100), 8);
+            float_msg(is6, mstr(3100), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(4), 10);
         end
         if (sequence2 == 11) then begin
-            set_global_var(1008, 5);
+            set_global_var(GVAR_AQE_HELP_TO_ARAN, 5);
             add_timer_event(self_obj, game_ticks(1), 10);
         end
         if (sequence2 == 12) then begin
@@ -1295,7 +1295,7 @@ begin
         end
         if (sequence4 == 1) then begin
             game_ui_disable;
-            set_global_var(910, global_var(910) bwor 262144);
+            set_global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS, global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwor 262144);
             reg_anim_func(2, Aran_obj);
             animate_move_obj_to_tile(Aran_obj, 20071, 0);
             reg_anim_func(2, dude_obj);
@@ -1303,7 +1303,7 @@ begin
             add_timer_event(self_obj, game_ticks(2), 11);
         end
         if (sequence4 == 2) then begin
-            set_global_var(1000, global_var(1000) bwor 4096);
+            set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwor 4096);
             add_timer_event(self_obj, game_ticks(2), 11);
         end
         if (sequence4 == 3) then begin
@@ -1317,102 +1317,102 @@ begin
             anim(Aran_obj, 1000, 5);
             move_to(dude_obj, 18283, 0);
             anim(dude_obj, 1000, 5);
-            metarule3(108, 16479, 0, 0);
+            tile_set_center(16479);
             call Generate_Attack_Soldier();
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777294) != 0) then begin
                 if (party_member_obj(16777294) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777294), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777294))) then begin
+                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 reg_anim_func(2, party_member_obj(16777729));
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777779));
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777811));
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777814));
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1436,13 +1436,13 @@ begin
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1472,15 +1472,15 @@ begin
             add_timer_event(self_obj, game_ticks(1), 11);
         end
         if (sequence4 == 6) then begin
-            float_msg(Aran_obj, message_str(1633, 3500), 2);
+            float_msg(Aran_obj, mstr(3500), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 11);
         end
         if (sequence4 == 7) then begin
-            float_msg(Aran_obj, message_str(1633, 3501), 2);
+            float_msg(Aran_obj, mstr(3501), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(6), 11);
         end
         if (sequence4 == 8) then begin
-            float_msg(Myzrael_obj, message_str(1633, 3550), 9);
+            float_msg(Myzrael_obj, mstr(3550), FLOAT_MSG_WHITE);
             add_timer_event(self_obj, game_ticks(1), 11);
         end
         if (sequence4 == 9) then begin
@@ -1489,15 +1489,15 @@ begin
         end
         if (sequence4 == 10) then begin
             if (not(obj_is_carrying_obj_pid(Elisa_obj, 402))) then begin
-                restock_obj := create_object_sid(402, 0, 0, -1);
+                restock_obj := create_object(402, 0, 0);
                 add_mult_objs_to_inven(Elisa_obj, restock_obj, 1);
             end
             wield_obj_critter(Elisa_obj, obj_carrying_pid_obj(Elisa_obj, 402));
             add_timer_event(self_obj, game_ticks(1), 11);
         end
         if (sequence4 == 11) then begin
-            if (not((global_var(904) bwand 1073741824) != 0)) then begin
-                set_global_var(904, global_var(904) bwor 1073741824);
+            if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 1073741824) != 0)) then begin
+                set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 1073741824);
             end
             reg_anim_func(2, Elisa_obj);
             reg_anim_func(1, 1);
@@ -1513,58 +1513,58 @@ begin
         end
         if (sequence4 == 12) then begin
             add_timer_event(Myzrael_obj, game_ticks(0), 66);
-            set_global_var(904, global_var(904) bwor 32);
+            set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 32);
             add_timer_event(self_obj, game_ticks(1), 11);
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 add_timer_event(party_member_obj(16777814), 5, 31);
             end
         end
         if (sequence4 == 13) then begin
             kill_critter(Myzrael_obj, 62);
-            float_msg(Aran_obj, message_str(1633, 3600), 2);
+            float_msg(Aran_obj, mstr(3600), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 11);
         end
         if (sequence4 == 14) then begin
-            float_msg(Elisa_obj, message_str(1633, 3650), 8);
+            float_msg(Elisa_obj, mstr(3650), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(6), 11);
         end
         if (sequence4 == 15) then begin
-            float_msg(Aran_obj, message_str(1633, 3700), 2);
+            float_msg(Aran_obj, mstr(3700), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(6), 11);
         end
         if (sequence4 == 16) then begin
-            float_msg(Elisa_obj, message_str(1633, 3701), 8);
+            float_msg(Elisa_obj, mstr(3701), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(8), 11);
         end
         if (sequence4 == 17) then begin
-            float_msg(Elisa_obj, message_str(1633, 3702), 8);
+            float_msg(Elisa_obj, mstr(3702), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(6), 11);
         end
         if (sequence4 == 18) then begin
-            float_msg(Elisa_obj, message_str(1633, 3703), 8);
+            float_msg(Elisa_obj, mstr(3703), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(7), 11);
         end
         if (sequence4 == 19) then begin
-            float_msg(Aran_obj, message_str(1633, 3750), 2);
+            float_msg(Aran_obj, mstr(3750), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 11);
         end
         if (sequence4 == 20) then begin
-            float_msg(Elisa_obj, message_str(1633, 3800), 8);
+            float_msg(Elisa_obj, mstr(3800), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(4), 11);
         end
         if (sequence4 == 21) then begin
-            float_msg(Elisa_obj, message_str(1633, 3801), 8);
+            float_msg(Elisa_obj, mstr(3801), FLOAT_MSG_YELLOW);
             add_timer_event(self_obj, game_ticks(4), 11);
         end
         if (sequence4 == 22) then begin
-            set_global_var(910, global_var(910) bwand (-1 - 262144));
+            set_global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS, global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand (-1 - 262144));
             game_ui_enable;
-            set_global_var(1008, 8);
+            set_global_var(GVAR_AQE_HELP_TO_ARAN, 8);
         end
     end
     if (fixed_param == 12) then begin
-        if (not((global_var(904) bwand 1073741824) != 0)) then begin
-            set_global_var(904, global_var(904) bwor 1073741824);
+        if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 1073741824) != 0)) then begin
+            set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 1073741824);
         end
         game_ui_disable;
         set_map_var(0, map_var(0) bwor 524288);
@@ -1584,12 +1584,12 @@ begin
         end
     end
     if (fixed_param == 15) then begin
-        float_msg(Aran_obj, message_str(1633, 4150), 2);
+        float_msg(Aran_obj, mstr(4150), FLOAT_MSG_RED);
         add_timer_event(self_obj, game_ticks(6), 16);
     end
     if (fixed_param == 16) then begin
-        float_msg(Aran_obj, message_str(1633, 4151), 2);
-        if (global_var(1011) < 13) then begin
+        float_msg(Aran_obj, mstr(4151), FLOAT_MSG_RED);
+        if (global_var(GVAR_AQE_EMPEROR_SOLDIERS_COUNT) < 13) then begin
             add_timer_event(self_obj, game_ticks(6), 17);
         end
         else begin
@@ -1597,11 +1597,11 @@ begin
         end
     end
     if (fixed_param == 17) then begin
-        float_msg(Aran_obj, message_str(1633, 4152), 2);
+        float_msg(Aran_obj, mstr(4152), FLOAT_MSG_RED);
         add_timer_event(self_obj, game_ticks(6), 20);
     end
     if (fixed_param == 20) then begin
-        float_msg(Aran_obj, message_str(1633, 4153), 2);
+        float_msg(Aran_obj, mstr(4153), FLOAT_MSG_RED);
         add_timer_event(self_obj, game_ticks(6), 21);
     end
     if (fixed_param == 21) then begin
@@ -1617,107 +1617,107 @@ begin
             anim(Aran_obj, 1000, 2);
             move_to(dude_obj, 16882, 0);
             anim(dude_obj, 1000, 5);
-            metarule3(108, 15882, 0, 0);
+            tile_set_center(15882);
             add_timer_event(Aran_obj, game_ticks(0), 2);
-            set_global_var(904, global_var(904) bwor 1);
-            set_global_var(865, global_var(865) bwor 262144);
-            if (not((global_var(904) bwand 1073741824) != 0)) then begin
-                set_global_var(904, global_var(904) bwor 1073741824);
+            set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 1);
+            set_global_var(GVAR_AQ_ALBUQ_EVENTS, global_var(GVAR_AQ_ALBUQ_EVENTS) bwor 262144);
+            if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 1073741824) != 0)) then begin
+                set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 1073741824);
             end
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777294) != 0) then begin
                 if (party_member_obj(16777294) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777294), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777294))) then begin
+                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777729) != 0) then begin
                 reg_anim_func(2, party_member_obj(16777729));
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777779));
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777811));
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 reg_anim_func(2, party_member_obj(16777814));
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1741,13 +1741,13 @@ begin
             if (party_member_obj(16777729) != 0) then begin
                 anim(party_member_obj(16777729), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
             if (party_member_obj(16778017) != 0) then begin
@@ -1768,20 +1768,20 @@ begin
             if (party_member_obj(16777812) != 0) then begin
                 anim(party_member_obj(16777812), 1000, 5);
             end
-            as1 := create_object_sid(16778031, 17474, 0, 130);
-            as2 := create_object_sid(16778045, 14480, 0, 130);
-            as3 := create_object_sid(16778032, 15274, 0, 130);
-            restock_obj := create_object_sid(118, 0, 0, -1);
+            as1 := create_object_sid(16778031, 17474, 0, SCRIPT_ACISVOJ6);
+            as2 := create_object_sid(16778045, 14480, 0, SCRIPT_ACISVOJ6);
+            as3 := create_object_sid(16778032, 15274, 0, SCRIPT_ACISVOJ6);
+            restock_obj := create_object(118, 0, 0);
             add_mult_objs_to_inven(as1, restock_obj, 1);
-            restock_obj := create_object_sid(406, 0, 0, -1);
+            restock_obj := create_object(406, 0, 0);
             add_mult_objs_to_inven(as2, restock_obj, 1);
-            restock_obj := create_object_sid(406, 0, 0, -1);
+            restock_obj := create_object(406, 0, 0);
             add_mult_objs_to_inven(as3, restock_obj, 1);
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(as1, restock_obj, 2);
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(as2, restock_obj, 2);
-            restock_obj := create_object_sid(40, 0, 0, -1);
+            restock_obj := create_object(40, 0, 0);
             add_mult_objs_to_inven(as3, restock_obj, 2);
             wield_obj_critter(as1, obj_carrying_pid_obj(as1, 118));
             wield_obj_critter(as2, obj_carrying_pid_obj(as2, 406));
@@ -2356,85 +2356,85 @@ begin
             end
             if (party_member_obj(16777729) != 0) then begin
                 if (party_member_obj(16777729) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777729), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777729))) then begin
+                        critter_attempt_placement(party_member_obj(16777729), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0)) then begin
                 if (party_member_obj(16777779) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777779), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777779))) then begin
+                        critter_attempt_placement(party_member_obj(16777779), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0)) then begin
                 if (party_member_obj(16777811) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777811), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777811))) then begin
+                        critter_attempt_placement(party_member_obj(16777811), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777812) != 0) then begin
                 if (party_member_obj(16777812) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777812), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777812))) then begin
+                        critter_attempt_placement(party_member_obj(16777812), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0)) then begin
                 if (party_member_obj(16777814) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777814), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777814))) then begin
+                        critter_attempt_placement(party_member_obj(16777814), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777748) != 0) then begin
                 if (party_member_obj(16777748) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777748), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777748))) then begin
+                        critter_attempt_placement(party_member_obj(16777748), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778017) != 0) then begin
                 if (party_member_obj(16778017) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778017), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778017))) then begin
+                        critter_attempt_placement(party_member_obj(16778017), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778016) != 0) then begin
                 if (party_member_obj(16778016) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778016), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778016))) then begin
+                        critter_attempt_placement(party_member_obj(16778016), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778049) != 0) then begin
                 if (party_member_obj(16778049) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778049), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778049))) then begin
+                        critter_attempt_placement(party_member_obj(16778049), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778050) != 0) then begin
                 if (party_member_obj(16778050) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778050), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778050))) then begin
+                        critter_attempt_placement(party_member_obj(16778050), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16778051) != 0) then begin
                 if (party_member_obj(16778051) != 0) then begin
-                    if (has_trait(1, party_member_obj(16778051), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16778051))) then begin
+                        critter_attempt_placement(party_member_obj(16778051), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
             if (party_member_obj(16777294) != 0) then begin
                 if (party_member_obj(16777294) != 0) then begin
-                    if (has_trait(1, party_member_obj(16777294), 666)) then begin
-                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(tile_num(dude_obj), (has_trait(1, dude_obj, 10) + 3) % 6, 2), elevation(dude_obj));
+                    if (obj_is_visible_flag(party_member_obj(16777294))) then begin
+                        critter_attempt_placement(party_member_obj(16777294), tile_num_in_direction(dude_tile, (obj_get_rot(dude_obj) + 3) % 6, 2), dude_elevation);
                     end
                 end
             end
@@ -2449,13 +2449,13 @@ begin
         end
         if (sequence5 == 5) then begin
             game_ui_enable;
-            if (not((global_var(904) bwand 1073741824) != 0)) then begin
-                set_global_var(904, global_var(904) bwor 1073741824);
+            if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 1073741824) != 0)) then begin
+                set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 1073741824);
             end
             add_timer_event(Aran_obj, game_ticks(0), 1);
         end
     end
-    if ((fixed_param == 30) and ((global_var(1007) == 2) or (global_var(1006) == 2))) then begin
+    if ((fixed_param == 30) and ((global_var(GVAR_AQE_MESAGE_FROM_ARAN) == 2) or (global_var(GVAR_AQE_MESAGE_FROM_ELISA) == 2))) then begin
         if (fixed_param == 30) then begin
             sequence6 := sequence6 + 1;
         end
@@ -2470,97 +2470,97 @@ begin
             add_timer_event(self_obj, game_ticks(1), 30);
         end
         if (sequence6 == 3) then begin
-            metarule3(108, 16281, 0, 0);
-            tulsa := create_object_sid(16777953, 17283, 0, -1);
+            tile_set_center(16281);
+            tulsa := create_object(16777953, 17283, 0);
             anim(tulsa, 1000, 5);
             add_timer_event(self_obj, game_ticks(1), 30);
         end
         if (sequence6 == 4) then begin
             gfade_in(600);
-            metarule3(108, 16281, 0, 0);
-            if ((tile_num(dude_obj) == 18281) and (has_trait(1, dude_obj, 10) != 5)) then begin
+            tile_set_center(16281);
+            if ((dude_tile == 18281) and (obj_get_rot(dude_obj) != 5)) then begin
                 anim(dude_obj, 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0) and (art_anim(obj_art_fid(party_member_obj(16777814))) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0) and (art_anim(obj_art_fid(party_member_obj(16777814))) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0) and (art_anim(obj_art_fid(party_member_obj(16777779))) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0) and (art_anim(obj_art_fid(party_member_obj(16777779))) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0) and (art_anim(obj_art_fid(party_member_obj(16777811))) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0) and (art_anim(obj_art_fid(party_member_obj(16777811))) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
             add_timer_event(self_obj, game_ticks(1), 30);
         end
         if (sequence6 == 5) then begin
-            float_msg(tulsa, message_str(1633, 5000), 2);
-            metarule3(108, 16281, 0, 0);
-            if ((tile_num(dude_obj) == 18281) and (has_trait(1, dude_obj, 10) != 5)) then begin
+            float_msg(tulsa, mstr(5000), FLOAT_MSG_RED);
+            tile_set_center(16281);
+            if ((dude_tile == 18281) and (obj_get_rot(dude_obj) != 5)) then begin
                 anim(dude_obj, 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0) and (art_anim(obj_art_fid(party_member_obj(16777814))) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0) and (art_anim(obj_art_fid(party_member_obj(16777814))) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0) and (art_anim(obj_art_fid(party_member_obj(16777779))) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0) and (art_anim(obj_art_fid(party_member_obj(16777779))) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0) and (art_anim(obj_art_fid(party_member_obj(16777811))) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0) and (art_anim(obj_art_fid(party_member_obj(16777811))) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
             add_timer_event(self_obj, game_ticks(6), 30);
         end
         if (sequence6 == 6) then begin
-            float_msg(tulsa, message_str(1633, 5001), 2);
-            if ((tile_num(dude_obj) == 18281) and (has_trait(1, dude_obj, 10) != 5)) then begin
+            float_msg(tulsa, mstr(5001), FLOAT_MSG_RED);
+            if ((dude_tile == 18281) and (obj_get_rot(dude_obj) != 5)) then begin
                 anim(dude_obj, 1000, 5);
             end
-            if ((party_member_obj(16777814) != 0) and ((global_var(910) bwand 128) == 0) and (art_anim(obj_art_fid(party_member_obj(16777814))) == 0)) then begin
+            if ((party_member_obj(16777814) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 128) == 0) and (art_anim(obj_art_fid(party_member_obj(16777814))) == 0)) then begin
                 anim(party_member_obj(16777814), 1000, 5);
             end
-            if ((party_member_obj(16777779) != 0) and ((global_var(910) bwand 32) == 0) and (art_anim(obj_art_fid(party_member_obj(16777779))) == 0)) then begin
+            if ((party_member_obj(16777779) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 32) == 0) and (art_anim(obj_art_fid(party_member_obj(16777779))) == 0)) then begin
                 anim(party_member_obj(16777779), 1000, 5);
             end
-            if ((party_member_obj(16777811) != 0) and ((global_var(910) bwand 64) == 0) and (art_anim(obj_art_fid(party_member_obj(16777811))) == 0)) then begin
+            if ((party_member_obj(16777811) != 0) and ((global_var(GVAR_PTR_PARTY_MEMBER_ACTIONS) bwand 64) == 0) and (art_anim(obj_art_fid(party_member_obj(16777811))) == 0)) then begin
                 anim(party_member_obj(16777811), 1000, 5);
             end
             add_timer_event(self_obj, game_ticks(6), 30);
         end
         if (sequence6 == 7) then begin
-            if ((global_var(904) bwand 1) != 0) then begin
-                float_msg(Aran_obj, message_str(1633, 5050), 9);
+            if ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 1) != 0) then begin
+                float_msg(Aran_obj, mstr(5050), FLOAT_MSG_WHITE);
             end
             else begin
-                float_msg(Elisa_obj, message_str(1633, 5050), 9);
+                float_msg(Elisa_obj, mstr(5050), FLOAT_MSG_WHITE);
             end
             add_timer_event(self_obj, game_ticks(7), 30);
         end
         if (sequence6 == 8) then begin
-            if ((global_var(904) bwand 1) != 0) then begin
-                float_msg(Aran_obj, message_str(1633, 5051), 9);
+            if ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 1) != 0) then begin
+                float_msg(Aran_obj, mstr(5051), FLOAT_MSG_WHITE);
             end
             else begin
-                float_msg(Elisa_obj, message_str(1633, 5051), 9);
+                float_msg(Elisa_obj, mstr(5051), FLOAT_MSG_WHITE);
             end
             add_timer_event(self_obj, game_ticks(7), 30);
         end
         if (sequence6 == 9) then begin
-            float_msg(tulsa, message_str(1633, 5100), 2);
+            float_msg(tulsa, mstr(5100), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(5), 30);
         end
         if (sequence6 == 10) then begin
-            if ((global_var(904) bwand 1) != 0) then begin
-                float_msg(Aran_obj, message_str(1633, 5150), 9);
+            if ((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwand 1) != 0) then begin
+                float_msg(Aran_obj, mstr(5150), FLOAT_MSG_WHITE);
             end
             else begin
-                float_msg(Elisa_obj, message_str(1633, 5150), 9);
+                float_msg(Elisa_obj, mstr(5150), FLOAT_MSG_WHITE);
             end
             add_timer_event(self_obj, game_ticks(5), 30);
         end
         if (sequence6 == 11) then begin
             reg_anim_func(2, tulsa);
             anim(tulsa, 1000, 2);
-            metarule3(108, 16281, 0, 0);
-            float_msg(tulsa, message_str(1633, 5200), 2);
+            tile_set_center(16281);
+            float_msg(tulsa, mstr(5200), FLOAT_MSG_RED);
             add_timer_event(self_obj, game_ticks(1), 30);
         end
         if (sequence6 == 12) then begin
@@ -2573,8 +2573,8 @@ begin
             add_timer_event(self_obj, game_ticks(1), 30);
         end
         if (sequence6 == 14) then begin
-            set_global_var(866, global_var(866) bwor 1073741824);
-            float_msg(tulsa, message_str(1633, 5201), 2);
+            set_global_var(GVAR_AQ_ALBUQ_SPEECHES, global_var(GVAR_AQ_ALBUQ_SPEECHES) bwor 1073741824);
+            float_msg(tulsa, mstr(5201), FLOAT_MSG_RED);
             animate_move_obj_to_tile(tulsa, 20483, 0);
             add_timer_event(self_obj, game_ticks(1), 30);
         end
@@ -2624,14 +2624,14 @@ begin
             sequence3 := sequence3 + 1;
         end
         if (sequence3 == 1) then begin
-            float_msg(dude_obj, message_str(1633, 4503), 4);
-            display_msg(message_str(1633, 4504));
+            float_msg(dude_obj, mstr(4503), FLOAT_MSG_BLUE);
+            display_mstr(4504);
             add_timer_event(self_obj, game_ticks(5), 75);
         end
         if (sequence3 == 2) then begin
-            gfade_out(1);
+            fade_out;
             game_ui_enable;
-            critter_heal(dude_obj, -get_critter_stat(dude_obj, 7));
+            critter_heal(dude_obj, -get_critter_stat(dude_obj, STAT_max_hp));
         end
     end
     if (fixed_param == 80) then begin
@@ -2640,7 +2640,7 @@ begin
         end
         if (sequence4 == 1) then begin
             game_ui_disable;
-            metarule3(100, self_obj, 80, 0);
+            rm_fixed_timer_event(self_obj, 80);
             if (combat_is_initialized) then begin
                 terminate_combat;
             end
@@ -2651,7 +2651,7 @@ begin
                 game_ui_disable;
             end
             if (not(obj_is_carrying_obj_pid(Elisa_obj, 402))) then begin
-                restock_obj := create_object_sid(402, 0, 0, -1);
+                restock_obj := create_object(402, 0, 0);
                 add_mult_objs_to_inven(Elisa_obj, restock_obj, 1);
             end
             wield_obj_critter(Elisa_obj, obj_carrying_pid_obj(Elisa_obj, 402));
@@ -2672,7 +2672,7 @@ begin
         end
         if (sequence4 == 4) then begin
             add_timer_event(Myzrael_obj, game_ticks(0), 66);
-            set_global_var(904, global_var(904) bwor 32);
+            set_global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS, global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS) bwor 32);
             add_timer_event(self_obj, game_ticks(1), 80);
         end
         if (sequence4 == 5) then begin
@@ -2681,9 +2681,9 @@ begin
             add_timer_event(self_obj, 2, 80);
         end
         if (sequence4 == 6) then begin
-            set_global_var(1008, 8);
+            set_global_var(GVAR_AQE_HELP_TO_ARAN, 8);
             if (tile_contains_obj_pid(15273, 0, 16778031)) then begin
-                animate_move_obj_to_tile(tile_contains_pid_obj(17085, 0, 16778031), tile_num(dude_obj), 1);
+                animate_move_obj_to_tile(tile_contains_pid_obj(17085, 0, 16778031), dude_tile, 1);
             end
         end
     end
@@ -2697,41 +2697,41 @@ end
 
 procedure Generate_Gate_Guards
 begin
-    gateguard1 := create_object_sid(16778031, 27909, 0, 142);
-    gateguard2 := create_object_sid(16778032, 27902, 0, 142);
-    gateguard3 := create_object_sid(16778045, 28905, 0, 142);
-    gateguard4 := create_object_sid(16778031, 28501, 0, 142);
-    gateguard5 := create_object_sid(16778032, 28911, 0, 142);
-    gateguard6 := create_object_sid(16778031, 28105, 0, 142);
+    gateguard1 := create_object_sid(16778031, 27909, 0, SCRIPT_ACISVOJ8);
+    gateguard2 := create_object_sid(16778032, 27902, 0, SCRIPT_ACISVOJ8);
+    gateguard3 := create_object_sid(16778045, 28905, 0, SCRIPT_ACISVOJ8);
+    gateguard4 := create_object_sid(16778031, 28501, 0, SCRIPT_ACISVOJ8);
+    gateguard5 := create_object_sid(16778032, 28911, 0, SCRIPT_ACISVOJ8);
+    gateguard6 := create_object_sid(16778031, 28105, 0, SCRIPT_ACISVOJ8);
     anim(gateguard1, 1000, 2);
     anim(gateguard2, 1000, 2);
     anim(gateguard3, 1000, 2);
     anim(gateguard4, 1000, 2);
     anim(gateguard5, 1000, 2);
     anim(gateguard6, 1000, 2);
-    restock_obj := create_object_sid(599, 0, 0, -1);
+    restock_obj := create_object(599, 0, 0);
     add_mult_objs_to_inven(gateguard1, restock_obj, 1);
-    restock_obj := create_object_sid(406, 0, 0, -1);
+    restock_obj := create_object(406, 0, 0);
     add_mult_objs_to_inven(gateguard2, restock_obj, 1);
-    restock_obj := create_object_sid(24, 0, 0, -1);
+    restock_obj := create_object(24, 0, 0);
     add_mult_objs_to_inven(gateguard3, restock_obj, 1);
-    restock_obj := create_object_sid(599, 0, 0, -1);
+    restock_obj := create_object(599, 0, 0);
     add_mult_objs_to_inven(gateguard4, restock_obj, 1);
-    restock_obj := create_object_sid(118, 0, 0, -1);
+    restock_obj := create_object(118, 0, 0);
     add_mult_objs_to_inven(gateguard5, restock_obj, 1);
-    restock_obj := create_object_sid(406, 0, 0, -1);
+    restock_obj := create_object(406, 0, 0);
     add_mult_objs_to_inven(gateguard6, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(gateguard1, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(gateguard2, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(gateguard3, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(gateguard4, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(gateguard5, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(gateguard6, restock_obj, 1);
     wield_obj_critter(gateguard1, obj_carrying_pid_obj(gateguard1, 599));
     wield_obj_critter(gateguard2, obj_carrying_pid_obj(gateguard2, 406));
@@ -2743,132 +2743,132 @@ end
 
 procedure Generate_Arans_Soldiers
 begin
-    if (not((global_var(1000) bwand 128) != 0)) then begin
-        is1 := create_object_sid(16778031, 30309, 0, 140);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 128) != 0)) then begin
+        is1 := create_object_sid(16778031, 30309, 0, SCRIPT_ACISVOJ9);
     end
-    if (not((global_var(1000) bwand 256) != 0)) then begin
-        is2 := create_object_sid(16778031, 30501, 0, 140);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 256) != 0)) then begin
+        is2 := create_object_sid(16778031, 30501, 0, SCRIPT_ACISVOJ9);
     end
-    if (not((global_var(1000) bwand 512) != 0)) then begin
-        is3 := create_object_sid(16778031, 30907, 0, 140);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 512) != 0)) then begin
+        is3 := create_object_sid(16778031, 30907, 0, SCRIPT_ACISVOJ9);
     end
-    if (not((global_var(1000) bwand 1024) != 0)) then begin
-        is4 := create_object_sid(16778032, 31301, 0, 140);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 1024) != 0)) then begin
+        is4 := create_object_sid(16778032, 31301, 0, SCRIPT_ACISVOJ9);
     end
-    if (not((global_var(1000) bwand 2048) != 0)) then begin
-        is5 := create_object_sid(16778031, 31511, 0, 140);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 2048) != 0)) then begin
+        is5 := create_object_sid(16778031, 31511, 0, SCRIPT_ACISVOJ9);
     end
-    if (not((global_var(1000) bwand 128) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 128) != 0)) then begin
         anim(is1, 1000, 5);
     end
-    if (not((global_var(1000) bwand 256) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 256) != 0)) then begin
         anim(is2, 1000, 5);
     end
-    if (not((global_var(1000) bwand 512) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 512) != 0)) then begin
         anim(is3, 1000, 5);
     end
-    if (not((global_var(1000) bwand 1024) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 1024) != 0)) then begin
         anim(is4, 1000, 5);
     end
-    if (not((global_var(1000) bwand 2048) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 2048) != 0)) then begin
         anim(is5, 1000, 5);
     end
-    if (not((global_var(1000) bwand 128) != 0)) then begin
-        restock_obj := create_object_sid(599, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 128) != 0)) then begin
+        restock_obj := create_object(599, 0, 0);
     end
     add_mult_objs_to_inven(is1, restock_obj, 1);
-    if (not((global_var(1000) bwand 256) != 0)) then begin
-        restock_obj := create_object_sid(118, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 256) != 0)) then begin
+        restock_obj := create_object(118, 0, 0);
     end
     add_mult_objs_to_inven(is2, restock_obj, 1);
-    if (not((global_var(1000) bwand 512) != 0)) then begin
-        restock_obj := create_object_sid(599, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 512) != 0)) then begin
+        restock_obj := create_object(599, 0, 0);
     end
     add_mult_objs_to_inven(is3, restock_obj, 1);
-    if (not((global_var(1000) bwand 1024) != 0)) then begin
-        restock_obj := create_object_sid(402, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 1024) != 0)) then begin
+        restock_obj := create_object(402, 0, 0);
     end
     add_mult_objs_to_inven(is4, restock_obj, 1);
-    if (not((global_var(1000) bwand 2048) != 0)) then begin
-        restock_obj := create_object_sid(406, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 2048) != 0)) then begin
+        restock_obj := create_object(406, 0, 0);
     end
     add_mult_objs_to_inven(is5, restock_obj, 1);
-    if (not((global_var(1000) bwand 128) != 0)) then begin
-        restock_obj := create_object_sid(38, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 128) != 0)) then begin
+        restock_obj := create_object(38, 0, 0);
     end
     add_mult_objs_to_inven(is1, restock_obj, 1);
-    if (not((global_var(1000) bwand 256) != 0)) then begin
-        restock_obj := create_object_sid(39, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 256) != 0)) then begin
+        restock_obj := create_object(39, 0, 0);
     end
     add_mult_objs_to_inven(is2, restock_obj, 1);
-    if (not((global_var(1000) bwand 512) != 0)) then begin
-        restock_obj := create_object_sid(38, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 512) != 0)) then begin
+        restock_obj := create_object(38, 0, 0);
     end
     add_mult_objs_to_inven(is3, restock_obj, 1);
-    if (not((global_var(1000) bwand 1024) != 0)) then begin
-        restock_obj := create_object_sid(38, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 1024) != 0)) then begin
+        restock_obj := create_object(38, 0, 0);
     end
     add_mult_objs_to_inven(is4, restock_obj, 1);
-    if (not((global_var(1000) bwand 2048) != 0)) then begin
-        restock_obj := create_object_sid(38, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 2048) != 0)) then begin
+        restock_obj := create_object(38, 0, 0);
     end
     add_mult_objs_to_inven(is5, restock_obj, 1);
-    if (not((global_var(1000) bwand 128) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 128) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
     end
     add_mult_objs_to_inven(is1, restock_obj, 1);
-    if (not((global_var(1000) bwand 256) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 256) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
     end
     add_mult_objs_to_inven(is2, restock_obj, 1);
-    if (not((global_var(1000) bwand 512) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 512) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
     end
     add_mult_objs_to_inven(is3, restock_obj, 1);
-    if (not((global_var(1000) bwand 1024) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 1024) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
     end
     add_mult_objs_to_inven(is4, restock_obj, 1);
-    if (not((global_var(1000) bwand 2048) != 0)) then begin
-        restock_obj := create_object_sid(40, 0, 0, -1);
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 2048) != 0)) then begin
+        restock_obj := create_object(40, 0, 0);
     end
     add_mult_objs_to_inven(is5, restock_obj, 1);
-    if (not((global_var(1000) bwand 128) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 128) != 0)) then begin
         wield_obj_critter(is1, obj_carrying_pid_obj(is1, 599));
     end
-    if (not((global_var(1000) bwand 256) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 256) != 0)) then begin
         wield_obj_critter(is2, obj_carrying_pid_obj(is2, 118));
     end
-    if (not((global_var(1000) bwand 512) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 512) != 0)) then begin
         wield_obj_critter(is3, obj_carrying_pid_obj(is3, 599));
     end
-    if (not((global_var(1000) bwand 1024) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 1024) != 0)) then begin
         wield_obj_critter(is4, obj_carrying_pid_obj(is4, 402));
     end
-    if (not((global_var(1000) bwand 2048) != 0)) then begin
+    if (not((global_var(GVAR_AQE_ALBUQ_EMPEROR_EVENTS_NEXT) bwand 2048) != 0)) then begin
         wield_obj_critter(is5, obj_carrying_pid_obj(is5, 406));
     end
 end
 
 procedure Generate_New_Soldiers
 begin
-    is6 := create_object_sid(16778031, 27104, 0, 140);
-    is7 := create_object_sid(16778032, 27106, 0, 140);
-    is8 := create_object_sid(16778045, 27303, 0, 140);
+    is6 := create_object_sid(16778031, 27104, 0, SCRIPT_ACISVOJ9);
+    is7 := create_object_sid(16778032, 27106, 0, SCRIPT_ACISVOJ9);
+    is8 := create_object_sid(16778045, 27303, 0, SCRIPT_ACISVOJ9);
     anim(is6, 1000, 2);
     anim(is7, 1000, 2);
     anim(is8, 1000, 2);
-    restock_obj := create_object_sid(599, 0, 0, -1);
+    restock_obj := create_object(599, 0, 0);
     add_mult_objs_to_inven(is6, restock_obj, 1);
-    restock_obj := create_object_sid(406, 0, 0, -1);
+    restock_obj := create_object(406, 0, 0);
     add_mult_objs_to_inven(is7, restock_obj, 1);
-    restock_obj := create_object_sid(406, 0, 0, -1);
+    restock_obj := create_object(406, 0, 0);
     add_mult_objs_to_inven(is8, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is6, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is7, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is8, restock_obj, 1);
     wield_obj_critter(is6, obj_carrying_pid_obj(is6, 599));
     wield_obj_critter(is7, obj_carrying_pid_obj(is7, 406));
@@ -2878,13 +2878,13 @@ begin
     move_to(Myzrael_obj, 16280, 0);
     anim(Myzrael_obj, 1000, 2);
     add_timer_event(Myzrael_obj, 1, 66);
-    is10 := create_object_sid(16778031, 15273, 0, 142);
-    is11 := create_object_sid(16778032, 15488, 0, 142);
-    is12 := create_object_sid(16778045, 16476, 0, 142);
-    is13 := create_object_sid(16778031, 17085, 0, 142);
-    is14 := create_object_sid(16778032, 14882, 0, 142);
-    is16 := create_object_sid(16778045, 15685, 0, 142);
-    is17 := create_object_sid(16778032, 16488, 0, 142);
+    is10 := create_object_sid(16778031, 15273, 0, SCRIPT_ACISVOJ8);
+    is11 := create_object_sid(16778032, 15488, 0, SCRIPT_ACISVOJ8);
+    is12 := create_object_sid(16778045, 16476, 0, SCRIPT_ACISVOJ8);
+    is13 := create_object_sid(16778031, 17085, 0, SCRIPT_ACISVOJ8);
+    is14 := create_object_sid(16778032, 14882, 0, SCRIPT_ACISVOJ8);
+    is16 := create_object_sid(16778045, 15685, 0, SCRIPT_ACISVOJ8);
+    is17 := create_object_sid(16778032, 16488, 0, SCRIPT_ACISVOJ8);
     anim(is10, 1000, 2);
     anim(is11, 1000, 2);
     anim(is12, 1000, 2);
@@ -2892,33 +2892,33 @@ begin
     anim(is14, 1000, 2);
     anim(is16, 1000, 2);
     anim(is17, 1000, 2);
-    restock_obj := create_object_sid(599, 0, 0, -1);
+    restock_obj := create_object(599, 0, 0);
     add_mult_objs_to_inven(is10, restock_obj, 1);
-    restock_obj := create_object_sid(406, 0, 0, -1);
+    restock_obj := create_object(406, 0, 0);
     add_mult_objs_to_inven(is11, restock_obj, 1);
-    restock_obj := create_object_sid(402, 0, 0, -1);
+    restock_obj := create_object(402, 0, 0);
     add_mult_objs_to_inven(is12, restock_obj, 1);
-    restock_obj := create_object_sid(599, 0, 0, -1);
+    restock_obj := create_object(599, 0, 0);
     add_mult_objs_to_inven(is13, restock_obj, 1);
-    restock_obj := create_object_sid(599, 0, 0, -1);
+    restock_obj := create_object(599, 0, 0);
     add_mult_objs_to_inven(is14, restock_obj, 1);
-    restock_obj := create_object_sid(406, 0, 0, -1);
+    restock_obj := create_object(406, 0, 0);
     add_mult_objs_to_inven(is16, restock_obj, 1);
-    restock_obj := create_object_sid(118, 0, 0, -1);
+    restock_obj := create_object(118, 0, 0);
     add_mult_objs_to_inven(is17, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is10, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is11, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is12, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is13, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is14, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is16, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is17, restock_obj, 1);
     wield_obj_critter(is10, obj_carrying_pid_obj(is10, 599));
     wield_obj_critter(is11, obj_carrying_pid_obj(is11, 406));
@@ -2931,20 +2931,19 @@ end
 
 procedure Generate_Attack_Soldier
 begin
-    is15 := create_object_sid(16778031, 15877, 0, 142);
+    is15 := create_object_sid(16778031, 15877, 0, SCRIPT_ACISVOJ8);
     anim(is15, 1000, 2);
-    restock_obj := create_object_sid(406, 0, 0, -1);
+    restock_obj := create_object(406, 0, 0);
     add_mult_objs_to_inven(is15, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is15, restock_obj, 1);
     wield_obj_critter(is15, obj_carrying_pid_obj(is15, 406));
-    is20 := create_object_sid(16778031, 21271, 0, 140);
+    is20 := create_object_sid(16778031, 21271, 0, SCRIPT_ACISVOJ9);
     anim(is20, 1000, 2);
-    restock_obj := create_object_sid(406, 0, 0, -1);
+    restock_obj := create_object(406, 0, 0);
     add_mult_objs_to_inven(is20, restock_obj, 1);
-    restock_obj := create_object_sid(40, 0, 0, -1);
+    restock_obj := create_object(40, 0, 0);
     add_mult_objs_to_inven(is20, restock_obj, 1);
     wield_obj_critter(is20, obj_carrying_pid_obj(is8, 406));
     set_map_var(0, map_var(0) bwor 32768);
 end
-
