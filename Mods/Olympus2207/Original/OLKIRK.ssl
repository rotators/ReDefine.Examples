variable steal_perk;
variable steal_gloves;
variable animation_is_called;
variable float_is_called;
variable already_talk;
variable persuade_mod;

procedure start;
procedure critter_p_proc;
procedure combat_p_proc;
procedure description_p_proc;
procedure look_at_p_proc;
procedure pickup_p_proc;
procedure push_p_proc;
procedure talk_p_proc;
procedure destroy_p_proc;
procedure use_skill_on_p_proc;
procedure damage_p_proc;
procedure map_enter_p_proc;
procedure timed_event_p_proc;
procedure Node001;
procedure Node010;
procedure Node011;
procedure Node012;
procedure Node021;
procedure Node0211;
procedure Node0212;
procedure Node022;
procedure Node023;
procedure Node024;
procedure Node025;
procedure Node999;
procedure NodeParty;
procedure DialogParty;
procedure Healing;
procedure Healing_self;
procedure Healing_dude_binty;
procedure Healing_dude_analgetic;
procedure Healing_dude_heal_up;
procedure Healing_dude_lazareth;
procedure Armor;
procedure Remove_armor;
procedure Remove_Aviator;
procedure New_armor;
procedure Weapon;
procedure Remove_Weapon;
procedure Weapon_melee;
procedure Weapon_throw;
procedure Weapon_shoot;
procedure Weapon_expl;
procedure Weapon_best;
procedure Distance;
procedure DistanceClose;
procedure DistanceMedium;
procedure DistanceFar;
procedure DialogParty2;
procedure AboutThisPlace;
procedure NewIdeas;
procedure BeforeCombat;
procedure Waiting;


procedure start
begin
    if (local_var(1) == 0) then begin
        set_local_var(13, 1);
        set_local_var(3, tile_num(self_obj));
        set_local_var(1, 1);
        set_local_var(4, random(50, 70));
        set_local_var(5, random(60, 80));
        set_local_var(11, 1);
        set_local_var(6, random(-30, 20));
        critter_add_trait(self_obj, 1, 6, 0);
        critter_add_trait(self_obj, 1, 5, 3);
    end
end

procedure critter_p_proc
begin
    if ((animation_is_called == 0) and (anim_busy(self_obj) == 0)) then begin
        animation_is_called := 1;
        add_timer_event(self_obj, random(29, 76), 1);
    end
    if (float_is_called == 0) then begin
        float_is_called := 1;
        add_timer_event(self_obj, random(200, 700), 2);
    end
    if (global_var(265) == 1) then begin
        if (local_var(11) == 0) then begin
            if ((tile_distance(tile_num(dude_obj), tile_num(self_obj)) > 3) and (tile_distance(tile_num(dude_obj), tile_num(self_obj)) <= 7)) then begin
                animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(dude_obj), rotation_to_tile(tile_num(dude_obj), tile_num(self_obj)), random(2, 4)), 0);
            end
            else begin
                if (tile_distance(tile_num(dude_obj), tile_num(self_obj)) > 7) then begin
                    animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(dude_obj), rotation_to_tile(tile_num(dude_obj), tile_num(self_obj)), random(2, 4)), 1);
                end
            end
        end
        else begin
            if (local_var(11) == 1) then begin
                if ((tile_distance(tile_num(dude_obj), tile_num(self_obj)) > 6) and (tile_distance(tile_num(dude_obj), tile_num(self_obj)) <= 10)) then begin
                    animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(dude_obj), rotation_to_tile(tile_num(dude_obj), tile_num(self_obj)), random(3, 5)), 0);
                end
                else begin
                    if (tile_distance(tile_num(dude_obj), tile_num(self_obj)) > 10) then begin
                        animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(dude_obj), rotation_to_tile(tile_num(dude_obj), tile_num(self_obj)), random(3, 5)), 1);
                    end
                end
            end
            else begin
                if ((tile_distance(tile_num(dude_obj), tile_num(self_obj)) > 10) and (tile_distance(tile_num(dude_obj), tile_num(self_obj)) <= 16)) then begin
                    animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(dude_obj), rotation_to_tile(tile_num(dude_obj), tile_num(self_obj)), random(4, 6)), 0);
                end
                else begin
                    if (tile_distance(tile_num(dude_obj), tile_num(self_obj)) > 16) then begin
                        animate_move_obj_to_tile(self_obj, tile_num_in_direction(tile_num(dude_obj), rotation_to_tile(tile_num(dude_obj), tile_num(self_obj)), random(4, 6)), 1);
                    end
                end
            end
        end
    end
    if (not(critter_inven_obj(self_obj, 0)) and (obj_art_fid(self_obj) != 16777226)) then begin
        metarule3(107, self_obj, 16777226, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 113) and (obj_art_fid(self_obj) != 16777246)) then begin
        metarule3(107, self_obj, 16777246, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 114) and (obj_art_fid(self_obj) != 16777312)) then begin
        metarule3(107, self_obj, 16777312, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 115) and (obj_art_fid(self_obj) != 16777244)) then begin
        metarule3(107, self_obj, 16777244, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 116) and (obj_art_fid(self_obj) != 16777244)) then begin
        metarule3(107, self_obj, 16777244, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 117) and (obj_art_fid(self_obj) != 16777240)) then begin
        metarule3(107, self_obj, 16777240, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 118) and (obj_art_fid(self_obj) != 16777277)) then begin
        metarule3(107, self_obj, 16777277, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 119) and (obj_art_fid(self_obj) != 16777250)) then begin
        metarule3(107, self_obj, 16777250, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 120) or (obj_pid(critter_inven_obj(self_obj, 0)) == 121) or (obj_pid(critter_inven_obj(self_obj, 0)) == 122) or (obj_pid(critter_inven_obj(self_obj, 0)) == 123) and (obj_art_fid(self_obj) != 16777248)) then begin
        metarule3(107, self_obj, 16777248, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 124) and (obj_art_fid(self_obj) != 16777252)) then begin
        metarule3(107, self_obj, 16777252, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 125) and (obj_art_fid(self_obj) != 16777253)) then begin
        metarule3(107, self_obj, 16777253, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 126) and (obj_art_fid(self_obj) != 16777253)) then begin
        metarule3(107, self_obj, 16777253, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 127) and (obj_art_fid(self_obj) != 16777254)) then begin
        metarule3(107, self_obj, 16777254, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 128) and (obj_art_fid(self_obj) != 16777256)) then begin
        metarule3(107, self_obj, 16777256, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 129) and (obj_art_fid(self_obj) != 16777255)) then begin
        metarule3(107, self_obj, 16777255, 0);
    end
    if ((obj_pid(critter_inven_obj(self_obj, 0)) == 391) and (obj_art_fid(self_obj) != 16777237)) then begin
        metarule3(107, self_obj, 16777237, 0);
    end
    if (obj_can_see_obj(self_obj, dude_obj)) then begin
        if ((local_var(2) == 1) or (global_var(47) <= -31)) then begin
            set_local_var(2, 0);
            attack_setup(self_obj, dude_obj);
        end
    end
end

procedure combat_p_proc
begin
end

procedure description_p_proc
begin
    script_overrides;
    if (local_var(7) == 0) then begin
        display_msg(message_str(92, 2));
    end
    else begin
        display_msg(message_str(92, 4));
    end
end

procedure look_at_p_proc
begin
    script_overrides;
    if (local_var(7) == 0) then begin
        display_msg(message_str(92, 1));
    end
    else begin
        display_msg(message_str(92, 3));
    end
end

procedure pickup_p_proc
begin
    if (source_obj == dude_obj) then begin
        set_local_var(2, 1);
    end
end

procedure push_p_proc
begin
end

procedure talk_p_proc
begin
    if (not(anim_busy(self_obj))) then begin
        anim(self_obj, 1000, rotation_to_tile(tile_num(self_obj), tile_num(dude_obj)));
    end
    if ((local_var(14) == 1) and not(global_var(6) == 3)) then begin
        float_msg(self_obj, message_str(92, random(1030, 1033)), 0);
    end
    else begin
        if (local_var(13) == 1) then begin
            start_gdialog(92, self_obj, -1, -1, -1);
            gsay_start;
            if (global_var(265) == 1) then begin
                call DialogParty();
            end
            else begin
                if (not(global_var(6) == 3)) then begin
                    call Node001();
                end
                else begin
                    if (not((global_var(69) bwand 1) != 0) and (local_var(7) == 2) and (global_var(122) != 2)) then begin
                        call Node024();
                    end
                    else begin
                        call Node010();
                    end
                end
            end
            gsay_end;
            end_dialogue;
        end
        else begin
            float_msg(self_obj, message_str(92, random(1038, 1039)), 0);
        end
    end
end

procedure destroy_p_proc
begin
    if (global_var(265) == 1) then begin
        set_global_var(265, 0);
    end
    if (source_obj == dude_obj) then begin
        set_global_var(0, global_var(0) - 1);
        if ((47 == 50) or (47 == 59)) then begin
            set_global_var(47, global_var(47) - 3);
        end
        else begin
            set_global_var(47, global_var(47) - 6);
        end
    end
end

procedure use_skill_on_p_proc
begin
    if (action_being_used == 10) then begin
        steal_perk := 0;
        steal_gloves := 0;
        if (has_trait(0, dude_obj, 37) != 0) then begin
            steal_perk := steal_perk + 15;
        end
        if (has_trait(0, dude_obj, 33) != 0) then begin
            steal_perk := steal_perk + 30;
        end
        if ((obj_pid(critter_inven_obj(dude_obj, 1)) == 245) or (obj_pid(critter_inven_obj(dude_obj, 2)) == 245)) then begin
            steal_gloves := 10;
        end
        if (random(0, 100) <= ((has_skill(dude_obj, 10) / 2) + (((3 * get_critter_stat(dude_obj, 5)) + (((get_critter_stat(dude_obj, 6) - 4) * 4) - (difficulty_level * 4)) + (2 * steal_perk) + steal_gloves) / (local_var(4) / 25)))) then begin
            display_msg(message_str(10, random(145, 148)));
        end
        else begin
            script_overrides;
            if (random(0, 100) <= (25 - floor((((get_critter_stat(dude_obj, 6) - 4) * 4) - (difficulty_level * 4)) / 3))) then begin
                float_msg(self_obj, message_str(10, random(206, 209)), 2);
            end
            else begin
                display_msg(message_str(10, random(200, 203)));
            end
        end
    end
    if (action_being_used == 12) then begin
        script_overrides;
        display_msg(message_str(10, 204) + ((has_skill(dude_obj, 10) / 2) + (((3 * get_critter_stat(dude_obj, 5)) + (((get_critter_stat(dude_obj, 6) - 4) * 4) - (difficulty_level * 4)) + (2 * steal_perk) + steal_gloves) / (local_var(4) / 25))) + message_str(10, 205));
    end
end

procedure damage_p_proc
begin
    if (source_obj == dude_obj) then begin
        set_local_var(2, 1);
    end
end

procedure map_enter_p_proc
begin
    if ((days_since_visited >= 2) and (local_var(7) == 1)) then begin
        set_local_var(7, 2);
    end
end

procedure timed_event_p_proc
begin
    if ((fixed_param == 1) and not(combat_is_initialized)) then begin
        animation_is_called := 0;
    end
    if ((fixed_param == 2) and not(combat_is_initialized)) then begin
        float_is_called := 0;
    end
end

procedure Node001
begin
    set_local_var(14, 1);
    gsay_reply(92, message_str(92, 10) + obj_name(dude_obj) + message_str(92, 11));
    gsay_option(92, 12, Node999, 50);
    gsay_option(92, 13, Node999, 50);
end

procedure Node010
begin
    if (global_var(265) == 2) then begin
        gsay_reply(92, 900);
        gsay_option(92, 929, NodeParty, 50);
        gsay_option(92, 919, Node999, 50);
    end
    else begin
        if ((global_var(122) == 2) and not((global_var(69) bwand 1) != 0)) then begin
            gsay_reply(92, 104);
            gsay_option(92, 103, Node999, 50);
            gsay_option(92, 105, Node999, 50);
        end
        else begin
            if ((global_var(69) bwand 1) != 0) then begin
                if (local_var(7) == 3) then begin
                    gsay_reply(92, 223);
                    gsay_option(92, 221, NodeParty, 50);
                    gsay_option(92, 222, Node999, 50);
                end
                else begin
                    gsay_reply(92, 200);
                    gsay_option(92, 201, Node021, 50);
                    gsay_option(92, 202, Node023, 50);
                    gsay_option(92, 203, Node021, 50);
                end
            end
            else begin
                if (local_var(7) == 0) then begin
                    gsay_reply(92, obj_name(dude_obj) + message_str(92, 100));
                    gsay_option(92, 101, Node011, 50);
                    gsay_option(92, 102, Node012, 50);
                    gsay_option(92, 103, Node999, 50);
                end
                if (local_var(7) == 1) then begin
                    gsay_reply(92, 104);
                    gsay_option(92, 105, Node999, 50);
                end
            end
        end
    end
end

procedure Node011
begin
    gsay_reply(92, 110);
    gsay_option(92, 111, Node012, 50);
    gsay_option(92, 112, Node012, 50);
end

procedure Node012
begin
    set_local_var(7, 1);
    gsay_reply(92, 120);
    gsay_option(92, 121, Node999, 50);
    gsay_option(92, 122, Node999, 50);
    gsay_option(92, 123, Node999, 50);
end

procedure Node021
begin
    gsay_reply(92, message_str(92, 210) + obj_name(dude_obj) + message_str(92, 211));
    gsay_option(92, 212, Node0211, 50);
    gsay_option(92, 213, Node0212, 50);
    gsay_option(92, 214, Node999, 50);
end

procedure Node0211
begin
    persuade_mod := random(10, 20);
    call Node022();
end

procedure Node0212
begin
    persuade_mod := random(20, 30);
    call Node022();
end

procedure Node022
begin
    if (random(0, 100) <= (floor((has_skill(dude_obj, 14) + (get_critter_stat(dude_obj, 3) * 10)) / 3) + persuade_mod)) then begin
        set_local_var(7, 3);
        gsay_reply(92, 220);
        gsay_option(92, 221, NodeParty, 50);
        gsay_option(92, 222, Node999, 50);
    end
    else begin
        set_local_var(13, 0);
        gsay_reply(92, 234);
        if (persuade_mod >= 25) then begin
            gsay_option(92, 231, Node0212, 50);
        end
        gsay_option(92, 232, Node999, 50);
        gsay_option(92, 233, Node999, 50);
    end
end

procedure Node023
begin
    gsay_reply(92, 230);
    gsay_option(92, 231, Node0211, 50);
    gsay_option(92, 232, Node999, 50);
    gsay_option(92, 233, Node999, 50);
end

procedure Node024
begin
    gsay_reply(92, 240);
    if (obj_carrying_pid_obj(dude_obj, 335)) then begin
        gsay_option(92, 242, Node999, 50);
    end
    else begin
        gsay_option(92, 241, Node025, 50);
    end
    gsay_option(92, 243, Node999, 50);
end

procedure Node025
begin
    gsay_reply(92, 250);
    gsay_option(92, 251, Node999, 50);
    gsay_option(92, 252, Node999, 50);
end

procedure Node999
begin
    already_talk := 0;
    persuade_mod := 0;
end

procedure NodeParty
begin
    set_local_var(7, 4);
    party_add(self_obj);
    set_global_var(265, 1);
    call DialogParty();
end

procedure DialogParty
begin
    if (already_talk == 0) then begin
        already_talk := 1;
        gsay_reply(92, random(900, 904));
    end
    else begin
        gsay_reply(92, 920);
    end
    if (get_critter_stat(self_obj, 35) < get_critter_stat(self_obj, 7)) then begin
        gsay_option(92, 910, Healing, 50);
    end
    gsay_option(92, 911, Armor, 50);
    gsay_option(92, 912, Weapon, 50);
    gsay_option(92, 913, Distance, 50);
    gsay_option(92, 914, DialogParty2, 50);
    gsay_option(92, 919, Node999, 50);
end

procedure Healing
begin
    if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 3)) then begin
        gsay_reply(92, 930);
    end
    else begin
        if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 2)) then begin
            gsay_reply(92, 931);
        end
        else begin
            if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4)) then begin
                gsay_reply(92, 932);
            end
            else begin
                gsay_reply(92, 933);
            end
        end
    end
    if (obj_carrying_pid_obj(self_obj, 220) or obj_carrying_pid_obj(self_obj, 221) or obj_carrying_pid_obj(self_obj, 222) or obj_carrying_pid_obj(self_obj, 223)) then begin
        gsay_option(92, 940, Healing_self, 50);
    end
    if (obj_carrying_pid_obj(dude_obj, 220)) then begin
        gsay_option(92, message_str(92, 934) + message_str(92, 936) + message_str(92, 935), Healing_dude_binty, 50);
    end
    if (obj_carrying_pid_obj(dude_obj, 221)) then begin
        gsay_option(92, message_str(92, 934) + message_str(92, 937) + message_str(92, 935), Healing_dude_analgetic, 50);
    end
    if (obj_carrying_pid_obj(dude_obj, 222)) then begin
        gsay_option(92, message_str(92, 934) + message_str(92, 938) + message_str(92, 935), Healing_dude_heal_up, 50);
    end
    if (obj_carrying_pid_obj(dude_obj, 223)) then begin
        gsay_option(92, message_str(92, 934) + message_str(92, 939) + message_str(92, 935), Healing_dude_lazareth, 50);
    end
    if (not(obj_carrying_pid_obj(self_obj, 220)) and not(obj_carrying_pid_obj(self_obj, 221)) and not(obj_carrying_pid_obj(self_obj, 222)) and not(obj_carrying_pid_obj(self_obj, 223)) and not(obj_carrying_pid_obj(dude_obj, 220)) and not(obj_carrying_pid_obj(dude_obj, 221)) and not(obj_carrying_pid_obj(dude_obj, 222)) and not(obj_carrying_pid_obj(dude_obj, 223))) then begin
        gsay_option(92, 946, Node999, 50);
    end
    gsay_option(92, 947, DialogParty, 50);
end

procedure Healing_self
begin
    if (obj_carrying_pid_obj(self_obj, 223)) then begin
        use_obj_on_obj(obj_carrying_pid_obj(self_obj, 223), self_obj);
    end
    else begin
        if (obj_carrying_pid_obj(self_obj, 222)) then begin
            use_obj_on_obj(obj_carrying_pid_obj(self_obj, 222), self_obj);
        end
        else begin
            if (obj_carrying_pid_obj(self_obj, 221)) then begin
                use_obj_on_obj(obj_carrying_pid_obj(self_obj, 221), self_obj);
            end
            else begin
                use_obj_on_obj(obj_carrying_pid_obj(self_obj, 220), self_obj);
            end
        end
    end
    gsay_reply(92, 941);
    gsay_option(92, 918, DialogParty, 50);
end

procedure Healing_dude_binty
begin
    rm_obj_from_inven(dude_obj, obj_carrying_pid_obj(dude_obj, 220));
    add_obj_to_inven(self_obj, create_object_sid(220, 1, 2, -1));
    use_obj_on_obj(obj_carrying_pid_obj(self_obj, 220), self_obj);
    if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 3)) then begin
        gsay_reply(92, 942);
    end
    else begin
        if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 2)) then begin
            gsay_reply(92, 943);
        end
        else begin
            if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4)) then begin
                gsay_reply(92, 944);
            end
            else begin
                gsay_reply(92, 945);
            end
        end
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Healing_dude_analgetic
begin
    rm_obj_from_inven(dude_obj, obj_carrying_pid_obj(dude_obj, 221));
    add_obj_to_inven(self_obj, create_object_sid(221, 1, 2, -1));
    use_obj_on_obj(obj_carrying_pid_obj(self_obj, 221), self_obj);
    if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 3)) then begin
        gsay_reply(92, 942);
    end
    else begin
        if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 2)) then begin
            gsay_reply(92, 943);
        end
        else begin
            if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4)) then begin
                gsay_reply(92, 944);
            end
            else begin
                gsay_reply(92, 945);
            end
        end
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Healing_dude_heal_up
begin
    rm_obj_from_inven(dude_obj, obj_carrying_pid_obj(dude_obj, 222));
    add_obj_to_inven(self_obj, create_object_sid(222, 1, 2, -1));
    use_obj_on_obj(obj_carrying_pid_obj(self_obj, 222), self_obj);
    if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 3)) then begin
        gsay_reply(92, 942);
    end
    else begin
        if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 2)) then begin
            gsay_reply(92, 943);
        end
        else begin
            if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4)) then begin
                gsay_reply(92, 944);
            end
            else begin
                gsay_reply(92, 945);
            end
        end
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Healing_dude_lazareth
begin
    rm_obj_from_inven(dude_obj, obj_carrying_pid_obj(dude_obj, 223));
    add_obj_to_inven(self_obj, create_object_sid(223, 1, 2, -1));
    use_obj_on_obj(obj_carrying_pid_obj(self_obj, 223), self_obj);
    if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 3)) then begin
        gsay_reply(92, 942);
    end
    else begin
        if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4 * 2)) then begin
            gsay_reply(92, 943);
        end
        else begin
            if (get_critter_stat(self_obj, 35) >= (get_critter_stat(self_obj, 7) / 4)) then begin
                gsay_reply(92, 944);
            end
            else begin
                gsay_reply(92, 945);
            end
        end
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Armor
begin
    if (critter_inven_obj(self_obj, 0) == 114) then begin
        gsay_reply(92, random(948, 949));
    end
    else begin
        gsay_reply(92, random(949, 950));
    end
    if (critter_inven_obj(self_obj, 0) != 0) then begin
        gsay_option(92, 951, Remove_armor, 50);
    end
    gsay_option(92, random(952, 955), New_armor, 50);
    gsay_option(92, 918, DialogParty, 50);
end

procedure Remove_armor
begin
    variable LVar0 := 0;
    if (critter_inven_obj(self_obj, 0) == 114) then begin
        if ((has_skill(dude_obj, 14) * get_critter_stat(dude_obj, 3)) < 360) then begin
            gsay_reply(92, random(907, 909));
            gsay_option(92, 956, Remove_Aviator, 50);
            gsay_option(92, 957, Node999, 50);
        end
        else begin
            LVar0 := critter_inven_obj(self_obj, 0);
            rm_obj_from_inven(self_obj, LVar0);
            add_obj_to_inven(self_obj, LVar0);
            gsay_reply(92, random(905, 906));
            gsay_option(92, 918, DialogParty, 50);
        end
    end
    else begin
        LVar0 := critter_inven_obj(self_obj, 0);
        rm_obj_from_inven(self_obj, LVar0);
        add_obj_to_inven(self_obj, LVar0);
        gsay_reply(92, random(905, 906));
        gsay_option(92, 918, DialogParty, 50);
    end
end

procedure Remove_Aviator
begin
    variable LVar0 := 0;
    if ((has_skill(dude_obj, 14) * get_critter_stat(dude_obj, 3)) < 300) then begin
        gsay_reply(92, 958);
        gsay_option(92, 957, DialogParty, 50);
    end
    else begin
        LVar0 := critter_inven_obj(self_obj, 0);
        rm_obj_from_inven(self_obj, LVar0);
        add_obj_to_inven(self_obj, LVar0);
        gsay_reply(92, 959);
        gsay_option(92, 918, DialogParty, 50);
    end
end

procedure New_armor
begin
    variable LVar0 := 1;
    if (obj_carrying_pid_obj(self_obj, 114)) then begin
        wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 114));
    end
    else begin
        if (obj_carrying_pid_obj(self_obj, 129)) then begin
            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 129));
        end
        else begin
            if (obj_carrying_pid_obj(self_obj, 128)) then begin
                wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 128));
            end
            else begin
                if (obj_carrying_pid_obj(self_obj, 127)) then begin
                    wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 127));
                end
                else begin
                    if (obj_carrying_pid_obj(self_obj, 126)) then begin
                        wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 126));
                    end
                    else begin
                        if (obj_carrying_pid_obj(self_obj, 125)) then begin
                            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 125));
                        end
                        else begin
                            if (obj_carrying_pid_obj(self_obj, 122)) then begin
                                wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 122));
                            end
                            else begin
                                if (obj_carrying_pid_obj(self_obj, 124)) then begin
                                    wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 124));
                                end
                                else begin
                                    if (obj_carrying_pid_obj(self_obj, 121)) then begin
                                        wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 121));
                                    end
                                    else begin
                                        if (obj_carrying_pid_obj(self_obj, 120)) then begin
                                            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 120));
                                        end
                                        else begin
                                            if (obj_carrying_pid_obj(self_obj, 119)) then begin
                                                wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 119));
                                            end
                                            else begin
                                                if (obj_carrying_pid_obj(self_obj, 118)) then begin
                                                    wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 118));
                                                end
                                                else begin
                                                    if (obj_carrying_pid_obj(self_obj, 117)) then begin
                                                        wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 117));
                                                    end
                                                    else begin
                                                        if (obj_carrying_pid_obj(self_obj, 116)) then begin
                                                            wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 116));
                                                        end
                                                        else begin
                                                            if (obj_carrying_pid_obj(self_obj, 115)) then begin
                                                                wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 115));
                                                            end
                                                            else begin
                                                                if (obj_carrying_pid_obj(self_obj, 123)) then begin
                                                                    wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 123));
                                                                end
                                                                else begin
                                                                    if (obj_carrying_pid_obj(self_obj, 113)) then begin
                                                                        wield_obj_critter(self_obj, obj_carrying_pid_obj(self_obj, 113));
                                                                    end
                                                                    else begin
                                                                        LVar0 := 0;
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    if (LVar0 == 1) then begin
        gsay_reply(92, random(905, 906));
    end
    else begin
        gsay_reply(92, 921);
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Weapon
begin
    gsay_reply(92, random(960, 961));
    if ((critter_inven_obj(self_obj, 1) != 0) or (critter_inven_obj(self_obj, 2) != 0)) then begin
        gsay_option(92, 962, Remove_Weapon, 50);
    end
    gsay_option(92, 963, Weapon_melee, 50);
    gsay_option(92, 964, Weapon_throw, 50);
    gsay_option(92, 965, Weapon_shoot, 50);
    gsay_option(92, 966, Weapon_expl, 50);
    gsay_option(92, 967, Weapon_best, 50);
    gsay_option(92, 918, DialogParty, 50);
end

procedure Remove_Weapon
begin
    metarule(43, self_obj);
    gsay_reply(92, random(905, 906));
    gsay_option(92, 918, DialogParty, 50);
end

procedure Weapon_melee
begin
    variable LVar0 := 0;
    if (obj_carrying_pid_obj(self_obj, 60) != 0) then begin
        LVar0 := obj_carrying_pid_obj(self_obj, 60);
    end
    else begin
        if (obj_carrying_pid_obj(self_obj, 87) != 0) then begin
            LVar0 := obj_carrying_pid_obj(self_obj, 87);
        end
        else begin
            if (obj_carrying_pid_obj(self_obj, 103) != 0) then begin
                LVar0 := obj_carrying_pid_obj(self_obj, 103);
            end
            else begin
                if (obj_carrying_pid_obj(self_obj, 40) != 0) then begin
                    LVar0 := obj_carrying_pid_obj(self_obj, 40);
                end
                else begin
                    if (obj_carrying_pid_obj(self_obj, 90) != 0) then begin
                        LVar0 := obj_carrying_pid_obj(self_obj, 90);
                    end
                    else begin
                        if (obj_carrying_pid_obj(self_obj, 61) != 0) then begin
                            LVar0 := obj_carrying_pid_obj(self_obj, 61);
                        end
                        else begin
                            if (obj_carrying_pid_obj(self_obj, 107) != 0) then begin
                                LVar0 := obj_carrying_pid_obj(self_obj, 107);
                            end
                            else begin
                                if (obj_carrying_pid_obj(self_obj, 68) != 0) then begin
                                    LVar0 := obj_carrying_pid_obj(self_obj, 68);
                                end
                                else begin
                                    if (obj_carrying_pid_obj(self_obj, 88) != 0) then begin
                                        LVar0 := obj_carrying_pid_obj(self_obj, 88);
                                    end
                                    else begin
                                        if (obj_carrying_pid_obj(self_obj, 66) != 0) then begin
                                            LVar0 := obj_carrying_pid_obj(self_obj, 66);
                                        end
                                        else begin
                                            if (obj_carrying_pid_obj(self_obj, 34) != 0) then begin
                                                LVar0 := obj_carrying_pid_obj(self_obj, 34);
                                            end
                                            else begin
                                                if (obj_carrying_pid_obj(self_obj, 37) != 0) then begin
                                                    LVar0 := obj_carrying_pid_obj(self_obj, 37);
                                                end
                                                else begin
                                                    if (obj_carrying_pid_obj(self_obj, 106) != 0) then begin
                                                        LVar0 := obj_carrying_pid_obj(self_obj, 106);
                                                    end
                                                    else begin
                                                        if (obj_carrying_pid_obj(self_obj, 109) != 0) then begin
                                                            LVar0 := obj_carrying_pid_obj(self_obj, 109);
                                                        end
                                                        else begin
                                                            if (obj_carrying_pid_obj(self_obj, 112) != 0) then begin
                                                                LVar0 := obj_carrying_pid_obj(self_obj, 112);
                                                            end
                                                            else begin
                                                                if (obj_carrying_pid_obj(self_obj, 38) != 0) then begin
                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 38);
                                                                end
                                                                else begin
                                                                    if (obj_carrying_pid_obj(self_obj, 39) != 0) then begin
                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 39);
                                                                    end
                                                                    else begin
                                                                        if (obj_carrying_pid_obj(self_obj, 67) != 0) then begin
                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 67);
                                                                        end
                                                                        else begin
                                                                            if (obj_carrying_pid_obj(self_obj, 111) != 0) then begin
                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 111);
                                                                            end
                                                                            else begin
                                                                                if (obj_carrying_pid_obj(self_obj, 64) != 0) then begin
                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 64);
                                                                                end
                                                                                else begin
                                                                                    if (obj_carrying_pid_obj(self_obj, 89) != 0) then begin
                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 89);
                                                                                    end
                                                                                    else begin
                                                                                        if (obj_carrying_pid_obj(self_obj, 36) != 0) then begin
                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 36);
                                                                                        end
                                                                                        else begin
                                                                                            if (obj_carrying_pid_obj(self_obj, 108) != 0) then begin
                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 108);
                                                                                            end
                                                                                            else begin
                                                                                                if (obj_carrying_pid_obj(self_obj, 110) != 0) then begin
                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 110);
                                                                                                end
                                                                                                else begin
                                                                                                    if (obj_carrying_pid_obj(self_obj, 35) != 0) then begin
                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 35);
                                                                                                    end
                                                                                                    else begin
                                                                                                        if (obj_carrying_pid_obj(self_obj, 65) != 0) then begin
                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 65);
                                                                                                        end
                                                                                                    end
                                                                                                end
                                                                                            end
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    if (LVar0 != 0) then begin
        wield_obj_critter(self_obj, LVar0);
        gsay_reply(92, message_str(92, 968) + obj_name(LVar0) + message_str(92, 969));
    end
    else begin
        gsay_reply(92, 922);
        gsay_option(92, 923, Weapon, 50);
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Weapon_throw
begin
    variable LVar0 := 0;
    if (obj_carrying_pid_obj(self_obj, 217) != 0) then begin
        LVar0 := obj_carrying_pid_obj(self_obj, 217);
    end
    else begin
        if (obj_carrying_pid_obj(self_obj, 62) != 0) then begin
            LVar0 := obj_carrying_pid_obj(self_obj, 62);
        end
        else begin
            if (obj_carrying_pid_obj(self_obj, 63) != 0) then begin
                LVar0 := obj_carrying_pid_obj(self_obj, 63);
            end
            else begin
                if (obj_carrying_pid_obj(self_obj, 218) != 0) then begin
                    LVar0 := obj_carrying_pid_obj(self_obj, 218);
                end
                else begin
                    if (obj_carrying_pid_obj(self_obj, 213) != 0) then begin
                        LVar0 := obj_carrying_pid_obj(self_obj, 213);
                    end
                end
            end
        end
    end
    if (LVar0 != 0) then begin
        wield_obj_critter(self_obj, LVar0);
        gsay_reply(92, message_str(92, 968) + obj_name(LVar0) + message_str(92, 969));
    end
    else begin
        gsay_reply(92, 922);
        gsay_option(92, 923, Weapon, 50);
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Weapon_shoot
begin
    variable LVar0 := 0;
    if (obj_carrying_pid_obj(self_obj, 181) != 0) then begin
        LVar0 := obj_carrying_pid_obj(self_obj, 181);
    end
    else begin
        if (obj_carrying_pid_obj(self_obj, 173) != 0) then begin
            LVar0 := obj_carrying_pid_obj(self_obj, 173);
        end
        else begin
            if (obj_carrying_pid_obj(self_obj, 144) != 0) then begin
                LVar0 := obj_carrying_pid_obj(self_obj, 144);
            end
            else begin
                if (obj_carrying_pid_obj(self_obj, 174) != 0) then begin
                    LVar0 := obj_carrying_pid_obj(self_obj, 174);
                end
                else begin
                    if (obj_carrying_pid_obj(self_obj, 171) != 0) then begin
                        LVar0 := obj_carrying_pid_obj(self_obj, 171);
                    end
                    else begin
                        if (obj_carrying_pid_obj(self_obj, 154) != 0) then begin
                            LVar0 := obj_carrying_pid_obj(self_obj, 154);
                        end
                        else begin
                            if (obj_carrying_pid_obj(self_obj, 156) != 0) then begin
                                LVar0 := obj_carrying_pid_obj(self_obj, 156);
                            end
                            else begin
                                if (obj_carrying_pid_obj(self_obj, 162) != 0) then begin
                                    LVar0 := obj_carrying_pid_obj(self_obj, 162);
                                end
                                else begin
                                    if (obj_carrying_pid_obj(self_obj, 170) != 0) then begin
                                        LVar0 := obj_carrying_pid_obj(self_obj, 170);
                                    end
                                    else begin
                                        if (obj_carrying_pid_obj(self_obj, 151) != 0) then begin
                                            LVar0 := obj_carrying_pid_obj(self_obj, 151);
                                        end
                                        else begin
                                            if (obj_carrying_pid_obj(self_obj, 168) != 0) then begin
                                                LVar0 := obj_carrying_pid_obj(self_obj, 168);
                                            end
                                            else begin
                                                if (obj_carrying_pid_obj(self_obj, 169) != 0) then begin
                                                    LVar0 := obj_carrying_pid_obj(self_obj, 169);
                                                end
                                                else begin
                                                    if (obj_carrying_pid_obj(self_obj, 153) != 0) then begin
                                                        LVar0 := obj_carrying_pid_obj(self_obj, 153);
                                                    end
                                                    else begin
                                                        if (obj_carrying_pid_obj(self_obj, 142) != 0) then begin
                                                            LVar0 := obj_carrying_pid_obj(self_obj, 142);
                                                        end
                                                        else begin
                                                            if (obj_carrying_pid_obj(self_obj, 130) != 0) then begin
                                                                LVar0 := obj_carrying_pid_obj(self_obj, 130);
                                                            end
                                                            else begin
                                                                if (obj_carrying_pid_obj(self_obj, 152) != 0) then begin
                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 152);
                                                                end
                                                                else begin
                                                                    if (obj_carrying_pid_obj(self_obj, 155) != 0) then begin
                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 155);
                                                                    end
                                                                    else begin
                                                                        if (obj_carrying_pid_obj(self_obj, 177) != 0) then begin
                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 177);
                                                                        end
                                                                        else begin
                                                                            if (obj_carrying_pid_obj(self_obj, 161) != 0) then begin
                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 161);
                                                                            end
                                                                            else begin
                                                                                if (obj_carrying_pid_obj(self_obj, 160) != 0) then begin
                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 160);
                                                                                end
                                                                                else begin
                                                                                    if (obj_carrying_pid_obj(self_obj, 178) != 0) then begin
                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 178);
                                                                                    end
                                                                                    else begin
                                                                                        if (obj_carrying_pid_obj(self_obj, 189) != 0) then begin
                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 189);
                                                                                        end
                                                                                        else begin
                                                                                            if (obj_carrying_pid_obj(self_obj, 180) != 0) then begin
                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 180);
                                                                                            end
                                                                                            else begin
                                                                                                if (obj_carrying_pid_obj(self_obj, 176) != 0) then begin
                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 176);
                                                                                                end
                                                                                                else begin
                                                                                                    if (obj_carrying_pid_obj(self_obj, 133) != 0) then begin
                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 133);
                                                                                                    end
                                                                                                    else begin
                                                                                                        if (obj_carrying_pid_obj(self_obj, 148) != 0) then begin
                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 148);
                                                                                                        end
                                                                                                        else begin
                                                                                                            if (obj_carrying_pid_obj(self_obj, 165) != 0) then begin
                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 165);
                                                                                                            end
                                                                                                            else begin
                                                                                                                if (obj_carrying_pid_obj(self_obj, 167) != 0) then begin
                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 167);
                                                                                                                end
                                                                                                                else begin
                                                                                                                    if (obj_carrying_pid_obj(self_obj, 149) != 0) then begin
                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 149);
                                                                                                                    end
                                                                                                                    else begin
                                                                                                                        if (obj_carrying_pid_obj(self_obj, 175) != 0) then begin
                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 175);
                                                                                                                        end
                                                                                                                        else begin
                                                                                                                            if (obj_carrying_pid_obj(self_obj, 164) != 0) then begin
                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 164);
                                                                                                                            end
                                                                                                                            else begin
                                                                                                                                if (obj_carrying_pid_obj(self_obj, 137) != 0) then begin
                                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 137);
                                                                                                                                end
                                                                                                                                else begin
                                                                                                                                    if (obj_carrying_pid_obj(self_obj, 150) != 0) then begin
                                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 150);
                                                                                                                                    end
                                                                                                                                    else begin
                                                                                                                                        if (obj_carrying_pid_obj(self_obj, 131) != 0) then begin
                                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 131);
                                                                                                                                        end
                                                                                                                                        else begin
                                                                                                                                            if (obj_carrying_pid_obj(self_obj, 172) != 0) then begin
                                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 172);
                                                                                                                                            end
                                                                                                                                            else begin
                                                                                                                                                if (obj_carrying_pid_obj(self_obj, 166) != 0) then begin
                                                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 166);
                                                                                                                                                end
                                                                                                                                                else begin
                                                                                                                                                    if (obj_carrying_pid_obj(self_obj, 163) != 0) then begin
                                                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 163);
                                                                                                                                                    end
                                                                                                                                                    else begin
                                                                                                                                                        if (obj_carrying_pid_obj(self_obj, 159) != 0) then begin
                                                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 159);
                                                                                                                                                        end
                                                                                                                                                        else begin
                                                                                                                                                            if (obj_carrying_pid_obj(self_obj, 140) != 0) then begin
                                                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 140);
                                                                                                                                                            end
                                                                                                                                                            else begin
                                                                                                                                                                if (obj_carrying_pid_obj(self_obj, 143) != 0) then begin
                                                                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 143);
                                                                                                                                                                end
                                                                                                                                                                else begin
                                                                                                                                                                    if (obj_carrying_pid_obj(self_obj, 132) != 0) then begin
                                                                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 132);
                                                                                                                                                                    end
                                                                                                                                                                    else begin
                                                                                                                                                                        if (obj_carrying_pid_obj(self_obj, 179) != 0) then begin
                                                                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 179);
                                                                                                                                                                        end
                                                                                                                                                                        else begin
                                                                                                                                                                            if (obj_carrying_pid_obj(self_obj, 141) != 0) then begin
                                                                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 141);
                                                                                                                                                                            end
                                                                                                                                                                            else begin
                                                                                                                                                                                if (obj_carrying_pid_obj(self_obj, 136) != 0) then begin
                                                                                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 136);
                                                                                                                                                                                end
                                                                                                                                                                                else begin
                                                                                                                                                                                    if (obj_carrying_pid_obj(self_obj, 187) != 0) then begin
                                                                                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 187);
                                                                                                                                                                                    end
                                                                                                                                                                                    else begin
                                                                                                                                                                                        if (obj_carrying_pid_obj(self_obj, 188) != 0) then begin
                                                                                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 188);
                                                                                                                                                                                        end
                                                                                                                                                                                        else begin
                                                                                                                                                                                            if (obj_carrying_pid_obj(self_obj, 186) != 0) then begin
                                                                                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 186);
                                                                                                                                                                                            end
                                                                                                                                                                                            else begin
                                                                                                                                                                                                if (obj_carrying_pid_obj(self_obj, 147) != 0) then begin
                                                                                                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 147);
                                                                                                                                                                                                end
                                                                                                                                                                                                else begin
                                                                                                                                                                                                    if (obj_carrying_pid_obj(self_obj, 138) != 0) then begin
                                                                                                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 138);
                                                                                                                                                                                                    end
                                                                                                                                                                                                    else begin
                                                                                                                                                                                                        if (obj_carrying_pid_obj(self_obj, 139) != 0) then begin
                                                                                                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 139);
                                                                                                                                                                                                        end
                                                                                                                                                                                                        else begin
                                                                                                                                                                                                            if (obj_carrying_pid_obj(self_obj, 146) != 0) then begin
                                                                                                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 146);
                                                                                                                                                                                                            end
                                                                                                                                                                                                        end
                                                                                                                                                                                                    end
                                                                                                                                                                                                end
                                                                                                                                                                                            end
                                                                                                                                                                                        end
                                                                                                                                                                                    end
                                                                                                                                                                                end
                                                                                                                                                                            end
                                                                                                                                                                        end
                                                                                                                                                                    end
                                                                                                                                                                end
                                                                                                                                                            end
                                                                                                                                                        end
                                                                                                                                                    end
                                                                                                                                                end
                                                                                                                                            end
                                                                                                                                        end
                                                                                                                                    end
                                                                                                                                end
                                                                                                                            end
                                                                                                                        end
                                                                                                                    end
                                                                                                                end
                                                                                                            end
                                                                                                        end
                                                                                                    end
                                                                                                end
                                                                                            end
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    if (LVar0 != 0) then begin
        wield_obj_critter(self_obj, LVar0);
        gsay_reply(92, message_str(92, 968) + obj_name(LVar0) + message_str(92, 969));
    end
    else begin
        gsay_reply(92, 922);
        gsay_option(92, 923, Weapon, 50);
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Weapon_expl
begin
    variable LVar0 := 0;
    if (obj_carrying_pid_obj(self_obj, 196) != 0) then begin
        LVar0 := obj_carrying_pid_obj(self_obj, 196);
    end
    else begin
        if (obj_carrying_pid_obj(self_obj, 198) != 0) then begin
            LVar0 := obj_carrying_pid_obj(self_obj, 198);
        end
        else begin
            if (obj_carrying_pid_obj(self_obj, 135) != 0) then begin
                LVar0 := obj_carrying_pid_obj(self_obj, 135);
            end
            else begin
                if (obj_carrying_pid_obj(self_obj, 184) != 0) then begin
                    LVar0 := obj_carrying_pid_obj(self_obj, 184);
                end
                else begin
                    if (obj_carrying_pid_obj(self_obj, 183) != 0) then begin
                        LVar0 := obj_carrying_pid_obj(self_obj, 183);
                    end
                    else begin
                        if (obj_carrying_pid_obj(self_obj, 199) != 0) then begin
                            LVar0 := obj_carrying_pid_obj(self_obj, 199);
                        end
                        else begin
                            if (obj_carrying_pid_obj(self_obj, 197) != 0) then begin
                                LVar0 := obj_carrying_pid_obj(self_obj, 197);
                            end
                            else begin
                                if (obj_carrying_pid_obj(self_obj, 216) != 0) then begin
                                    LVar0 := obj_carrying_pid_obj(self_obj, 216);
                                end
                                else begin
                                    if (obj_carrying_pid_obj(self_obj, 215) != 0) then begin
                                        LVar0 := obj_carrying_pid_obj(self_obj, 215);
                                    end
                                    else begin
                                        if (obj_carrying_pid_obj(self_obj, 212) != 0) then begin
                                            LVar0 := obj_carrying_pid_obj(self_obj, 212);
                                        end
                                        else begin
                                            if (obj_carrying_pid_obj(self_obj, 219) != 0) then begin
                                                LVar0 := obj_carrying_pid_obj(self_obj, 219);
                                            end
                                            else begin
                                                if (obj_carrying_pid_obj(self_obj, 214) != 0) then begin
                                                    LVar0 := obj_carrying_pid_obj(self_obj, 214);
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    if (LVar0 != 0) then begin
        wield_obj_critter(self_obj, LVar0);
        gsay_reply(92, message_str(92, 968) + obj_name(LVar0) + message_str(92, 969));
    end
    else begin
        gsay_reply(92, 922);
        gsay_option(92, 923, Weapon, 50);
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Weapon_best
begin
    variable LVar0 := 0;
    if (obj_carrying_pid_obj(self_obj, 93) != 0) then begin
        LVar0 := obj_carrying_pid_obj(self_obj, 93);
    end
    else begin
        if (obj_carrying_pid_obj(self_obj, 192) != 0) then begin
            LVar0 := obj_carrying_pid_obj(self_obj, 192);
        end
        else begin
            if (obj_carrying_pid_obj(self_obj, 94) != 0) then begin
                LVar0 := obj_carrying_pid_obj(self_obj, 94);
            end
            else begin
                if (obj_carrying_pid_obj(self_obj, 196) != 0) then begin
                    LVar0 := obj_carrying_pid_obj(self_obj, 196);
                end
                else begin
                    if (obj_carrying_pid_obj(self_obj, 100) != 0) then begin
                        LVar0 := obj_carrying_pid_obj(self_obj, 100);
                    end
                    else begin
                        if (obj_carrying_pid_obj(self_obj, 198) != 0) then begin
                            LVar0 := obj_carrying_pid_obj(self_obj, 198);
                        end
                        else begin
                            if (obj_carrying_pid_obj(self_obj, 95) != 0) then begin
                                LVar0 := obj_carrying_pid_obj(self_obj, 95);
                            end
                            else begin
                                if (obj_carrying_pid_obj(self_obj, 191) != 0) then begin
                                    LVar0 := obj_carrying_pid_obj(self_obj, 191);
                                end
                                else begin
                                    if (obj_carrying_pid_obj(self_obj, 101) != 0) then begin
                                        LVar0 := obj_carrying_pid_obj(self_obj, 101);
                                    end
                                    else begin
                                        if (obj_carrying_pid_obj(self_obj, 99) != 0) then begin
                                            LVar0 := obj_carrying_pid_obj(self_obj, 99);
                                        end
                                        else begin
                                            if (obj_carrying_pid_obj(self_obj, 181) != 0) then begin
                                                LVar0 := obj_carrying_pid_obj(self_obj, 181);
                                            end
                                            else begin
                                                if (obj_carrying_pid_obj(self_obj, 92) != 0) then begin
                                                    LVar0 := obj_carrying_pid_obj(self_obj, 92);
                                                end
                                                else begin
                                                    if (obj_carrying_pid_obj(self_obj, 135) != 0) then begin
                                                        LVar0 := obj_carrying_pid_obj(self_obj, 135);
                                                    end
                                                    else begin
                                                        if (obj_carrying_pid_obj(self_obj, 173) != 0) then begin
                                                            LVar0 := obj_carrying_pid_obj(self_obj, 173);
                                                        end
                                                        else begin
                                                            if (obj_carrying_pid_obj(self_obj, 144) != 0) then begin
                                                                LVar0 := obj_carrying_pid_obj(self_obj, 144);
                                                            end
                                                            else begin
                                                                if (obj_carrying_pid_obj(self_obj, 194) != 0) then begin
                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 194);
                                                                end
                                                                else begin
                                                                    if (obj_carrying_pid_obj(self_obj, 193) != 0) then begin
                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 193);
                                                                    end
                                                                    else begin
                                                                        if (obj_carrying_pid_obj(self_obj, 184) != 0) then begin
                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 184);
                                                                        end
                                                                        else begin
                                                                            if (obj_carrying_pid_obj(self_obj, 1) != 0) then begin
                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 1);
                                                                            end
                                                                            else begin
                                                                                if (obj_carrying_pid_obj(self_obj, 138) != 0) then begin
                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 138);
                                                                                end
                                                                                else begin
                                                                                    if (obj_carrying_pid_obj(self_obj, 164) != 0) then begin
                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 164);
                                                                                    end
                                                                                    else begin
                                                                                        if (obj_carrying_pid_obj(self_obj, 186) != 0) then begin
                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 186);
                                                                                        end
                                                                                        else begin
                                                                                            if (obj_carrying_pid_obj(self_obj, 151) != 0) then begin
                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 151);
                                                                                            end
                                                                                            else begin
                                                                                                if (obj_carrying_pid_obj(self_obj, 39) != 0) then begin
                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 39);
                                                                                                end
                                                                                                else begin
                                                                                                    if (obj_carrying_pid_obj(self_obj, 190) != 0) then begin
                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 190);
                                                                                                    end
                                                                                                    else begin
                                                                                                        if (obj_carrying_pid_obj(self_obj, 67) != 0) then begin
                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 67);
                                                                                                        end
                                                                                                        else begin
                                                                                                            if (obj_carrying_pid_obj(self_obj, 111) != 0) then begin
                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 111);
                                                                                                            end
                                                                                                            else begin
                                                                                                                if (obj_carrying_pid_obj(self_obj, 147) != 0) then begin
                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 147);
                                                                                                                end
                                                                                                                else begin
                                                                                                                    if (obj_carrying_pid_obj(self_obj, 139) != 0) then begin
                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 139);
                                                                                                                    end
                                                                                                                    else begin
                                                                                                                        if (obj_carrying_pid_obj(self_obj, 150) != 0) then begin
                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 150);
                                                                                                                        end
                                                                                                                        else begin
                                                                                                                            if (obj_carrying_pid_obj(self_obj, 64) != 0) then begin
                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 64);
                                                                                                                            end
                                                                                                                            else begin
                                                                                                                                if (obj_carrying_pid_obj(self_obj, 70) != 0) then begin
                                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 70);
                                                                                                                                end
                                                                                                                                else begin
                                                                                                                                    if (obj_carrying_pid_obj(self_obj, 89) != 0) then begin
                                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 89);
                                                                                                                                    end
                                                                                                                                    else begin
                                                                                                                                        if (obj_carrying_pid_obj(self_obj, 36) != 0) then begin
                                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 36);
                                                                                                                                        end
                                                                                                                                        else begin
                                                                                                                                            if (obj_carrying_pid_obj(self_obj, 108) != 0) then begin
                                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 108);
                                                                                                                                            end
                                                                                                                                            else begin
                                                                                                                                                if (obj_carrying_pid_obj(self_obj, 63) != 0) then begin
                                                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 63);
                                                                                                                                                end
                                                                                                                                                else begin
                                                                                                                                                    if (obj_carrying_pid_obj(self_obj, 110) != 0) then begin
                                                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 110);
                                                                                                                                                    end
                                                                                                                                                    else begin
                                                                                                                                                        if (obj_carrying_pid_obj(self_obj, 35) != 0) then begin
                                                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 35);
                                                                                                                                                        end
                                                                                                                                                        else begin
                                                                                                                                                            if (obj_carrying_pid_obj(self_obj, 65) != 0) then begin
                                                                                                                                                                LVar0 := obj_carrying_pid_obj(self_obj, 65);
                                                                                                                                                            end
                                                                                                                                                            else begin
                                                                                                                                                                if (obj_carrying_pid_obj(self_obj, 146) != 0) then begin
                                                                                                                                                                    LVar0 := obj_carrying_pid_obj(self_obj, 146);
                                                                                                                                                                end
                                                                                                                                                                else begin
                                                                                                                                                                    if (obj_carrying_pid_obj(self_obj, 213) != 0) then begin
                                                                                                                                                                        LVar0 := obj_carrying_pid_obj(self_obj, 213);
                                                                                                                                                                    end
                                                                                                                                                                    else begin
                                                                                                                                                                        if (obj_carrying_pid_obj(self_obj, 218) != 0) then begin
                                                                                                                                                                            LVar0 := obj_carrying_pid_obj(self_obj, 218);
                                                                                                                                                                        end
                                                                                                                                                                    end
                                                                                                                                                                end
                                                                                                                                                            end
                                                                                                                                                        end
                                                                                                                                                    end
                                                                                                                                                end
                                                                                                                                            end
                                                                                                                                        end
                                                                                                                                    end
                                                                                                                                end
                                                                                                                            end
                                                                                                                        end
                                                                                                                    end
                                                                                                                end
                                                                                                            end
                                                                                                        end
                                                                                                    end
                                                                                                end
                                                                                            end
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    if (LVar0 != 0) then begin
        wield_obj_critter(self_obj, LVar0);
        gsay_reply(92, message_str(92, 968) + obj_name(LVar0) + message_str(92, 969));
    end
    else begin
        gsay_reply(92, 922);
        gsay_option(92, 923, Weapon, 50);
    end
    gsay_option(92, 918, DialogParty, 50);
end

procedure Distance
begin
    gsay_reply(92, random(970, 971));
    gsay_option(92, 972, DistanceClose, 50);
    gsay_option(92, 973, DistanceMedium, 50);
    gsay_option(92, 974, DistanceFar, 50);
    gsay_option(92, 918, DialogParty, 50);
end

procedure DistanceClose
begin
    set_local_var(11, 0);
    gsay_reply(92, random(905, 906));
    gsay_option(92, 918, DialogParty, 50);
end

procedure DistanceMedium
begin
    set_local_var(11, 1);
    gsay_reply(92, random(905, 906));
    gsay_option(92, 918, DialogParty, 50);
end

procedure DistanceFar
begin
    set_local_var(11, 2);
    gsay_reply(92, random(905, 906));
    gsay_option(92, 918, DialogParty, 50);
end

procedure DialogParty2
begin
    gsay_reply(92, 920);
    gsay_option(92, 915, AboutThisPlace, 50);
    gsay_option(92, 916, NewIdeas, 50);
    gsay_option(92, 917, BeforeCombat, 50);
    gsay_option(92, 924, Waiting, 50);
    gsay_option(92, 919, Node999, 50);
end

procedure AboutThisPlace
begin
end

procedure NewIdeas
begin
end

procedure BeforeCombat
begin
end

procedure Waiting
begin
    party_remove(self_obj);
    set_global_var(265, 2);
    gsay_reply(92, 925);
    gsay_option(92, 926, Node999, 50);
    gsay_option(92, 927, Node999, 50);
    gsay_option(92, 928, Node999, 50);
end

