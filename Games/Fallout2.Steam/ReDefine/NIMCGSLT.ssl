variable ProtoOfItemGiven;
variable ValueOfRollCheck := 1;
variable Scenery_Creation;
variable Scenery_Creation_Hex;
variable Scenery_Creation_Count;
variable Temp_Scenery_Creation_Hex;
variable Scenery_Creation_Ptr;
variable How_Many_Party_Members_Are_Injured;
variable How_Many_Party_Members_Armed;
variable PartyHealingItem;

procedure checkPartyMembersNearDoor;

variable global_temp;
variable dest_tile;
variable step_tile;
variable in_dialog;
variable forced_node;
variable restock_amt;
variable restock_obj;
variable restock_trash;
variable removed_qty;
variable last_timed_obj;
variable last_timed_param;
variable check_still_kill;
variable stored_msg;
variable stored_node;
variable top_msg;
variable var_num;

procedure ChooseFromList;
procedure CLICK_PREV;
procedure CLICK_0;
procedure CLICK_1;
procedure CLICK_2;
procedure CLICK_3;
procedure CLICK_4;
procedure CLICK_MORE;

variable floater_patch_msg;
variable hs_temp;

procedure start;
procedure pickup_p_proc;
procedure talk_p_proc;
procedure destroy_p_proc;
procedure look_at_p_proc;
procedure description_p_proc;
procedure use_p_proc;
procedure use_skill_on_p_proc;
procedure damage_p_proc;
procedure map_enter_p_proc;
procedure timed_event_p_proc;
procedure Node998;
procedure Node999;
procedure Node000;
procedure Node001;
procedure Node002;
procedure Node003;
procedure Node004;
procedure Node005;
procedure Node006;
procedure Node013;
procedure Node014;
procedure Node015;
procedure Node016;
procedure Node017;
procedure Node018;
procedure Node019;

variable coin_mult;
variable win_payoff;
variable reel_1;
variable reel_2;
variable reel_3;

import variable mcGeeSlotMachineOBJ;
import variable mcGeeOBJ;

procedure Node997;
procedure Node981;
procedure Node982;
procedure Node983;
procedure Node984;
procedure Node985;


procedure checkPartyMembersNearDoor
begin
    if (party_member_obj(16777278) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777278)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777376) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777376)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777377) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777377)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777305) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777305)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777313) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777313)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777323) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777323)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777352) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777352)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777378) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777378)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777368) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777368)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777379) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777379)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777380) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777380)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777295) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777295)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777381) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777381)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777407) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777407)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777411) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777411)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777412) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777412)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777413) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777413)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777481) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777481)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777558) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777558)) <= 5) then begin
            return 1;
        end
    end
    if (party_member_obj(16777600) != 0) then begin
        if (tile_distance_objs(self_obj, party_member_obj(16777600)) <= 5) then begin
            return 1;
        end
    end
    return 0;
end

procedure ChooseFromList
begin
    variable LVar0 := 0;
    Reply(stored_msg);
    if (message_str(SCRIPT_NEWR1, top_msg - 1) != "") then begin
        giq_option(1, NAME, message_str(SCRIPT_NEWR1, 150), CLICK_PREV, NEUTRAL_REACTION);
    end
    if (LVar0 == 0) then begin
        if (message_str(SCRIPT_NEWR1, top_msg + 0) != "") then begin
            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 0), CLICK_0, NEUTRAL_REACTION);
        end
        else begin
            LVar0 := 1;
        end
    end
    if (LVar0 == 0) then begin
        if (message_str(SCRIPT_NEWR1, top_msg + 1) != "") then begin
            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 1), CLICK_1, NEUTRAL_REACTION);
        end
        else begin
            LVar0 := 1;
        end
    end
    if (LVar0 == 0) then begin
        if (message_str(SCRIPT_NEWR1, top_msg + 2) != "") then begin
            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 2), CLICK_2, NEUTRAL_REACTION);
        end
        else begin
            LVar0 := 1;
        end
    end
    if (LVar0 == 0) then begin
        if (message_str(SCRIPT_NEWR1, top_msg + 3) != "") then begin
            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 3), CLICK_3, NEUTRAL_REACTION);
        end
        else begin
            LVar0 := 1;
        end
    end
    if (LVar0 == 0) then begin
        if (message_str(SCRIPT_NEWR1, top_msg + 4) != "") then begin
            giq_option(1, NAME, message_str(SCRIPT_NEWR1, top_msg + 4), CLICK_4, NEUTRAL_REACTION);
        end
        else begin
            LVar0 := 1;
        end
    end
    if (LVar0 == 0) then begin
        if (message_str(SCRIPT_NEWR1, top_msg + 5) != "") then begin
            giq_option(1, NAME, message_str(SCRIPT_NEWR1, 151), CLICK_MORE, NEUTRAL_REACTION);
        end
    end
end

procedure CLICK_PREV
begin
    top_msg := top_msg - 5;
    call ChooseFromList();
end

procedure CLICK_0
begin
    set_global_var(var_num, (global_var(var_num) / 100 * 100) + (top_msg % 100));
    call stored_node();
end

procedure CLICK_1
begin
    set_global_var(var_num, (global_var(var_num) / 100 * 100) + ((top_msg + 1) % 100));
    call stored_node();
end

procedure CLICK_2
begin
    set_global_var(var_num, (global_var(var_num) / 100 * 100) + ((top_msg + 2) % 100));
    call stored_node();
end

procedure CLICK_3
begin
    set_global_var(var_num, (global_var(var_num) / 100 * 100) + ((top_msg + 3) % 100));
    call stored_node();
end

procedure CLICK_4
begin
    set_global_var(var_num, (global_var(var_num) / 100 * 100) + ((top_msg + 4) % 100));
    call stored_node();
end

procedure CLICK_MORE
begin
    top_msg := top_msg + 5;
    call ChooseFromList();
end

procedure start
begin
end

procedure pickup_p_proc
begin
    if (source_obj == dude_obj) then begin
        call Node998();
    end
end

procedure talk_p_proc
begin
    start_gdialog(414, self_obj, 4, -1, -1);
    gsay_start;
    call Node000();
    gsay_end;
    end_dialogue;
end

procedure destroy_p_proc
begin
    mcGeeSlotMachineOBJ := 0;
end

procedure look_at_p_proc
begin
    script_overrides;
    if ((dude_iq > 3) and (dude_skill(SKILL_GAMBLING) >= 25)) then begin
        display_mstr(150);
    end
    else begin
        display_msg(message_str(SCRIPT_ZISLOTS, 100));
    end
end

procedure description_p_proc
begin
    variable LVar0 := 0;
    script_overrides;
    if ((dude_iq > 3) and (dude_skill(SKILL_GAMBLING) >= 25)) then begin
        display_mstr(150 + ((local_var(4) bwand 4) != 0));
    end
    else begin
        display_msg(message_str(SCRIPT_ZISLOTS, 100) + message_str(SCRIPT_ZISLOTS, 130));
    end
    set_local_var(4, local_var(4) bwor 4);
end

procedure use_p_proc
begin
    if (source_obj == dude_obj) then begin
        dialogue_system_enter;
    end
end

procedure use_skill_on_p_proc
begin
    variable LVar0 := 0;
    if ((action_being_used == 16) and ((dude_iq > 3) and (dude_skill(SKILL_GAMBLING) >= 25))) then begin
        script_overrides;
        display_mstr(320);
        if (0) then begin
            set_global_var(GVAR_NEW_RENO_MCGEE_SEED, 1);
        end
    end
    else begin
        if (action_being_used == 13) then begin
            script_overrides;
            LVar0 := roll_vs_skill(dude_obj, action_being_used, 0);
            if (tile_distance_objs(mcGeeOBJ, mcGeeSlotMachineOBJ) <= 2) then begin
                display_mstr(321);
            end
            else begin
                if ((global_var(GVAR_NEW_RENO_MCGEE_SEED) == 2) or (global_var(GVAR_NEW_RENO_MCGEE_SEED) == 3)) then begin
                    display_mstr(322);
                end
                else begin
                    if (local_var(3) != 0) then begin
                        display_mstr(323);
                    end
                    else begin
                        if (0) then begin
                            set_global_var(GVAR_NEW_RENO_MCGEE_SEED, 1);
                        end
                        LVar0 := roll_vs_skill(dude_obj, 13, 0);
                        if (is_success(LVar0)) then begin
                            if (is_critical(LVar0)) then begin
                                display_mstr(324);
                                set_local_var(3, 1);
                            end
                            else begin
                                display_mstr(325);
                                set_local_var(3, 2);
                            end
                        end
                        else begin
                            display_mstr(326);
                            if (is_critical(LVar0)) then begin
                                set_local_var(3, 4);
                                give_exp_points(100);
                                display_msg(g_mstr(100) + 100 + g_mstr(101));
                            end
                            else begin
                                set_local_var(3, 3);
                                give_exp_points(50);
                                display_msg(g_mstr(100) + 50 + g_mstr(101));
                            end
                        end
                    end
                end
            end
        end
    end
end

procedure damage_p_proc
begin
end

procedure map_enter_p_proc
begin
    variable LVar0 := 0;
    mcGeeSlotMachineOBJ := self_obj;
    if (map_first_run) then begin
        if (local_var(0) == 0) then begin
            set_local_var(0, 3);
        end
    end
    last_timed_obj := self_obj;
    last_timed_param := last_timed_param;
    rm_fixed_timer_event(self_obj, 1);
    add_timer_event(self_obj, game_ticks(5) + random(0, game_ticks(30 - 5)), 1);
end

procedure timed_event_p_proc
begin
    if ((combat_is_initialized == 0) and (tile_distance(tile_num(self_obj), dude_tile) <= 5)) then begin
        float_msg(self_obj, mstr(random(203 - (3 * (dude_gender == 0) * drug_influence(dude_obj)), 212 + (4 * (dude_gender == 1) * drug_influence(dude_obj)))), FLOAT_MSG_LIGHT_GREY);
    end
    last_timed_obj := self_obj;
    last_timed_param := last_timed_param;
    rm_fixed_timer_event(self_obj, 1);
    add_timer_event(self_obj, game_ticks(15) + random(0, game_ticks(30 - 15)), 1);
end

procedure Node998
begin
end

procedure Node999
begin
end

procedure Node000
begin
    if (((dude_iq > 3) and (dude_skill(SKILL_GAMBLING) >= 25)) == 0) then begin
        call Node004();
    end
    else begin
        if ((local_var(2) <= 0) or local_var(1) or (item_caps_total(dude_obj) < ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3))))) then begin
            call Node003();
        end
        else begin
            call Node001();
        end
    end
end

procedure Node001
begin
    gsay_reply(SCRIPT_ZISLOTS, 245 + drug_influence(dude_obj));
    if (local_var(1)) then begin
        giq_option(1, NAME, 311, Node003, NEUTRAL_REACTION);
    end
    else begin
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 1) and (item_caps_total(dude_obj) >= (1 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (1 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node981, NEUTRAL_REACTION);
            end
            else begin
                if ((1 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (1 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node981, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (1 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node981, NEUTRAL_REACTION);
                end
            end
        end
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 2) and (item_caps_total(dude_obj) >= (2 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (2 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node982, NEUTRAL_REACTION);
            end
            else begin
                if ((2 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (2 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node982, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (2 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node982, NEUTRAL_REACTION);
                end
            end
        end
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 3) and (item_caps_total(dude_obj) >= (3 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (3 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node983, NEUTRAL_REACTION);
            end
            else begin
                if ((3 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (3 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node983, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (3 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node983, NEUTRAL_REACTION);
                end
            end
        end
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 4) and (item_caps_total(dude_obj) >= (4 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (4 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node984, NEUTRAL_REACTION);
            end
            else begin
                if ((4 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (4 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node984, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (4 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node984, NEUTRAL_REACTION);
                end
            end
        end
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 5) and (item_caps_total(dude_obj) >= (5 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (5 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node985, NEUTRAL_REACTION);
            end
            else begin
                if ((5 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (5 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node985, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (5 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node985, NEUTRAL_REACTION);
                end
            end
        end
        if (drug_influence(dude_obj) == 0) then begin
            giq_option(1, SCRIPT_ZISLOTS, 254 + (item_caps_total(dude_obj) == 0) + (((game_time_hour <= 600) or (game_time_hour >= 1800)) * 2), Node999, NEUTRAL_REACTION);
        end
        else begin
            giq_option(1, SCRIPT_ZISLOTS, 258 + (dude_gender == 0), Node999, NEUTRAL_REACTION);
        end
    end
end

procedure Node002
begin
    variable LVar0 := 0;
    if (-(coin_mult * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) < 473) then begin
        item_caps_adjust(dude_obj, 473);
    end
    else begin
        item_caps_adjust(dude_obj, -(coin_mult * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))));
    end
    if ((-(coin_mult * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) >= (100 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3))) * coin_mult)) and (coin_mult == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))))) then begin
        set_local_var(1, 1);
    end
    debug_msg("\nSlot money remaining == " + local_var(2));
    LVar0 := random(1, 3);
    if (win_payoff == 1) then begin
        win_payoff := 2;
        if (LVar0 == 1) then begin
            reel_1 := 1001;
        end
        else begin
            reel_1 := random(1002, 1007);
        end
        if (LVar0 == 2) then begin
            reel_2 := 1001;
        end
        else begin
            reel_2 := random(1002, 1007);
        end
        if (LVar0 == 3) then begin
            reel_3 := 1001;
        end
        else begin
            reel_3 := random(1002, 1007);
        end
    end
    else begin
        if (win_payoff == 2) then begin
            win_payoff := 5;
            if (LVar0 != 1) then begin
                reel_1 := 1001;
            end
            else begin
                reel_1 := random(1002, 1007);
            end
            if (LVar0 != 2) then begin
                reel_2 := 1001;
            end
            else begin
                reel_2 := random(1002, 1007);
            end
            if (LVar0 != 3) then begin
                reel_3 := 1001;
            end
            else begin
                reel_3 := random(1002, 1007);
            end
        end
        else begin
            if (win_payoff == 3) then begin
                win_payoff := 10;
                if (LVar0 == 1) then begin
                    reel_1 := 1002 + ((random(1, 2) == 1) * (1005 - 1002));
                end
                else begin
                    reel_1 := 1002;
                end
                if (LVar0 == 2) then begin
                    reel_2 := 1002 + ((random(1, 2) == 1) * (1005 - 1002));
                end
                else begin
                    reel_2 := 1002;
                end
                if (LVar0 == 3) then begin
                    reel_3 := 1002 + ((random(1, 2) == 1) * (1005 - 1002));
                end
                else begin
                    reel_3 := 1002;
                end
            end
            else begin
                if (win_payoff == 4) then begin
                    win_payoff := 15;
                    if (LVar0 == 1) then begin
                        reel_1 := 1003 + ((random(1, 2) == 1) * (1005 - 1003));
                    end
                    else begin
                        reel_1 := 1003;
                    end
                    if (LVar0 == 2) then begin
                        reel_2 := 1003 + ((random(1, 2) == 1) * (1005 - 1003));
                    end
                    else begin
                        reel_2 := 1003;
                    end
                    if (LVar0 == 3) then begin
                        reel_3 := 1003 + ((random(1, 2) == 1) * (1005 - 1003));
                    end
                    else begin
                        reel_3 := 1003;
                    end
                end
                else begin
                    if (win_payoff == 5) then begin
                        win_payoff := 25;
                        if (LVar0 == 1) then begin
                            reel_1 := 1004 + ((random(1, 2) == 1) * (1005 - 1004));
                        end
                        else begin
                            reel_1 := 1004;
                        end
                        if (LVar0 == 2) then begin
                            reel_2 := 1004 + ((random(1, 2) == 1) * (1005 - 1004));
                        end
                        else begin
                            reel_2 := 1004;
                        end
                        if (LVar0 == 3) then begin
                            reel_3 := 1004 + ((random(1, 2) == 1) * (1005 - 1004));
                        end
                        else begin
                            reel_3 := 1004;
                        end
                    end
                    else begin
                        if (win_payoff == 6) then begin
                            win_payoff := 100;
                            if (LVar0 == 1) then begin
                                reel_1 := 1006 + ((random(1, 2) == 1) * (1005 - 1006));
                            end
                            else begin
                                reel_1 := 1006;
                            end
                            if (LVar0 == 2) then begin
                                reel_2 := 1006 + ((random(1, 2) == 1) * (1005 - 1006));
                            end
                            else begin
                                reel_2 := 1006;
                            end
                            if (LVar0 == 3) then begin
                                reel_3 := 1006 + ((random(1, 2) == 1) * (1005 - 1006));
                            end
                            else begin
                                reel_3 := 1006;
                            end
                        end
                        else begin
                            if (win_payoff == 7) then begin
                                win_payoff := 100;
                                reel_1 := 1005;
                                reel_2 := 1005;
                                reel_3 := 1005;
                            end
                            else begin
                                if (win_payoff == 8) then begin
                                    win_payoff := 100;
                                    reel_1 := 1007;
                                    reel_2 := 1007;
                                    reel_3 := 1007;
                                end
                                else begin
                                    win_payoff := 0;
                                    reel_1 := random(1002, 1007);
                                    reel_2 := random(1002, 1007);
                                    if (reel_1 != reel_2) then begin
                                        reel_3 := random(1002, 1007);
                                    end
                                    else begin
                                        reel_3 := random(1002, 1007);
                                        while ((reel_3 == reel_1) or (reel_3 == 1005)) do begin
                                            reel_3 := reel_3 + 1;
                                            if (reel_3 > 1007) then begin
                                                reel_3 := 1002;
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    if ((100 <= win_payoff) and (coin_mult == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))))) then begin
        set_local_var(1, 1);
        LVar0 := mstr(310);
    end
    else begin
        LVar0 := mstr(260 + (win_payoff == 0)) + message_str(SCRIPT_ZISLOTS, reel_1) + message_str(SCRIPT_ZISLOTS, 599) + message_str(SCRIPT_ZISLOTS, reel_2) + message_str(SCRIPT_ZISLOTS, 599) + message_str(SCRIPT_ZISLOTS, reel_3) + message_str(SCRIPT_ZISLOTS, 599);
        if ((100 <= win_payoff) and (coin_mult == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))))) then begin
            LVar0 := LVar0 + message_str(SCRIPT_ZISLOTS, 605);
        end
        else begin
            if ((100 <= win_payoff) and (coin_mult == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))))) then begin
                LVar0 := LVar0 + message_str(SCRIPT_ZISLOTS, 604);
            end
            else begin
                if (10 <= win_payoff) then begin
                    LVar0 := LVar0 + (message_str(SCRIPT_ZISLOTS, 603) + message_str(SCRIPT_ZISLOTS, (reel_1 * (reel_1 != 1005)) + (reel_2 * (reel_1 == 1005)) + 100) + message_str(SCRIPT_ZISLOTS, 613));
                end
                else begin
                    if (5 <= win_payoff) then begin
                        LVar0 := LVar0 + message_str(SCRIPT_ZISLOTS, 602);
                    end
                    else begin
                        if (2 <= win_payoff) then begin
                            LVar0 := LVar0 + message_str(SCRIPT_ZISLOTS, 601);
                        end
                        else begin
                            LVar0 := LVar0 + message_str(SCRIPT_ZISLOTS, 600);
                        end
                    end
                end
            end
        end
        win_payoff := win_payoff * (coin_mult * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3))));
        if (win_payoff > 0) then begin
            LVar0 := LVar0 + (message_str(SCRIPT_ZISLOTS, 700) + win_payoff + message_str(SCRIPT_ZISLOTS, 701));
        end
        if (drug_influence(dude_obj)) then begin
            if (win_payoff == 0) then begin
                LVar0 := LVar0 + mstr(251);
            end
            else begin
                if ((win_payoff / (coin_mult * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3))))) >= 10) then begin
                    LVar0 := LVar0 + mstr(265);
                end
                else begin
                    if ((win_payoff / (coin_mult * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3))))) >= 5) then begin
                        LVar0 := LVar0 + mstr(261);
                    end
                    else begin
                        LVar0 := LVar0 + mstr(255);
                    end
                end
            end
        end
    end
    if (win_payoff < 473) then begin
        item_caps_adjust(dude_obj, 473);
    end
    else begin
        item_caps_adjust(dude_obj, win_payoff);
    end
    if ((win_payoff >= (100 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3))) * coin_mult)) and (coin_mult == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))))) then begin
        set_local_var(1, 1);
    end
    debug_msg("\nSlot money remaining == " + local_var(2));
    gsay_reply(SCRIPT_ZISLOTS, LVar0);
    if (local_var(1)) then begin
        giq_option(1, NAME, 311, Node003, NEUTRAL_REACTION);
    end
    else begin
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 1) and (item_caps_total(dude_obj) >= (1 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (1 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node981, NEUTRAL_REACTION);
            end
            else begin
                if ((1 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (1 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node981, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (1 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node981, NEUTRAL_REACTION);
                end
            end
        end
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 2) and (item_caps_total(dude_obj) >= (2 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (2 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node982, NEUTRAL_REACTION);
            end
            else begin
                if ((2 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (2 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node982, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (2 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node982, NEUTRAL_REACTION);
                end
            end
        end
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 3) and (item_caps_total(dude_obj) >= (3 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (3 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node983, NEUTRAL_REACTION);
            end
            else begin
                if ((3 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (3 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node983, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (3 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node983, NEUTRAL_REACTION);
                end
            end
        end
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 4) and (item_caps_total(dude_obj) >= (4 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (4 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node984, NEUTRAL_REACTION);
            end
            else begin
                if ((4 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (4 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node984, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (4 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node984, NEUTRAL_REACTION);
                end
            end
        end
        if ((((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3))) >= 5) and (item_caps_total(dude_obj) >= (5 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))))) then begin
            if (item_caps_total(dude_obj) == ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) then begin
                giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 252) + (5 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 253), Node985, NEUTRAL_REACTION);
            end
            else begin
                if ((5 == ((5 * (local_var(0) == 1)) + (5 * (local_var(0) == 2)) + (5 * (local_var(0) == 3)))) and (dude_skill(SKILL_GAMBLING) >= 50)) then begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (5 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251) + (message_str(SCRIPT_ZISLOTS, 3000) + message_str(SCRIPT_ZISLOTS, random(1105, 1107)) + message_str(SCRIPT_ZISLOTS, random(3001, 3002))), Node985, NEUTRAL_REACTION);
                end
                else begin
                    giq_option(1, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 250) + (5 * ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) + message_str(SCRIPT_ZISLOTS, 251), Node985, NEUTRAL_REACTION);
                end
            end
        end
        if (drug_influence(dude_obj) == 0) then begin
            giq_option(1, SCRIPT_ZISLOTS, 254 + (item_caps_total(dude_obj) == 0) + (((game_time_hour <= 600) or (game_time_hour >= 1800)) * 2), Node999, NEUTRAL_REACTION);
        end
        else begin
            giq_option(1, SCRIPT_ZISLOTS, 258 + (dude_gender == 0), Node999, NEUTRAL_REACTION);
        end
    end
end

procedure Node003
begin
    if ((item_caps_total(dude_obj) < ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3)))) and (local_var(1) == 0)) then begin
        gsay_reply(SCRIPT_ZISLOTS, 2175);
        giq_option(1, SCRIPT_ZISLOTS, 2176, Node999, NEUTRAL_REACTION);
    end
    else begin
        Reply(315);
        giq_option(1, SCRIPT_ZISLOTS, 2186, Node999, NEUTRAL_REACTION);
    end
end

procedure Node004
begin
    Reply(230);
    giq_option(-3, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 2101) + dude_name + message_str(SCRIPT_ZISLOTS, 2102), Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 2103) + dude_name + message_str(SCRIPT_ZISLOTS, 2104), Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2105, Node006, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2106, Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2107, Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2108, Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2109, Node999, NEUTRAL_REACTION);
    giq_option(4, SCRIPT_ZISLOTS, 2110, Node999, NEUTRAL_REACTION);
end

procedure Node005
begin
    Reply(235);
    giq_option(-3, SCRIPT_ZISLOTS, message_str(SCRIPT_ZISLOTS, 2131) + dude_name + message_str(SCRIPT_ZISLOTS, 2132), Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2133, Node006, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2134, Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2135, Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2136, Node005, NEUTRAL_REACTION);
    giq_option(-3, SCRIPT_ZISLOTS, 2137, Node999, NEUTRAL_REACTION);
    giq_option(4, SCRIPT_ZISLOTS, 2138, Node999, NEUTRAL_REACTION);
end

procedure Node006
begin
    Reply(240);
    giq_option(1, SCRIPT_ZISLOTS, 2152, Node999, NEUTRAL_REACTION);
    giq_option(4, SCRIPT_ZISLOTS, 2153, Node999, NEUTRAL_REACTION);
end

procedure Node013
begin
    Reply(270);
    giq_option(1, SCRIPT_ZISLOTS, 2282, Node014, NEUTRAL_REACTION);
    giq_option(1, SCRIPT_ZISLOTS, 2283, Node014, NEUTRAL_REACTION);
    giq_option(1, SCRIPT_ZISLOTS, 2284, Node999, NEUTRAL_REACTION);
end

procedure Node014
begin
    Reply(275);
    giq_option(1, SCRIPT_ZISLOTS, 2302, Node015, NEUTRAL_REACTION);
    giq_option(1, SCRIPT_ZISLOTS, 2303, Node001, NEUTRAL_REACTION);
    if (dude_gender == 0) then begin
        giq_option(1, SCRIPT_ZISLOTS, 2304, Node999, NEUTRAL_REACTION);
    end
    giq_option(1, SCRIPT_ZISLOTS, 2305, Node999, NEUTRAL_REACTION);
end

procedure Node015
begin
    Reply(280);
    giq_option(1, SCRIPT_ZISLOTS, 2322, Node016, NEUTRAL_REACTION);
    giq_option(1, SCRIPT_ZISLOTS, 2303, Node001, NEUTRAL_REACTION);
    if (dude_gender == 0) then begin
        giq_option(1, SCRIPT_ZISLOTS, 2304, Node999, NEUTRAL_REACTION);
    end
    giq_option(1, SCRIPT_ZISLOTS, 2305, Node999, NEUTRAL_REACTION);
end

procedure Node016
begin
    Reply(285);
    if (global_var(GVAR_FALLOUT_2) == 8) then begin
        giq_option(1, SCRIPT_ZISLOTS, 2345, Node017, NEUTRAL_REACTION);
        giq_option(1, SCRIPT_ZISLOTS, 2346, Node017, NEUTRAL_REACTION);
        giq_option(1, SCRIPT_ZISLOTS, 2347, Node017, NEUTRAL_REACTION);
    end
    else begin
        if (global_var(GVAR_FALLOUT_2) == 5) then begin
            giq_option(1, SCRIPT_ZISLOTS, 2344, Node017, NEUTRAL_REACTION);
        end
        else begin
            if (global_var(GVAR_FALLOUT_2) == 4) then begin
                giq_option(1, SCRIPT_ZISLOTS, 2343, Node017, NEUTRAL_REACTION);
            end
            else begin
                if (global_var(GVAR_FALLOUT_2) == 0) then begin
                    giq_option(1, SCRIPT_ZISLOTS, 2342, Node017, NEUTRAL_REACTION);
                end
            end
        end
    end
    giq_option(1, SCRIPT_ZISLOTS, 2348, Node017, NEUTRAL_REACTION);
    giq_option(1, SCRIPT_ZISLOTS, 2305, Node999, NEUTRAL_REACTION);
end

procedure Node017
begin
    giq_option(1, SCRIPT_ZISLOTS, 2372, Node018, NEUTRAL_REACTION);
    giq_option(1, SCRIPT_ZISLOTS, 2373, Node018, NEUTRAL_REACTION);
    giq_option(1, SCRIPT_ZISLOTS, 2305, Node999, NEUTRAL_REACTION);
end

procedure Node018
begin
    Reply(300);
    giq_option(1, NAME, 301, Node019, NEUTRAL_REACTION);
end

procedure Node019
begin
    Reply(305);
    giq_option(1, NAME, 306, Node999, NEUTRAL_REACTION);
end

procedure Node997
begin
    variable LVar0 := 0;
    variable LVar1 := 0;
    if (((local_var(2) <= 0) or local_var(1) or (item_caps_total(dude_obj) < ((1 * (local_var(0) == 1)) + (1 * (local_var(0) == 2)) + (1 * (local_var(0) == 3))))) == 0) then begin
        win_payoff := 0;
        LVar0 := roll_vs_skill(dude_obj, 16, (((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9))) * (local_var(0) == 3)) + (win_payoff * ((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9)))));
        if (is_success(LVar0) and (((25 * (local_var(0) == 1)) + (100 * (local_var(0) == 2)) + (100 * (local_var(0) == 3))) >= 2)) then begin
            win_payoff := 1;
            LVar1 := roll_vs_skill(dude_obj, 16, (((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9))) * (local_var(0) == 3)) + (win_payoff * ((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9)))));
            if (is_critical(LVar0) or is_success(LVar1) and (((25 * (local_var(0) == 1)) + (100 * (local_var(0) == 2)) + (100 * (local_var(0) == 3))) >= 5)) then begin
                win_payoff := 2;
                LVar0 := roll_vs_skill(dude_obj, 16, (((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9))) * (local_var(0) == 3)) + (win_payoff * ((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9)))));
                if (is_critical(LVar1) or is_success(LVar0) and (((25 * (local_var(0) == 1)) + (100 * (local_var(0) == 2)) + (100 * (local_var(0) == 3))) >= 10)) then begin
                    win_payoff := 3;
                    LVar1 := roll_vs_skill(dude_obj, 16, (((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9))) * (local_var(0) == 3)) + (win_payoff * ((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9)))));
                    if (is_critical(LVar0) or is_success(LVar1) and (((25 * (local_var(0) == 1)) + (100 * (local_var(0) == 2)) + (100 * (local_var(0) == 3))) >= 15)) then begin
                        win_payoff := 4;
                        LVar0 := roll_vs_skill(dude_obj, 16, (((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9))) * (local_var(0) == 3)) + (win_payoff * ((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9)))));
                        if (is_critical(LVar1) or is_success(LVar0) and (((25 * (local_var(0) == 1)) + (100 * (local_var(0) == 2)) + (100 * (local_var(0) == 3))) >= 25)) then begin
                            win_payoff := 5;
                            LVar1 := roll_vs_skill(dude_obj, 16, (((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9))) * (local_var(0) == 3)) + (win_payoff * ((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9)))));
                            if (is_critical(LVar0) or is_success(LVar1) and (((25 * (local_var(0) == 1)) + (100 * (local_var(0) == 2)) + (100 * (local_var(0) == 3))) >= 100)) then begin
                                win_payoff := 6;
                                LVar0 := roll_vs_skill(dude_obj, 16, (((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9))) * (local_var(0) == 3)) + (win_payoff * ((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9)))));
                                if (is_critical(LVar1) or is_success(LVar0) and (((25 * (local_var(0) == 1)) + (100 * (local_var(0) == 2)) + (100 * (local_var(0) == 3))) >= 100)) then begin
                                    win_payoff := 7;
                                    LVar1 := roll_vs_skill(dude_obj, 16, (((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9))) * (local_var(0) == 3)) + (win_payoff * ((-45 * (dude_luck < 9)) + (75 * (dude_luck >= 9)))));
                                    if (is_critical(LVar0) or is_success(LVar1) and (((25 * (local_var(0) == 1)) + (100 * (local_var(0) == 2)) + (100 * (local_var(0) == 3))) >= 100)) then begin
                                        win_payoff := 8;
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        call Node002();
    end
    else begin
        debug_msg("\nPLAY BLOCKED");
        debug_msg("\n   slot_tube_size == " + local_var(2));
        debug_msg("\n   won_jackpot == " + local_var(1));
    end
end

procedure Node981
begin
    coin_mult := 1;
    call Node997();
end

procedure Node982
begin
    coin_mult := 2;
    call Node997();
end

procedure Node983
begin
    coin_mult := 3;
    call Node997();
end

procedure Node984
begin
    coin_mult := 4;
    call Node997();
end

procedure Node985
begin
    coin_mult := 5;
    call Node997();
end
