diff --git a/Games/Fallout2.Steam/Original/FILAOTBL.ssl b/Games/Fallout2.Steam/ReDefine/FILAOTBL.ssl
index 79cd8a9..fd6fd38 100644
--- a/Games/Fallout2.Steam/Original/FILAOTBL.ssl
+++ b/Games/Fallout2.Steam/ReDefine/FILAOTBL.ssl
@@ -192,7 +192,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 13) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 13) < restock_amt) then begin
-                            restock_obj := create_object_sid(13, 0, 0, -1);
+                            restock_obj := create_object(13, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 13));
                         end
                         else begin
@@ -205,17 +205,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 13);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 13);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -233,7 +233,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 13) < restock_amt) then begin
-                        restock_obj := create_object_sid(13, 0, 0, -1);
+                        restock_obj := create_object(13, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 13));
                     end
                     else begin
@@ -246,17 +246,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 13);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 13);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -275,7 +275,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 16) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 16) < restock_amt) then begin
-                            restock_obj := create_object_sid(16, 0, 0, -1);
+                            restock_obj := create_object(16, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 16));
                         end
                         else begin
@@ -288,17 +288,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 16);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 16);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -316,7 +316,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 16) < restock_amt) then begin
-                        restock_obj := create_object_sid(16, 0, 0, -1);
+                        restock_obj := create_object(16, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 16));
                     end
                     else begin
@@ -329,17 +329,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 16);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 16);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -358,7 +358,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
                     if (80 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
-                            restock_obj := create_object_sid(234, 0, 0, -1);
+                            restock_obj := create_object(234, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 234));
                         end
                         else begin
@@ -371,17 +371,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 234);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 234);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -399,7 +399,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 234) < restock_amt) then begin
-                        restock_obj := create_object_sid(234, 0, 0, -1);
+                        restock_obj := create_object(234, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 234));
                     end
                     else begin
@@ -412,17 +412,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 234);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 234);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -437,11 +437,11 @@ begin
                         end
                     end
                 end
-                restock_amt := random(1, 1);
+                restock_amt := 1;
                 if (obj_is_carrying_obj_pid(self_obj, 241) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 241) < restock_amt) then begin
-                            restock_obj := create_object_sid(241, 0, 0, -1);
+                            restock_obj := create_object(241, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 241));
                         end
                         else begin
@@ -454,17 +454,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 241);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 241);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -482,7 +482,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 241) < restock_amt) then begin
-                        restock_obj := create_object_sid(241, 0, 0, -1);
+                        restock_obj := create_object(241, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 241));
                     end
                     else begin
@@ -495,17 +495,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 241);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 241);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -524,7 +524,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
                     if (55 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
-                            restock_obj := create_object_sid(296, 0, 0, -1);
+                            restock_obj := create_object(296, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 296));
                         end
                         else begin
@@ -537,17 +537,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 296);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 296);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -565,7 +565,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 296) < restock_amt) then begin
-                        restock_obj := create_object_sid(296, 0, 0, -1);
+                        restock_obj := create_object(296, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 296));
                     end
                     else begin
@@ -578,17 +578,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 296);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 296);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -607,7 +607,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 387) < restock_amt) then begin
                     if (45 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 387) < restock_amt) then begin
-                            restock_obj := create_object_sid(387, 0, 0, -1);
+                            restock_obj := create_object(387, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 387));
                         end
                         else begin
@@ -620,17 +620,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 387);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 387);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -648,7 +648,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 387) < restock_amt) then begin
-                        restock_obj := create_object_sid(387, 0, 0, -1);
+                        restock_obj := create_object(387, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 387));
                     end
                     else begin
@@ -661,17 +661,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 387);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 387);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -686,11 +686,11 @@ begin
                         end
                     end
                 end
-                restock_amt := random(1, 1);
+                restock_amt := 1;
                 if (obj_is_carrying_obj_pid(self_obj, 401) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 401) < restock_amt) then begin
-                            restock_obj := create_object_sid(401, 0, 0, -1);
+                            restock_obj := create_object(401, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 401));
                         end
                         else begin
@@ -703,17 +703,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 401);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 401);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -731,7 +731,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 401) < restock_amt) then begin
-                        restock_obj := create_object_sid(401, 0, 0, -1);
+                        restock_obj := create_object(401, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 401));
                     end
                     else begin
@@ -744,17 +744,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 401);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 401);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -769,11 +769,11 @@ begin
                         end
                     end
                 end
-                restock_amt := random(1, 1);
+                restock_amt := 1;
                 if (obj_is_carrying_obj_pid(self_obj, 402) < restock_amt) then begin
                     if (40 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 402) < restock_amt) then begin
-                            restock_obj := create_object_sid(402, 0, 0, -1);
+                            restock_obj := create_object(402, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 402));
                         end
                         else begin
@@ -786,17 +786,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 402);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 402);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -814,7 +814,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 402) < restock_amt) then begin
-                        restock_obj := create_object_sid(402, 0, 0, -1);
+                        restock_obj := create_object(402, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 402));
                     end
                     else begin
@@ -827,17 +827,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 402);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 402);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -856,7 +856,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 289) < restock_amt) then begin
                     if (30 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 289) < restock_amt) then begin
-                            restock_obj := create_object_sid(289, 0, 0, -1);
+                            restock_obj := create_object(289, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 289));
                         end
                         else begin
@@ -869,17 +869,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 289);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 289);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -897,7 +897,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 289) < restock_amt) then begin
-                        restock_obj := create_object_sid(289, 0, 0, -1);
+                        restock_obj := create_object(289, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 289));
                     end
                     else begin
@@ -910,17 +910,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 289);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 289);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -939,7 +939,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 308) < restock_amt) then begin
                     if (25 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 308) < restock_amt) then begin
-                            restock_obj := create_object_sid(308, 0, 0, -1);
+                            restock_obj := create_object(308, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 308));
                         end
                         else begin
@@ -952,17 +952,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 308);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 308);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -980,7 +980,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 308) < restock_amt) then begin
-                        restock_obj := create_object_sid(308, 0, 0, -1);
+                        restock_obj := create_object(308, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 308));
                     end
                     else begin
@@ -993,17 +993,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 308);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 308);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1022,7 +1022,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 314) < restock_amt) then begin
                     if (78 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 314) < restock_amt) then begin
-                            restock_obj := create_object_sid(314, 0, 0, -1);
+                            restock_obj := create_object(314, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 314));
                         end
                         else begin
@@ -1035,17 +1035,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 314);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 314);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1063,7 +1063,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 314) < restock_amt) then begin
-                        restock_obj := create_object_sid(314, 0, 0, -1);
+                        restock_obj := create_object(314, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 314));
                     end
                     else begin
@@ -1076,17 +1076,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 314);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 314);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1105,7 +1105,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 315) < restock_amt) then begin
                     if (90 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 315) < restock_amt) then begin
-                            restock_obj := create_object_sid(315, 0, 0, -1);
+                            restock_obj := create_object(315, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 315));
                         end
                         else begin
@@ -1118,17 +1118,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 315);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 315);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1146,7 +1146,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 315) < restock_amt) then begin
-                        restock_obj := create_object_sid(315, 0, 0, -1);
+                        restock_obj := create_object(315, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 315));
                     end
                     else begin
@@ -1159,17 +1159,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 315);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 315);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1188,7 +1188,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 240) < restock_amt) then begin
                     if (60 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 240) < restock_amt) then begin
-                            restock_obj := create_object_sid(240, 0, 0, -1);
+                            restock_obj := create_object(240, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 240));
                         end
                         else begin
@@ -1201,17 +1201,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 240);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 240);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1229,7 +1229,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 240) < restock_amt) then begin
-                        restock_obj := create_object_sid(240, 0, 0, -1);
+                        restock_obj := create_object(240, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 240));
                     end
                     else begin
@@ -1242,17 +1242,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 240);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 240);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1271,7 +1271,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 74) < restock_amt) then begin
                     if (60 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 74) < restock_amt) then begin
-                            restock_obj := create_object_sid(74, 0, 0, -1);
+                            restock_obj := create_object(74, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 74));
                         end
                         else begin
@@ -1284,17 +1284,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 74);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 74);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1312,7 +1312,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 74) < restock_amt) then begin
-                        restock_obj := create_object_sid(74, 0, 0, -1);
+                        restock_obj := create_object(74, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 74));
                     end
                     else begin
@@ -1325,17 +1325,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 74);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 74);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1354,7 +1354,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 3) < restock_amt) then begin
                     if (60 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 3) < restock_amt) then begin
-                            restock_obj := create_object_sid(3, 0, 0, -1);
+                            restock_obj := create_object(3, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 3));
                         end
                         else begin
@@ -1367,17 +1367,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 3);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 3);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1395,7 +1395,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 3) < restock_amt) then begin
-                        restock_obj := create_object_sid(3, 0, 0, -1);
+                        restock_obj := create_object(3, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 3));
                     end
                     else begin
@@ -1408,17 +1408,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 3);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 3);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1437,7 +1437,7 @@ begin
                 if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
                     if (65 >= random(1, 100)) then begin
                         if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
-                            restock_obj := create_object_sid(380, 0, 0, -1);
+                            restock_obj := create_object(380, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 380));
                         end
                         else begin
@@ -1450,17 +1450,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 380);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 380);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1478,7 +1478,7 @@ begin
                 end
                 else begin
                     if (obj_is_carrying_obj_pid(self_obj, 380) < restock_amt) then begin
-                        restock_obj := create_object_sid(380, 0, 0, -1);
+                        restock_obj := create_object(380, 0, 0);
                         add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 380));
                     end
                     else begin
@@ -1491,17 +1491,17 @@ begin
                                 restock_obj := obj_carrying_pid_obj(self_obj, 380);
                                 if (obj_type(self_obj) == 1) then begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 380);
-                                    if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                        if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                            restock_obj := critter_inven_obj(self_obj, 0);
+                                    if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                        if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                            restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                             debug_msg("armour pid == " + obj_pid(restock_obj));
                                             rm_obj_from_inven(self_obj, restock_obj);
                                             add_obj_to_inven(self_obj, restock_obj);
                                         end
                                     end
                                     else begin
-                                        if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                            metarule(43, self_obj);
+                                        if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                            inven_unwield(self_obj);
                                         end
                                     end
                                 end
@@ -1519,11 +1519,11 @@ begin
             end
             else begin
                 if (tile_num(self_obj) == 25519) then begin
-                    restock_amt := random(1, 1);
+                    restock_amt := 1;
                     if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
-                                restock_obj := create_object_sid(20, 0, 0, -1);
+                                restock_obj := create_object(20, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 20));
                             end
                             else begin
@@ -1536,17 +1536,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 20);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 20);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1564,7 +1564,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 20) < restock_amt) then begin
-                            restock_obj := create_object_sid(20, 0, 0, -1);
+                            restock_obj := create_object(20, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 20));
                         end
                         else begin
@@ -1577,17 +1577,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 20);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 20);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1606,7 +1606,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 383) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 383) < restock_amt) then begin
-                                restock_obj := create_object_sid(383, 0, 0, -1);
+                                restock_obj := create_object(383, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 383));
                             end
                             else begin
@@ -1619,17 +1619,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 383);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 383);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1647,7 +1647,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 383) < restock_amt) then begin
-                            restock_obj := create_object_sid(383, 0, 0, -1);
+                            restock_obj := create_object(383, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 383));
                         end
                         else begin
@@ -1660,17 +1660,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 383);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 383);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1689,7 +1689,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 384) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 384) < restock_amt) then begin
-                                restock_obj := create_object_sid(384, 0, 0, -1);
+                                restock_obj := create_object(384, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 384));
                             end
                             else begin
@@ -1702,17 +1702,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 384);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 384);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1730,7 +1730,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 384) < restock_amt) then begin
-                            restock_obj := create_object_sid(384, 0, 0, -1);
+                            restock_obj := create_object(384, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 384));
                         end
                         else begin
@@ -1743,17 +1743,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 384);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 384);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1772,7 +1772,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                                restock_obj := create_object_sid(40, 0, 0, -1);
+                                restock_obj := create_object(40, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                             end
                             else begin
@@ -1785,17 +1785,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1813,7 +1813,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 40) < restock_amt) then begin
-                            restock_obj := create_object_sid(40, 0, 0, -1);
+                            restock_obj := create_object(40, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 40));
                         end
                         else begin
@@ -1826,17 +1826,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 40);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 40);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1855,7 +1855,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 47) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 47) < restock_amt) then begin
-                                restock_obj := create_object_sid(47, 0, 0, -1);
+                                restock_obj := create_object(47, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 47));
                             end
                             else begin
@@ -1868,17 +1868,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 47);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 47);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1896,7 +1896,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 47) < restock_amt) then begin
-                            restock_obj := create_object_sid(47, 0, 0, -1);
+                            restock_obj := create_object(47, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 47));
                         end
                         else begin
@@ -1909,17 +1909,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 47);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 47);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -1938,7 +1938,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
                         if (80 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-                                restock_obj := create_object_sid(49, 0, 0, -1);
+                                restock_obj := create_object(49, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
                             end
                             else begin
@@ -1951,17 +1951,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 49);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 49);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -1979,7 +1979,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 49) < restock_amt) then begin
-                            restock_obj := create_object_sid(49, 0, 0, -1);
+                            restock_obj := create_object(49, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 49));
                         end
                         else begin
@@ -1992,17 +1992,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 49);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 49);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2021,7 +2021,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 48) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 48) < restock_amt) then begin
-                                restock_obj := create_object_sid(48, 0, 0, -1);
+                                restock_obj := create_object(48, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 48));
                             end
                             else begin
@@ -2034,17 +2034,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 48);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 48);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2062,7 +2062,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 48) < restock_amt) then begin
-                            restock_obj := create_object_sid(48, 0, 0, -1);
+                            restock_obj := create_object(48, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 48));
                         end
                         else begin
@@ -2075,17 +2075,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 48);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 48);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2104,7 +2104,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 53) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 53) < restock_amt) then begin
-                                restock_obj := create_object_sid(53, 0, 0, -1);
+                                restock_obj := create_object(53, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 53));
                             end
                             else begin
@@ -2117,17 +2117,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 53);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 53);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2145,7 +2145,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 53) < restock_amt) then begin
-                            restock_obj := create_object_sid(53, 0, 0, -1);
+                            restock_obj := create_object(53, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 53));
                         end
                         else begin
@@ -2158,17 +2158,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 53);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 53);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2187,7 +2187,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                                restock_obj := create_object_sid(71, 0, 0, -1);
+                                restock_obj := create_object(71, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                             end
                             else begin
@@ -2200,17 +2200,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2228,7 +2228,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 71) < restock_amt) then begin
-                            restock_obj := create_object_sid(71, 0, 0, -1);
+                            restock_obj := create_object(71, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 71));
                         end
                         else begin
@@ -2241,17 +2241,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 71);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 71);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2270,7 +2270,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 87) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 87) < restock_amt) then begin
-                                restock_obj := create_object_sid(87, 0, 0, -1);
+                                restock_obj := create_object(87, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 87));
                             end
                             else begin
@@ -2283,17 +2283,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 87);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 87);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2311,7 +2311,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 87) < restock_amt) then begin
-                            restock_obj := create_object_sid(87, 0, 0, -1);
+                            restock_obj := create_object(87, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 87));
                         end
                         else begin
@@ -2324,17 +2324,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 87);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 87);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2353,7 +2353,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 91) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 91) < restock_amt) then begin
-                                restock_obj := create_object_sid(91, 0, 0, -1);
+                                restock_obj := create_object(91, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 91));
                             end
                             else begin
@@ -2366,17 +2366,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 91);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 91);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2394,7 +2394,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 91) < restock_amt) then begin
-                            restock_obj := create_object_sid(91, 0, 0, -1);
+                            restock_obj := create_object(91, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 91));
                         end
                         else begin
@@ -2407,17 +2407,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 91);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 91);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2436,7 +2436,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 109) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 109) < restock_amt) then begin
-                                restock_obj := create_object_sid(109, 0, 0, -1);
+                                restock_obj := create_object(109, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 109));
                             end
                             else begin
@@ -2449,17 +2449,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 109);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 109);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2477,7 +2477,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 109) < restock_amt) then begin
-                            restock_obj := create_object_sid(109, 0, 0, -1);
+                            restock_obj := create_object(109, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 109));
                         end
                         else begin
@@ -2490,17 +2490,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 109);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 109);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2519,7 +2519,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 110) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 110) < restock_amt) then begin
-                                restock_obj := create_object_sid(110, 0, 0, -1);
+                                restock_obj := create_object(110, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 110));
                             end
                             else begin
@@ -2532,17 +2532,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 110);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 110);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2560,7 +2560,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 110) < restock_amt) then begin
-                            restock_obj := create_object_sid(110, 0, 0, -1);
+                            restock_obj := create_object(110, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 110));
                         end
                         else begin
@@ -2573,17 +2573,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 110);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 110);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2602,7 +2602,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
-                                restock_obj := create_object_sid(144, 0, 0, -1);
+                                restock_obj := create_object(144, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 144));
                             end
                             else begin
@@ -2615,17 +2615,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 144);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 144);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2643,7 +2643,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 144) < restock_amt) then begin
-                            restock_obj := create_object_sid(144, 0, 0, -1);
+                            restock_obj := create_object(144, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 144));
                         end
                         else begin
@@ -2656,17 +2656,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 144);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 144);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2685,7 +2685,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
-                                restock_obj := create_object_sid(271, 0, 0, -1);
+                                restock_obj := create_object(271, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 271));
                             end
                             else begin
@@ -2698,17 +2698,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 271);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 271);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2726,7 +2726,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 271) < restock_amt) then begin
-                            restock_obj := create_object_sid(271, 0, 0, -1);
+                            restock_obj := create_object(271, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 271));
                         end
                         else begin
@@ -2739,17 +2739,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 271);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 271);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2768,7 +2768,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
-                                restock_obj := create_object_sid(272, 0, 0, -1);
+                                restock_obj := create_object(272, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 272));
                             end
                             else begin
@@ -2781,17 +2781,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 272);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 272);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2809,7 +2809,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 272) < restock_amt) then begin
-                            restock_obj := create_object_sid(272, 0, 0, -1);
+                            restock_obj := create_object(272, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 272));
                         end
                         else begin
@@ -2822,17 +2822,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 272);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 272);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2851,7 +2851,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
                         if (35 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                                restock_obj := create_object_sid(273, 0, 0, -1);
+                                restock_obj := create_object(273, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                             end
                             else begin
@@ -2864,17 +2864,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2892,7 +2892,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 273) < restock_amt) then begin
-                            restock_obj := create_object_sid(273, 0, 0, -1);
+                            restock_obj := create_object(273, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 273));
                         end
                         else begin
@@ -2905,17 +2905,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 273);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 273);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -2934,7 +2934,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 284) < restock_amt) then begin
                         if (45 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 284) < restock_amt) then begin
-                                restock_obj := create_object_sid(284, 0, 0, -1);
+                                restock_obj := create_object(284, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 284));
                             end
                             else begin
@@ -2947,17 +2947,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 284);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 284);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -2975,7 +2975,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 284) < restock_amt) then begin
-                            restock_obj := create_object_sid(284, 0, 0, -1);
+                            restock_obj := create_object(284, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 284));
                         end
                         else begin
@@ -2988,17 +2988,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 284);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 284);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3017,7 +3017,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 408) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 408) < restock_amt) then begin
-                                restock_obj := create_object_sid(408, 0, 0, -1);
+                                restock_obj := create_object(408, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 408));
                             end
                             else begin
@@ -3030,17 +3030,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 408);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 408);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3058,7 +3058,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 408) < restock_amt) then begin
-                            restock_obj := create_object_sid(408, 0, 0, -1);
+                            restock_obj := create_object(408, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 408));
                         end
                         else begin
@@ -3071,17 +3071,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 408);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 408);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3100,7 +3100,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 73) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 73) < restock_amt) then begin
-                                restock_obj := create_object_sid(73, 0, 0, -1);
+                                restock_obj := create_object(73, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 73));
                             end
                             else begin
@@ -3113,17 +3113,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 73);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 73);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3141,7 +3141,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 73) < restock_amt) then begin
-                            restock_obj := create_object_sid(73, 0, 0, -1);
+                            restock_obj := create_object(73, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 73));
                         end
                         else begin
@@ -3154,17 +3154,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 73);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 73);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3183,7 +3183,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 76) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 76) < restock_amt) then begin
-                                restock_obj := create_object_sid(76, 0, 0, -1);
+                                restock_obj := create_object(76, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 76));
                             end
                             else begin
@@ -3196,17 +3196,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 76);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 76);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3224,7 +3224,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 76) < restock_amt) then begin
-                            restock_obj := create_object_sid(76, 0, 0, -1);
+                            restock_obj := create_object(76, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 76));
                         end
                         else begin
@@ -3237,17 +3237,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 76);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 76);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3266,7 +3266,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 80) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 80) < restock_amt) then begin
-                                restock_obj := create_object_sid(80, 0, 0, -1);
+                                restock_obj := create_object(80, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 80));
                             end
                             else begin
@@ -3279,17 +3279,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 80);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 80);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3307,7 +3307,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 80) < restock_amt) then begin
-                            restock_obj := create_object_sid(80, 0, 0, -1);
+                            restock_obj := create_object(80, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 80));
                         end
                         else begin
@@ -3320,17 +3320,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 80);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 80);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3349,7 +3349,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 86) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 86) < restock_amt) then begin
-                                restock_obj := create_object_sid(86, 0, 0, -1);
+                                restock_obj := create_object(86, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 86));
                             end
                             else begin
@@ -3362,17 +3362,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 86);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 86);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3390,7 +3390,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 86) < restock_amt) then begin
-                            restock_obj := create_object_sid(86, 0, 0, -1);
+                            restock_obj := create_object(86, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 86));
                         end
                         else begin
@@ -3403,17 +3403,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 86);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 86);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3432,7 +3432,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 102) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 102) < restock_amt) then begin
-                                restock_obj := create_object_sid(102, 0, 0, -1);
+                                restock_obj := create_object(102, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 102));
                             end
                             else begin
@@ -3445,17 +3445,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 102);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 102);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3473,7 +3473,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 102) < restock_amt) then begin
-                            restock_obj := create_object_sid(102, 0, 0, -1);
+                            restock_obj := create_object(102, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 102));
                         end
                         else begin
@@ -3486,17 +3486,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 102);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 102);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3515,7 +3515,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 228) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 228) < restock_amt) then begin
-                                restock_obj := create_object_sid(228, 0, 0, -1);
+                                restock_obj := create_object(228, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 228));
                             end
                             else begin
@@ -3528,17 +3528,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 228);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 228);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3556,7 +3556,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 228) < restock_amt) then begin
-                            restock_obj := create_object_sid(228, 0, 0, -1);
+                            restock_obj := create_object(228, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 228));
                         end
                         else begin
@@ -3569,17 +3569,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 228);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 228);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3598,7 +3598,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 237) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 237) < restock_amt) then begin
-                                restock_obj := create_object_sid(237, 0, 0, -1);
+                                restock_obj := create_object(237, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 237));
                             end
                             else begin
@@ -3611,17 +3611,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 237);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 237);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3639,7 +3639,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 237) < restock_amt) then begin
-                            restock_obj := create_object_sid(237, 0, 0, -1);
+                            restock_obj := create_object(237, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 237));
                         end
                         else begin
@@ -3652,17 +3652,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 237);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 237);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3681,7 +3681,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 51) < restock_amt) then begin
                         if (33 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 51) < restock_amt) then begin
-                                restock_obj := create_object_sid(51, 0, 0, -1);
+                                restock_obj := create_object(51, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 51));
                             end
                             else begin
@@ -3694,17 +3694,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 51);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 51);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3722,7 +3722,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 51) < restock_amt) then begin
-                            restock_obj := create_object_sid(51, 0, 0, -1);
+                            restock_obj := create_object(51, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 51));
                         end
                         else begin
@@ -3735,17 +3735,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 51);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 51);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3764,7 +3764,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
-                                restock_obj := create_object_sid(52, 0, 0, -1);
+                                restock_obj := create_object(52, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 52));
                             end
                             else begin
@@ -3777,17 +3777,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 52);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 52);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3805,7 +3805,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 52) < restock_amt) then begin
-                            restock_obj := create_object_sid(52, 0, 0, -1);
+                            restock_obj := create_object(52, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 52));
                         end
                         else begin
@@ -3818,17 +3818,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 52);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 52);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3847,7 +3847,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 59) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 59) < restock_amt) then begin
-                                restock_obj := create_object_sid(59, 0, 0, -1);
+                                restock_obj := create_object(59, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 59));
                             end
                             else begin
@@ -3860,17 +3860,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 59);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 59);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3888,7 +3888,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 59) < restock_amt) then begin
-                            restock_obj := create_object_sid(59, 0, 0, -1);
+                            restock_obj := create_object(59, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 59));
                         end
                         else begin
@@ -3901,17 +3901,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 59);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 59);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -3930,7 +3930,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 75) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 75) < restock_amt) then begin
-                                restock_obj := create_object_sid(75, 0, 0, -1);
+                                restock_obj := create_object(75, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 75));
                             end
                             else begin
@@ -3943,17 +3943,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 75);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 75);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -3971,7 +3971,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 75) < restock_amt) then begin
-                            restock_obj := create_object_sid(75, 0, 0, -1);
+                            restock_obj := create_object(75, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 75));
                         end
                         else begin
@@ -3984,17 +3984,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 75);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 75);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4013,7 +4013,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 77) < restock_amt) then begin
                         if (20 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 77) < restock_amt) then begin
-                                restock_obj := create_object_sid(77, 0, 0, -1);
+                                restock_obj := create_object(77, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 77));
                             end
                             else begin
@@ -4026,17 +4026,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 77);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 77);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4054,7 +4054,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 77) < restock_amt) then begin
-                            restock_obj := create_object_sid(77, 0, 0, -1);
+                            restock_obj := create_object(77, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 77));
                         end
                         else begin
@@ -4067,17 +4067,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 77);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 77);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4096,7 +4096,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 84) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 84) < restock_amt) then begin
-                                restock_obj := create_object_sid(84, 0, 0, -1);
+                                restock_obj := create_object(84, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 84));
                             end
                             else begin
@@ -4109,17 +4109,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 84);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 84);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4137,7 +4137,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 84) < restock_amt) then begin
-                            restock_obj := create_object_sid(84, 0, 0, -1);
+                            restock_obj := create_object(84, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 84));
                         end
                         else begin
@@ -4150,17 +4150,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 84);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 84);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4179,7 +4179,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
                         if (60 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
-                                restock_obj := create_object_sid(85, 0, 0, -1);
+                                restock_obj := create_object(85, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 85));
                             end
                             else begin
@@ -4192,17 +4192,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 85);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 85);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4220,7 +4220,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 85) < restock_amt) then begin
-                            restock_obj := create_object_sid(85, 0, 0, -1);
+                            restock_obj := create_object(85, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 85));
                         end
                         else begin
@@ -4233,17 +4233,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 85);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 85);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4262,7 +4262,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
-                                restock_obj := create_object_sid(127, 0, 0, -1);
+                                restock_obj := create_object(127, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 127));
                             end
                             else begin
@@ -4275,17 +4275,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 127);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 127);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4303,7 +4303,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 127) < restock_amt) then begin
-                            restock_obj := create_object_sid(127, 0, 0, -1);
+                            restock_obj := create_object(127, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 127));
                         end
                         else begin
@@ -4316,17 +4316,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 127);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 127);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4345,7 +4345,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 410) < restock_amt) then begin
                         if (40 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 410) < restock_amt) then begin
-                                restock_obj := create_object_sid(410, 0, 0, -1);
+                                restock_obj := create_object(410, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 410));
                             end
                             else begin
@@ -4358,17 +4358,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 410);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 410);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4386,7 +4386,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 410) < restock_amt) then begin
-                            restock_obj := create_object_sid(410, 0, 0, -1);
+                            restock_obj := create_object(410, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 410));
                         end
                         else begin
@@ -4399,17 +4399,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 410);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 410);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4428,7 +4428,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 411) < restock_amt) then begin
                         if (35 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 411) < restock_amt) then begin
-                                restock_obj := create_object_sid(411, 0, 0, -1);
+                                restock_obj := create_object(411, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 411));
                             end
                             else begin
@@ -4441,17 +4441,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 411);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 411);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4469,7 +4469,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 411) < restock_amt) then begin
-                            restock_obj := create_object_sid(411, 0, 0, -1);
+                            restock_obj := create_object(411, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 411));
                         end
                         else begin
@@ -4482,17 +4482,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 411);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 411);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4511,7 +4511,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 226) < restock_amt) then begin
                         if (30 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 226) < restock_amt) then begin
-                                restock_obj := create_object_sid(226, 0, 0, -1);
+                                restock_obj := create_object(226, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 226));
                             end
                             else begin
@@ -4524,17 +4524,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 226);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 226);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4552,7 +4552,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 226) < restock_amt) then begin
-                            restock_obj := create_object_sid(226, 0, 0, -1);
+                            restock_obj := create_object(226, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 226));
                         end
                         else begin
@@ -4565,17 +4565,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 226);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 226);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4594,7 +4594,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
-                                restock_obj := create_object_sid(363, 0, 0, -1);
+                                restock_obj := create_object(363, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 363));
                             end
                             else begin
@@ -4607,17 +4607,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4635,7 +4635,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 363) < restock_amt) then begin
-                            restock_obj := create_object_sid(363, 0, 0, -1);
+                            restock_obj := create_object(363, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 363));
                         end
                         else begin
@@ -4648,17 +4648,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 363);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 363);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4677,7 +4677,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 382) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 382) < restock_amt) then begin
-                                restock_obj := create_object_sid(382, 0, 0, -1);
+                                restock_obj := create_object(382, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 382));
                             end
                             else begin
@@ -4690,17 +4690,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 382);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 382);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4718,7 +4718,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 382) < restock_amt) then begin
-                            restock_obj := create_object_sid(382, 0, 0, -1);
+                            restock_obj := create_object(382, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 382));
                         end
                         else begin
@@ -4731,17 +4731,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 382);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 382);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4760,7 +4760,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
-                                restock_obj := create_object_sid(39, 0, 0, -1);
+                                restock_obj := create_object(39, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 39));
                             end
                             else begin
@@ -4773,17 +4773,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4801,7 +4801,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 39) < restock_amt) then begin
-                            restock_obj := create_object_sid(39, 0, 0, -1);
+                            restock_obj := create_object(39, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 39));
                         end
                         else begin
@@ -4814,17 +4814,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 39);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 39);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4843,7 +4843,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 37) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 37) < restock_amt) then begin
-                                restock_obj := create_object_sid(37, 0, 0, -1);
+                                restock_obj := create_object(37, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 37));
                             end
                             else begin
@@ -4856,17 +4856,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 37);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 37);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4884,7 +4884,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 37) < restock_amt) then begin
-                            restock_obj := create_object_sid(37, 0, 0, -1);
+                            restock_obj := create_object(37, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 37));
                         end
                         else begin
@@ -4897,17 +4897,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 37);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 37);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -4926,7 +4926,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
-                                restock_obj := create_object_sid(33, 0, 0, -1);
+                                restock_obj := create_object(33, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 33));
                             end
                             else begin
@@ -4939,17 +4939,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -4967,7 +4967,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 33) < restock_amt) then begin
-                            restock_obj := create_object_sid(33, 0, 0, -1);
+                            restock_obj := create_object(33, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 33));
                         end
                         else begin
@@ -4980,17 +4980,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 33);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 33);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5009,7 +5009,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 32) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 32) < restock_amt) then begin
-                                restock_obj := create_object_sid(32, 0, 0, -1);
+                                restock_obj := create_object(32, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 32));
                             end
                             else begin
@@ -5022,17 +5022,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5050,7 +5050,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 32) < restock_amt) then begin
-                            restock_obj := create_object_sid(32, 0, 0, -1);
+                            restock_obj := create_object(32, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 32));
                         end
                         else begin
@@ -5063,17 +5063,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 32);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 32);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5092,7 +5092,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 357) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 357) < restock_amt) then begin
-                                restock_obj := create_object_sid(357, 0, 0, -1);
+                                restock_obj := create_object(357, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 357));
                             end
                             else begin
@@ -5105,17 +5105,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5133,7 +5133,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 357) < restock_amt) then begin
-                            restock_obj := create_object_sid(357, 0, 0, -1);
+                            restock_obj := create_object(357, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 357));
                         end
                         else begin
@@ -5146,17 +5146,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 357);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 357);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5175,7 +5175,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 361) < restock_amt) then begin
                         if (65 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 361) < restock_amt) then begin
-                                restock_obj := create_object_sid(361, 0, 0, -1);
+                                restock_obj := create_object(361, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 361));
                             end
                             else begin
@@ -5188,17 +5188,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5216,7 +5216,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 361) < restock_amt) then begin
-                            restock_obj := create_object_sid(361, 0, 0, -1);
+                            restock_obj := create_object(361, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 361));
                         end
                         else begin
@@ -5229,17 +5229,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 361);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 361);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5258,7 +5258,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 362) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 362) < restock_amt) then begin
-                                restock_obj := create_object_sid(362, 0, 0, -1);
+                                restock_obj := create_object(362, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 362));
                             end
                             else begin
@@ -5271,17 +5271,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 362);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 362);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5299,7 +5299,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 362) < restock_amt) then begin
-                            restock_obj := create_object_sid(362, 0, 0, -1);
+                            restock_obj := create_object(362, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 362));
                         end
                         else begin
@@ -5312,17 +5312,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 362);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 362);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5341,7 +5341,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
-                                restock_obj := create_object_sid(29, 0, 0, -1);
+                                restock_obj := create_object(29, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 29));
                             end
                             else begin
@@ -5354,17 +5354,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5382,7 +5382,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 29) < restock_amt) then begin
-                            restock_obj := create_object_sid(29, 0, 0, -1);
+                            restock_obj := create_object(29, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 29));
                         end
                         else begin
@@ -5395,17 +5395,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 29);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 29);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5424,7 +5424,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                                restock_obj := create_object_sid(30, 0, 0, -1);
+                                restock_obj := create_object(30, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
                             end
                             else begin
@@ -5437,17 +5437,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 30);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 30);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5465,7 +5465,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 30) < restock_amt) then begin
-                            restock_obj := create_object_sid(30, 0, 0, -1);
+                            restock_obj := create_object(30, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 30));
                         end
                         else begin
@@ -5478,17 +5478,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 30);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 30);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5507,7 +5507,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
                         if (50 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
-                                restock_obj := create_object_sid(360, 0, 0, -1);
+                                restock_obj := create_object(360, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 360));
                             end
                             else begin
@@ -5520,17 +5520,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5548,7 +5548,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 360) < restock_amt) then begin
-                            restock_obj := create_object_sid(360, 0, 0, -1);
+                            restock_obj := create_object(360, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 360));
                         end
                         else begin
@@ -5561,17 +5561,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 360);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 360);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5590,7 +5590,7 @@ begin
                     if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
                         if (100 >= random(1, 100)) then begin
                             if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
-                                restock_obj := create_object_sid(34, 0, 0, -1);
+                                restock_obj := create_object(34, 0, 0);
                                 add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 34));
                             end
                             else begin
@@ -5603,17 +5603,17 @@ begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                         if (obj_type(self_obj) == 1) then begin
                                             restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                            if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                                if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                    restock_obj := critter_inven_obj(self_obj, 0);
+                                            if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                                if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                    restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                     debug_msg("armour pid == " + obj_pid(restock_obj));
                                                     rm_obj_from_inven(self_obj, restock_obj);
                                                     add_obj_to_inven(self_obj, restock_obj);
                                                 end
                                             end
                                             else begin
-                                                if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                    metarule(43, self_obj);
+                                                if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                    inven_unwield(self_obj);
                                                 end
                                             end
                                         end
@@ -5631,7 +5631,7 @@ begin
                     end
                     else begin
                         if (obj_is_carrying_obj_pid(self_obj, 34) < restock_amt) then begin
-                            restock_obj := create_object_sid(34, 0, 0, -1);
+                            restock_obj := create_object(34, 0, 0);
                             add_mult_objs_to_inven(self_obj, restock_obj, restock_amt - obj_is_carrying_obj_pid(self_obj, 34));
                         end
                         else begin
@@ -5644,17 +5644,17 @@ begin
                                     restock_obj := obj_carrying_pid_obj(self_obj, 34);
                                     if (obj_type(self_obj) == 1) then begin
                                         restock_obj := obj_carrying_pid_obj(self_obj, 34);
-                                        if (critter_inven_obj(self_obj, 0) == restock_obj) then begin
-                                            if (obj_item_subtype(critter_inven_obj(self_obj, 0)) == 0) then begin
-                                                restock_obj := critter_inven_obj(self_obj, 0);
+                                        if (critter_inven_obj(self_obj, INVEN_TYPE_WORN) == restock_obj) then begin
+                                            if (obj_item_subtype(critter_inven_obj(self_obj, INVEN_TYPE_WORN)) == 0) then begin
+                                                restock_obj := critter_inven_obj(self_obj, INVEN_TYPE_WORN);
                                                 debug_msg("armour pid == " + obj_pid(restock_obj));
                                                 rm_obj_from_inven(self_obj, restock_obj);
                                                 add_obj_to_inven(self_obj, restock_obj);
                                             end
                                         end
                                         else begin
-                                            if ((critter_inven_obj(self_obj, 2) == restock_obj) or (critter_inven_obj(self_obj, 1) == restock_obj)) then begin
-                                                metarule(43, self_obj);
+                                            if ((critter_inven_obj(self_obj, INVEN_TYPE_LEFT_HAND) == restock_obj) or (critter_inven_obj(self_obj, INVEN_TYPE_RIGHT_HAND) == restock_obj)) then begin
+                                                inven_unwield(self_obj);
                                             end
                                         end
                                     end
@@ -5691,4 +5691,3 @@ end
 procedure timed_event_p_proc
 begin
 end
-
